const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/DkdmLFCq.js","../chunks/DMifMBhm.js","../chunks/Dp-glvE3.js","../chunks/Bb2EGTyq.js"])))=>i.map(i=>d[i]);
import{a as B,s as Ee,_ as Me}from"../chunks/Bb2EGTyq.js";import"../chunks/DsnmJJEf.js";import{d as ze,o as Ae,s as x}from"../chunks/Dp-glvE3.js";import{d as le,e as Q,a as l,p as Pe,f as p,j as i,s as n,t as N,i as Oe,k as c,g as a,B as h,C as I,r as o,n as E,D as Be}from"../chunks/DMifMBhm.js";import{e as De,s as ie,i as Ve,r as Ge}from"../chunks/TsqZmrQj.js";import{l as Re,s as Te,i as f}from"../chunks/COuqRsV2.js";import{a as He,c as Je,i as Le,b as Se}from"../chunks/DkdmLFCq.js";import{p as Ue}from"../chunks/D0w_JB7G.js";import{C as We,l as Qe}from"../chunks/CdqG5YMz.js";import{g as oe}from"../chunks/CV7-XOrz.js";import{U as qe,r as ne,W as Fe}from"../chunks/CRUYibrV.js";import{v as Ke}from"../chunks/BYmFNSF7.js";import{C as Xe}from"../chunks/BqMHeLcl.js";import"../chunks/BwJf7g35.js";import{I as Ye,s as Ze}from"../chunks/ChfAoN8L.js";function de(D,M){const V=Re(M,["children","$$slots","$$events","$$legacy"]);const w=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["path",{d:"M12 9v4"}],["path",{d:"M12 17h.01"}]];Ye(D,Te({name:"triangle-alert"},()=>V,{get iconNode(){return w},children:(g,q)=>{var b=le(),G=Q(b);Ze(G,M,"default",{}),l(g,b)},$$slots:{default:!0}}))}var ea=p('<span class="block text-xs mt-1 uppercase tracking-widest text-slate-500 font-black"> </span>'),aa=p('<div class="mt-4 px-3 py-1 bg-amber-500/10 border border-amber-500/20 rounded-full text-[10px] text-amber-500 font-bold uppercase tracking-wider animate-pulse flex items-center gap-2"><!> Aguardando o Mestre ficar online...</div>'),ta=p('<div class="mb-6 bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center gap-3"><!> <p class="text-red-400 text-sm font-bold"> </p></div>'),ra=p('<p class="text-red-400 text-xs mt-1">Senha incorreta.</p>'),sa=p('<div class="mb-6 bg-slate-950/50 p-4 rounded-xl border border-slate-800"><label for="campaign-pwd-input" class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-indigo-500 animate-pulse"></div> Senha Necessária</label> <input id="campaign-pwd-input" type="password" placeholder="Digite a senha da campanha..."/> <!></div>'),ia=p('<button><div class="w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-xs font-bold"> </div> <div class="flex-1 text-left"><div class="font-bold text-sm"> </div> <div class="text-[10px] opacity-60"> </div></div> <!></button>'),oa=p("<div>Nenhum personagem encontrado.</div> <div>Crie um personagem primeiro!</div>",1),na=p('<div class="flex flex-col items-center gap-2"><!> <div class="text-amber-500 font-bold">Todos os seus personagens já estão em campanhas.</div> <div class="text-xs text-slate-500">Crie um novo personagem ou saia de uma campanha existente.</div></div>'),da=p('<div class="text-center py-8 text-slate-600 italic text-sm space-y-2"><!></div>'),la=p('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> Validando...',1),ca=p('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> Carregando...',1),va=p('<div class="min-h-screen bg-slate-950 flex items-center justify-center p-4"><div class="max-w-md w-full bg-slate-900 border border-slate-800 rounded-2xl p-8 shadow-2xl"><div class="flex flex-col items-center text-center mb-8"><div class="w-16 h-16 bg-indigo-600/20 rounded-full flex items-center justify-center text-indigo-400 mb-4 border border-indigo-500/30"><!></div> <h1 class="text-2xl font-bold text-white mb-2">Convite para Campanha</h1> <p class="text-slate-400">Você foi convidado para participar de <span class="text-indigo-400 font-bold"> </span> <!></p> <!></div> <!> <!> <div class="space-y-4 mb-8"><label for="char-selector" class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2">Escolha seu Personagem</label> <div id="char-selector" class="space-y-2 max-h-60 overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div> <div class="flex gap-3"><button class="flex-1 py-3 rounded-xl bg-slate-800 hover:bg-slate-700 text-white font-bold transition-all">Recusar</button> <button class="flex-1 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold transition-all shadow-lg shadow-indigo-900/20 flex items-center justify-center gap-2"><!></button></div></div></div> <!>',1);function Na(D,M){Pe(M,!0);const V=()=>B(Ue,"$page",b),w=()=>B(Je,"$character",b),g=()=>B(Qe,"$liveCharacters",b),q=()=>B(Le,"$isGmOnline",b),[b,G]=Ee(),$=V().params.id;let y=I(()=>w().campaignName||"Buscando campanha..."),R=I(()=>w().gmName||"..."),z=I(()=>w().passwordHash),F=I(()=>g().filter(t=>!t.campaignId)),m=h(null),A=h(!1),C=h(""),k=h(!1),P=h(!1),_=h("");Ae(()=>{$&&He($,!1)});async function ce(){if(c(_,""),!a(m)||!$)return;if(g().find(e=>e.id===a(m))?.campaignId){c(_,"Este personagem já está em uma campanha!");return}if(a(z)){if(!a(C)){c(k,!0);return}c(P,!0);const e=await Ke(a(C),a(z));if(c(P,!1),!e){c(k,!0);return}}c(k,!1),c(A,!0)}function ve(){if(!a(m)||!$)return;const t=g().find(e=>e.id===a(m));if(t){if(t.campaignId){c(_,"Este personagem já está em uma campanha!"),c(A,!1);return}Me(async()=>{const{charactersMap:e}=await import("../chunks/DkdmLFCq.js").then(r=>r.Q);return{charactersMap:e}},__vite__mapDeps([0,1,2,3]),import.meta.url).then(({charactersMap:e})=>{e.set(a(m),{...t,campaignId:$,campaignName:a(y),gmName:a(R),campaignApproval:"pending"}),oe(ne("/characters/[id]",{id:a(m)}))})}}var K=va(),T=Q(K),X=i(T),H=i(X),J=i(H),pe=i(J);qe(pe,{size:32}),o(J);var L=n(J,4),S=n(i(L)),me=i(S,!0);o(S);var fe=n(S,2);{var ue=t=>{var e=ea(),r=i(e);o(e),N(()=>x(r,`Mestre: ${a(R)??""}`)),l(t,e)};f(fe,t=>{a(R)!=="..."&&t(ue)})}o(L);var ge=n(L,2);{var be=t=>{var e=aa(),r=i(e);Fe(r,{size:12}),E(),o(e),l(t,e)};f(ge,t=>{q()||t(be)})}o(H);var Y=n(H,2);{var _e=t=>{var e=ta(),r=i(e);de(r,{size:20,class:"text-red-500 mb-0.5"});var v=n(r,2),u=i(v,!0);o(v),o(e),N(()=>x(u,a(_))),l(t,e)};f(Y,t=>{a(_)&&t(_e)})}var Z=n(Y,2);{var xe=t=>{var e=sa(),r=n(i(e),2);Ge(r);var v=n(r,2);{var u=s=>{var d=ra();l(s,d)};f(v,s=>{a(k)&&s(u)})}o(e),N(()=>ie(r,1,`w-full bg-slate-900 border ${a(k)?"border-red-500":"border-slate-700"} rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors`)),Se(r,()=>a(C),s=>c(C,s)),l(t,e)};f(Z,t=>{a(z)&&t(xe)})}var U=n(Z,2),ee=n(i(U),2),ae=i(ee);De(ae,17,()=>a(F),Ve,(t,e)=>{var r=ia();r.__click=()=>{c(m,a(e).id,!0),c(_,"")};var v=i(r),u=i(v,!0);o(v);var s=n(v,2),d=i(s),W=i(d,!0);o(d);var se=n(d,2),je=i(se);o(se),o(s);var Ne=n(s,2);{var Ie=j=>{Xe(j,{size:16,class:"text-indigo-400"})};f(Ne,j=>{a(m)===a(e).id&&j(Ie)})}o(r),N(j=>{ie(r,1,`w-full flex items-center gap-3 p-3 rounded-xl border transition-all ${a(m)===a(e).id?"bg-indigo-600/20 border-indigo-500 text-white":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`),x(u,j),x(W,a(e).name),x(je,`Lvl ${a(e).level??""} • ${a(e).ancestry??""}`)},[()=>a(e).name.charAt(0)]),l(t,r)});var he=n(ae,2);{var we=t=>{var e=da(),r=i(e);{var v=s=>{var d=oa();E(2),l(s,d)},u=s=>{var d=na(),W=i(d);de(W,{size:24,class:"text-amber-500"}),E(4),o(d),l(s,d)};f(r,s=>{g().length===0?s(v):s(u,!1)})}o(e),l(t,e)};f(he,t=>{a(F).length===0&&t(we)})}o(ee),o(U);var te=n(U,2),re=i(te);re.__click=()=>oe(ne("/"));var O=n(re,2);O.__click=ce;var $e=i(O);{var ye=t=>{var e=la();E(),l(t,e)},Ce=t=>{var e=le(),r=Q(e);{var v=s=>{var d=ca();E(),l(s,d)},u=s=>{var d=Be("Aceitar Convite");l(s,d)};f(r,s=>{a(y)==="Buscando campanha..."?s(v):s(u,!1)},!0)}l(t,e)};f($e,t=>{a(P)?t(ye):t(Ce,!1)})}o(O),o(te),o(X),o(T);var ke=n(T,2);{let t=I(()=>`Deseja entrar na campanha "${a(y)}" com o personagem "${g().find(e=>e.id===a(m))?.name}"?`);We(ke,{get isOpen(){return a(A)},title:"Confirmar Participação",get message(){return a(t)},onConfirm:ve,onCancel:()=>c(A,!1)})}N(()=>{x(me,a(y)),O.disabled=!a(m)||a(P)||!!a(z)&&!a(C)||a(y)==="Buscando campanha..."}),l(D,K),Oe(),G()}ze(["click"]);export{Na as component};
