import"../chunks/DsnmJJEf.js";import"../chunks/ChbcetSK.js";import{u as ce,v as T,k as v,w as kt,j as h,z as $t,A as m,D as ye,B as r,y as a,x as t,F as e,t as y,n as Gt,a9 as xa,V as ra,ak as zr,E as It,at as Cr,G as Er,L as tr,bc as Ba}from"../chunks/DfayzYqb.js";import{d as St,o as Ia,s as d,w as Ta,g as bt,e as ea}from"../chunks/Cx0o8vWd.js";import{l as zt,s as Ct,i as x,p as yt}from"../chunks/C746LlRB.js";import{h as ha}from"../chunks/DcAUHn_s.js";import{a as Ue,$ as Bt,e as mt,s as Ge,i as Mt,r as dt,b as ba,h as Pr,k as qa}from"../chunks/Bs3V2B0j.js";import{a as Tt,s as Be,b as Nr}from"../chunks/DukWTdxy.js";import{I as Et,s as Pt}from"../chunks/tM_ceOsH.js";import{X as gr,C as Va,b as Ea,S as Mr,M as fr,f as Ir,a as Ua,D as Tr,q as la,A as jr,c as ar,P as La,e as Or}from"../chunks/q51fhgLv.js";import{t as Ve,b as gt,c as Ka,f as da}from"../chunks/D1-YRAfI.js";import{l as hr,a as Ya,b as Ar,c as Dr}from"../chunks/COIJJyGo.js";import{d as qt,b as ct,u as rr,t as Gr,v as Br}from"../chunks/Bx7F0qE8.js";import{f as Kt,c as lt,a as nt,e as $a,b as Sa,i as Ja}from"../chunks/CdkHlkWG.js";import{b as Ur,g as za}from"../chunks/D3fOdLgx.js";import{r as ta,C as _a,U as sr,W as Lr}from"../chunks/TBMN0-ks.js";import{S as br,a as Rr,b as Fr,D as aa,G as Ca,C as Hr,g as Ra}from"../chunks/DXWhg5s7.js";import{G as Xa,S as Za,C as Wr,P as or}from"../chunks/Ceu7Fgqy.js";import{L as qr,U as wa,S as ir,a as Vr}from"../chunks/uRVIJNgA.js";import{c as Kr}from"../chunks/BASt3_wo.js";import{S as Yr}from"../chunks/D6v5F6iE.js";import{h as Jr}from"../chunks/BYmFNSF7.js";import{C as Xr}from"../chunks/DhygBu6m.js";import{b as Zr}from"../chunks/UR9fxUxp.js";function ma(f,l){const n=zt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M5 12h14"}],["path",{d:"m12 5 7 7-7 7"}]];Et(f,Ct({name:"arrow-right"},()=>n,{get iconNode(){return g},children:(i,c)=>{var o=ce(),u=T(o);Pt(u,l,"default",{}),v(i,o)},$$slots:{default:!0}}))}function mr(f,l){const n=zt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M12 7v14"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"}]];Et(f,Ct({name:"book-open"},()=>n,{get iconNode(){return g},children:(i,c)=>{var o=ce(),u=T(o);Pt(u,l,"default",{}),v(i,o)},$$slots:{default:!0}}))}function Qr(f,l){const n=zt(l,["children","$$slots","$$events","$$legacy"]);const g=[["circle",{cx:"12",cy:"12",r:"10"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16"}]];Et(f,Ct({name:"circle-alert"},()=>n,{get iconNode(){return g},children:(i,c)=>{var o=ce(),u=T(o);Pt(u,l,"default",{}),v(i,o)},$$slots:{default:!0}}))}function es(f,l){const n=zt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"m2 2 20 20"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07"}]];Et(f,Ct({name:"cloud-off"},()=>n,{get iconNode(){return g},children:(i,c)=>{var o=ce(),u=T(o);Pt(u,l,"default",{}),v(i,o)},$$slots:{default:!0}}))}function ts(f,l){const n=zt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"}]];Et(f,Ct({name:"cloud"},()=>n,{get iconNode(){return g},children:(i,c)=>{var o=ce(),u=T(o);Pt(u,l,"default",{}),v(i,o)},$$slots:{default:!0}}))}function nr(f,l){const n=zt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]];Et(f,Ct({name:"download"},()=>n,{get iconNode(){return g},children:(i,c)=>{var o=ce(),u=T(o);Pt(u,l,"default",{}),v(i,o)},$$slots:{default:!0}}))}function as(f,l){const n=zt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56"}]];Et(f,Ct({name:"loader-circle"},()=>n,{get iconNode(){return g},children:(i,c)=>{var o=ce(),u=T(o);Pt(u,l,"default",{}),v(i,o)},$$slots:{default:!0}}))}function rs(f,l){const n=zt(l,["children","$$slots","$$events","$$legacy"]);const g=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21"}]];Et(f,Ct({name:"monitor"},()=>n,{get iconNode(){return g},children:(i,c)=>{var o=ce(),u=T(o);Pt(u,l,"default",{}),v(i,o)},$$slots:{default:!0}}))}function ss(f,l){const n=zt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor"}]];Et(f,Ct({name:"palette"},()=>n,{get iconNode(){return g},children:(i,c)=>{var o=ce(),u=T(o);Pt(u,l,"default",{}),v(i,o)},$$slots:{default:!0}}))}function os(f,l){const n=zt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]];Et(f,Ct({name:"refresh-cw"},()=>n,{get iconNode(){return g},children:(i,c)=>{var o=ce(),u=T(o);Pt(u,l,"default",{}),v(i,o)},$$slots:{default:!0}}))}function Fa(f,l){const n=zt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3"}]];Et(f,Ct({name:"scroll"},()=>n,{get iconNode(){return g},children:(i,c)=>{var o=ce(),u=T(o);Pt(u,l,"default",{}),v(i,o)},$$slots:{default:!0}}))}function is(f,l){const n=zt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"}],["path",{d:"M12 8v4"}],["path",{d:"M12 16h.01"}]];Et(f,Ct({name:"shield-alert"},()=>n,{get iconNode(){return g},children:(i,c)=>{var o=ce(),u=T(o);Pt(u,l,"default",{}),v(i,o)},$$slots:{default:!0}}))}var ns=h('<button class="fixed bottom-28 md:bottom-6 right-6 z-[60] bg-indigo-600 hover:bg-indigo-500 text-white h-14 px-4 rounded-full shadow-2xl shadow-indigo-900/50 flex items-center justify-center font-bold animate-pulse hover:animate-none transition-all active:scale-95 group"><!> <span class="text-sm uppercase tracking-wider max-w-0 overflow-hidden ml-0 group-hover:max-w-xs group-hover:ml-2 transition-all duration-300 md:max-w-xs md:ml-2 md:inline"> </span></button>'),ls=h("<div><!></div>"),ds=h("<div><!></div>"),cs=h('<li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">1</span> <!></li> <li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">2</span> <div><!></div></li>',1),vs=h('<li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">1</span> <div><!></div></li> <li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">2</span> <div><!></div></li>',1),us=h('<div class="fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-in fade-in"><div class="bg-slate-900 border border-slate-700 rounded-2xl p-6 max-w-sm w-full relative shadow-2xl mb-4 sm:mb-0 animate-in slide-in-from-bottom-10 sm:slide-in-from-bottom-0 sm:zoom-in-95"><button class="absolute top-4 right-4 text-slate-400 hover:text-white p-1"><!></button> <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2"><!> </h3> <ol class="space-y-4 text-slate-300 text-sm"><!></ol> <div class="mt-6 text-center"><button class="text-indigo-400 text-sm font-bold hover:text-indigo-300"> </button></div></div></div>'),ps=h("<!> <!>",1);function gs(f,l){kt(l,!0);const n=()=>Be(Bt,"$t",g),[g,i]=Tt();let c=ye(null),o=ye(!1),u=ye(!1),b=ye(!1),s=ye(!1);Ia(()=>{if(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone){m(o,!1);return}const U=window.navigator.userAgent;m(b,/iPad|iPhone|iPod/.test(U)&&!window.MSStream,!0),m(s,/CriOS/i.test(U),!0),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(U)&&m(o,!0),window.addEventListener("beforeinstallprompt",P=>{P.preventDefault(),m(c,P,!0),m(o,!0)}),window.addEventListener("appinstalled",()=>{m(c,null),m(o,!1),m(u,!1)})});async function I(){if(r(c)){r(c).prompt();const{outcome:D}=await r(c).userChoice;D==="accepted"&&(m(c,null),m(o,!1))}else m(u,!0)}const S="inline w-3.5 h-3.5",j=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${S}"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" x2="12" y1="2" y2="15"/></svg>`,Q=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${S}"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M8 12h8"/><path d="M12 8v8"/></svg>`,V=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${S}"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></svg>`;function z(D,U){const J=n()(D),P=`<span class="inline-flex items-center justify-center bg-slate-800 p-1 rounded mx-1 align-middle">${U}</span>`;return J.replace("{icon}",P)}var E=ps(),ee=T(E);{var w=D=>{var U=ns();U.__click=I;var J=t(U);nr(J,{size:24});var P=a(J,2),N=t(P,!0);e(P),e(U),y((k,$)=>{Ue(U,"aria-label",k),d(N,$)},[()=>n()("home.install.button"),()=>n()("home.install.button")]),v(D,U)};x(ee,D=>{r(o)&&D(w)})}var W=a(ee,2);{var A=D=>{var U=us(),J=t(U),P=t(J);P.__click=()=>m(u,!1);var N=t(P);gr(N,{size:20}),e(P);var k=a(P,2),$=t(k);nr($,{size:24,class:"text-indigo-500"});var M=a($);e(k);var te=a(k,2),oe=t(te);{var re=B=>{var H=cs(),xe=T(H),Ie=a(t(xe),2);{var Ee=ne=>{var q=ls(),Z=t(q);ha(Z,()=>z("home.install.ios_chrome_step1",j)),e(q),v(ne,q)},L=ne=>{var q=ds(),Z=t(q);ha(Z,()=>z("home.install.ios_step1",j)),e(q),v(ne,q)};x(Ie,ne=>{r(s)?ne(Ee):ne(L,!1)})}e(xe);var F=a(xe,2),ae=a(t(F),2),Fe=t(ae);ha(Fe,()=>z("home.install.ios_step2",Q)),e(ae),e(F),v(B,H)},ue=B=>{var H=vs(),xe=T(H),Ie=a(t(xe),2),Ee=t(Ie);ha(Ee,()=>z("home.install.android_step1",V)),e(Ie),e(xe);var L=a(xe,2),F=a(t(L),2),ae=t(F);ha(ae,()=>n()("home.install.android_step2")),e(F),e(L),v(B,H)};x(oe,B=>{r(b)?B(re):B(ue,!1)})}e(te);var ie=a(te,2),ke=t(ie);ke.__click=()=>m(u,!1);var X=t(ke,!0);e(ke),e(ie),e(J),e(U),y((B,H)=>{d(M,` ${B??""}`),d(X,H)},[()=>n()("home.install.title"),()=>n()("home.install.close")]),v(D,U)};x(W,D=>{r(u)&&D(A)})}v(f,E),$t(),i()}St(["click"]);var fs=h('<div class="absolute top-4 right-4 bg-black/50 p-2 rounded-full backdrop-blur-sm border border-white/10"><!></div>'),hs=h('<div class="absolute top-4 right-4 bg-indigo-500 p-2 rounded-full shadow-lg shadow-indigo-500/40 animate-in zoom-in duration-200"><!></div>'),bs=h('<div><div class="absolute inset-0 bg-slate-900"><img/> <div class="absolute inset-0 bg-gradient-to-t from-black via-black/80 to-transparent"></div></div> <div class="relative p-6 h-full flex flex-col justify-end min-h-[200px]"><!> <!> <div><h3 class="text-xl font-black text-white uppercase leading-tight mb-2 group-hover:text-indigo-400 transition-colors"> </h3> <p class="text-xs text-slate-400 font-medium leading-relaxed max-w-[90%]"> </p></div></div> <div class="absolute inset-0 bg-indigo-500/10 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"></div></div>'),ms=h('<div class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>');function _r(f,l){kt(l,!0);const n=()=>Be(Bt,"$t",g),[g,i]=Tt(),c={sofdl:ta("/artworks/books/sofdl-core.webp"),sofww:ta("/artworks/books/sofww-core.webp"),dle:ta("/artworks/books/dle-core.webp")},o={dle:"object-[center_75%]",sofww:"object-center",sofdl:"object-center"};function u(I){return c[I]||""}function b(I){return o[I]||"object-center"}var s=ms();mt(s,21,()=>br,Mt,(I,S)=>{var j=bs();j.__click=()=>!r(S).disabled&&l.onSelect(r(S).id);var Q=t(j),V=t(Q);Gt(2),e(Q);var z=a(Q,2),E=t(z);{var ee=N=>{var k=fs(),$=t(k);qr($,{size:16,class:"text-slate-400"}),e(k),v(N,k)};x(E,N=>{r(S).disabled&&N(ee)})}var w=a(E,2);{var W=N=>{var k=hs(),$=t(k);_a($,{size:16,class:"text-white"}),e(k),v(N,k)};x(w,N=>{l.selectedSystem===r(S).id&&N(W)})}var A=a(w,2),D=t(A),U=t(D,!0);e(D);var J=a(D,2),P=t(J,!0);e(J),e(A),e(z),Gt(2),e(j),y((N,k,$,M,te)=>{Ge(j,1,`group relative rounded-2xl overflow-hidden cursor-pointer transition-all duration-300 border-2
            ${l.selectedSystem===r(S).id?"border-indigo-500 ring-2 ring-indigo-500/50 scale-[1.02]":"border-transparent hover:border-white/20 hover:scale-[1.01]"}
            ${r(S).disabled?"opacity-50 cursor-not-allowed grayscale":""}`),Ue(V,"src",N),Ue(V,"alt",k),Ge(V,1,`w-full h-full object-cover ${$??""} opacity-40 group-hover:opacity-60 transition-opacity duration-500`),d(U,M),d(P,te)},[()=>u(r(S).id),()=>n()(r(S).nameKey),()=>b(r(S).id),()=>n()(r(S).nameKey),()=>n()(r(S).descriptionKey)]),v(I,j)}),e(s),v(f,s),$t(),i()}St(["click"]);const _s=["Alistair","Baelor","Caelum","Daeron","Eldric","Fenris","Gareth","Havelock","Ignis","Jarek","Kaelen","Lucius","Malacor","Nyx","Orion","Pireus","Quintus","Rurik","Severus","Thorne","Ulric","Valerius","Wulfric","Xander","Yoric","Zephyr","Azura","Bellatrix","Celeste","Dahlia"],xs=["Aethelgard","Bramble","Cinder","Driftwood","Ember","Fable","Gossamer","Hollow","Ivy","Juniper","Kestrel","Lark","Moss","Nettle","Omen","Pebble","Quill","Rowan","Sage","Thistle","Umber","Vesper","Willow","Yarrow","Zephyr","Ash","Birch","Crow","Dusk"],lr=["the Brave","the Cursed","the Swift","the Wise","the Fool","the Strong","the Shadow","the Light","of the North","of the South","the Wanderer","the Lost","the Broken","the Eternal","the Mad"];function xr(f="person"){const l=Math.random()>.5?_s:xs,n=l[Math.floor(Math.random()*l.length)];if(f==="person")return Math.random()>.7?`${n} ${lr[Math.floor(Math.random()*lr.length)]}`:n;{const g=["Shadow","Legacy","Curse","Fall","Rise","Revenge","Secret","Tale","Legend","Doom"],i=["of","of the","from","and"];return`The ${g[Math.floor(Math.random()*g.length)]} ${i[Math.floor(Math.random()*i.length)]} ${n}`}}const Wt=Ta("idle"),er=Ta(null),Pa=Ta(null),ws="701898444454-7ml9onnv529k99rkvgh1slhdj4a1arrm.apps.googleusercontent.com",dr="https://www.googleapis.com/auth/drive.appdata https://www.googleapis.com/auth/userinfo.profile",Xe=Ta({signedIn:!1,accessToken:null,tokenExpiry:null,userProfile:null,isInited:!1});let Na,cr=!1;const ca="wwv_google_session";function ys(){localStorage.removeItem(ca),Xe.update(f=>({...f,signedIn:!1,accessToken:null,tokenExpiry:null,userProfile:null})),console.log("Session cleared due to expired or invalid token")}async function Ma(){ys(),console.warn("OAuth token expired or invalid. Please sign in again.")}async function wr(f){try{const l=await fetch("https://www.googleapis.com/oauth2/v1/userinfo?alt=json",{headers:{Authorization:`Bearer ${f}`}});if(l.status===401){await Ma();return}if(l.ok){const n=await l.json();Xe.update(g=>({...g,userProfile:{name:n.name,picture:n.picture}})),yr()}}catch(l){console.error("Failed to fetch user profile:",l)}}function ks(){try{const f=localStorage.getItem(ca);if(f){const l=JSON.parse(f);if(l.accessToken)return l.tokenExpiry&&Date.now()>l.tokenExpiry?(console.log("Stored token is expired, clearing session"),localStorage.removeItem(ca),!1):(Xe.set({signedIn:!0,accessToken:l.accessToken,tokenExpiry:l.tokenExpiry||null,userProfile:l.userProfile||null,isInited:!0}),console.log("Restored session from localStorage"),wr(l.accessToken),!0)}}catch(f){console.error("Failed to load stored session:",f)}return!1}function yr(){const f=bt(Xe);f.signedIn&&f.accessToken?localStorage.setItem(ca,JSON.stringify({accessToken:f.accessToken,tokenExpiry:f.tokenExpiry,userProfile:f.userProfile})):localStorage.removeItem(ca)}async function $s(){const f=ws;if(ks()){try{await ur(),Na=google.accounts.oauth2.initTokenClient({client_id:f,scope:dr,callback:vr}),cr=!0}catch(n){console.warn("Could not initialize GIS after restoring session:",n)}return}try{await ur(),Na=google.accounts.oauth2.initTokenClient({client_id:f,scope:dr,callback:vr}),cr=!0,Xe.update(n=>({...n,isInited:!0})),console.log("Google Auth Initialized")}catch(n){console.error("Failed to initialize Google Auth:",n),Pa.set("init_failed"),Xe.update(g=>({...g,isInited:!0}))}}function vr(f){if(f.error!==void 0){console.error("Google Auth Error:",f);return}console.log("Google Auth Success",f);const l=f.expires_in||3600,n=Date.now()+l*1e3;Xe.update(g=>({...g,signedIn:!0,accessToken:f.access_token,tokenExpiry:n})),yr(),wr(f.access_token)}let Qt=null;function ur(){return typeof window>"u"||typeof google<"u"&&google.accounts?Promise.resolve():Qt||(Qt=new Promise((f,l)=>{if(document.querySelector('script[src="https://accounts.google.com/gsi/client"]')){const i=setInterval(()=>{typeof google<"u"&&google.accounts&&(clearInterval(i),f())},100);setTimeout(()=>{clearInterval(i),(typeof google>"u"||!google.accounts)&&(Qt=null,l(new Error("Google Identity Services script found but failed to initialize")))},5e3);return}const g=document.createElement("script");g.src="https://accounts.google.com/gsi/client",g.async=!0,g.defer=!0,g.onload=()=>{const i=setInterval(()=>{typeof google<"u"&&google.accounts&&(clearInterval(i),f())},50);setTimeout(()=>{clearInterval(i),(typeof google>"u"||!google.accounts)&&(Qt=null,l(new Error("Google object not available after script load")))},5e3)},g.onerror=()=>{Qt=null;const c=!navigator.onLine?"Failed to load Google script: No internet connection":"Failed to load Google script: Blocked by browser or network error";l(new Error(c))},document.head.appendChild(g)}),Qt)}function kr(){Na?(Pa.set(null),Na.requestAccessToken()):(console.error("Google Auth not initialized"),Pa.set("not_initialized"),Wt.set("error"))}function Ss(){const f=bt(Xe).accessToken;localStorage.removeItem(ca),Xe.update(l=>({...l,signedIn:!1,accessToken:null,tokenExpiry:null,userProfile:null})),f&&typeof google<"u"&&google.accounts&&google.accounts.oauth2.revoke(f,()=>{console.log("Access token revoked")})}async function $r(){const f=bt(Xe),l=f.accessToken;if(!l)throw new Error("Not signed in");if(f.tokenExpiry&&Date.now()>f.tokenExpiry)throw await Ma(),new Error("Token expired, please sign in again");const g=`https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent("name = 'weird-wizard-backup.json' and 'appDataFolder' in parents and trashed = false")}&spaces=appDataFolder&fields=files(id, name, modifiedTime, size)`,i=await fetch(g,{headers:{Authorization:`Bearer ${l}`}});if(i.status===401)throw await Ma(),new Error("Token expired, please sign in again");if(!i.ok)throw new Error("Failed to list backups: "+i.statusText);return(await i.json()).files||[]}async function zs(f){const l=bt(Xe).accessToken;if(!l)throw new Error("Not signed in");const n=JSON.stringify(f),g="weird-wizard-backup.json",i=await $r(),c=i.length>0?i[0].id:null;if(c){const o=`https://www.googleapis.com/upload/drive/v3/files/${c}?uploadType=media`,u=await fetch(o,{method:"PATCH",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:n});if(!u.ok){const b=await u.text();throw console.error("Upload error details:",b),new Error("Upload failed: "+u.statusText)}return await u.json()}else{const o={name:g,mimeType:"application/json",parents:["appDataFolder"]},u=new FormData;u.append("metadata",new Blob([JSON.stringify(o)],{type:"application/json"})),u.append("file",new Blob([n],{type:"application/json"}));const s=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:{Authorization:`Bearer ${l}`},body:u});if(!s.ok){const I=await s.text();throw console.error("Upload error details:",I),new Error("Upload failed: "+s.statusText)}return await s.json()}}async function Cs(f){const l=bt(Xe).accessToken;if(!l)throw new Error("Not signed in");const n=`https://www.googleapis.com/drive/v3/files/${f}?alt=media`,g=await fetch(n,{headers:{Authorization:`Bearer ${l}`}});if(g.status===401)throw await Ma(),new Error("Token expired, please sign in again");if(!g.ok)throw new Error("Download failed: "+g.statusText);return await g.json()}let Ha;async function Qa(){if(bt(Xe).accessToken)try{console.log("Syncing from cloud..."),Wt.set("syncing");const l=await $r();if(l.length===0){console.log("No backups found in cloud."),Wt.set("success");return}const n=l[0].id,g=await Cs(n),i=new Set;if(Kt.forEach((c,o)=>{i.add(String(o)),console.log("[DEBUG] Local deleted ID entry:",{key:o,type:typeof o,val:c})}),console.log("[DEBUG] Total locally deleted IDs:",i.size),g.deletedIds&&Array.isArray(g.deletedIds)){console.log("[DEBUG] Cloud data deletedIds count:",g.deletedIds.length);for(const c of g.deletedIds){const o=String(c.id);Kt.has(o)||(Kt.set(o,c),console.log("[DEBUG] New deletion synced from cloud:",o)),i.add(o),c.type==="character"&&lt.has(o)&&(lt.delete(o),console.log("[DEBUG] Removed char locally based on cloud deletion:",o)),c.type==="campaign"&&nt.has(o)&&(nt.delete(o),console.log("[DEBUG] Removed camp locally based on cloud deletion:",o)),c.type==="enemy"&&$a.has(o)&&($a.delete(o),console.log("[DEBUG] Removed enemy locally based on cloud deletion:",o)),c.type==="encounter"&&Sa.has(o)&&(Sa.delete(o),console.log("[DEBUG] Removed encounter locally based on cloud deletion:",o))}}if(g.characters&&Array.isArray(g.characters)){console.log("[DEBUG] Syncing",g.characters.length,"characters from cloud");for(const c of g.characters){const o=String(c.id);if(i.has(o)||Kt.has(o)){console.log("[DEBUG] Skipping character because it is marked as deleted:",{id:o,name:c.name}),lt.has(o)&&(console.log("[DEBUG] Character found locally but marked deleted. Removing now:",o),lt.delete(o));for(const I of lt.keys()){const S=lt.get(I);S&&S.id===o&&(console.log("[DEBUG] Mismatched key entry found for deleted char. Removing:",I),lt.delete(I))}continue}const u=lt.get(o),b=c.lastUpdate||0,s=u?.lastUpdate||0;if(u&&s>b){console.log("[DEBUG] Skipping cloud overwrite for character, local is newer:",{id:o,localTime:s,cloudTime:b});continue}console.log("[DEBUG] Syncing character from cloud:",{id:o,name:c.name,status:u?"OVERWRITING":"ADDING"}),lt.set(o,c)}}if(g.campaigns&&Array.isArray(g.campaigns)){console.log("[DEBUG] Syncing",g.campaigns.length,"campaigns from cloud");for(const c of g.campaigns){const o=String(c.id);if(i.has(o)||Kt.has(o)){console.log("[DEBUG] Skipping campaign because it is marked as deleted:",{id:o,name:c.name}),nt.has(o)&&(console.log("[DEBUG] Campaign found locally but marked deleted. Removing now:",o),nt.delete(o));for(const I of nt.keys()){const S=nt.get(I);S&&S.id===o&&(console.log("[DEBUG] Mismatched key entry found for deleted camp. Removing:",I),nt.delete(I))}continue}const u=nt.get(o),b=c.lastUpdate||0,s=u?.lastUpdate||0;if(u&&s>b){console.log("[DEBUG] Skipping cloud overwrite for campaign, local is newer:",{id:o,localTime:s,cloudTime:b});continue}console.log("[DEBUG] Syncing campaign from cloud:",{id:o,name:c.name,status:nt.has(o)?"OVERWRITING":"ADDING"}),nt.set(o,c)}}if(g.enemies&&Array.isArray(g.enemies))for(const c of g.enemies){const o=String(c.id);!i.has(o)&&!$a.has(o)&&$a.set(o,c)}if(g.encounters&&Array.isArray(g.encounters))for(const c of g.encounters){const o=String(c.id);!i.has(o)&&!Sa.has(o)&&Sa.set(o,c)}if(g.images&&typeof g.images=="object"){console.log("[DEBUG] Syncing",Object.keys(g.images).length,"images from cloud");for(const[c,o]of Object.entries(g.images))Ja.has(c)||(Ja.set(c,o),console.log("[DEBUG] New image synced from cloud:",c))}if(g.appSettings){console.log("[DEBUG] Syncing app settings from cloud");const c=bt(qt),o={...g.appSettings};!o.userName&&(o.defaultPlayerName||o.defaultGmName)&&(o.userName=o.defaultPlayerName||o.defaultGmName||"",console.log("[DEBUG] Migrated legacy settings to userName:",o.userName)),delete o.defaultPlayerName,delete o.defaultGmName;const u={...o,...c};console.log("[DEBUG] Merged settings:",{current:c,cloud:o,merged:u}),qt.set(u)}console.log("[DEBUG] Sync from cloud complete."),Wt.set("success"),er.set(Date.now())}catch(l){console.error("Failed to sync from cloud:",l),Wt.set("error")}}async function Wa(){bt(Xe).accessToken&&(Ha&&clearTimeout(Ha),Ha=setTimeout(async()=>{try{console.log("Syncing to cloud..."),Wt.set("syncing");const l=[],n=new Set;Kt.forEach((s,I)=>{l.push({id:I,...s}),n.add(String(I))});const g=bt(hr).filter(s=>!n.has(String(s.id))),i=bt(Ya).filter(s=>!n.has(String(s.id))),c=bt(Ar).filter(s=>!n.has(String(s.id))),o=bt(Dr).filter(s=>!n.has(String(s.id))),u={};Ja.forEach((s,I)=>{u[I]=s});const b={characters:g,campaigns:i,enemies:c,encounters:o,images:u,deletedIds:l,appSettings:bt(qt),timestamp:Date.now(),version:1,appName:"WeirdWizardVault"};console.log("[DEBUG] Uploading to cloud:",{charactersCount:b.characters.length,campaignsCount:b.campaigns.length,enemiesCount:c.length,imagesCount:Object.keys(u).length,deletedIdsCount:l.length}),await zs(b),console.log("Sync to cloud complete."),Wt.set("success"),er.set(Date.now())}catch(l){console.error("Failed to sync to cloud:",l),Wt.set("error")}},2e3))}var Es=h('<button class="p-2 -ml-2 hover:bg-white/5 rounded-full text-slate-400 hover:text-white transition-all"><!></button>'),Ps=h("<div></div>"),Ns=h('<div class="space-y-6 text-center"><h3 class="text-3xl md:text-4xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400 max-w-lg mx-auto mb-8"> </p> <!></div>'),Ms=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="space-y-6"><div><label class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest"> </label> <div class="relative"><input class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 text-lg font-bold text-white outline-none transition-all placeholder:text-slate-600"/> <button class="absolute right-3 top-1/2 -translate-y-1/2 p-2 text-slate-500 hover:text-indigo-400 hover:bg-indigo-500/10 rounded-lg transition-all"><!></button></div></div> <div><label class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest"> </label> <input class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 font-medium text-white outline-none transition-all placeholder:text-slate-600"/></div> <div><label class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest"> </label> <textarea class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 text-white outline-none transition-all resize-none placeholder:text-slate-600" rows="4"></textarea></div> <button class="w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> <!></button></div></div>'),Is=h('<div class="w-6 h-6 rounded-full bg-indigo-500 flex items-center justify-center shadow-[0_0_10px_rgba(99,102,241,0.5)]"><!></div>'),Ts=h('<button><div class="flex-1"><div> </div> <div class="text-xs opacity-60 mt-1 font-medium"> </div></div> <!></button>'),js=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="space-y-3"></div> <button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> <!></button></div>'),Os=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="bg-slate-900/50 border border-slate-800 rounded-2xl p-6 space-y-4"><label class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest flex items-center gap-2"><!> </label> <input type="password" class="w-full bg-slate-950 border border-slate-700 rounded-xl p-4 text-white outline-none focus:border-indigo-500 transition-all placeholder:text-slate-700 font-mono text-center tracking-widest text-lg" placeholder="••••••••"/> <p class="text-xs text-slate-500 leading-relaxed text-center px-4"> </p></div> <button class="w-full bg-emerald-500 hover:bg-emerald-400 text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-emerald-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> </button></div>'),As=h('<div class="fixed inset-0 bg-slate-950/95 backdrop-blur-md z-[100] flex flex-col overflow-hidden"><div class="px-6 py-4 flex items-center justify-between border-b border-white/5 bg-white/[0.02]"><div class="flex items-center gap-4"><!> <div><h2 class="text-xl font-black text-white uppercase tracking-tight"> </h2> <div class="flex items-center gap-2 mt-1"></div></div></div> <button class="text-slate-500 hover:text-white font-bold text-xs uppercase tracking-widest px-4 py-2 hover:bg-white/5 rounded-lg transition-all"> </button></div> <div class="flex-1 overflow-y-auto custom-scrollbar p-6 flex flex-col items-center svelte-1uk72qn"><div class="w-full max-w-2xl py-8"><!></div></div></div>');function Ds(f,l){kt(l,!0);const n=()=>Be(qt,"$appSettings",c),g=()=>Be(Xe,"$googleSession",c),i=()=>Be(Bt,"$t",c),[c,o]=Tt();let u=yt(l,"isOpen",3,!1),b=ye(1),s=xa({name:"",description:"",gmName:"",password:"",system:"",tier:"starting"});ra(()=>{u()&&(m(b,1),s.system="",s.tier="starting",s.name="",s.description="",s.gmName=n().userName||g().userProfile?.name||"",s.password="")});function I(){m(b,r(b)+1)}function S(){r(b)>1&&m(b,r(b)-1)}function j(w){s.system=w,s.tier=Rr(w),I()}function Q(){l.onSave({...s})}function V(){s.name=xr("campaign")}var z=ce(),E=T(z);{var ee=w=>{var W=As(),A=t(W),D=t(A),U=t(D);{var J=X=>{var B=Es();B.__click=S;var H=t(B);Va(H,{size:24}),e(B),v(X,B)};x(U,X=>{r(b)>1&&X(J)})}var P=a(U,2),N=t(P),k=t(N,!0);e(N);var $=a(N,2);mt($,20,()=>[1,2,3,4],Mt,(X,B)=>{var H=Ps();y(()=>Ge(H,1,`h-1 rounded-full transition-all duration-500 ${B<=r(b)?"w-8 bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]":"w-2 bg-slate-800"}`)),v(X,H)}),e($),e(P),e(D);var M=a(D,2);M.__click=function(...X){l.onClose?.apply(this,X)};var te=t(M,!0);e(M),e(A);var oe=a(A,2),re=t(oe),ue=t(re);{var ie=X=>{var B=Ns(),H=t(B),xe=t(H,!0);e(H);var Ie=a(H,2),Ee=t(Ie,!0);e(Ie);var L=a(Ie,2);_r(L,{get selectedSystem(){return s.system},onSelect:j}),e(B),y((F,ae)=>{d(xe,F),d(Ee,ae)},[()=>i()("wizard.campaign.step1_title"),()=>i()("wizard.campaign.step1_subtitle")]),Ve(1,B,()=>gt,()=>({duration:300,delay:100})),v(X,B)},ke=X=>{var B=ce(),H=T(B);{var xe=Ee=>{var L=Ms(),F=t(L),ae=t(F),Fe=t(ae,!0);e(ae);var ne=a(ae,2),q=t(ne,!0);e(ne),e(F);var Z=a(F,2),$e=t(Z),Ne=t($e),Te=t(Ne,!0);e(Ne);var Se=a(Ne,2),ve=t(Se);dt(ve);var be=a(ve,2);be.__click=V;var me=t(be);Ea(me,{size:20}),e(be),e(Se),e($e);var He=a($e,2),pe=t(He),we=t(pe,!0);e(pe);var G=a(pe,2);dt(G),e(He);var ge=a(He,2),Pe=t(ge),We=t(Pe,!0);e(Pe);var se=a(Pe,2);zr(se),e(ge);var K=a(ge,2);K.__click=I;var fe=t(K),Me=a(fe);ma(Me,{size:20}),e(K),e(Z),e(L),y((Y,le,Le,je,vt,Qe,ze,he,de,_e)=>{d(Fe,Y),d(q,le),d(Te,Le),Ue(ve,"placeholder",je),Ue(be,"title",vt),d(we,Qe),Ue(G,"placeholder",ze),d(We,he),Ue(se,"placeholder",de),K.disabled=!s.name,d(fe,`${_e??""} `)},[()=>i()("wizard.campaign.step2_title"),()=>i()("wizard.campaign.step2_subtitle"),()=>i()("wizard.campaign.step2_name_label"),()=>i()("wizard.campaign.step2_name_placeholder"),()=>i()("wizard.campaign.step2_random_name_tooltip"),()=>i()("wizard.campaign.step2_gm_label"),()=>i()("wizard.campaign.step2_gm_placeholder"),()=>i()("wizard.campaign.step2_description_label"),()=>i()("wizard.campaign.step2_description_placeholder"),()=>i()("wizard.campaign.continue")]),ct(ve,()=>s.name,Y=>s.name=Y),ct(G,()=>s.gmName,Y=>s.gmName=Y),ct(se,()=>s.description,Y=>s.description=Y),Ve(1,L,()=>gt,()=>({duration:300,delay:100})),v(Ee,L)},Ie=Ee=>{var L=ce(),F=T(L);{var ae=ne=>{var q=js(),Z=t(q),$e=t(Z),Ne=t($e,!0);e($e);var Te=a($e,2),Se=t(Te,!0);e(Te),e(Z);var ve=a(Z,2);mt(ve,21,()=>Fr(s.system),Mt,(pe,we)=>{var G=Ts();G.__click=()=>s.tier=r(we).value;var ge=t(G),Pe=t(ge),We=t(Pe,!0);e(Pe);var se=a(Pe,2),K=t(se,!0);e(se),e(ge);var fe=a(ge,2);{var Me=Y=>{var le=Is(),Le=t(le);_a(Le,{size:14,class:"text-white"}),e(le),v(Y,le)};x(fe,Y=>{s.tier===r(we).value&&Y(Me)})}e(G),y((Y,le)=>{Ge(G,1,`w-full relative flex items-center p-4 rounded-xl border-2 text-left transition-all ${s.tier===r(we).value?"bg-indigo-600/10 border-indigo-500 ring-1 ring-indigo-500/50":"bg-slate-900/50 border-slate-800 text-slate-400 hover:border-slate-600 hover:bg-slate-900"}`),Ge(Pe,1,`font-black uppercase tracking-wide text-lg ${s.tier===r(we).value?"text-indigo-400":"text-slate-300"}`),d(We,Y),d(K,le)},[()=>i()(r(we).labelKey),()=>i()("wizard.campaign.step3_tier_description")]),v(pe,G)}),e(ve);var be=a(ve,2);be.__click=I;var me=t(be),He=a(me);ma(He,{size:20}),e(be),e(q),y((pe,we,G)=>{d(Ne,pe),d(Se,we),d(me,`${G??""} `)},[()=>i()("wizard.campaign.step3_title"),()=>i()("wizard.campaign.step3_subtitle"),()=>i()("wizard.campaign.continue")]),Ve(1,q,()=>gt,()=>({duration:300,delay:100})),v(ne,q)},Fe=ne=>{var q=ce(),Z=T(q);{var $e=Ne=>{var Te=Os(),Se=t(Te),ve=t(Se),be=t(ve,!0);e(ve);var me=a(ve,2),He=t(me,!0);e(me),e(Se);var pe=a(Se,2),we=t(pe),G=t(we);Mr(G,{size:14});var ge=a(G);e(we);var Pe=a(we,2);dt(Pe);var We=a(Pe,2),se=t(We,!0);e(We),e(pe);var K=a(pe,2);K.__click=Q;var fe=t(K,!0);e(K),e(Te),y((Me,Y,le,Le,je)=>{d(be,Me),d(He,Y),d(ge,` ${le??""}`),d(se,Le),d(fe,je)},[()=>i()("wizard.campaign.step4_title"),()=>i()("wizard.campaign.step4_subtitle"),()=>i()("wizard.campaign.step4_password_label"),()=>i()("wizard.campaign.step4_password_info"),()=>i()("wizard.campaign.create")]),ct(Pe,()=>s.password,Me=>s.password=Me),Ve(1,Te,()=>gt,()=>({duration:300,delay:100})),v(Ne,Te)};x(Z,Ne=>{r(b)===4&&Ne($e)},!0)}v(ne,q)};x(F,ne=>{r(b)===3?ne(ae):ne(Fe,!1)},!0)}v(Ee,L)};x(H,Ee=>{r(b)===2?Ee(xe):Ee(Ie,!1)},!0)}v(X,B)};x(ue,X=>{r(b)===1?X(ie):X(ke,!1)})}e(re),e(oe),e(W),y((X,B)=>{d(k,X),d(te,B)},[()=>i()("wizard.campaign.title"),()=>i()("wizard.campaign.cancel")]),Ve(3,W,()=>gt,()=>({duration:200})),v(w,W)};x(E,w=>{u()&&w(ee)})}v(f,z),$t(),o()}St(["click"]);var Gs=h('<div class="space-y-4"><div><label class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest flex items-center gap-1"><!> </label> <div class="p-3 bg-slate-800 rounded-lg border border-slate-700 text-slate-300 text-sm font-bold flex items-center gap-2"> <span class="text-[9px] bg-slate-700 text-slate-400 px-1.5 py-0.5 rounded uppercase tracking-wider ml-auto"> </span></div></div> <div><label for="char-name" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest"> </label> <input id="char-name" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div> <div><label for="char-player" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest flex items-center gap-1"><!> </label> <input id="char-player" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div> <div class="grid grid-cols-2 gap-4"><div><label for="char-ancestry" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest"> </label> <input id="char-ancestry" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div> <div><label for="char-level" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest"> </label> <input id="char-level" type="number" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div></div> <div><label for="char-path" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest"> </label> <input id="char-path" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div> <div class="grid grid-cols-2 gap-4"><div><label for="char-defense" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest"> </label> <input id="char-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div> <div><label for="char-health" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest"> </label> <input id="char-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div></div></div> <div class="flex gap-3 mt-8"><button class="flex-1 bg-slate-700 hover:bg-slate-600 transition-all py-3 rounded-xl text-white font-bold active:scale-95"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 transition-all py-3 rounded-xl text-white font-bold shadow-lg shadow-indigo-900/20 active:scale-95"> </button></div>',1);function Bs(f,l){kt(l,!0);const n=()=>Be(Bt,"$t",g),[g,i]=Tt();let c=yt(l,"isOpen",3,!1),o=yt(l,"initialData",3,"{}"),u=xa({name:"",playerName:"",ancestry:"",novicePath:"",level:1,defense:10,health:24,system:aa});ra(()=>{if(c()&&o())try{const s=JSON.parse(o());u.name=s.name||"",u.playerName=s.playerName||"",u.ancestry=s.ancestry||"",u.novicePath=s.paths&&s.paths.novice?s.paths.novice:"",u.level=s.level||1,u.defense=s.defense||10,u.health=s.health||s.normalHealth||24,u.system=s.system||aa}catch{u.name="",u.playerName="",u.ancestry="",u.novicePath="",u.level=1,u.defense=10,u.health=24,u.system=aa}});function b(){l.onSave({...u})}{let s=It(()=>n()("character.settings.title"));fr(f,{get isOpen(){return c()},get onClose(){return l.onClose},get title(){return r(s)},maxWidth:"max-w-md",children:(I,S)=>{var j=Gs(),Q=T(j),V=t(Q),z=t(V),E=t(z);Ca(E,{size:12});var ee=a(E);e(z);var w=a(z,2),W=t(w),A=a(W),D=t(A,!0);e(A),e(w),e(V);var U=a(V,2),J=t(U),P=t(J,!0);e(J);var N=a(J,2);dt(N),e(U);var k=a(U,2),$=t(k),M=t($);wa(M,{size:12});var te=a(M);e($);var oe=a($,2);dt(oe),e(k);var re=a(k,2),ue=t(re),ie=t(ue),ke=t(ie,!0);e(ie);var X=a(ie,2);dt(X),e(ue);var B=a(ue,2),H=t(B),xe=t(H,!0);e(H);var Ie=a(H,2);dt(Ie),e(B),e(re);var Ee=a(re,2),L=t(Ee),F=t(L,!0);e(L);var ae=a(L,2);dt(ae),e(Ee);var Fe=a(Ee,2),ne=t(Fe),q=t(ne),Z=t(q,!0);e(q);var $e=a(q,2);dt($e),e(ne);var Ne=a(ne,2),Te=t(Ne),Se=t(Te,!0);e(Te);var ve=a(Te,2);dt(ve),e(Ne),e(Fe),e(Q);var be=a(Q,2),me=t(be);me.__click=function(...G){l.onClose?.apply(this,G)};var He=t(me,!0);e(me);var pe=a(me,2);pe.__click=b;var we=t(pe,!0);e(pe),e(be),y((G,ge,Pe,We,se,K,fe,Me,Y,le,Le,je,vt,Qe,ze,he)=>{d(ee,` ${G??""}`),d(W,`${ge??""} `),d(D,Pe),d(P,We),Ue(N,"placeholder",se),d(te,` ${K??""}`),Ue(oe,"placeholder",fe),d(ke,Me),Ue(X,"placeholder",Y),d(xe,le),d(F,Le),Ue(ae,"placeholder",je),d(Z,vt),d(Se,Qe),d(He,ze),d(we,he)},[()=>n()("character.settings.system_label"),()=>(()=>{const G=br.find(ge=>ge.id===u.system);return G?n()(G.nameKey):n()("character.settings.system_unknown")})(),()=>n()("character.settings.fixed"),()=>n()("character.settings.name_label"),()=>n()("character.settings.name_placeholder"),()=>n()("character.settings.player_label"),()=>n()("character.settings.player_placeholder"),()=>n()("character.settings.ancestry_label"),()=>n()("character.settings.ancestry_placeholder"),()=>n()("character.settings.level_label"),()=>n()("character.settings.path_label"),()=>n()("character.settings.path_placeholder"),()=>n()("character.settings.defense_label"),()=>n()("character.settings.health_label"),()=>n()("character.settings.cancel"),()=>n()("character.settings.save_changes")]),ct(N,()=>u.name,G=>u.name=G),ct(oe,()=>u.playerName,G=>u.playerName=G),ct(X,()=>u.ancestry,G=>u.ancestry=G),ct(Ie,()=>u.level,G=>u.level=G),ct(ae,()=>u.novicePath,G=>u.novicePath=G),ct($e,()=>u.defense,G=>u.defense=G),ct(ve,()=>u.health,G=>u.health=G),v(I,j)},$$slots:{default:!0}})}$t(),i()}St(["click"]);var Us=h('<button class="p-2 -ml-2 hover:bg-white/5 rounded-full text-slate-400 hover:text-white transition-all"><!></button>'),Ls=h("<div></div>"),Rs=h('<div class="space-y-6 text-center"><h3 class="text-3xl md:text-4xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400 max-w-lg mx-auto mb-8"> </p> <!></div>'),Fs=h("<button> </button>"),Hs=h("<button> </button> <button> </button>",1),Ws=h('<div class="pt-2"><label for="other-ancestry" class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest"> </label> <input id="other-ancestry" class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 text-white outline-none transition-all placeholder:text-slate-600"/></div>'),qs=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="grid grid-cols-2 gap-3"><!></div> <!> <button class="w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> <!></button></div>'),Vs=h('<button class="p-3 rounded-xl border border-slate-800 bg-slate-900/50 hover:bg-slate-800 text-slate-300 hover:text-white font-bold text-xs uppercase tracking-widest transition-all"> </button>'),Ks=h('<div class="grid grid-cols-2 gap-2"></div>'),Ys=h("<button> </button>"),Js=h('<div class="space-y-3"><div class="flex items-center justify-between"><button class="text-xs text-indigo-400 hover:text-indigo-300 font-bold uppercase tracking-widest flex items-center gap-1 transition-all"><!> </button></div> <div class="grid grid-cols-2 gap-2 max-h-48 overflow-y-auto custom-scrollbar pr-2 svelte-n6fmm8"></div></div>'),Xs=h('<div class="w-16 h-16 bg-slate-800 rounded-full mx-auto flex items-center justify-center mb-2"><!></div> <p class="text-xs text-slate-500"> </p>',1),Zs=h('<div class="space-y-1"><div class="text-[10px] text-indigo-400 font-bold uppercase tracking-widest"> </div> <div class="text-xl font-black text-white"> </div></div>'),Qs=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="space-y-4"><!> <div class="bg-slate-900/50 border-2 border-slate-800 rounded-2xl p-6 text-center space-y-4"><!> <button class="w-full bg-white/5 hover:bg-white/10 text-white font-bold py-3 rounded-xl border border-white/10 transition-all flex items-center justify-center gap-2 hover:border-white/20 text-xs"><!> </button></div></div> <button class="w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> <!></button></div>'),eo=h("<button> </button>"),to=h("<button> </button>"),ao=h('<div class="pt-2"><label for="other-path" class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest"> </label> <input id="other-path" class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 text-white outline-none transition-all placeholder:text-slate-600"/></div>'),ro=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="grid grid-cols-2 gap-3"><button class="col-span-2 p-3 text-xs text-slate-500 hover:text-white uppercase tracking-widest hover:underline"> </button> <!></div> <!> <button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> <!></button></div>'),so=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="space-y-6"><div><label for="character-name" class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest"> </label> <div class="relative"><input id="character-name" class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 text-lg font-bold text-white outline-none transition-all placeholder:text-slate-600"/> <button class="absolute right-3 top-1/2 -translate-y-1/2 p-2 text-slate-500 hover:text-indigo-400 hover:bg-indigo-500/10 rounded-lg transition-all"><!></button></div></div> <div><label for="player-name" class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest flex items-center gap-2"><!> </label> <input id="player-name" class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 font-medium text-white outline-none transition-all placeholder:text-slate-600"/></div> <div class="bg-indigo-900/20 border border-indigo-500/20 rounded-xl p-4 flex items-start gap-3"><!> <div><h4 class="text-sm font-bold text-white mb-1"> </h4> <p class="text-xs text-slate-400"> </p></div></div> <button class="w-full bg-emerald-500 hover:bg-emerald-400 disabled:opacity-50 text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-emerald-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> </button></div></div>'),oo=h('<div class="fixed inset-0 bg-slate-950/95 backdrop-blur-md z-[100] flex flex-col overflow-hidden"><div class="px-6 py-4 flex items-center justify-between border-b border-white/5 bg-white/[0.02]"><div class="flex items-center gap-4"><!> <div><h2 class="text-xl font-black text-white uppercase tracking-tight"> </h2> <div class="flex items-center gap-2 mt-1"></div></div></div> <button class="text-slate-500 hover:text-white font-bold text-xs uppercase tracking-widest px-4 py-2 hover:bg-white/5 rounded-lg transition-all"> </button></div> <div class="flex-1 overflow-y-auto custom-scrollbar p-6 flex flex-col items-center svelte-n6fmm8"><div class="w-full max-w-2xl py-8"><!></div></div></div>');function io(f,l){kt(l,!0);const n=()=>Be(qt,"$appSettings",c),g=()=>Be(Xe,"$googleSession",c),i=()=>Be(Bt,"$t",c),[c,o]=Tt();let u=yt(l,"isOpen",3,!1),b=ye(1),s=xa({name:"",playerName:"",system:"",ancestry:"",profession:"",novicePath:""}),I=ye(""),S=ye(""),j=ye("");const Q={sofdl:{Academic:["architecture","astrology","engineering","etiquette_customs","folklore","geography","heraldry","history","law","literature","magic","medicine","navigation","occult","philosophy","politics","nature","religion","science","war"],Criminal:["agitator","beggar","burglar","carouser","charlatan","cultist","fence","forger","gambler","grave_robber","informant","murderer","pickpocket","pirate","prostitute","rebel","saboteur","spy","thug","urchin"],Martial:["constable","detective","guard","jailer","officer","marine","mercenary","militia_member","patroller","peasant_conscript","slave","soldier","squire","torturer"],Wilderness:["bandit","barbarian","exile","gatherer","guide","hermit","hunter","nomad","pioneer","poacher","prospector","outlaw","refugee","spelunker","tracker","trapper","woodcutter"],Religious:["devotee","evangelist","flagellant","heretic","initiate_old_faith","minister","acolyte_new_god","inquisitor_henchman","pilgrim","street_preacher","temple_ward"],Common:["animal_trainer","apothecary","artisan","artist","boatman","butcher","cook","drover","entertainer","farmer","fisher","groom","laborer","merchant","miner","musician","sailor","servant","shopkeeper","teamster"]},sofww:{Entertainment:["acrobat","animal_handler","artist","busker","clown","dancer","fortune_teller","juggler","singer","thespian"],Military:["caravan_guard","herald","house_guard","marine","member_of_the_watch","mercenary_soldier","militia_member","soldier","squire","sworn_bodyguard"],Religious:["acolyte","aspirant","cultist","evangelist","fundamentalist","heretic","missionary","minister","prophet","scribe"],Academic:["apothecary","apprentice_magician","astrologer","doctor","folklorist","inventor","naturalist","occultist","philosopher","politician"],Aristocratic:["carouser","dilettante","merchant","landholder","influencer"],Common:["baker","bartender","carpenter","cook","exterminator","farmer","fisher","gravedigger","groom","herder","jeweler","laborer","mason","miner","sailor","servant","shopkeeper","smith","tanner","teamster"],Criminal:["bandit","burglar","charlatan","constable","detective","forger","grave_robber","jailer","mugger","rake"],Wilderness:["beggar","forester","gatherer","hunter","nomad","pilgrim","prospector","recluse","spelunker","woodcutter"]}};ra(()=>{u()&&(m(b,1),s.system="",s.name="",s.playerName=n().userName||g().userProfile?.name||"",s.ancestry="",s.profession="",s.novicePath="",m(I,""),m(S,""),m(j,""))});function V(){r(b)===2&&s.ancestry==="Other"&&!r(I)||r(b)===4&&s.novicePath==="Other"&&!r(S)||(r(b)===2&&s.ancestry==="Other"&&(s.ancestry=r(I)),r(b)===4&&s.novicePath==="Other"&&(s.novicePath=r(S)),r(b)===3&&m(j,""),m(b,r(b)+1))}function z(){r(b)>1&&m(b,r(b)-1)}function E(P){s.system=P,V()}function ee(){s.name=xr("person")}function w(){const P=s.system==="sofdl"||s.system==="sofww"?s.system:"sofww",N=Q[P],k=Object.keys(N),$=k[Math.floor(Math.random()*k.length)],M=N[$],te=M[Math.floor(Math.random()*M.length)],oe=i()(`professions.${P}.${$.toLowerCase()}.${te}`),re=i()(`professions.categories.${$.toLowerCase()}`);s.profession=`${oe} (${re})`,m(j,"")}function W(P,N){const k=s.system==="sofdl"||s.system==="sofww"?s.system:"sofww",$=i()(`professions.${k}.${P.toLowerCase()}.${N}`),M=i()(`professions.categories.${P.toLowerCase()}`);s.profession=`${$} (${M})`}function A(){s.novicePath==="Other"&&(s.novicePath=r(S));const P=s.system==="sofdl"||s.system==="sofww"?s.system:"sofww";let N=s.ancestry;["Human","Changeling","Clockwork","Dwarf","Goblin","Orc"].includes(N)&&(N=i()(`ancestries.${P}.${N.toLowerCase()}`));let $=s.novicePath;["Magician","Priest","Rogue","Warrior","Fighter","Mage","Ancestry"].includes($)&&($=i()(`paths.${P}.${$.toLowerCase()}`));const te={...s,ancestry:N,novicePath:$,level:s.system==="sofdl"?0:1,health:(s.system==="sofdl",10),defense:10};l.onSave(te)}var D=ce(),U=T(D);{var J=P=>{var N=oo(),k=t(N),$=t(k),M=t($);{var te=L=>{var F=Us();F.__click=z;var ae=t(F);Va(ae,{size:24}),e(F),v(L,F)};x(M,L=>{r(b)>1&&L(te)})}var oe=a(M,2),re=t(oe),ue=t(re,!0);e(re);var ie=a(re,2);mt(ie,20,()=>[1,2,3,4,5],Mt,(L,F)=>{var ae=Ls();y(()=>Ge(ae,1,`h-1 rounded-full transition-all duration-500 ${F<=r(b)?"w-8 bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]":"w-2 bg-slate-800"}`)),v(L,ae)}),e(ie),e(oe),e($);var ke=a($,2);ke.__click=function(...L){l.onClose?.apply(this,L)};var X=t(ke,!0);e(ke),e(k);var B=a(k,2),H=t(B),xe=t(H);{var Ie=L=>{var F=Rs(),ae=t(F),Fe=t(ae,!0);e(ae);var ne=a(ae,2),q=t(ne,!0);e(ne);var Z=a(ne,2);_r(Z,{get selectedSystem(){return s.system},onSelect:E}),e(F),y(($e,Ne)=>{d(Fe,$e),d(q,Ne)},[()=>i()("wizard.character.step1_title"),()=>i()("wizard.character.step1_subtitle")]),Ve(1,F,()=>gt,()=>({duration:300,delay:100})),v(L,F)},Ee=L=>{var F=ce(),ae=T(F);{var Fe=q=>{var Z=qs(),$e=t(Z),Ne=t($e),Te=t(Ne,!0);e(Ne);var Se=a(Ne,2),ve=t(Se,!0);e(Se),e($e);var be=a($e,2),me=t(be);{var He=se=>{var K=ce(),fe=T(K);mt(fe,16,()=>["Human","Changeling","Clockwork","Dwarf","Goblin","Orc","Other"],Mt,(Me,Y)=>{var le=Fs();le.__click=()=>s.ancestry=Y;var Le=t(le,!0);e(le),y(je=>{Ge(le,1,`p-4 rounded-xl border-2 text-center font-bold uppercase tracking-wider transition-all ${s.ancestry===Y?"bg-indigo-600/20 border-indigo-500 text-white shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-600 hover:text-white"}`),d(Le,je)},[()=>i()(`ancestries.sofdl.${Y.toLowerCase()}`)]),v(Me,le)}),v(se,K)},pe=se=>{var K=Hs(),fe=T(K);fe.__click=()=>s.ancestry="Human";var Me=t(fe,!0);e(fe);var Y=a(fe,2);Y.__click=()=>s.ancestry="Other";var le=t(Y,!0);e(Y),y((Le,je)=>{Ge(fe,1,`p-4 rounded-xl border-2 text-center font-bold uppercase tracking-wider transition-all ${s.ancestry==="Human"?"bg-indigo-600/20 border-indigo-500 text-white shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-600 hover:text-white"}`),d(Me,Le),Ge(Y,1,`p-4 rounded-xl border-2 text-center font-bold uppercase tracking-wider transition-all ${s.ancestry==="Other"?"bg-indigo-600/20 border-indigo-500 text-white shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-600 hover:text-white"}`),d(le,je)},[()=>i()("ancestries.sofww.human"),()=>i()("ancestries.sofww.other")]),v(se,K)};x(me,se=>{s.system==="sofdl"?se(He):se(pe,!1)})}e(be);var we=a(be,2);{var G=se=>{var K=Ws(),fe=t(K),Me=t(fe,!0);e(fe);var Y=a(fe,2);dt(Y),e(K),y((le,Le)=>{d(Me,le),Ue(Y,"placeholder",Le)},[()=>i()("wizard.character.step2_other_label"),()=>i()("wizard.character.step2_other_placeholder")]),ct(Y,()=>r(I),le=>m(I,le)),Ve(1,K,()=>Ka),v(se,K)};x(we,se=>{s.ancestry==="Other"&&se(G)})}var ge=a(we,2);ge.__click=V;var Pe=t(ge),We=a(Pe);ma(We,{size:20}),e(ge),e(Z),y((se,K,fe)=>{d(Te,se),d(ve,K),ge.disabled=!s.ancestry||s.ancestry==="Other"&&!r(I),d(Pe,`${fe??""} `)},[()=>i()("wizard.character.step2_title"),()=>i()("wizard.character.step2_subtitle"),()=>i()("wizard.character.continue")]),Ve(1,Z,()=>gt,()=>({duration:300,delay:100})),v(q,Z)},ne=q=>{var Z=ce(),$e=T(Z);{var Ne=Se=>{var ve=Qs(),be=t(ve),me=t(be),He=t(me,!0);e(me);var pe=a(me,2),we=t(pe,!0);e(pe),e(be);var G=a(be,2),ge=t(G);{var Pe=ze=>{var he=Ks();mt(he,21,()=>Object.keys(Q[s.system==="sofdl"?"sofdl":"sofww"]),Mt,(de,_e)=>{var Ce=Vs();Ce.__click=()=>m(j,r(_e),!0);var Ke=t(Ce,!0);e(Ce),y(De=>d(Ke,De),[()=>i()(`professions.categories.${r(_e).toLowerCase()}`)]),v(de,Ce)}),e(he),v(ze,he)},We=ze=>{var he=Js(),de=t(he),_e=t(de);_e.__click=()=>m(j,"");var Ce=t(_e);Va(Ce,{size:14});var Ke=a(Ce);e(_e),e(de);var De=a(de,2);mt(De,21,()=>Q[s.system==="sofdl"?"sofdl":"sofww"][r(j)],Mt,(Oe,at)=>{const ft=It(()=>i()(`professions.${s.system==="sofdl"?"sofdl":"sofww"}.${r(j).toLowerCase()}.${r(at)}`));var _t=Ys();_t.__click=()=>W(r(j),r(at));var R=t(_t,!0);e(_t),y(p=>{Ge(_t,1,`p-2.5 rounded-lg border text-left text-xs font-bold transition-all ${p??""}`),d(R,r(ft))},[()=>s.profession.includes(r(ft))?"bg-indigo-600/20 border-indigo-500 text-white shadow-[0_0_10px_rgba(99,102,241,0.2)]":"bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-700 hover:text-slate-200"]),v(Oe,_t)}),e(De),e(he),y(Oe=>d(Ke,` ${Oe??""}`),[()=>i()(`professions.categories.${r(j).toLowerCase()}`)]),Ve(1,he,()=>gt,()=>({duration:200})),v(ze,he)};x(ge,ze=>{r(j)?ze(We,!1):ze(Pe)})}var se=a(ge,2),K=t(se);{var fe=ze=>{var he=Xs(),de=T(he),_e=t(de);mr(_e,{size:28,class:"text-slate-600"}),e(de);var Ce=a(de,2),Ke=t(Ce,!0);e(Ce),y(De=>d(Ke,De),[()=>i()("wizard.character.step3_empty_message")]),v(ze,he)},Me=ze=>{var he=Zs(),de=t(he),_e=t(de,!0);e(de);var Ce=a(de,2),Ke=t(Ce,!0);e(Ce),e(he),y(De=>{d(_e,De),d(Ke,s.profession)},[()=>i()("wizard.character.step3_your_profession")]),Ve(1,he,()=>gt),v(ze,he)};x(K,ze=>{s.profession?ze(Me,!1):ze(fe)})}var Y=a(K,2);Y.__click=w;var le=t(Y);Ea(le,{size:16});var Le=a(le);e(Y),e(se),e(G);var je=a(G,2);je.__click=V;var vt=t(je),Qe=a(vt);ma(Qe,{size:20}),e(je),e(ve),y((ze,he,de,_e)=>{d(He,ze),d(we,he),d(Le,` ${de??""}`),je.disabled=!s.profession,d(vt,`${_e??""} `)},[()=>i()("wizard.character.step3_title"),()=>i()("wizard.character.step3_subtitle"),()=>s.profession?i()("wizard.character.step3_roll_again"):i()("wizard.character.step3_roll"),()=>i()("wizard.character.continue")]),Ve(1,ve,()=>gt,()=>({duration:300,delay:100})),v(Se,ve)},Te=Se=>{var ve=ce(),be=T(ve);{var me=pe=>{var we=ro(),G=t(we),ge=t(G),Pe=t(ge,!0);e(ge);var We=a(ge,2),se=t(We,!0);e(We),e(G);var K=a(G,2),fe=t(K);fe.__click=()=>s.novicePath="";var Me=t(fe,!0);e(fe);var Y=a(fe,2);{var le=de=>{var _e=ce(),Ce=T(_e);mt(Ce,16,()=>["Magician","Priest","Rogue","Warrior","Other"],Mt,(Ke,De)=>{var Oe=eo();Oe.__click=()=>s.novicePath=De;var at=t(Oe,!0);e(Oe),y(ft=>{Ge(Oe,1,`p-4 rounded-xl border-2 text-center font-bold uppercase tracking-wider transition-all ${s.novicePath===De?"bg-indigo-600/20 border-indigo-500 text-white shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-600 hover:text-white"}`),d(at,ft)},[()=>i()(`paths.sofdl.${De.toLowerCase()}`)]),v(Ke,Oe)}),v(de,_e)},Le=de=>{var _e=ce(),Ce=T(_e);mt(Ce,16,()=>["Fighter","Mage","Priest","Rogue","Ancestry","Other"],Mt,(Ke,De)=>{var Oe=to();Oe.__click=()=>s.novicePath=De;var at=t(Oe,!0);e(Oe),y(ft=>{Ge(Oe,1,`p-4 rounded-xl border-2 text-center font-bold uppercase tracking-wider transition-all ${s.novicePath===De?"bg-indigo-600/20 border-indigo-500 text-white shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-600 hover:text-white"}`),d(at,ft)},[()=>i()(`paths.sofww.${De.toLowerCase()}`)]),v(Ke,Oe)}),v(de,_e)};x(Y,de=>{s.system==="sofdl"?de(le):de(Le,!1)})}e(K);var je=a(K,2);{var vt=de=>{var _e=ao(),Ce=t(_e),Ke=t(Ce,!0);e(Ce);var De=a(Ce,2);dt(De),e(_e),y((Oe,at)=>{d(Ke,Oe),Ue(De,"placeholder",at)},[()=>i()("wizard.character.step4_other_label"),()=>i()("wizard.character.step4_other_placeholder")]),ct(De,()=>r(S),Oe=>m(S,Oe)),Ve(1,_e,()=>Ka),v(de,_e)};x(je,de=>{s.novicePath==="Other"&&de(vt)})}var Qe=a(je,2);Qe.__click=V;var ze=t(Qe),he=a(ze);ma(he,{size:20}),e(Qe),e(we),y((de,_e,Ce,Ke)=>{d(Pe,de),d(se,_e),d(Me,Ce),d(ze,`${Ke??""} `)},[()=>i()("wizard.character.step4_title"),()=>i()("wizard.character.step4_subtitle"),()=>i()("wizard.character.step4_skip"),()=>i()("wizard.character.continue")]),Ve(1,we,()=>gt,()=>({duration:300,delay:100})),v(pe,we)},He=pe=>{var we=ce(),G=T(we);{var ge=Pe=>{var We=so(),se=t(We),K=t(se),fe=t(K,!0);e(K);var Me=a(K,2),Y=t(Me,!0);e(Me),e(se);var le=a(se,2),Le=t(le),je=t(Le),vt=t(je,!0);e(je);var Qe=a(je,2),ze=t(Qe);dt(ze);var he=a(ze,2);he.__click=ee;var de=t(he);Ea(de,{size:20}),e(he),e(Qe),e(Le);var _e=a(Le,2),Ce=t(_e),Ke=t(Ce);wa(Ke,{size:14});var De=a(Ke);e(Ce);var Oe=a(Ce,2);dt(Oe),e(_e);var at=a(_e,2),ft=t(at);Ir(ft,{size:20,class:"text-indigo-400 shrink-0 mt-0.5"});var _t=a(ft,2),R=t(_t),p=t(R,!0);e(R);var O=a(R,2),_=t(O,!0);e(O),e(_t),e(at);var C=a(at,2);C.__click=A;var qe=t(C,!0);e(C),e(le),e(We),y((Re,jt,Ot,Nt,rt,Ut,Lt,Vt,Yt,sa)=>{d(fe,Re),d(Y,jt),d(vt,Ot),Ue(ze,"placeholder",Nt),Ue(he,"title",rt),d(De,` ${Ut??""}`),Ue(Oe,"placeholder",Lt),d(p,Vt),d(_,Yt),C.disabled=!s.name,d(qe,sa)},[()=>i()("wizard.character.step5_title"),()=>i()("wizard.character.step5_subtitle"),()=>i()("wizard.character.step5_character_name_label"),()=>i()("wizard.character.step5_character_name_placeholder"),()=>i()("wizard.character.step5_random_name_tooltip"),()=>i()("wizard.character.step5_player_name_label"),()=>i()("wizard.character.step5_player_name_placeholder"),()=>i()("wizard.character.step5_ready_title"),()=>i()("wizard.character.step5_ready_message"),()=>i()("wizard.character.create")]),ct(ze,()=>s.name,Re=>s.name=Re),ct(Oe,()=>s.playerName,Re=>s.playerName=Re),Ve(1,We,()=>gt,()=>({duration:300,delay:100})),v(Pe,We)};x(G,Pe=>{r(b)===5&&Pe(ge)},!0)}v(pe,we)};x(be,pe=>{r(b)===4?pe(me):pe(He,!1)},!0)}v(Se,ve)};x($e,Se=>{r(b)===3?Se(Ne):Se(Te,!1)},!0)}v(q,Z)};x(ae,q=>{r(b)===2?q(Fe):q(ne,!1)},!0)}v(L,F)};x(xe,L=>{r(b)===1?L(Ie):L(Ee,!1)})}e(H),e(B),e(N),y((L,F)=>{d(ue,L),d(X,F)},[()=>i()("wizard.character.title"),()=>i()("wizard.character.cancel")]),Ve(3,N,()=>gt,()=>({duration:200})),v(P,N)};x(U,P=>{u()&&P(J)})}v(f,D),$t(),o()}St(["click"]);var no=h('<div class="ml-auto flex items-center h-full self-center"><div class="w-3 h-3 rounded-full bg-indigo-500 shadow-[0_0_10px_rgba(99,102,241,0.5)]"></div></div>'),lo=h('<button><div><!></div> <div class="flex-1"><h4 class="font-bold text-sm mb-1"> </h4> <p class="text-[10px] opacity-70 leading-relaxed"> </p></div> <!></button>'),co=h('<div class="space-y-3 pt-4 border-t border-slate-800"><label class="text-xs font-black uppercase tracking-widest text-slate-500 flex items-center gap-2"><!> </label> <div class="grid grid-cols-1 gap-3"></div></div>'),vo=h('<div class="space-y-6"><div><label for="settings-player-name" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest flex items-center gap-1"><!> </label> <input id="settings-player-name" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors" placeholder="Seu nome ou apelido"/> <p class="text-[10px] text-slate-500 mt-1">O nome do jogador associado a este personagem.</p></div> <!></div> <div class="flex flex-col-reverse sm:flex-row gap-3 mt-8"><button class="flex-1 bg-slate-700 hover:bg-slate-600 transition-all py-4 sm:py-3 rounded-xl text-white font-bold active:scale-95"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 transition-all py-4 sm:py-3 rounded-xl text-white font-bold shadow-lg shadow-indigo-900/20 active:scale-95"> </button></div>',1);function uo(f,l){kt(l,!0);const n=()=>Be(Bt,"$t",g),[g,i]=Tt();let c=yt(l,"isOpen",3,!1),o=yt(l,"characterData",3,null),u=ye(""),b=ye("standard"),s=[{value:"standard",label:"Standard",desc:"Sistema de magia padrão do Shadow of the Demon Lord.",icon:mr,disabled:!1},{value:"forbidden_rules",label:"Forbidden Rules",desc:"Coming Soon",icon:Yr,disabled:!0},{value:"uncanny_arcana",label:"Uncanny Arcana",desc:"Coming Soon",icon:ir,disabled:!0}];ra(()=>{c()&&o()&&(m(u,o().playerName||"",!0),m(b,o().magicSystem||"standard",!0))});function I(){l.onSave({playerName:r(u),magicSystem:r(b)})}{let S=It(()=>n()("character.settings.title_label"));fr(f,{get isOpen(){return c()},get onClose(){return l.onClose},get title(){return`⚙️ ${r(S)??""}`},maxWidth:"max-w-md",children:(j,Q)=>{var V=vo(),z=T(V),E=t(z),ee=t(E),w=t(ee);wa(w,{size:12});var W=a(w);e(ee);var A=a(ee,2);dt(A),Gt(2),e(E);var D=a(E,2);{var U=M=>{var te=co(),oe=t(te),re=t(oe);ir(re,{size:14});var ue=a(re);e(oe);var ie=a(oe,2);mt(ie,21,()=>s,Mt,(ke,X)=>{var B=lo();B.__click=()=>!r(X).disabled&&m(b,r(X).value,!0);var H=t(B),xe=t(H);Kr(xe,()=>r(X).icon,(q,Z)=>{Z(q,{size:20})}),e(H);var Ie=a(H,2),Ee=t(Ie),L=t(Ee,!0);e(Ee);var F=a(Ee,2),ae=t(F,!0);e(F),e(Ie);var Fe=a(Ie,2);{var ne=q=>{var Z=no();v(q,Z)};x(Fe,q=>{r(b)===r(X).value&&q(ne)})}e(B),y(()=>{Ge(B,1,`flex items-start gap-4 p-4 rounded-xl border text-left transition-all ${r(b)===r(X).value?"bg-indigo-600/20 border-indigo-500 text-white":"bg-slate-900 border-slate-700 text-slate-400 hover:border-slate-600"} ${r(X).disabled?"opacity-50 cursor-not-allowed":""}`),B.disabled=r(X).disabled,Ge(H,1,`mt-1 p-2 rounded-lg bg-slate-800 ${r(b)===r(X).value?"text-indigo-400":"text-slate-500"}`),d(L,r(X).label),d(ae,r(X).desc)}),v(ke,B)}),e(ie),e(te),y(ke=>d(ue,` ${ke??""}`),[()=>n()("character.settings.magic_system")]),v(M,te)};x(D,M=>{o()?.system==="sofdl"&&M(U)})}e(z);var J=a(z,2),P=t(J);P.__click=function(...M){l.onClose?.apply(this,M)};var N=t(P,!0);e(P);var k=a(P,2);k.__click=I;var $=t(k,!0);e(k),e(J),y((M,te,oe)=>{d(W,` ${M??""}`),d(N,te),d($,oe)},[()=>n()("character.settings.player_name"),()=>n()("common.buttons.cancel")||"Cancelar",()=>n()("common.buttons.save")||"Salvar"]),ct(A,()=>r(u),M=>m(u,M)),v(j,V)},$$slots:{default:!0}})}$t(),i()}St(["click"]);var po=h('<img alt="Avatar" class="w-10 h-10 rounded-full border-2 border-indigo-500/50 shadow-lg object-cover"/>'),go=h('<div class="w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center text-white border-2 border-indigo-400/30 shadow-lg"><span class="font-bold text-lg"><!></span></div>'),fo=h('<div class="absolute right-0 top-full mt-2 w-48 bg-slate-800 rounded-xl shadow-xl border border-slate-700 p-2 z-50 animate-in fade-in slide-in-from-top-2"><div class="px-3 py-2 border-b border-slate-700 mb-2"><p class="text-xs text-slate-400"> </p> <p class="text-sm font-bold text-white truncate"> </p></div> <button class="w-full flex items-center gap-2 px-3 py-2 text-slate-300 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors text-sm"><!> </button></div>  <div class="fixed inset-0 z-40"></div>',1),ho=h('<div class="relative"><button><!> <div class="absolute bottom-1 right-1 w-3 h-3 bg-emerald-500 rounded-full border-2 border-slate-900"></div></button> <!></div>'),bo=h('<div class="w-4 h-4 rounded-full border-2 border-slate-300 border-t-slate-600 animate-spin"></div>'),mo=Cr('<svg class="w-4 h-4" viewBox="0 0 24 24"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg>'),_o=h("<button><!> <span> </span></button>");function xo(f,l){kt(l,!0);const n=()=>Be(Xe,"$googleSession",i),g=()=>Be(Bt,"$t",i),[i,c]=Tt();let o=yt(l,"className",3,""),u=ye(!1);var b=ce(),s=T(b);{var I=j=>{var Q=ho(),V=t(Q);V.__click=()=>m(u,!r(u));var z=t(V);{var E=A=>{var D=po();y(()=>Ue(D,"src",n().userProfile.picture)),v(A,D)},ee=A=>{var D=go(),U=t(D),J=t(U);{var P=k=>{var $=Er();y(M=>d($,M),[()=>n().userProfile.name[0].toUpperCase()]),v(k,$)},N=k=>{wa(k,{size:20})};x(J,k=>{n().userProfile?.name?k(P):k(N,!1)})}e(U),e(D),v(A,D)};x(z,A=>{n().userProfile?.picture?A(E):A(ee,!1)})}Gt(2),e(V);var w=a(V,2);{var W=A=>{var D=fo(),U=T(D),J=t(U),P=t(J),N=t(P,!0);e(P);var k=a(P,2),$=t(k,!0);e(k),e(J);var M=a(J,2);M.__click=()=>{Ss(),m(u,!1)};var te=t(M);Vr(te,{size:14});var oe=a(te);e(M),e(U);var re=a(U,2);re.__click=()=>m(u,!1),y((ue,ie,ke)=>{d(N,ue),d($,ie),d(oe,` ${ke??""}`)},[()=>g()("common.auth.signed_in_as"),()=>n().userProfile?.name??g()("common.auth.user"),()=>g()("common.auth.logout")]),v(A,D)};x(w,A=>{r(u)&&A(W)})}e(Q),y(A=>{Ge(V,1,`flex items-center gap-2 p-1 rounded-full hover:bg-slate-800 transition-colors border border-transparent hover:border-slate-700 ${o()??""}`),Ue(V,"title",A)},[()=>n().userProfile?.name||g()("common.auth.user")]),v(j,Q)},S=j=>{var Q=_o();Q.__click=function(...W){kr?.apply(this,W)};var V=t(Q);{var z=W=>{var A=bo();v(W,A)},E=W=>{var A=mo();v(W,A)};x(V,W=>{n().isInited?W(E,!1):W(z)})}var ee=a(V,2),w=t(ee,!0);e(ee),e(Q),y(W=>{Q.disabled=!n().isInited,Ge(Q,1,`flex items-center gap-2 px-4 py-2 bg-white text-slate-900 hover:bg-slate-100 rounded-full font-bold text-xs transition-all shadow-lg hover:shadow-xl hover:scale-105 disabled:opacity-50 disabled:cursor-wait disabled:scale-100 disabled:shadow-none ${o()??""}`),d(w,W)},[()=>g()("common.auth.login")]),v(j,Q)};x(s,j=>{n().signedIn?j(I):j(S,!1)})}v(f,b),$t(),c()}St(["click"]);var wo=h('<span class="w-2 h-2 rounded-full bg-amber-500"></span> <span class="text-amber-400">Auth: Init Failed</span>',1),yo=h('<span class="w-2 h-2 rounded-full bg-amber-500"></span> <span class="text-amber-400">Auth: Not Ready</span>',1),ko=h('<span class="w-2 h-2 rounded-full bg-slate-600"></span> <span> </span>',1),$o=h('<span class="w-2 h-2 rounded-full bg-indigo-500 animate-pulse"></span> <span> </span>',1),So=h('<span class="w-2 h-2 rounded-full bg-emerald-500"></span> <span> </span>',1),zo=h('<span class="w-2 h-2 rounded-full bg-red-500"></span> <span> </span>',1),Co=h('<span class="w-2 h-2 rounded-full bg-slate-500"></span> <span> </span>',1),Eo=h('<div class="mt-1.5 pt-1.5 border-t border-slate-800 text-[9px] text-slate-400 opacity-80 font-medium flex justify-between items-center gap-4"><span> </span> <span> </span></div>'),Po=h('<div class="mt-1 text-[9px] text-slate-400 opacity-60 italic"> </div>'),No=h('<div class="absolute top-full right-0 mt-3 whitespace-nowrap bg-slate-900/95 backdrop-blur-md text-white text-[10px] font-bold py-2 px-3 rounded-lg shadow-2xl border border-slate-700/50 z-[100] pointer-events-none min-w-[120px]"><div class="flex items-center gap-2"><!></div> <!></div>'),Mo=h('<div class="relative flex items-center"><button class="flex items-center justify-center p-2 rounded-xl hover:bg-slate-800/50 transition-all active:scale-95 group focus:outline-none"><!></button> <!></div>');function Io(f,l){kt(l,!0);const n=()=>Be(Xe,"$googleSession",u),g=()=>Be(Bt,"$t",u),i=()=>Be(Pa,"$authError",u),c=()=>Be(Wt,"$syncStatus",u),o=()=>Be(er,"$lastSyncTime",u),[u,b]=Tt();let s=ye(!1);function I(w){return new Date(w).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}var S=Mo(),j=t(S);j.__click=()=>n().signedIn?Qa():kr();var Q=t(j);{var V=w=>{is(w,{size:20,class:"text-amber-500"})},z=w=>{var W=ce(),A=T(W);{var D=J=>{es(J,{size:20,class:"text-slate-600 group-hover:text-slate-400"})},U=J=>{var P=ce(),N=T(P);{var k=M=>{os(M,{size:20,class:"animate-spin text-indigo-400"})},$=M=>{var te=ce(),oe=T(te);{var re=ie=>{Xr(ie,{size:20,class:"text-emerald-400 group-hover:text-emerald-300"})},ue=ie=>{var ke=ce(),X=T(ke);{var B=xe=>{Qr(xe,{size:20,class:"text-red-400"})},H=xe=>{ts(xe,{size:20,class:"text-slate-400 group-hover:text-slate-300"})};x(X,xe=>{c()==="error"?xe(B):xe(H,!1)},!0)}v(ie,ke)};x(oe,ie=>{c()==="success"?ie(re):ie(ue,!1)},!0)}v(M,te)};x(N,M=>{c()==="syncing"?M(k):M($,!1)},!0)}v(J,P)};x(A,J=>{n().signedIn?J(U,!1):J(D)},!0)}v(w,W)};x(Q,w=>{i()?w(V):w(z,!1)})}e(j);var E=a(j,2);{var ee=w=>{var W=No(),A=t(W),D=t(A);{var U=$=>{var M=wo();Gt(2),v($,M)},J=$=>{var M=ce(),te=T(M);{var oe=ue=>{var ie=yo();Gt(2),v(ue,ie)},re=ue=>{var ie=ce(),ke=T(ie);{var X=H=>{var xe=ko(),Ie=a(T(xe),2),Ee=t(Ie,!0);e(Ie),y(L=>d(Ee,L),[()=>g()("common.status.offline")]),v(H,xe)},B=H=>{var xe=ce(),Ie=T(xe);{var Ee=F=>{var ae=$o(),Fe=a(T(ae),2),ne=t(Fe,!0);e(Fe),y(q=>d(ne,q),[()=>g()("common.status.syncing")]),v(F,ae)},L=F=>{var ae=ce(),Fe=T(ae);{var ne=Z=>{var $e=So(),Ne=a(T($e),2),Te=t(Ne,!0);e(Ne),y(Se=>d(Te,Se),[()=>g()("common.status.saved")]),v(Z,$e)},q=Z=>{var $e=ce(),Ne=T($e);{var Te=ve=>{var be=zo(),me=a(T(be),2),He=t(me,!0);e(me),y(pe=>d(He,pe),[()=>g()("common.status.error")]),v(ve,be)},Se=ve=>{var be=Co(),me=a(T(be),2),He=t(me,!0);e(me),y(pe=>d(He,pe),[()=>g()("common.status.synced")]),v(ve,be)};x(Ne,ve=>{c()==="error"?ve(Te):ve(Se,!1)},!0)}v(Z,$e)};x(Fe,Z=>{c()==="success"?Z(ne):Z(q,!1)},!0)}v(F,ae)};x(Ie,F=>{c()==="syncing"?F(Ee):F(L,!1)},!0)}v(H,xe)};x(ke,H=>{n().signedIn?H(B,!1):H(X)},!0)}v(ue,ie)};x(te,ue=>{i()==="not_initialized"?ue(oe):ue(re,!1)},!0)}v($,M)};x(D,$=>{i()==="init_failed"?$(U):$(J,!1)})}e(A);var P=a(A,2);{var N=$=>{var M=Eo(),te=t(M),oe=t(te,!0);e(te);var re=a(te,2),ue=t(re,!0);e(re),e(M),y((ie,ke)=>{d(oe,ie),d(ue,ke)},[()=>g()("common.status.last_sync"),()=>I(o())]),v($,M)},k=$=>{var M=ce(),te=T(M);{var oe=re=>{var ue=Po(),ie=t(ue,!0);e(ue),y(ke=>d(ie,ke),[()=>g()("common.auth.login")]),v(re,ue)};x(te,re=>{n().signedIn||re(oe)},!0)}v($,M)};x(P,$=>{n().signedIn&&o()?$(N):$(k,!1)})}e(W),Ve(3,W,()=>gt,()=>({duration:150})),v(w,W)};x(E,w=>{r(s)&&w(ee)})}e(S),y(w=>Ue(j,"aria-label",w),[()=>g()("common.status.label")]),ea("mouseenter",j,()=>m(s,!0)),ea("mouseleave",j,()=>m(s,!1)),ea("focus",j,()=>m(s,!0)),ea("blur",j,()=>m(s,!1)),v(f,S),$t(),b()}St(["click"]);var To=h('<span class="text-[10px] text-slate-500 font-medium leading-tight mt-0.5"> </span>'),jo=h('<div class="flex flex-col"><span> </span> <!></div>'),Oo=h('<div class="absolute inset-0 flex items-center justify-center"><div class="w-1.5 h-1.5 rounded-full bg-indigo-600"></div></div>'),Ao=h("<div><!> <div><div><!></div></div></div>");function pr(f,l){kt(l,!0);let n=yt(l,"checked",3,!1),g=yt(l,"label",3,""),i=yt(l,"description",3,""),c=yt(l,"disabled",3,!1);function o(){c()||l.onToggle(!n())}var u=Ao();u.__click=o;var b=t(u);{var s=V=>{var z=jo(),E=t(z),ee=t(E,!0);e(E);var w=a(E,2);{var W=A=>{var D=To(),U=t(D,!0);e(D),y(()=>d(U,i())),v(A,D)};x(w,A=>{i()&&A(W)})}e(z),y(()=>{Ge(E,1,`text-sm font-black uppercase tracking-widest transition-colors ${n()?"text-indigo-400":"text-slate-300 group-hover:text-white"}`),d(ee,g())}),v(V,z)};x(b,V=>{(g()||i())&&V(s)})}var I=a(b,2),S=t(I),j=t(S);{var Q=V=>{var z=Oo();v(V,z)};x(j,V=>{n()&&V(Q)})}e(S),e(I),e(u),y(()=>{Ge(u,1,`flex items-center justify-between gap-4 p-1 group ${c()?"opacity-50 grayscale":"cursor-pointer"}`),Ge(I,1,`relative w-12 h-6 rounded-full transition-all duration-300 ease-in-out ${n()?"bg-indigo-600 shadow-[0_0_15px_rgba(79,70,229,0.4)]":"bg-slate-800 border border-white/5"}`),Ge(S,1,`absolute top-1 left-1 w-4 h-4 rounded-full bg-white transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)] shadow-md ${n()?"translate-x-6":"translate-x-0"}`)}),v(f,u),$t()}St(["click"]);var Do=h('<div class="absolute top-2 right-2 text-primary-400"><!></div>'),Go=h('<button><div class="w-12 h-12 rounded-full shadow-lg relative border-2 border-white/10 overflow-hidden"><div class="absolute inset-0 flex items-center justify-center font-bold text-sm">20</div></div> <span> </span> <!></button>'),Bo=h('<div class="h-full flex flex-col"><div class="h-48 bg-black/30 rounded-xl relative overflow-hidden shrink-0 mb-4 border border-white/5"><div class="w-full h-full"></div> <div class="absolute bottom-2 left-2 text-xs text-white/50 bg-black/50 px-2 py-1 rounded">Preview</div></div> <div class="flex-1 overflow-y-auto pr-2 custom-scrollbar"><div class="grid grid-cols-2 sm:grid-cols-3 gap-3"></div></div></div>');function Uo(f,l){kt(l,!0);const n=()=>Be(qt,"$appSettings",g),[g,i]=Tt();let c,o;const u=Object.entries(Ua).map(([z,E])=>({id:z,...E}));let b=ye(xa(n().diceTheme||"default"));Ia(async()=>{o=new Tr(c,{assetPath:"/assets/dice-box/",scale:6,theme_surface:r(b),theme_customColorset:Ua[r(b)]?.dice,theme_colorset:r(b),gravity_multiplier:400,baseScale:45,strength:1,onRollComplete:()=>{}}),await o.initialize(),await o.showSelector(["d20",{type:"d6",style:"boon"},{type:"d6",style:"bane"}])});async function s(z){m(b,z,!0),Nr(qt,tr(n).diceTheme=z,tr(n));const E=Ua[z];o&&E&&(await o.updateConfig({theme_surface:z,theme_colorset:z,theme_customColorset:E.dice}),await o.showSelector(["d20",{type:"d6",style:"boon"},{type:"d6",style:"bane"}]))}var I=Bo(),S=t(I),j=t(S);Zr(j,z=>c=z,()=>c),Gt(2),e(S);var Q=a(S,2),V=t(Q);mt(V,21,()=>u,Mt,(z,E)=>{var ee=Go();ee.__click=()=>s(r(E).id);var w=t(ee),W=t(w);e(w);var A=a(w,2);let D;var U=t(A,!0);e(A);var J=a(A,2);{var P=N=>{var k=Do(),$=t(k);_a($,{size:14}),e(k),v(N,k)};x(J,N=>{r(b)===r(E).id&&N(P)})}e(ee),y((N,k)=>{Ge(ee,1,`relative group flex flex-col items-center gap-2 p-3 rounded-xl border transition-all duration-200
                    ${r(b)===r(E).id?"bg-primary/20 border-primary/50 ring-1 ring-primary/50":"bg-white/5 border-white/5 hover:bg-white/10 hover:border-white/10"}`),Ue(ee,"aria-label",`Select theme ${r(E).name??""}`),ba(w,`background: ${N??""};`),ba(W,`color: ${k??""};`),D=Ge(A,1,"text-xs font-medium text-center truncate w-full px-1",null,D,{"text-primary-300":r(b)===r(E).id,"text-zinc-400":r(b)!==r(E).id}),d(U,r(E).name)},[()=>Array.isArray(r(E).dice.background)?r(E).dice.background[0]:r(E).dice.background,()=>Array.isArray(r(E).dice.foreground)?r(E).dice.foreground[0]:r(E).dice.foreground]),v(z,ee)}),e(V),e(Q),e(I),v(f,I),$t(),i()}St(["click"]);var Lo=h('<button class="p-2 -ml-2 hover:bg-white/5 rounded-full text-slate-400 hover:text-white transition-all active:scale-95"><!></button>'),Ro=h('<div class="p-2 bg-indigo-500/10 rounded-xl border border-indigo-500/20"><!></div>'),Fo=h('<button class="p-2 hover:bg-white/5 rounded-full text-slate-400 hover:text-white transition-all active:scale-95"><!></button>'),Ho=h('<div class="space-y-4"><div class="flex items-center gap-2 mb-2 text-pink-400"><!> <h3 class="text-xs font-black uppercase tracking-widest"> </h3></div> <div class="bg-white/5 rounded-2xl p-4 border border-white/5 h-[500px] overflow-hidden"><!></div></div>'),Wo=h('<button class="absolute right-2 top-1/2 -translate-y-1/2 text-xs text-indigo-400 hover:text-white bg-indigo-500/10 hover:bg-indigo-500 px-2 py-1 rounded transition-all">Google</button>'),qo=h('<div class="p-4 bg-white/[0.02] border-t border-white/5"><button class="w-full bg-slate-800 hover:bg-slate-700 text-white font-black uppercase tracking-widest py-3 rounded-2xl transition-all active:scale-[0.98] text-sm"> </button></div>'),Vo=h('<div class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center md:p-4"><div class="bg-slate-900 border-white/10 w-full md:max-w-md md:rounded-3xl shadow-2xl overflow-hidden flex flex-col h-full md:h-auto md:max-h-[90vh]"><div class="px-6 py-6 border-b border-white/5 flex items-center justify-between bg-white/[0.02]"><div class="flex items-center gap-3"><!> <div><h2 class="text-lg font-black text-white uppercase tracking-tight"> </h2> <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest"> </p></div></div> <!></div> <div class="flex-1 p-6 space-y-8 overflow-y-auto custom-scrollbar pb-32 md:pb-6 svelte-14b6qd9"><div class="space-y-4"><div class="flex items-center gap-2 mb-2 text-indigo-400"><!> <h3 class="text-xs font-black uppercase tracking-widest"> </h3></div> <div class="space-y-6"><!> <!></div></div> <!> <div class="space-y-4"><div class="flex items-center gap-2 mb-2 text-amber-400"><!> <h3 class="text-xs font-black uppercase tracking-widest"> </h3></div> <div class="grid grid-cols-1 gap-2"><button><div class="flex items-center gap-3"><span class="text-xl">🇧🇷</span> <span class="font-bold">Português (Brasil)</span></div> <!></button> <button><div class="flex items-center gap-3"><span class="text-xl">🇺🇸</span> <span class="font-bold">English (US)</span></div> <!></button></div></div> <div class="space-y-4"><div class="flex items-center gap-2 mb-2 text-indigo-400"><!> <h3 class="text-xs font-black uppercase tracking-widest"> </h3></div> <div class="grid grid-cols-1 gap-4"><div><label for="settings-user-name" class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-1"> </label> <div class="relative"><input id="settings-user-name" type="text" class="w-full bg-slate-800 border border-slate-700 rounded-lg p-3 pr-10 text-white focus:border-indigo-500 outline-none transition-all"/> <!></div></div></div></div> <div class="space-y-4"><div class="flex items-center gap-2 mb-2 text-emerald-400"><!> <h3 class="text-xs font-black uppercase tracking-widest"> </h3></div> <div class="bg-white/5 rounded-2xl p-4 border border-white/5"><div class="flex justify-between items-center opacity-50 cursor-not-allowed"><div class="flex flex-col"><span class="text-sm font-black uppercase tracking-widest text-slate-400"> </span> <span class="text-[10px] text-slate-500"> </span></div> <div class="w-12 h-6 bg-slate-800 rounded-full border border-white/5 p-1 relative"><div class="w-4 h-4 bg-slate-600 rounded-full"></div></div></div></div></div> <div class="pt-4 border-t border-white/5 flex flex-col items-center gap-4 text-center"><p class="text-[10px] text-slate-500 leading-relaxed max-w-[250px]"> </p></div></div> <!></div></div>');function Ko(f,l){kt(l,!0);const n=()=>Be(Bt,"$t",o),g=()=>Be(qt,"$appSettings",o),i=()=>Be(qa,"$locale",o),c=()=>Be(Xe,"$googleSession",o),[o,u]=Tt();let b=yt(l,"isOpen",3,!1),s=ye(!1);Ia(()=>{const z=()=>m(s,window.innerWidth<768);return z(),window.addEventListener("resize",z),()=>window.removeEventListener("resize",z)});function I(z,E){qt.update(ee=>({...ee,[z]:E}))}function S(z){qa.set(z),localStorage.setItem("user_locale",z)}var j=ce(),Q=T(j);{var V=z=>{var E=Vo();E.__click=function(...R){l.onClose?.apply(this,R)};var ee=t(E);ee.__click=R=>R.stopPropagation();var w=t(ee),W=t(w),A=t(W);{var D=R=>{var p=Lo();p.__click=function(..._){l.onClose?.apply(this,_)};var O=t(p);jr(O,{size:24}),e(p),v(R,p)},U=R=>{var p=Ro(),O=t(p);Za(O,{size:20,class:"text-indigo-400"}),e(p),v(R,p)};x(A,R=>{r(s)?R(D):R(U,!1)})}var J=a(A,2),P=t(J),N=t(P,!0);e(P);var k=a(P,2),$=t(k,!0);e(k),e(J),e(W);var M=a(W,2);{var te=R=>{var p=Fo();p.__click=function(..._){l.onClose?.apply(this,_)};var O=t(p);gr(O,{size:24}),e(p),v(R,p)};x(M,R=>{r(s)||R(te)})}e(w);var oe=a(w,2),re=t(oe),ue=t(re),ie=t(ue);rs(ie,{size:16});var ke=a(ie,2),X=t(ke,!0);e(ke),e(ue);var B=a(ue,2),H=t(B);{let R=It(()=>n()("settings.options.auto_open_history.label")),p=It(()=>n()("settings.options.auto_open_history.description"));pr(H,{get checked(){return g().autoOpenHistory},onToggle:O=>I("autoOpenHistory",O),get label(){return r(R)},get description(){return r(p)}})}var xe=a(H,2);{let R=It(()=>n()("settings.options.enable_3d_dice.label")),p=It(()=>n()("settings.options.enable_3d_dice.description"));pr(xe,{get checked(){return g().enable3DDice},onToggle:O=>I("enable3DDice",O),get label(){return r(R)},get description(){return r(p)}})}e(B),e(re);var Ie=a(re,2);{var Ee=R=>{var p=Ho(),O=t(p),_=t(O);Ea(_,{size:16});var C=a(_,2),qe=t(C,!0);e(C),e(O);var Re=a(O,2),jt=t(Re);Uo(jt,{}),e(Re),e(p),y(Ot=>d(qe,Ot),[()=>n()("settings.sections.dice_theme")]),Ve(3,p,()=>Ka),v(R,p)};x(Ie,R=>{g().enable3DDice&&R(Ee)})}var L=a(Ie,2),F=t(L),ae=t(F);Xa(ae,{size:16});var Fe=a(ae,2),ne=t(Fe,!0);e(Fe),e(F);var q=a(F,2),Z=t(q);Z.__click=()=>S("pt");var $e=a(t(Z),2);{var Ne=R=>{_a(R,{size:18,class:"text-indigo-400"})};x($e,R=>{i()==="pt"&&R(Ne)})}e(Z);var Te=a(Z,2);Te.__click=()=>S("en");var Se=a(t(Te),2);{var ve=R=>{_a(R,{size:18,class:"text-indigo-400"})};x(Se,R=>{i()==="en"&&R(ve)})}e(Te),e(q),e(L);var be=a(L,2),me=t(be),He=t(me);wa(He,{size:16});var pe=a(He,2),we=t(pe,!0);e(pe),e(me);var G=a(me,2),ge=t(G),Pe=t(ge),We=t(Pe,!0);e(Pe);var se=a(Pe,2),K=t(se);dt(K),K.__input=R=>I("userName",R.currentTarget.value);var fe=a(K,2);{var Me=R=>{var p=Wo();p.__click=()=>I("userName",c().userProfile?.name),v(R,p)};x(fe,R=>{!g().userName&&c().userProfile&&R(Me)})}e(se),e(ge),e(G),e(be);var Y=a(be,2),le=t(Y),Le=t(le);ss(Le,{size:16});var je=a(Le,2),vt=t(je,!0);e(je),e(le);var Qe=a(le,2),ze=t(Qe),he=t(ze),de=t(he),_e=t(de,!0);e(de);var Ce=a(de,2),Ke=t(Ce,!0);e(Ce),e(he),Gt(2),e(ze),e(Qe),e(Y);var De=a(Y,2),Oe=t(De),at=t(Oe,!0);e(Oe),e(De),e(oe);var ft=a(oe,2);{var _t=R=>{var p=qo(),O=t(p);O.__click=function(...C){l.onClose?.apply(this,C)};var _=t(O,!0);e(O),e(p),y(C=>d(_,C),[()=>n()("common.buttons.close")]),v(R,p)};x(ft,R=>{r(s)||R(_t)})}e(ee),e(E),y((R,p,O,_,C,qe,Re,jt,Ot,Nt,rt)=>{d(N,R),d($,p),d(X,O),d(ne,_),Ge(Z,1,`flex items-center justify-between px-4 py-3 rounded-2xl border transition-all ${i()==="pt"?"bg-indigo-600/10 border-indigo-500/50 text-white":"bg-white/5 border-white/5 text-slate-400 hover:bg-white/10"}`),Ge(Te,1,`flex items-center justify-between px-4 py-3 rounded-2xl border transition-all ${i()==="en"?"bg-indigo-600/10 border-indigo-500/50 text-white":"bg-white/5 border-white/5 text-slate-400 hover:bg-white/10"}`),d(we,C),d(We,qe),Ue(K,"placeholder",Re),Pr(K,g().userName||""),d(vt,jt),d(_e,Ot),d(Ke,Nt),d(at,rt)},[()=>n()("settings.title"),()=>n()("settings.description"),()=>n()("settings.sections.interface"),()=>n()("common.labels.language")||"Language",()=>n()("settings.sections.identity"),()=>n()("settings.options.user_name.label"),()=>n()("settings.options.user_name.placeholder"),()=>n()("settings.sections.appearance"),()=>n()("settings.options.theme.label"),()=>n()("settings.options.theme.description"),()=>n()("settings.sync_info")]),Ve(1,ee,()=>da,()=>r(s)?{x:"100%",duration:600,easing:la}:{y:20,duration:300}),Ve(2,ee,()=>da,()=>r(s)?{x:"100%",duration:600,easing:la}:{y:20,duration:300}),Ve(3,E,()=>gt,()=>({duration:200})),v(z,E)};x(Q,z=>{b()&&z(V)})}v(f,j),$t(),u()}St(["click","input"]);var Yo=h('<span class="text-[10px] text-slate-400 font-medium"> </span>'),Jo=h('<div class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hover:border-indigo-500/40 transition-all relative group flex flex-col shadow-lg hover:shadow-indigo-500/10 border-t-white/5"><div class="flex justify-between items-start mb-4"><div class="flex-1"><h3 class="font-black text-xl text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate pr-16"> </h3> <div class="flex items-center gap-2 mt-1 flex-wrap"><span class="text-[10px] bg-indigo-500/10 text-indigo-400 font-black px-2 py-0.5 rounded uppercase tracking-wider"> </span> <span class="text-[10px] text-slate-500 font-bold uppercase tracking-widest"> </span> <!></div> <div class="mt-2 flex items-center gap-2"><div class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800 text-[9px] text-slate-400 border border-slate-700 font-bold uppercase tracking-wider"><!> </div></div></div> <div class="flex items-center gap-1"><button class="text-slate-700 hover:text-indigo-400 p-2 rounded-xl hover:bg-indigo-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button> <button class="text-slate-700 hover:text-red-400 p-2 rounded-xl hover:bg-red-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button></div></div> <div class="space-y-3 mb-6"><div class="flex items-center justify-between text-xs text-slate-400"><span class="flex items-center gap-1.5 opacity-60"><!> </span> <span class="font-bold text-slate-300 truncate max-w-[150px]"> </span></div></div> <button class="w-full bg-slate-800 hover:bg-indigo-600 text-white py-3 rounded-2xl font-bold transition-all active:scale-[0.98] border border-slate-700 hover:border-indigo-400/30 flex items-center justify-center gap-2"> <!></button></div>'),Xo=h('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 col-start-1 row-start-1 w-full"><!> <button class="h-full min-h-[160px] border-2 border-dashed border-slate-800 rounded-3xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-500 transition-all hover:bg-indigo-500/5 gap-2 group shadow-sm bg-slate-900/20"><div class="w-12 h-12 rounded-full bg-slate-800 flex items-center justify-center group-hover:bg-indigo-500/10 group-hover:scale-110 transition-all"><!></div> <span class="font-bold"> </span></button></div>'),Zo=h('<span class="text-[9px] bg-emerald-500/10 text-emerald-400 px-2 py-0.5 rounded-full border border-emerald-500/20 font-black uppercase tracking-widest flex items-center gap-1"><!> </span>'),Qo=h('<div class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hover:border-indigo-500/40 transition-all group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10 border-t-white/5"><div class="mb-4"><div class="flex justify-between items-start mb-1"><h3 class="font-black text-2xl text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight"> </h3> <div class="flex items-center gap-1"><!> <button class="text-slate-700 hover:text-indigo-400 p-2 rounded-xl hover:bg-indigo-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button> <button class="text-slate-700 hover:text-red-400 p-2 rounded-xl hover:bg-red-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button></div></div> <p class="text-indigo-400 text-[10px] font-black uppercase tracking-[0.2em] mb-3"> </p> <div class="mb-3"><div class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800 text-[9px] text-slate-400 border border-slate-700 font-bold uppercase tracking-wider"><!> </div></div> <p class="text-sm text-slate-400 line-clamp-2 leading-relaxed h-10"> </p></div> <button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-2xl font-bold flex items-center justify-center gap-2 border border-indigo-400/20 shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98]"><!> </button></div>'),ei=h('<div class="w-1.5 h-1.5 rounded-full bg-amber-400 animate-pulse"></div> <span class="text-[9px] font-bold text-amber-400 uppercase tracking-wider"> </span>',1),ti=h('<div class="w-1.5 h-1.5 rounded-full bg-emerald-400 shadow-[0_0_8px_rgba(52,211,153,0.5)]"></div> <span class="text-[9px] font-bold text-emerald-400 uppercase tracking-wider"> </span>',1),ai=h('<div class="w-1.5 h-1.5 rounded-full bg-red-500"></div> <span class="text-[9px] font-bold text-red-500 uppercase tracking-wider"> </span>',1),ri=h('<div class="w-1.5 h-1.5 rounded-full bg-slate-500"></div> <span class="text-[9px] font-bold text-slate-500 uppercase tracking-wider"> </span>',1),si=h('<div class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hover:border-emerald-500/40 transition-all group relative flex flex-col justify-between shadow-xl border-t-white/5"><div><h3 class="font-black text-2xl text-white group-hover:text-emerald-400 mb-2 uppercase tracking-tight"> </h3> <div class="flex items-center gap-2 mb-4"><div class="px-2 py-0.5 bg-slate-800 rounded text-[9px] text-slate-400 font-black uppercase tracking-widest"> </div> <div class="flex items-center gap-1 px-2 py-0.5 bg-emerald-500/10 rounded text-[9px] text-emerald-400 font-black uppercase tracking-wider"><div class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></div> </div></div> <div class="mb-4"><div class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800/50 text-[9px] text-slate-400 border border-slate-700/50 font-bold uppercase tracking-wider"><!> </div></div> <p class="text-sm text-slate-400 line-clamp-3 leading-relaxed mb-6 h-15"> </p></div> <button class="w-full bg-emerald-600 hover:bg-emerald-500 text-white py-3 rounded-2xl font-black uppercase text-xs tracking-[0.1em] flex items-center justify-center gap-2 border border-emerald-400/20 transition-all active:scale-[0.98] group"> <!></button></div>'),oi=h('<div class="col-span-full py-12 flex flex-col items-center text-center opacity-40"><div class="w-16 h-16 bg-slate-800/50 rounded-full flex items-center justify-center text-slate-600 mb-3 border border-slate-700 border-dashed"><!></div> <h3 class="text-lg font-black uppercase tracking-widest text-slate-500"> </h3> <p class="text-slate-600 max-w-sm mt-2 text-sm"> </p></div>'),ii=h('<div class="space-y-8 col-start-1 row-start-1 w-full"><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><!> <button class="h-full min-h-[160px] border-2 border-dashed border-slate-800 rounded-3xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-500 transition-all hover:bg-indigo-500/5 gap-2 group shadow-sm bg-slate-900/20"><div class="w-12 h-12 rounded-full bg-slate-800 flex items-center justify-center group-hover:bg-indigo-500/10 group-hover:scale-110 transition-all"><!></div> <span class="font-bold"> </span></button></div> <div><div class="flex items-center gap-3 mb-4"><div class="h-px flex-1 bg-slate-800"></div> <h3 class="text-xs font-black uppercase tracking-widest text-emerald-400 flex items-center gap-2"><!> </h3> <div class="flex items-center gap-2 ml-2 px-2 py-1 bg-slate-900 rounded-full border border-slate-800"><!></div> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><!> <!></div></div></div>'),ni=h('<div class="fixed top-0 left-0 w-full flex justify-center items-center pointer-events-none z-[100] transition-all duration-300"><div class="bg-indigo-600 rounded-full p-2.5 shadow-xl border border-indigo-500/50 text-white"><!></div></div> <div class="animate-in fade-in px-4 md:px-8 max-w-7xl mx-auto pb-32 md:pb-20"><header class="mb-8 flex justify-between items-center border-b border-slate-800/50 pt-4 md:pt-8 pb-4 sticky top-0 bg-slate-950/80 backdrop-blur-md z-40 -mx-4 px-4 md:-mx-8 md:px-8 transition-all"><div class="flex items-center gap-3"><img alt="Schwalb Vault Logo" class="h-10 md:h-14 w-auto rounded-xl"/> <h1 class="text-xl md:text-3xl font-bold text-white flex items-center gap-2 text-gradient m-0 leading-none"><span class="hidden md:inline">Schwalb Vault</span> <span class="md:hidden">Schwalb Vault</span></h1></div> <div class="hidden md:flex absolute left-1/2 -translate-x-1/2 bg-slate-900/50 p-1.5 rounded-2xl border border-slate-800 glass shadow-xl backdrop-blur-md"><div class="relative flex"><div class="absolute inset-y-0 w-1/2 bg-indigo-600 rounded-xl transition-transform duration-300 ease-out shadow-lg shadow-indigo-500/20"></div> <button><!> </button> <button><!> </button></div></div> <div class="flex items-center justify-end min-w-[40px] gap-3"><!> <button class="p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-all"><!></button> <!></div></header> <div class="md:hidden fixed bottom-0 left-0 right-0 bg-slate-900/90 backdrop-blur-xl border-t border-slate-800 shadow-2xl rounded-t-2xl z-50 p-2 pb-safe"><div class="relative flex justify-between"><div class="absolute inset-y-0 w-1/2 bg-indigo-600/20 rounded-xl transition-transform duration-300 ease-out"></div> <button><!> <span class="transition-all duration-300"> </span></button> <button><!> <span class="transition-all duration-300"> </span></button></div></div> <div class="min-h-[500px] grid items-start relative"><!></div> <!> <!> <!> <!> <!> <!> <!></div>',1);function li(f,l){kt(l,!0);const n=()=>Be(Xe,"$googleSession",b),g=()=>Be(hr,"$liveCharacters",b),i=()=>Be(Ya,"$liveCampaigns",b),c=()=>Be(Bt,"$t",b),o=()=>Be(Gr,"$lobbyStatus",b),u=()=>Be(Br,"$publicCampaigns",b),[b,s]=Tt();let I=ye(0),S=ye(0),j=ye(!1),Q=ye(!1);const V=80;function z(p){window.scrollY===0&&(m(I,p.touches[0].clientY,!0),m(j,!0))}function E(p){if(!r(j))return;const _=p.touches[0].clientY-r(I);_>0&&window.scrollY<=0?m(S,Math.min(_*.4,120),!0):(m(j,!1),m(S,0))}async function ee(){if(r(j))if(m(j,!1),r(S)>V){m(Q,!0),m(S,60);try{navigator&&navigator.vibrate&&navigator.vibrate(50),await Qa()}finally{setTimeout(()=>{m(Q,!1),m(S,0)},1e3)}}else m(S,0)}Ia(()=>{$s();const p=localStorage.getItem("user_locale");return p&&qa.set(p),document.addEventListener("touchmove",E,{passive:!1}),()=>{document.removeEventListener("touchmove",E)}});let w=ye("characters"),W=ye("characters"),A=ye(!1);ra(()=>{r(w)!==r(W)&&m(W,r(w),!0)}),ra(()=>{n().signedIn&&Qa()}),ra(()=>{n().signedIn&&(g(),i(),Wa())});let D=ye(!1),U=ye(null);function J(p){m(U,p,!0),m(D,!0)}function P(p){if(!r(U))return;const O=r(U).id,C={...lt.get(O),...p};lt.set(O,C),m(D,!1)}let N=ye(!1),k=ye(!1),$="{}";function M(){m(k,!0)}async function te(p){const O=p.id||rr(),_=lt.get(O)||{};let C;p.system==="sofdl"?C={..._,id:O,system:"sofdl",name:p.name,playerName:p.playerName||"",ancestry:p.ancestry,level:p.level,attributes:p.attributes||_.attributes||{strength:10,agility:10,intellect:10,will:10},perception:p.perception||_.perception||10,defense:p.defense||10,health:p.health||10,healingRate:p.healingRate||_.healingRate||Math.floor((p.health||10)/4),size:_.size||1,speed:_.speed||10,power:_.power||0,damage:_.damage||0,insanity:_.insanity||0,corruption:_.corruption||0,description:_.description||"",notes:_.notes||"",paths:p.paths||_.paths||{novice:p.novicePath||"",expert:"",master:""},professions:p.professions||_.professions||(p.profession?[p.profession]:[]),languages:_.languages||["Common"],talents:_.talents||[],spells:_.spells||[],equipment:_.equipment||[],effects:_.effects||[]}:(C={..._,id:O,name:p.name,playerName:p.playerName||"",ancestry:p.ancestry,level:p.level,defense:p.defense,system:p.system||aa,paths:p.paths||_.paths||{novice:p.novicePath||"-",expert:"-",master:"-"},attributes:_.attributes||[{name:c()("modals.mod_targets.str"),value:10,key:"str"},{name:c()("modals.mod_targets.agi"),value:10,key:"agi"},{name:c()("modals.mod_targets.int"),value:10,key:"int"},{name:c()("modals.mod_targets.wil"),value:10,key:"wil"}],speed:_.speed||5,health:p.health,currentHealth:_.currentHealth||p.health,spells:_.spells||[],talents:_.talents||[],equipment:_.equipment||[],afflictions:_.afflictions||[],effects:_.effects||[],currency:_.currency||{gp:0,sp:0,cp:0},languages:_.languages||["Common"]},p.profession&&!C.professions?.includes(p.profession)&&(C.professions=[...C.professions||[],p.profession])),lt.set(O,C),m(N,!1),m(k,!1),za(ta("/characters/[id]",{id:O}))}let oe=ye(!1),re=ye(!1),ue=ye(null),ie=ye("{}");function ke(p=null){p?(m(ue,p.id,!0),m(ie,JSON.stringify(p),!0),m(oe,!0)):m(re,!0)}async function X(p){const O=r(ue)||rr(),_=r(ue)?nt.get(O):{},C={..._,id:O,name:p.name,description:p.description,gmName:p.gmName,players:_.players||[],backupEnabled:p.backupEnabled||!1,backupHash:p.backupHash||"",system:p.system||aa};p.removePassword?delete C.passwordHash:p.password&&(C.passwordHash=await Jr(p.password)),nt.set(O,C),m(oe,!1),m(re,!1)}let B=ye(!1),H=ye(xa({title:"",message:"",onConfirm:()=>{}}));function xe(p){m(H,{title:c()("dashboard.campaigns.delete_title"),message:c()("dashboard.campaigns.delete_message"),onConfirm:()=>{console.log("[DEBUG] Deleting campaign with ID:",p);let O=0;for(const _ of nt.keys()){const C=nt.get(_);(_===p||C&&C.id===p)&&(console.log("[DEBUG] Found match for deletion - Key:",_,"Camp ID:",C?.id),nt.delete(_),O++)}console.log("[DEBUG] Total entries deleted from map:",O),Kt.set(p,{type:"campaign",deletedAt:Date.now()}),console.log("[DEBUG] Deletion tracked in deletedIdsMap"),Wa(),m(B,!1)}},!0),m(B,!0)}function Ie(p){m(H,{title:c()("dashboard.characters.delete_title"),message:c()("dashboard.characters.delete_message"),onConfirm:()=>{bt(Ya).forEach(C=>{let qe=!1;C.members&&C.members.some(Re=>Re.id===p)&&(C.members=C.members.filter(Re=>Re.id!==p),qe=!0),C.sessionRoster&&C.sessionRoster.includes(p)&&(C.sessionRoster=C.sessionRoster.filter(Re=>Re!==p),qe=!0),C.activeEnemies&&C.activeEnemies.some(Re=>Re.id===p)&&(C.activeEnemies=C.activeEnemies.filter(Re=>Re.id!==p),qe=!0),qe&&nt.set(C.id,C)}),console.log("[DEBUG] Deleting character with ID:",p);let _=0;for(const C of lt.keys()){const qe=lt.get(C);(C===p||qe&&qe.id===p)&&(console.log("[DEBUG] Found match for deletion - Key:",C,"Char ID:",qe?.id),lt.delete(C),_++)}console.log("[DEBUG] Total entries deleted from map:",_),Kt.set(p,{type:"character",deletedAt:Date.now()}),console.log("[DEBUG] Deletion tracked in deletedIdsMap"),Wa(),m(B,!1)}},!0),m(B,!0)}var Ee=ni();ea("touchstart",Ba,z),ea("touchmove",Ba,E),ea("touchend",Ba,ee);var L=T(Ee),F=t(L),ae=t(F);{let p=It(()=>r(Q)?"animate-spin":""),O=It(()=>r(S)*2);as(ae,{get class(){return r(p)},size:20,get style(){return`transform: rotate(${r(O)??""}deg)`}})}e(F),e(L);var Fe=a(L,2),ne=t(Fe),q=t(ne),Z=t(q);Gt(2),e(q);var $e=a(q,2),Ne=t($e),Te=t(Ne),Se=a(Te,2);Se.__click=()=>m(w,"characters");var ve=t(Se);sr(ve,{size:18});var be=a(ve);e(Se);var me=a(Se,2);me.__click=()=>m(w,"campaigns");var He=t(me);Fa(He,{size:18});var pe=a(He);e(me),e(Ne),e($e);var we=a($e,2),G=t(we);Io(G,{});var ge=a(G,2);ge.__click=()=>m(A,!0);var Pe=t(ge);Za(Pe,{size:20}),e(ge);var We=a(ge,2);xo(We,{}),e(we),e(ne);var se=a(ne,2),K=t(se),fe=t(K),Me=a(fe,2);Me.__click=()=>m(w,"characters");var Y=t(Me);{let p=It(()=>r(w)==="characters"?2.5:2);sr(Y,{size:20,get strokeWidth(){return r(p)},class:"transition-all duration-300"})}var le=a(Y,2),Le=t(le,!0);e(le),e(Me);var je=a(Me,2);je.__click=()=>m(w,"campaigns");var vt=t(je);{let p=It(()=>r(w)==="campaigns"?2.5:2);Fa(vt,{size:20,get strokeWidth(){return r(p)},class:"transition-all duration-300"})}var Qe=a(vt,2),ze=t(Qe,!0);e(Qe),e(je),e(K),e(se);var he=a(se,2),de=t(he);{var _e=p=>{var O=Xo(),_=t(O);mt(_,1,g,Nt=>Nt.id,(Nt,rt)=>{var Ut=Jo(),Lt=t(Ut),Vt=t(Lt),Yt=t(Vt),sa=t(Yt,!0);e(Yt);var va=a(Yt,2),ua=t(va),ja=t(ua,!0);e(ua);var oa=a(ua,2),ya=t(oa);e(oa);var Oa=a(oa,2);{var Aa=Ht=>{var Dt=Yo(),Xt=t(Dt);e(Dt),y(()=>d(Xt,`• ${r(rt).playerName??""}`)),v(Ht,Dt)};x(Oa,Ht=>{r(rt).playerName&&Ht(Aa)})}e(va);var Ye=a(va,2),Ae=t(Ye),Ze=t(Ae);Ca(Ze,{size:10});var ut=a(Ze);e(Ae),e(Ye),e(Vt);var et=a(Vt,2),Je=t(et);Je.__click=()=>J(r(rt));var ot=t(Je);Za(ot,{size:16}),e(Je);var tt=a(Je,2);tt.__click=()=>Ie(r(rt).id);var xt=t(tt);ar(xt,{size:16}),e(tt),e(et),e(Lt);var ht=a(Lt,2),st=t(ht),pt=t(st),it=t(pt);Fa(it,{size:12});var At=a(it);e(pt);var wt=a(pt,2),ia=t(wt,!0);e(wt),e(st),e(ht);var Rt=a(ht,2);Rt.__click=()=>za(ta("/characters/[id]",{id:r(rt).id}));var Ft=t(Rt),Jt=a(Ft);or(Jt,{size:14,fill:"currentColor"}),e(Rt),e(Ut),y((Ht,Dt,Xt,Zt,na,pa)=>{d(sa,r(rt).name),d(ja,r(rt).ancestry||"Human"),d(ya,`${Ht??""} ${r(rt).level??""}`),d(ut,` ${Dt??""}`),Ue(Je,"title",Xt),Ue(tt,"title",Zt),d(At,` ${na??""}`),d(ia,r(rt).paths?.novice||"-"),d(Ft,`${pa??""} `)},[()=>c()("common.labels.level"),()=>c()(Ra(r(rt).system).nameKey),()=>c()("common.buttons.settings"),()=>c()("common.buttons.delete"),()=>c()("dashboard.characters.paths"),()=>c()("dashboard.characters.open_sheet")]),v(Nt,Ut)});var C=a(_,2);C.__click=()=>M();var qe=t(C),Re=t(qe);La(Re,{size:32}),e(qe);var jt=a(qe,2),Ot=t(jt,!0);e(jt),e(C),e(O),y(Nt=>d(Ot,Nt),[()=>c()("dashboard.characters.new_character")]),Ve(1,O,()=>da,()=>({x:-100,duration:300,easing:la})),Ve(2,O,()=>da,()=>({x:-100,duration:300,easing:la})),v(p,O)},Ce=p=>{var O=ii(),_=t(O),C=t(_);mt(C,1,i,Ye=>Ye.id,(Ye,Ae)=>{var Ze=Qo(),ut=t(Ze),et=t(ut),Je=t(et),ot=t(Je,!0);e(Je);var tt=a(Je,2),xt=t(tt);{var ht=ga=>{var fa=Zo(),ka=t(fa);Xa(ka,{size:10});var Da=a(ka);e(fa),y(Ga=>d(Da,` ${Ga??""}`),[()=>c()("dashboard.campaigns.published")]),v(ga,fa)};x(xt,ga=>{r(Ae).isPublished&&ga(ht)})}var st=a(xt,2);st.__click=()=>ke(r(Ae));var pt=t(st);Or(pt,{size:16}),e(st);var it=a(st,2);it.__click=()=>xe(r(Ae).id);var At=t(it);ar(At,{size:16}),e(it),e(tt),e(et);var wt=a(et,2),ia=t(wt,!0);e(wt);var Rt=a(wt,2),Ft=t(Rt),Jt=t(Ft);Ca(Jt,{size:10});var Ht=a(Jt);e(Ft),e(Rt);var Dt=a(Rt,2),Xt=t(Dt,!0);e(Dt),e(ut);var Zt=a(ut,2);Zt.__click=()=>za(ta("/campaigns/[id]",{id:r(Ae).id}));var na=t(Zt);or(na,{size:18,fill:"currentColor"});var pa=a(na);e(Zt),e(Ze),y((ga,fa,ka,Da,Ga,Sr)=>{d(ot,r(Ae).name),Ue(st,"title",ga),Ue(it,"title",fa),d(ia,ka),d(Ht,` ${Da??""}`),d(Xt,Ga),d(pa,` ${Sr??""}`)},[()=>c()("common.buttons.edit"),()=>c()("common.buttons.delete"),()=>r(Ae).gmName||c()("common.labels.master"),()=>c()(Ra(r(Ae).system||aa).nameKey),()=>r(Ae).description||c()("dashboard.campaigns.no_description"),()=>c()("dashboard.campaigns.start_session")]),v(Ye,Ze)});var qe=a(C,2);qe.__click=()=>ke();var Re=t(qe),jt=t(Re);La(jt,{size:32}),e(Re);var Ot=a(Re,2),Nt=t(Ot,!0);e(Ot),e(qe),e(_);var rt=a(_,2),Ut=t(rt),Lt=a(t(Ut),2),Vt=t(Lt);Xa(Vt,{size:14});var Yt=a(Vt);e(Lt);var sa=a(Lt,2),va=t(sa);{var ua=Ye=>{var Ae=ei(),Ze=a(T(Ae),2),ut=t(Ze,!0);e(Ze),y(et=>d(ut,et),[()=>c()("dashboard.status.connecting")]),v(Ye,Ae)},ja=Ye=>{var Ae=ce(),Ze=T(Ae);{var ut=Je=>{var ot=ti(),tt=a(T(ot),2),xt=t(tt,!0);e(tt),y(ht=>d(xt,ht),[()=>c()("dashboard.status.connected")]),v(Je,ot)},et=Je=>{var ot=ce(),tt=T(ot);{var xt=st=>{var pt=ai(),it=a(T(pt),2),At=t(it,!0);e(it),y(wt=>d(At,wt),[()=>c()("dashboard.status.error")]),v(st,pt)},ht=st=>{var pt=ri(),it=a(T(pt),2),At=t(it,!0);e(it),y(wt=>d(At,wt),[()=>c()("dashboard.status.disconnected")]),v(st,pt)};x(tt,st=>{o()==="error"?st(xt):st(ht,!1)},!0)}v(Je,ot)};x(Ze,Je=>{o()==="connected"?Je(ut):Je(et,!1)},!0)}v(Ye,Ae)};x(va,Ye=>{o()==="connecting"?Ye(ua):Ye(ja,!1)})}e(sa),Gt(2),e(Ut);var oa=a(Ut,2),ya=t(oa);mt(ya,1,u,Ye=>Ye.id,(Ye,Ae)=>{var Ze=si(),ut=t(Ze),et=t(ut),Je=t(et,!0);e(et);var ot=a(et,2),tt=t(ot),xt=t(tt,!0);e(tt);var ht=a(tt,2),st=a(t(ht));e(ht),e(ot);var pt=a(ot,2),it=t(pt),At=t(it);Ca(At,{size:10});var wt=a(At);e(it),e(pt);var ia=a(pt,2),Rt=t(ia,!0);e(ia),e(ut);var Ft=a(ut,2);Ft.__click=()=>za(ta("/campaigns/[id]/invite",{id:r(Ae).id}));var Jt=t(Ft),Ht=a(Jt);La(Ht,{size:18,class:"group-hover:rotate-90 transition-transform"}),e(Ft),e(Ze),y((Dt,Xt,Zt,na,pa)=>{d(Je,r(Ae).name),d(xt,Dt),d(st,` ${Xt??""}`),d(wt,` ${Zt??""}`),d(Rt,na),d(Jt,`${pa??""} `)},[()=>r(Ae).gmName||c()("common.labels.master"),()=>c()("dashboard.campaigns.online"),()=>c()(Ra(r(Ae).system||aa).nameKey),()=>r(Ae).description||c()("dashboard.campaigns.public_description"),()=>c()("dashboard.campaigns.join_adventure")]),v(Ye,Ze)});var Oa=a(ya,2);{var Aa=Ye=>{var Ae=oi(),Ze=t(Ae),ut=t(Ze);Lr(ut,{size:32}),e(Ze);var et=a(Ze,2),Je=t(et,!0);e(et);var ot=a(et,2),tt=t(ot,!0);e(ot),e(Ae),y((xt,ht)=>{d(Je,xt),d(tt,ht)},[()=>c()("dashboard.campaigns.no_online_campaigns"),()=>c()("dashboard.campaigns.no_online_description")]),v(Ye,Ae)};x(Oa,Ye=>{u().length===0&&Ye(Aa)})}e(oa),e(rt),e(O),y((Ye,Ae)=>{d(Nt,Ye),d(Yt,` ${Ae??""}`)},[()=>c()("dashboard.campaigns.new_campaign"),()=>c()("dashboard.campaigns.public_campaigns")]),Ve(1,O,()=>da,()=>({x:100,duration:300,easing:la})),Ve(2,O,()=>da,()=>({x:100,duration:300,easing:la})),v(p,O)};x(de,p=>{r(w)==="characters"?p(_e):p(Ce,!1)})}e(he);var Ke=a(he,2);io(Ke,{get isOpen(){return r(k)},onClose:()=>m(k,!1),onSave:te});var De=a(Ke,2);Ds(De,{get isOpen(){return r(re)},onClose:()=>m(re,!1),onSave:X});var Oe=a(De,2);Bs(Oe,{get isOpen(){return r(N)},initialData:$,onClose:()=>m(N,!1),onSave:te});var at=a(Oe,2);Wr(at,{get isOpen(){return r(oe)},get initialData(){return r(ie)},onClose:()=>m(oe,!1),onSave:X});var ft=a(at,2);Hr(ft,{get isOpen(){return r(B)},get title(){return r(H).title},get message(){return r(H).message},get onConfirm(){return r(H).onConfirm},onCancel:()=>m(B,!1)});var _t=a(ft,2);uo(_t,{get isOpen(){return r(D)},get characterData(){return r(U)},onClose:()=>m(D,!1),onSave:P});var R=a(_t,2);Ko(R,{get isOpen(){return r(A)},onClose:()=>m(A,!1)}),e(Fe),y((p,O,_,C,qe)=>{ba(L,`transform: translateY(${(r(Q)?60:r(S))??""}px); opacity: ${r(S)>0?1:0}`),Ue(Z,"src",`${Ur??""}/logo-black.webp`),ba(Te,`transform: translateX(${r(w)==="campaigns"?"100%":"0%"})`),Ge(Se,1,`relative z-10 px-6 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 flex items-center gap-2 ${r(w)==="characters"?"text-white":"text-slate-400 hover:text-white"}`),d(be,` ${p??""}`),Ge(me,1,`relative z-10 px-6 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 flex items-center gap-2 ${r(w)==="campaigns"?"text-white":"text-slate-400 hover:text-white"}`),d(pe,` ${O??""}`),Ue(ge,"title",_),ba(fe,`transform: translateX(${r(w)==="campaigns"?"100%":"0%"})`),Ge(Me,1,`relative flex-1 py-3 rounded-xl text-xs font-bold transition-all duration-300 flex flex-col items-center justify-center gap-1 z-10 ${r(w)==="characters"?"text-indigo-400":"text-slate-500"}`),d(Le,C),Ge(je,1,`relative flex-1 py-3 rounded-xl text-xs font-bold transition-all duration-300 flex flex-col items-center justify-center gap-1 z-10 ${r(w)==="campaigns"?"text-indigo-400":"text-slate-500"}`),d(ze,qe)},[()=>c()("dashboard.tabs.characters"),()=>c()("dashboard.tabs.campaigns"),()=>c()("settings.title"),()=>c()("dashboard.tabs.characters"),()=>c()("dashboard.tabs.campaigns")]),v(f,Ee),$t(),s()}St(["click"]);var di=h("<!> <!>",1);function ji(f){var l=di(),n=T(l);gs(n,{});var g=a(n,2);li(g,{}),v(f,l)}export{ji as component};
