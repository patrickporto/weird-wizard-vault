const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/CBXs46KE.js","../chunks/DfayzYqb.js","../chunks/Cx0o8vWd.js","../chunks/PPVm8Dsz.js","../chunks/Bs3V2B0j.js","../chunks/CdkHlkWG.js"])))=>i.map(i=>d[i]);
import{_ as Es}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import{u as It,v as Fe,k as d,w as oa,z as la,j as c,x as t,B as a,y as s,E as V,F as e,t as _,V as Fa,A as z,D as bt,n as Ea,G as Va,a9 as ga,ak as ha,bd as Ss}from"../chunks/DfayzYqb.js";import{d as ba,s as i,o as ss,g as Aa,e as ja}from"../chunks/Cx0o8vWd.js";import{e as Qe,s as Ve,i as Ot,$ as aa,r as Mt,a as le,h as Ya,b as $a,j as Is}from"../chunks/Bs3V2B0j.js";import{l as _a,s as xa,i as h,p as sa}from"../chunks/C746LlRB.js";import{g as Na,j as Ds,c as rs,h as Za,l as Rs,k as Ma,m as Ra,u as Ia,b as ut,n as vs,o as $s,p as Ns,e as As,d as Ts}from"../chunks/CBXs46KE.js";import{a as da,s as Ut}from"../chunks/DukWTdxy.js";import{p as Us}from"../chunks/BA-_nZYE.js";import{c as is,a as ea,e as ns,b as Qa}from"../chunks/CdkHlkWG.js";import{l as Ps,b as es,c as cs,a as Fs}from"../chunks/COIJJyGo.js";import{a as Hs,t as Ta,f as Ua}from"../chunks/D1-YRAfI.js";import{U as us,C as os,W as bs,r as _s}from"../chunks/BCFArNzm.js";import{A as Ls,a as qs,B as Bs,T as Ws,M as xs,G as Ca,H as ms,R as Gs,I as fs,C as ps,S as gs,L as Js,b as Vs,D as Qs,c as Ys}from"../chunks/2sVzG71T.js";import{k as ts}from"../chunks/DprScpwF.js";import{A as Da,C as Zs,s as hs}from"../chunks/Ezn9DR5P.js";import{M as Xs,X as ya,P as ra,E as Ha,d as Ks,c as ua,C as La,e as er,f as ys,b as za,A as tr}from"../chunks/DB_RYID1.js";import{C as ws}from"../chunks/DhygBu6m.js";import{b as ar,S as ks,a as sr,c as rr}from"../chunks/BXEcqP1q.js";import{S as Pa}from"../chunks/D6v5F6iE.js";import"../chunks/ChbcetSK.js";import{I as ma,s as fa}from"../chunks/tM_ceOsH.js";import{C as zs,D as Oa,a as ir}from"../chunks/DXWhg5s7.js";import{G as pa,P as Xa,S as nr,C as or}from"../chunks/DqmjLnZb.js";import{b as Cs}from"../chunks/UR9fxUxp.js";import{g as lr}from"../chunks/C8s4V3gi.js";import{W as dr}from"../chunks/f1qYprxU.js";function vr(J,r){const n=_a(r,["children","$$slots","$$events","$$legacy"]);const se=[["path",{d:"m6 9 6 6 6-6"}]];ma(J,xa({name:"chevron-down"},()=>n,{get iconNode(){return se},children:(D,x)=>{var E=It(),$=Fe(E);fa($,r,"default",{}),d(D,E)},$$slots:{default:!0}}))}function cr(J,r){const n=_a(r,["children","$$slots","$$events","$$legacy"]);const se=[["path",{d:"m18 15-6-6-6 6"}]];ma(J,xa({name:"chevron-up"},()=>n,{get iconNode(){return se},children:(D,x)=>{var E=It(),$=Fe(E);fa($,r,"default",{}),d(D,E)},$$slots:{default:!0}}))}function ur(J,r){const n=_a(r,["children","$$slots","$$events","$$legacy"]);const se=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];ma(J,xa({name:"copy"},()=>n,{get iconNode(){return se},children:(D,x)=>{var E=It(),$=Fe(E);fa($,r,"default",{}),d(D,E)},$$slots:{default:!0}}))}function br(J,r){const n=_a(r,["children","$$slots","$$events","$$legacy"]);const se=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];ma(J,xa({name:"flame"},()=>n,{get iconNode(){return se},children:(D,x)=>{var E=It(),$=Fe(E);fa($,r,"default",{}),d(D,E)},$$slots:{default:!0}}))}function _r(J,r){const n=_a(r,["children","$$slots","$$events","$$legacy"]);const se=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];ma(J,xa({name:"grip-vertical"},()=>n,{get iconNode(){return se},children:(D,x)=>{var E=It(),$=Fe(E);fa($,r,"default",{}),d(D,E)},$$slots:{default:!0}}))}function Ka(J,r){const n=_a(r,["children","$$slots","$$events","$$legacy"]);const se=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];ma(J,xa({name:"layers"},()=>n,{get iconNode(){return se},children:(D,x)=>{var E=It(),$=Fe(E);fa($,r,"default",{}),d(D,E)},$$slots:{default:!0}}))}function js(J,r){const n=_a(r,["children","$$slots","$$events","$$legacy"]);const se=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];ma(J,xa({name:"library"},()=>n,{get iconNode(){return se},children:(D,x)=>{var E=It(),$=Fe(E);fa($,r,"default",{}),d(D,E)},$$slots:{default:!0}}))}function xr(J,r){const n=_a(r,["children","$$slots","$$events","$$legacy"]);const se=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];ma(J,xa({name:"qr-code"},()=>n,{get iconNode(){return se},children:(D,x)=>{var E=It(),$=Fe(E);fa($,r,"default",{}),d(D,E)},$$slots:{default:!0}}))}function as(J,r){const n=_a(r,["children","$$slots","$$events","$$legacy"]);const se=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];ma(J,xa({name:"save"},()=>n,{get iconNode(){return se},children:(D,x)=>{var E=It(),$=Fe(E);fa($,r,"default",{}),d(D,E)},$$slots:{default:!0}}))}function mr(J,r){const n=_a(r,["children","$$slots","$$events","$$legacy"]);const se=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];ma(J,xa({name:"send"},()=>n,{get iconNode(){return se},children:(D,x)=>{var E=It(),$=Fe(E);fa($,r,"default",{}),d(D,E)},$$slots:{default:!0}}))}function fr(J){let r=!1;return document.body&&(document.body.appendChild(J),r=!0),{destroy(){r&&J.parentNode&&J.parentNode.removeChild(J)}}}var pr=c("<button> <!></button>"),gr=c('<p class="text-xs text-slate-600 italic"> </p>'),hr=c('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),yr=c('<div class="space-y-1"></div>'),wr=c('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),kr=c("<div><!></div>");function zr(J,r){oa(r,!0);const n=()=>Ut(aa,"$t",se),[se,D]=da();var x=It(),E=Fe(x);{var $=o=>{var S=kr(),T=t(S);{let te=V(()=>n()("session.affliction_modal.title"));Xs(T,{get isOpen(){return r.isOpen},get onClose(){return r.onClose},get title(){return a(te)},maxWidth:"max-w-md",children:(Ie,fe)=>{var I=wr(),R=Fe(I);Qe(R,21,()=>Object.keys(Ls),Ot,(ye,Me)=>{const Be=V(()=>r.afflictions.includes(a(Me)));var ge=pr();ge.__click=()=>r.onToggle(a(Me));var P=t(ge),ne=s(P);{var ve=Oe=>{ws(Oe,{size:14,class:"text-red-400"})};h(ne,Oe=>{a(Be)&&Oe(ve)})}e(ge),_(Oe=>{Ve(ge,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(Be)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),i(P,`${Oe??""} `)},[()=>n()(`character.afflictions.${a(Me)}`)]),d(ye,ge)}),e(R);var j=s(R,2),Q=t(j),U=t(Q),Se=t(U,!0);e(U);var ze=s(U,2);{var kt=ye=>{var Me=gr(),Be=t(Me,!0);e(Me),_(ge=>i(Be,ge),[()=>n()("session.affliction_modal.none_selected")]),d(ye,Me)},ae=ye=>{var Me=yr();Qe(Me,21,()=>r.afflictions,Ot,(Be,ge)=>{var P=hr(),ne=t(P),ve=t(ne);e(ne);var Oe=s(ne,2),we=t(Oe,!0);e(Oe),e(P),_((_t,nt)=>{i(ve,`${_t??""}:`),i(we,nt)},[()=>n()(`character.afflictions.${a(ge)}`),()=>n()(`sofww.afflictions.${a(ge).toLowerCase().replace(" ","_")}.effect`)]),d(Be,P)}),e(Me),d(ye,Me)};h(ze,ye=>{r.afflictions.length===0?ye(kt):ye(ae,!1)})}e(Q);var Ce=s(Q,2),_e=t(Ce);_e.__click=function(...ye){r.onClose?.apply(this,ye)};var je=t(_e,!0);e(_e),e(Ce),e(j),_((ye,Me)=>{i(Se,ye),i(je,Me)},[()=>n()("session.affliction_modal.effects"),()=>n()("session.affliction_modal.done")]),d(Ie,I)},$$slots:{default:!0}})}e(S),qs(S,te=>fr?.(te)),d(o,S)};h(E,o=>{r.isOpen&&o($)})}d(J,x),la(),D()}ba(["click"]);var Cr=c('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),jr=c('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),Mr=c('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),Or=c("<button><!></button>"),Er=c('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),Sr=c('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),Ir=c('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),Dr=c('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),Rr=c('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),$r=c('<div class="flex flex-col items-center justify-between bg-cyan-950/20 border border-cyan-500/30 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-cyan-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div>'),Nr=c('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),Ar=c('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),Tr=c('<div class="grid grid-cols-2 gap-4 mb-4"><div class="p-3 rounded-xl bg-purple-950/20 border border-purple-500/30 flex justify-between items-center group/ins"><div><span class="text-[9px] text-purple-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div> <div class="p-3 rounded-xl bg-red-950/20 border border-red-500/30 flex justify-between items-center group/cor"><div><span class="text-[9px] text-red-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div></div>'),Ur=c("<!> ",1),Pr=c('<div><div class="text-emerald-500 text-[10px] font-black uppercase mb-2 flex items-center gap-2"> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="flex flex-wrap gap-2"></div></div>'),Fr=c('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),Hr=c('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),Lr=c('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <!> <div class="grid grid-cols-2 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"><!> <!></div></div>'),qr=c('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div> <!></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function Br(J,r){oa(r,!0);const n=()=>Ut(aa,"$t",se),[se,D]=da();let x=sa(r,"updateEnemy",3,(m,b)=>{}),E=sa(r,"updatePlayer",3,(m,b)=>{}),$=sa(r,"removeFromCombat",3,m=>{}),o=V(()=>r.entity.type==="player"),S=V(()=>r.entity.system==="sofdl"),T=V(()=>r.entity.damage||0),te=V(()=>r.entity.normalHealth||r.entity.health||10),Ie=V(()=>r.entity.currentHealth??a(te)),fe=V(()=>a(T)>=a(Ie)),I=V(()=>a(T)>=a(Ie)/2&&!a(fe)),R=V(()=>a(Ie)>0?Math.min(100,Math.max(0,a(T)/a(Ie)*100)):100),j=bt(!1),Q=bt(!1);Fa(()=>{const m=r.entity.afflictions||[],b=m.includes("Incapacitated");if(a(fe)&&!b){const w={afflictions:[...m,"Incapacitated"]};r.entity.type==="player"?U(w):x()(r.entity.instanceId,w)}else if(!a(fe)&&b){const w={afflictions:m.filter(ke=>ke!=="Incapacitated")};r.entity.type==="player"?U(w):x()(r.entity.instanceId,w)}});function U(m){if(r.entity.type!=="player")return;const b=is.get(r.entity.id);if(b){const C={...b,...m};is.set(r.entity.id,C);const w=r.campaignId||r.entity.campaignId;w&&ar(w,C)}E()(r.entity.id,m),Na({id:r.entity.id,...m})}function Se(m){const b=parseInt(m.target.value);if(isNaN(b))return;const w={damage:Math.max(0,b)};r.entity.type==="player"?U(w):x()(r.entity.instanceId,w)}function ze(m){const b=parseInt(m.target.value);if(isNaN(b))return;const C=Math.max(0,b);let w=a(T);C<a(T)&&(w=C);const ke={currentHealth:C,damage:w};r.entity.type==="player"?U(ke):x()(r.entity.instanceId,ke)}function kt(){const m=!r.entity.acted;r.entity.type==="player"?U({acted:m}):x()(r.entity.instanceId,{acted:m})}function ae(){r.entity.type==="player"&&U({initiative:!r.entity.initiative})}function Ce(m){const b=r.entity.afflictions||[],w={afflictions:b.includes(m)?b.filter(ke=>ke!==m):[...b,m]};r.entity.type==="player"?U(w):x()(r.entity.instanceId,w)}var _e=qr(),je=t(_e);{var ye=m=>{var b=Cr(),C=t(b,!0);e(b),_(w=>i(C,w),[()=>n()("session.combat_card.initiative")]),d(m,b)};h(je,m=>{a(o)&&r.entity.initiative&&m(ye)})}var Me=s(je,2);{var Be=m=>{var b=jr();d(m,b)};h(Me,m=>{a(fe)&&m(Be)})}var ge=s(Me,2),P=t(ge),ne=t(P),ve=t(ne),Oe=t(ve);ts(Oe,()=>r.entity.imageUrl,m=>{{let b=V(()=>r.entity.name.charAt(0));Da(m,{get hash(){return r.entity.imageUrl},get alt(){return r.entity.name},size:"custom",get fallbackText(){return a(b)}})}}),e(ve);var we=s(ve,2);we.__click=kt;var _t=t(we);{var nt=m=>{Pa(m,{size:14,class:""})},ot=m=>{var b=It(),C=Fe(b);{var w=qe=>{ws(qe,{size:14})},ke=qe=>{ks(qe,{size:14})};h(C,qe=>{r.entity.acted?qe(w):qe(ke,!1)},!0)}d(m,b)};h(_t,m=>{a(fe)?m(nt):m(ot,!1)})}e(we),e(ne);var xt=s(ne,2),st=t(xt),St=t(st),ht=t(St),mt=t(ht),Pt=t(mt,!0);e(mt);var yt=s(mt,2);{var We=m=>{var b=Mr(),C=t(b);e(b),_(()=>i(C,`Dif ${r.entity.difficulty??""}`)),d(m,b)};h(yt,m=>{a(o)||m(We)})}e(ht),e(St);var Ze=s(St,2),Ee=t(Ze);Ee.__click=()=>z(j,!a(j));var De=t(Ee);{var Xe=m=>{cr(m,{size:14})},Ye=m=>{vr(m,{size:14})};h(De,m=>{a(j)?m(Xe):m(Ye,!1)})}e(Ee);var ft=s(Ee,2);{var W=m=>{var b=Or();b.__click=ae;var C=t(b);br(C,{size:14}),e(b),_(w=>{Ve(b,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${r.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),le(b,"title",w)},[()=>n()("session.combat_card.initiative")]),d(m,b)},he=m=>{var b=Er();b.__click=()=>$()(r.entity.instanceId);var C=t(b);ya(C,{size:14}),e(b),d(m,b)};h(ft,m=>{a(o)?m(W):m(he,!1)})}e(Ze),e(st);var Pe=s(st,2),ce=t(Pe),rt=s(ce,2);{var Ge=m=>{var b=Sr();_(()=>{Ve(b,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10
                            ${a(fe)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(R)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(I)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),$a(b,`width: ${a(R)??""}%`)}),d(m,b)};h(rt,m=>{a(R)>0&&m(Ge)})}var lt=s(rt,2);{var k=m=>{var b=Ir();d(m,b)};h(lt,m=>{a(T)===0&&m(k)})}var M=s(lt,2);{var N=m=>{var b=Dr(),C=t(b),w=t(C,!0);e(C),e(b),_(ke=>i(w,ke),[()=>n()("session.combat_card.incapacitated")]),d(m,b)},Y=m=>{var b=It(),C=Fe(b);{var w=ke=>{var qe=Rr(),at=t(qe),et=t(at,!0);e(at),e(qe),_(Ct=>i(et,Ct),[()=>n()("session.combat_card.injured")]),d(ke,qe)};h(C,ke=>{a(I)&&ke(w)},!0)}d(m,b)};h(M,m=>{a(fe)?m(N):m(Y,!1)})}e(Pe);var pe=s(Pe,2),ue=t(pe),Re=t(ue),Ke=t(Re),tt=t(Ke,!0);e(Ke);var zt=s(Ke,2),He=t(zt,!0);e(zt),e(Re);var A=s(Re,2),F=t(A),O=t(F,!0);e(F);var oe=s(F,2);Mt(oe),oe.__input=Se,Ea(2),e(A);var L=s(A,2),B=t(L),G=t(B,!0);e(B);var $e=s(B,2),de=t($e);Mt(de),de.__input=ze;var be=s(de,2),Z=t(be);e(be),e($e),e(L);var Ne=s(L,2);{var xe=m=>{var b=$r(),C=t(b),w=t(C,!0);e(C);var ke=s(C,2),qe=t(ke,!0);e(ke),e(b),_(at=>{i(w,at),i(qe,r.entity.perception||10)},[()=>n()("sofdl.attributes.perception")]),d(m,b)};h(Ne,m=>{a(S)&&m(xe)})}e(ue);var Le=s(ue,2),dt=t(Le);Qe(dt,17,()=>r.entity.afflictions||[],Ot,(m,b)=>{var C=Nr();C.__click=()=>Ce(a(b));var w=t(C),ke=s(w);ya(ke,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(C),_(()=>i(w,`${a(b)??""} `)),d(m,C)});var vt=s(dt,2);vt.__click=()=>z(Q,!0);var ct=t(vt);ra(ct,{size:10});var Ft=s(ct);e(vt),e(Le),e(pe),e(xt),e(P),e(ge);var Dt=s(ge,2);{var Vt=m=>{var b=Lr(),C=t(b),w=t(C),ke=t(w),qe=t(ke,!0);e(ke),Ea(2),e(w);var at=s(w,2);Qe(at,21,()=>a(S)?["strength","agility","intellect","will"]:["str","agi","int","wil"],Ot,(l,v)=>{const u=V(()=>a(S)?r.entity.attributes?.[a(v)]??10:r.entity.stats?.[a(v)]??r.entity.attributes?.[a(v)]??10),p=V(()=>a(u)-10);var q=Ar(),f=t(q),y=t(f,!0);e(f);var g=s(f,2),re=t(g,!0);e(g);var H=s(g,2),K=t(H);e(H),e(q),_(X=>{i(y,X),i(re,a(u)),Ve(H,1,`text-[9px] font-bold ${a(p)>=0?"text-emerald-500":"text-red-500"}`),i(K,`${a(p)>=0?"+":""}${a(p)??""}`)},[()=>a(S)?a(v).slice(0,3):a(v)]),d(l,q)}),e(at),e(C);var et=s(C,2);{var Ct=l=>{var v=Tr(),u=t(v),p=t(u),q=t(p),f=t(q,!0);e(q);var y=s(q,2),g=t(y,!0);e(y),e(p);var re=s(p,2);Bs(re,{size:20,class:"text-purple-500/30 group-hover/ins:text-purple-500 transition-colors"}),e(u);var H=s(u,2),K=t(H),X=t(K),me=t(X,!0);e(X);var ie=s(X,2),Te=t(ie,!0);e(ie),e(K);var ee=s(K,2);Pa(ee,{size:20,class:"text-red-500/30 group-hover/cor:text-red-500 transition-colors"}),e(H),e(v),_((Ue,Ae)=>{i(f,Ue),i(g,r.entity.insanity||0),i(me,Ae),i(Te,r.entity.corruption||0)},[()=>n()("sofdl.attributes.insanity"),()=>n()("sofdl.attributes.corruption")]),d(l,v)};h(et,l=>{a(S)&&l(Ct)})}var jt=s(et,2),Ht=t(jt),Rt=t(Ht),Bt=t(Rt,!0);e(Rt);var Jt=s(Rt,2),Xt=t(Jt,!0);e(Jt),e(Ht);var ta=s(Ht,2),Gt=t(ta),Wt=t(Gt,!0);e(Gt);var Qt=s(Gt,2),ca=t(Qt,!0);e(Qt),e(ta),e(jt);var Zt=s(jt,2),pt=t(Zt);{var Tt=l=>{var v=Pr(),u=t(v),p=t(u);Ea(),e(u);var q=s(u,2);Qe(q,21,()=>r.entity.senses,Ot,(f,y)=>{const g=V(()=>{const[K,X]=a(y).split(":");return{key:K,val:X}}),re=V(()=>n()(`character.senses.list.${a(g).key}`)+(a(g).val?` ${a(g).val}`:"")),H=V(()=>n()(`character.senses.descriptions.${a(g).key}`));Ws(f,{get text(){return a(H)},class:"text-xs bg-emerald-950/30 text-emerald-200 px-3 py-1.5 rounded border border-emerald-900/50 font-bold flex items-center gap-2 cursor-help whitespace-nowrap",children:(K,X)=>{var me=Ur(),ie=Fe(me);Ha(ie,{size:12,class:"text-emerald-500 flex-shrink-0"});var Te=s(ie);_(()=>i(Te,` ${a(re)??""}`)),d(K,me)},$$slots:{default:!0}})}),e(q),e(v),_(f=>i(p,`${f??""} `),[()=>n()("character.senses.title")]),d(l,v)};h(pt,l=>{r.entity.senses&&r.entity.senses.length>0&&l(Tt)})}var ia=s(pt,2);Qe(ia,16,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],Ot,(l,v)=>{var u=It(),p=Fe(u);{var q=f=>{var y=Hr(),g=t(y),re=t(g);Ea(),e(g);var H=s(g,2);Qe(H,21,()=>r.entity[v.key],Ot,(K,X)=>{var me=Fr(),ie=t(me),Te=t(ie,!0);e(ie);var ee=s(ie,2),Ue=t(ee,!0);e(ee),e(me),_(()=>{i(Te,a(X).name),i(Ue,a(X).description||a(X).effect)}),d(K,me)}),e(H),e(y),_(()=>{Ve(g,1,`${v.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),i(re,`${v.label??""} `)}),d(f,y)};h(p,f=>{r.entity[v.key]&&r.entity[v.key].length>0&&f(q)})}d(l,u)}),e(Zt),e(b),_((l,v,u)=>{i(qe,l),i(Bt,v),i(Xt,r.entity.size||1),i(Wt,u),i(ca,r.entity.speed||10)},[()=>n()("session.combat_card.attributes"),()=>n()("session.combat_card.size"),()=>n()("session.combat_card.speed")]),d(m,b)};h(Dt,m=>{a(j)&&m(Vt)})}var At=s(Dt,2);{let m=V(()=>r.entity.afflictions||[]);zr(At,{get isOpen(){return a(Q)},onClose:()=>z(Q,!1),get afflictions(){return a(m)},onToggle:Ce})}e(_e),_((m,b,C,w,ke)=>{Ve(_e,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(o)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),Ve(ve,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(fe)?"border-red-600 grayscale brightness-50":a(o)?"border-indigo-500/50":"border-red-900/50"}`),Ve(we,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${r.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(o)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),le(we,"title",m),Ve(mt,1,`text-base font-bold truncate leading-snug ${a(o)?"text-white":"text-red-100 font-serif tracking-wide"}`),i(Pt,r.entity.name),Ve(ce,1,`absolute inset-0 w-full ${a(T)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),i(tt,b),i(He,r.entity.defense||10),i(O,C),Ya(oe,a(T)),Ve(L,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(fe)?"bg-red-950/50 border-red-500":a(I)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),Ve(B,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(fe)?"text-red-400":a(I)?"text-orange-400":"text-emerald-400"}`),i(G,w),Ya(de,a(Ie)),i(Z,`/${a(te)??""}`),i(Ft,` ${ke??""}`)},[()=>r.entity.acted?n()("session.combat_card.acted"):n()("session.combat_card.act"),()=>n()("session.combat_card.defense"),()=>n()("session.combat_card.damage"),()=>n()("session.combat_card.health"),()=>n()("session.combat_card.add_affliction")]),d(J,_e),la(),D()}ba(["click","input"]);function Wr(J,{from:r,to:n},se={}){var{delay:D=0,duration:x=ae=>Math.sqrt(ae)*120,easing:E=Ks}=se,$=getComputedStyle(J),o=$.transform==="none"?"":$.transform,[S,T]=$.transformOrigin.split(" ").map(parseFloat);S/=J.clientWidth,T/=J.clientHeight;var te=Gr(J),Ie=J.clientWidth/n.width/te,fe=J.clientHeight/n.height/te,I=r.left+r.width*S,R=r.top+r.height*T,j=n.left+n.width*S,Q=n.top+n.height*T,U=(I-j)*Ie,Se=(R-Q)*fe,ze=r.width/n.width,kt=r.height/n.height;return{delay:D,duration:typeof x=="function"?x(Math.sqrt(U*U+Se*Se)):x,easing:E,css:(ae,Ce)=>{var _e=Ce*U,je=Ce*Se,ye=ae+Ce*ze,Me=ae+Ce*kt;return`transform: ${o} translate(${_e}px, ${je}px) scale(${ye}, ${Me});`}}}function Gr(J){if("currentCSSZoom"in J)return J.currentCSSZoom;for(var r=J,n=1;r!==null;)n*=+getComputedStyle(r).zoom,r=r.parentElement;return n}function Jr(J,r=1,n=0){const se=[];let D=0;for(let o=0;o<r;o++){const S=Math.floor(Math.random()*J)+1;se.push(S),D+=S}let x=`${r}d${J}`,E=[],$=0;if(n!==0)if(J===20){const o=Math.abs(n);for(let T=0;T<o;T++)E.push(Math.floor(Math.random()*6)+1);const S=Math.max(...E);n>0?($=S,D+=S,x+=` + ${S} [Boon]`):($=-S,D-=S,x+=` - ${S} [Bane]`)}else $=n,D+=n,x+=n>0?` + ${n}`:` - ${Math.abs(n)}`;return{total:D,results:se,bonusRolls:E,formula:x,crit:J===20&&se.includes(20),modifierTotal:$,dice:[{sides:J,count:r,results:se}]}}function Vr(J){const r=J.replace(/\s+/g,""),n=/([+-]?)(?:(\d+)?d(\d+)|(\d+))/g;let se=0,D="";const x=[],E=[];let $,o=!0;for(;($=n.exec(r))!==null;){if($[0]===""){n.lastIndex++;continue}const T=($[1]||"+")==="-"?-1:1,te=$[2],Ie=$[3],fe=$[4];if(Ie){const I=te?parseInt(te):1,R=parseInt(Ie),j=[];let Q=0;for(let kt=0;kt<I;kt++){const ae=Math.floor(Math.random()*R)+1;j.push(ae),Q+=ae}x.push(...j),E.push({sides:R,count:I,results:j});const U=Q*T;se+=U;const Se=o&&T===1?"":T===1?" + ":" - ";I===1&&R===3&&j[0];const ze=`${Se}${I}d${R}[${j.join(",")}]`;D+=ze}else if(fe){const I=parseInt(fe);se+=I*T;const j=`${o&&T===1?"":T===1?" + ":" - "}${I}`;D+=j}o=!1}return{total:se,results:x,bonusRolls:[],formula:D.trim(),crit:!1,modifierTotal:0,dice:E}}var Qr=c('<div class="h-full border-r border-slate-900/30 last:border-0"></div>'),Yr=c('<div class="flex flex-col items-center"><span> </span> <span class="text-[8px] font-mono text-slate-600"><!></span></div>'),Zr=c('<div class="space-y-4 w-full"><div class="relative h-3 w-full bg-slate-800 rounded-full overflow-hidden border border-slate-700/50 shadow-inner"><div class="absolute inset-0 flex"></div> <div><div class="absolute inset-0 bg-white/10 animate-pulse"></div></div></div> <div class="flex justify-between w-full px-1"></div></div>');function Ms(J,r){oa(r,!0);const n=()=>Ut(aa,"$t",se),[se,D]=da();let x=V(()=>()=>{for(let I=0;I<r.segments.length;I++)if(r.value<=r.segments[I].max)return I;return r.segments.length-1}),E=V(()=>()=>{const I=a(x)(),R=I===0?0:r.segments[I-1].max,j=r.segments[I].max;if(I===r.segments.length-1&&r.value>j)return 1;const Q=j-R;return Q===0?1:Math.min(1,Math.max(0,(r.value-R)/Q))}),$=V(()=>()=>{const I=a(x)(),R=100/r.segments.length;return I*R+a(E)()*R}),o=V(()=>r.segments[a(x)()].color);var S=Zr(),T=t(S),te=t(T);Qe(te,21,()=>r.segments,Ot,(I,R)=>{var j=Qr();_(()=>$a(j,`width: ${100/r.segments.length}%`)),d(I,j)}),e(te);var Ie=s(te,2);e(T);var fe=s(T,2);Qe(fe,21,()=>r.segments,Ot,(I,R,j)=>{var Q=Yr(),U=t(Q),Se=t(U,!0);e(U);var ze=s(U,2),kt=t(ze);{var ae=_e=>{var je=Va();_(()=>i(je,`${r.segments[j-1].max+1}+`)),d(_e,je)},Ce=_e=>{var je=It(),ye=Fe(je);{var Me=ge=>{var P=Va();_(()=>i(P,a(R).max)),d(ge,P)},Be=ge=>{var P=Va();_(()=>i(P,a(R).max)),d(ge,P)};h(ye,ge=>{j===0?ge(Me):ge(Be,!1)},!0)}d(_e,je)};h(kt,_e=>{j===r.segments.length-1?_e(ae):_e(Ce,!1)})}e(ze),e(Q),_((_e,je)=>{$a(Q,`width: ${100/r.segments.length}%`),Ve(U,1,`text-[9px] font-black uppercase tracking-tighter transition-colors ${_e??""}`,"svelte-1ix6916"),i(Se,je)},[()=>j===a(x)()?a(o).replace("bg-","text-"):"text-slate-500",()=>n()("campaign.difficulty."+a(R).key)]),d(I,Q)}),e(fe),e(S),_(I=>{Ve(Ie,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out rounded-full ${a(o)??""}`,"svelte-1ix6916"),$a(Ie,`width: ${I??""}%`)},[()=>a($)()]),d(J,S),la(),D()}var Xr=c('<div><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-2"><!> <span class="text-xs font-black uppercase tracking-widest"> </span></div> <div class="text-xs font-bold uppercase opacity-70"> </div></div> <div class="flex items-center justify-between mb-6"><div><div class="text-3xl font-black leading-none"> </div> <div class="text-[10px] font-bold uppercase opacity-50 mt-1"> </div></div> <div class="text-right"><div class="text-sm font-black uppercase"> </div> <div class="text-[10px] font-bold opacity-40 mt-1 flex items-center justify-end gap-1"><span class="uppercase tracking-tighter"> </span> <span> </span></div></div></div> <!></div>');function ls(J,r){oa(r,!0);const n=()=>Ut(aa,"$t",se),[se,D]=da(),x={starting:{easy:3,avgMin:4,avgMax:15,challMin:16,challMax:30,hard:31,maxCreature:25},novice:{easy:10,avgMin:11,avgMax:30,challMin:31,challMax:50,hard:51,maxCreature:100},expert:{easy:30,avgMin:31,avgMax:50,challMin:51,challMax:125,hard:126,maxCreature:250},master:{easy:50,avgMin:51,avgMax:125,challMin:126,challMax:200,hard:201,maxCreature:null}};let E=V(()=>x[r.tier]||x.starting),$=V(()=>()=>r.totalDifficulty<=a(E).easy?"easy":r.totalDifficulty<=a(E).avgMax?"average":r.totalDifficulty<=a(E).challMax?"challenging":"hard"),o=V(()=>[{key:"easy",max:a(E).easy,color:"bg-green-500"},{key:"average",max:a(E).avgMax,color:"bg-yellow-500"},{key:"challenging",max:a(E).challMax,color:"bg-orange-500"},{key:"hard",max:a(E).challMax*1.5,color:"bg-red-500"}]),S=V(()=>()=>{switch(a($)()){case"easy":return"text-green-400 bg-green-500/10 border-green-500/30";case"average":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/30";case"challenging":return"text-orange-400 bg-orange-500/10 border-orange-500/30";case"hard":return"text-red-400 bg-red-500/10 border-red-500/30";default:return"text-slate-400 bg-slate-500/10 border-slate-500/30"}});var T=Xr(),te=t(T),Ie=t(te),fe=t(Ie);Pa(fe,{size:18});var I=s(fe,2),R=t(I,!0);e(I),e(Ie);var j=s(Ie,2),Q=t(j,!0);e(j),e(te);var U=s(te,2),Se=t(U),ze=t(Se),kt=t(ze,!0);e(ze);var ae=s(ze,2),Ce=t(ae,!0);e(ae),e(Se);var _e=s(Se,2),je=t(_e),ye=t(je,!0);e(je);var Me=s(je,2),Be=t(Me),ge=t(Be);e(Be);var P=s(Be,2),ne=t(P,!0);e(P),e(Me),e(_e),e(U);var ve=s(U,2);Ms(ve,{get value(){return r.totalDifficulty},get segments(){return a(o)}}),e(T),_((Oe,we,_t,nt,ot,xt,st)=>{Ve(T,1,`rounded-xl border p-4 ${Oe??""} shadow-lg`),i(R,we),i(Q,_t),i(kt,r.totalDifficulty),i(Ce,nt),i(ye,ot),i(ge,`${xt??""}:`),i(ne,st)},[()=>a(S)(),()=>n()("campaign.difficulty.title"),()=>n()("campaign.settings.tiers."+r.tier),()=>n()("campaign.difficulty.total"),()=>n()("campaign.difficulty."+a($)()),()=>n()("campaign.difficulty.max_creature"),()=>a(E).maxCreature??n()("campaign.difficulty.none")]),d(J,T),la(),D()}var Kr=c('<div><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-2"><!> <span class="text-xs font-black uppercase tracking-widest"> </span></div> <div class="flex items-center gap-2 text-xs font-bold uppercase opacity-70"><span> </span> <span class="text-[10px] bg-black/20 px-2 py-0.5 rounded"> </span></div></div> <div class="flex items-center justify-between mb-6"><div><div class="text-3xl font-black leading-none"> </div> <div class="text-[10px] font-bold uppercase opacity-50 mt-1"> </div></div> <div class="text-right"><div class="text-sm font-black uppercase"> </div> <div class="text-[10px] font-medium opacity-50 mt-1 uppercase tracking-tighter"> </div></div></div> <!></div>');function ds(J,r){oa(r,!0);const n=()=>Ut(aa,"$t",se),[se,D]=da(),x={starting:{easy:.5,average:1,hard:1.5},novice:{easy:1,average:2,hard:3},expert:{easy:2,average:4,hard:6},master:{easy:4,average:8,hard:12}};let E=V(()=>x[r.tier]||x.novice),$=V(()=>({easy:a(E).easy*r.playerCount,average:a(E).average*r.playerCount,hard:a(E).hard*r.playerCount})),o=V(()=>()=>r.totalDifficulty<=a($).easy?"easy":r.totalDifficulty<=a($).average?"average":"hard"),S=V(()=>[{key:"easy",max:a($).easy,color:"bg-green-500"},{key:"average",max:a($).average,color:"bg-yellow-500"},{key:"hard",max:a($).hard*1.5,color:"bg-red-500"}]),T=V(()=>()=>{switch(a(o)()){case"easy":return"text-green-400 bg-green-500/10 border-green-500/30";case"average":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/30";case"hard":return"text-red-400 bg-red-500/10 border-red-500/30";default:return"text-slate-400 bg-slate-500/10 border-slate-500/30"}});var te=Kr(),Ie=t(te),fe=t(Ie),I=t(fe);Pa(I,{size:18});var R=s(I,2),j=t(R,!0);e(R),e(fe);var Q=s(fe,2),U=t(Q),Se=t(U,!0);e(U);var ze=s(U,2),kt=t(ze,!0);e(ze),e(Q),e(Ie);var ae=s(Ie,2),Ce=t(ae),_e=t(Ce),je=t(_e,!0);e(_e);var ye=s(_e,2),Me=t(ye,!0);e(ye),e(Ce);var Be=s(Ce,2),ge=t(Be),P=t(ge,!0);e(ge);var ne=s(ge,2),ve=t(ne);e(ne),e(Be),e(ae);var Oe=s(ae,2);Ms(Oe,{get value(){return r.totalDifficulty},get segments(){return a(S)}}),e(te),_((we,_t,nt,ot,xt,st,St)=>{Ve(te,1,`rounded-xl border p-4 ${we??""} shadow-lg`),i(j,_t),i(Se,nt),i(kt,ot),i(je,r.totalDifficulty),i(Me,xt),i(P,st),i(ve,`${a(E).average??""}/${St??""}`)},[()=>a(T)(),()=>n()("campaign.difficulty.title"),()=>n()("campaign.settings.tiers."+r.tier),()=>n()("campaign.difficulty.players",{values:{count:r.playerCount}}),()=>n()("campaign.difficulty.total"),()=>n()("campaign.difficulty."+a(o)()),()=>n()("common.labels.master")]),d(J,te),la(),D()}var ei=c('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),ti=c('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),ai=c('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),si=c('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),ri=c('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),ii=c('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),ni=c('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),oi=c('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),li=c('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),di=c('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),vi=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1 flex items-center gap-2"><!> <div class="min-w-0 flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),ci=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),ui=c("<!> <!>",1),bi=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),_i=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),xi=c("<!> <!>",1),mi=c('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),fi=c('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),pi=c('<div class="lg:hidden"><!></div>'),gi=c("<div><!></div>"),hi=c('<div class="text-center text-slate-500 italic py-10"> </div>'),yi=c('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),wi=c('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),ki=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),zi=c('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),Ci=c('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),ji=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Mi=c('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1 flex flex-col"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),Oi=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Ei=c("<!> <!>",1),Si=c('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),Ii=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Di=c("<!> <!>",1),Ri=c('<div class="fixed inset-0 z-50 flex justify-end bg-black/60"><div class="w-full max-w-[300px] h-full bg-slate-900 border-l border-slate-800 p-4 shadow-2xl animate-in slide-in-from-right duration-300"><div class="flex justify-between items-center mb-4"><h3 class="font-bold text-white uppercase tracking-widest text-sm flex items-center gap-2"><!> </h3> <button class="bg-slate-800 p-2 rounded-lg text-slate-400 hover:text-white"><!></button></div> <div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="h-[calc(100%-100px)] overflow-y-auto custom-scrollbar space-y-2"><!></div></div></div>'),$i=c('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="hidden lg:flex flex-col h-[400px] bg-slate-900 border border-slate-800 rounded-xl p-4"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4" role="region" aria-label="Combat Zone"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <!> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"><!></div></div> <!> <!> <!> <button class="lg:hidden fixed bottom-24 right-4 bg-slate-800 text-white p-3 rounded-full shadow-lg border border-slate-700 z-40 active:scale-90 transition-transform" aria-label="Add Enemy"><!></button> <!> <!>',1);function Ni(J,r){oa(r,!0);const n=()=>Ut(Ps,"$liveCharacters",$),se=()=>Ut(es,"$liveEnemies",$),D=()=>Ut(cs,"$liveEncounters",$),x=()=>Ut(aa,"$t",$),E=()=>Ut(Ma,"$isHistoryOpen",$),[$,o]=da();let S=bt(!1),T=bt(!1),te=bt(!1),Ie=bt(!1);const fe={active:!1,round:1};let I=bt("enemies"),R=bt(!1),j=bt(ga([])),Q=bt(ga({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));ss(()=>{if(r.campaign?.id){Ds(r.campaign.id,!0);const l=Aa(aa)("common.labels.master");rs.update(u=>({...u,campaignId:r.campaign.id,name:r.campaign.gmName||l}));const v=setInterval(()=>{const u=ea.get(r.campaign.id)||r.campaign,p=Aa(aa)("common.labels.master");Za(r.campaign.id,{name:u.name,gmName:u.gmName||p})},3e4);return()=>{clearInterval(v),Rs(),rs.update(u=>({...u,campaignId:null}))}}});const U=V(()=>typeof window<"u"?`${window.location.origin}${_s("/campaigns/[id]/invite",{id:r.campaign?.id})}`:"");function Se(){a(U)&&(navigator.clipboard.writeText(a(U)),z(te,!0),setTimeout(()=>{z(te,!1)},2e3))}let ze=V(()=>r.campaign?.sessionRoster||[]),kt=V(()=>r.campaign?.combat||fe),ae=V(()=>r.campaign?.activeEnemies||[]),Ce=V(()=>r.campaign?.members||[]),_e=V(()=>r.campaign?.initiativeStyle||"dle"),je=V(()=>r.campaign?.tier||ir(r.campaign?.system)),ye=V(()=>a(ae).reduce((l,v)=>l+(v.difficulty||0),0)),Me=V(()=>a(ze).length||1),Be=V(()=>Array.from(new Set([...a(ze),...a(Ce).map(v=>v.id)])).map(v=>{const u=n().find(q=>q.id===v),p=a(Ce).find(q=>q.id===v);return u&&p?{...u,...p,lastUpdate:p.lastUpdate}:u||p}).filter(Boolean)),ge=V(()=>a(Be).filter(l=>!l.campaignApproval||l.campaignApproval==="approved")),P=V(()=>a(Be).filter(l=>l.campaignApproval==="pending")),ne=V(()=>n().filter(l=>!a(ze).includes(l.id)&&!a(Ce).some(v=>v.id===l.id)&&(l.system||Oa)===(r.campaign?.system||Oa))),ve=V(()=>se().filter(l=>{const v=(l.system||Oa)===(r.campaign?.system||Oa),u=l.campaignId===r.campaign?.id||l.global;return v&&u})),Oe=V(()=>D().filter(l=>(l.system||Oa)===(r.campaign?.system||Oa)&&!0));function we(l){if(!r.campaign?.id)return;const u={...ea.get(r.campaign.id)||r.campaign,...l};ea.set(r.campaign.id,u),l.combat&&Ra(r.campaign.id,l.combat),(l.name||l.gmName)&&Za(r.campaign.id,{name:u.name,gmName:u.gmName}),rr(r.campaign.id,u)}function _t(l){if(a(ze).includes(l)){const v=a(ze).filter(u=>u!==l);we({sessionRoster:v})}else{const v=[...a(ze),l];we({sessionRoster:v})}}function nt(l){ft(l,{campaignApproval:"approved"}),Na({id:l,campaignApproval:"approved"})}function ot(l){Na({id:l,campaignApproval:"rejected",campaignId:null});const u=((ea.get(r.campaign.id)||r.campaign).members||[]).filter(p=>p.id!==l);we({members:u})}function xt(l){const v=a(Be).find(u=>u.id===l);z(Q,{isOpen:!0,title:x()("session.players.remove_title"),message:x()("session.players.remove_message",{values:{name:v?.name||"este personagem"}}),onConfirm:()=>{const u=ea.get(r.campaign.id)||r.campaign;Na({id:l,campaignId:null});const p=(u.sessionRoster||[]).filter(y=>y!==l),q=(u.members||[]).filter(y=>y.id!==l),f=(u.activeEnemies||[]).filter(y=>y.type!=="player"||y.id!==l);we({sessionRoster:p,members:q,activeEnemies:f}),a(Q).isOpen=!1}},!0)}function st(l){const u=(ea.get(r.campaign.id)||r.campaign).activeEnemies||[],p={...l,instanceId:Ia(),damage:0,currentHealth:l.health,afflictions:[],acted:!1,initiative:!1};we({activeEnemies:[...u,p]})}function St(l){const u=(ea.get(r.campaign.id)||r.campaign).activeEnemies||[];let p=[];l.enemies.forEach(q=>{const f=se().find(y=>y.id===q.enemyId);if(f)for(let y=0;y<q.count;y++)p.push({...f,instanceId:Ia(),damage:0,currentHealth:f.health,afflictions:[],acted:!1,initiative:!1})}),we({activeEnemies:[...u,...p]})}function ht(){we({combat:{active:!0,round:1}}),Ra(r.campaign.id,{active:!0,round:1})}function mt(){const l=a(ae).filter(v=>v.damage<(v.currentHealth??v.health)&&v.endOfRound&&v.endOfRound.length>0).map(v=>({name:v.name,effects:v.endOfRound}));if(l.length>0){z(j,l,!0),z(R,!0);return}Pt()}function Pt(){const l=ea.get(r.campaign.id)||r.campaign,v=(l.combat?.round||1)+1,u=(l.activeEnemies||[]).map(p=>({...p,acted:!1}));we({combat:{...l.combat,round:v},activeEnemies:u}),Ra(r.campaign.id,{active:!0,round:v}),z(R,!1)}function yt(l){we({combat:{active:!1,round:1}}),Ra(r.campaign.id,{active:!1,round:1})}function We(l){const v=ea.get(r.campaign.id)||r.campaign;we({activeEnemies:(v.activeEnemies||[]).filter(u=>u.instanceId!==l)})}function Ze(l,v){const u=ea.get(r.campaign.id)||r.campaign;we({activeEnemies:(u.activeEnemies||[]).map(p=>p.instanceId===l?{...p,...v}:p)})}function Ee(){const l=ea.get(r.campaign.id)||r.campaign,v=l.combat?.round||1;v>1&&we({combat:{...l.combat,round:v-1}})}let De=bt(ga(Date.now()));ss(()=>{const l=setInterval(()=>{z(De,Date.now(),!0)},1e4);return()=>clearInterval(l)});let Xe=V(()=>(()=>{const l=a(ge).filter(v=>a(ze).includes(v.id));return sr(a(_e),l,a(ae))})());function Ye(l){return l.lastUpdate?a(De)-l.lastUpdate<6e4:!1}function ft(l,v){const u=ea.get(r.campaign.id)||r.campaign,p=u.members||[],q=p.findIndex(H=>H.id===l);let f=p;q!==-1&&(f=[...p],f[q]={...f[q],...v});const y=u.activeEnemies||[],g=y.findIndex(H=>H.id===l&&H.type==="player");let re=y;g!==-1&&(re=[...y],re[g]={...re[g],...v}),we({members:f,activeEnemies:re})}function W(l,v,u){l.dataTransfer&&(l.dataTransfer.setData("application/json",JSON.stringify({item:v,type:u})),l.dataTransfer.effectAllowed="copy")}function he(l){return l.preventDefault(),!1}function Pe(l){l.preventDefault();const v=l.dataTransfer?.getData("application/json");if(v)try{const{item:u,type:p}=JSON.parse(v);p==="enemy"?st(u):p==="encounter"&&St(u)}catch(u){console.error("Drop error",u)}}var ce=$i(),rt=Fe(ce),Ge=t(rt),lt=t(Ge),k=t(lt),M=t(k),N=t(M);us(N,{size:14,class:"text-indigo-500"});var Y=s(N),pe=s(Y);{var ue=l=>{var v=ei(),u=t(v,!0);e(v),_(()=>i(u,a(ge).length)),d(l,v)};h(pe,l=>{a(ge).length>0&&l(ue)})}e(M);var Re=s(M,2);Re.__click=()=>z(S,!a(S));var Ke=t(Re,!0);e(Re),e(k);var tt=s(k,2);{var zt=l=>{var v=ai(),u=t(v),p=s(t(u),2),q=t(p);e(p),e(u);var f=s(u,2);Qe(f,17,()=>a(P),y=>y.id,(y,g)=>{var re=ti(),H=t(re),K=t(H),X=t(K,!0);e(K);var me=s(K,2),ie=t(me,!0);e(me),e(H);var Te=s(H,2),ee=t(Te);ee.__click=()=>nt(a(g).id);var Ue=t(ee);os(Ue,{size:14}),e(ee);var Ae=s(ee,2);Ae.__click=()=>ot(a(g).id);var wt=t(Ae);ua(wt,{size:14}),e(Ae),e(Te),e(re),_(gt=>{i(X,a(g).name),i(ie,gt)},[()=>x()("session.players.new_request")]),d(y,re)}),Ea(2),e(v),_(y=>i(q,`${y??""} (${a(P).length??""})`),[()=>x()("session.players.waiting_approval")]),d(l,v)};h(tt,l=>{a(P).length>0&&l(zt)})}var He=s(tt,2),A=t(He),F=t(A);Qe(F,17,()=>a(ge),l=>l.id,(l,v)=>{const u=V(()=>Ye(a(v))),p=V(()=>a(ze).includes(a(v).id));var q=ri(),f=t(q),y=s(f,2),g=t(y),re=t(g,!0);e(g);var H=s(g,2),K=t(H);{var X=Je=>{var it=si(),Et=t(it,!0);e(it),_(qt=>i(Et,qt),[()=>x()("common.labels.session")]),d(Je,it)};h(K,Je=>{a(p)&&Je(X)})}var me=s(K);e(H),e(y);var ie=s(y,2),Te=t(ie);Te.__click=()=>_t(a(v).id);var ee=t(Te);{var Ue=Je=>{xs(Je,{size:14})},Ae=Je=>{ra(Je,{size:14})};h(ee,Je=>{a(p)?Je(Ue):Je(Ae,!1)})}e(Te);var wt=s(Te,2);wt.__click=()=>xt(a(v).id);var gt=t(wt);ua(gt,{size:14}),e(wt),e(ie),e(q),_((Je,it,Et)=>{Ve(q,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(u)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(u)||a(p)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),Ve(f,1,`w-2 h-2 rounded-full ${a(u)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),Ve(g,1,`font-bold text-sm ${a(u)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),i(re,a(v).name),i(me,` ${Je??""} ${a(v).level??""} • ${a(v).ancestry??""}`),Ve(Te,1,`p-1.5 rounded-lg transition-all ${a(p)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),le(Te,"title",it),le(wt,"title",Et)},[()=>x()("common.labels.level"),()=>a(p)?x()("session.players.remove_from_session"):x()("session.players.add_to_session"),()=>x()("session.players.kick_from_campaign")]),d(l,q)});var O=s(F,2);{var oe=l=>{var v=ii(),u=t(v,!0);e(v),_(p=>i(u,p),[()=>x()("session.players.none")]),d(l,v)};h(O,l=>{a(ge).length===0&&l(oe)})}e(A),e(He);var L=s(He,2),B=t(L);{var G=l=>{var v=ni(),u=Fe(v);u.__click=()=>we({isPublished:!0});var p=t(u);pa(p,{size:14});var q=s(p);e(u);var f=s(u,2),y=t(f,!0);e(f),_((g,re)=>{i(q,` ${g??""}`),i(y,re)},[()=>x()("session.publish.publish_session"),()=>x()("session.publish.make_visible")]),d(l,v)},$e=l=>{var v=di(),u=Fe(v),p=t(u),q=t(p),f=t(q);bs(f,{size:10,class:"animate-pulse"});var y=s(f);e(q),e(p);var g=s(p,2);g.__click=()=>z(Ie,!a(Ie));var re=t(g);xr(re,{size:14}),e(g),e(u);var H=s(u,2);{var K=it=>{var Et=oi(),qt=t(Et);e(Et),_(($t,Nt)=>{le(qt,"src",$t),le(qt,"alt",Nt)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(U))}`,()=>x()("session.publish.qr_alt")]),d(it,Et)};h(H,it=>{a(Ie)&&it(K)})}var X=s(H,2),me=t(X),ie=t(me);ie.__click=Se;var Te=t(ie,!0);e(ie);var ee=s(ie,2);ee.__click=Se;var Ue=t(ee);{var Ae=it=>{var Et=li(),qt=t(Et);os(qt,{size:10,class:"inline mr-1"});var $t=s(qt);e(Et),_(Nt=>i($t,` ${Nt??""}`),[()=>x()("common.buttons.copied")]),d(it,Et)};h(Ue,it=>{a(te)&&it(Ae)})}var wt=s(Ue,2);ur(wt,{size:14}),e(ee),e(me),e(X);var gt=s(X,2);gt.__click=()=>we({isPublished:!1});var Je=t(gt,!0);e(gt),_((it,Et,qt,$t)=>{i(y,` ${it??""}`),le(g,"title",Et),i(Te,a(U)),le(ee,"aria-label",qt),i(Je,$t)},[()=>x()("session.publish.public_session"),()=>x()("session.publish.qr_code"),()=>x()("session.publish.copy_link"),()=>x()("session.publish.remove_public")]),d(l,v)};h(B,l=>{r.campaign?.isPublished?l($e,!1):l(G)})}e(L),e(lt);var de=s(lt,2),be=t(de),Z=t(be);Z.__click=()=>z(I,"enemies");var Ne=t(Z);Ca(Ne,{size:14});var xe=s(Ne);e(Z);var Le=s(Z,2);Le.__click=()=>z(I,"encounters");var dt=t(Le);Ka(dt,{size:14});var vt=s(dt);e(Le),e(be);var ct=s(be,2),Ft=t(ct);{var Dt=l=>{var v=ui(),u=Fe(v);Qe(u,17,()=>a(ve),f=>f.id,(f,y)=>{var g=vi(),re=t(g),H=t(re);_r(H,{size:12,class:"text-slate-600 cursor-grab"});var K=s(H,2),X=t(K),me=t(X),ie=s(me);{var Te=gt=>{pa(gt,{size:10,class:"text-indigo-400"})};h(ie,gt=>{a(y).global&&gt(Te)})}e(X);var ee=s(X,2),Ue=t(ee);e(ee),e(K),e(re);var Ae=s(re,2);Ae.__click=()=>st(a(y));var wt=t(Ae);ra(wt,{size:16}),e(Ae),e(g),_(gt=>{i(me,`${a(y).name??""} `),i(Ue,`${gt??""} ${a(y).difficulty??""}`)},[()=>x()("session.enemies.difficulty")]),ja("dragstart",g,gt=>W(gt,a(y),"enemy")),d(f,g)});var p=s(u,2);{var q=f=>{var y=ci(),g=t(y,!0);e(y),_(re=>i(g,re),[()=>x()("session.enemies.none")]),d(f,y)};h(p,f=>{a(ve).length===0&&f(q)})}d(l,v)},Vt=l=>{var v=xi(),u=Fe(v);Qe(u,17,()=>a(Oe),f=>f.id,(f,y)=>{var g=bi(),re=t(g),H=t(re),K=t(H),X=s(K);{var me=Ae=>{pa(Ae,{size:10,class:"text-indigo-400"})};h(X,Ae=>{a(y).global&&Ae(me)})}e(H);var ie=s(H,2),Te=t(ie);e(ie),e(re);var ee=s(re,2);ee.__click=()=>St(a(y));var Ue=t(ee);Xa(Ue,{size:14}),e(ee),e(g),_((Ae,wt)=>{i(K,`${a(y).name??""} `),i(Te,`${Ae??""} ${wt??""}`)},[()=>a(y).enemies?.reduce((Ae,wt)=>Ae+wt.count,0)||0,()=>x()("session.enemies.title")]),ja("dragstart",g,Ae=>W(Ae,a(y),"encounter")),d(f,g)});var p=s(u,2);{var q=f=>{var y=_i(),g=t(y,!0);e(y),_(re=>i(g,re),[()=>x()("session.enemies.no_encounters")]),d(f,y)};h(p,f=>{a(Oe).length===0&&f(q)})}d(l,v)};h(Ft,l=>{a(I)==="enemies"?l(Dt):l(Vt,!1)})}e(ct),e(de),e(Ge);var At=s(Ge,2),m=t(At),b=t(m),C=t(b);{var w=l=>{var v=mi();v.__click=ht;var u=t(v);ks(u,{size:20});var p=s(u);e(v),_(q=>i(p,` ${q??""}`),[()=>x()("session.combat.start")]),d(l,v)},ke=l=>{var v=fi(),u=t(v);u.__click=Ee;var p=t(u);La(p,{size:20}),e(u);var q=s(u,2),f=t(q),y=t(f,!0);e(f);var g=s(f),re=t(g,!0);e(g),e(q);var H=s(q,2);H.__click=mt;var K=t(H);Gs(K,{size:16});var X=s(K);e(H);var me=s(H,4);me.__click=()=>yt();var ie=t(me,!0);e(me),e(v),_((Te,ee,Ue,Ae,wt)=>{le(u,"title",Te),i(y,ee),i(re,a(kt).round),le(H,"title",Ue),i(X,` ${Ae??""}`),i(ie,wt)},[()=>x()("session.combat.previous"),()=>x()("session.combat.round"),()=>x()("session.combat.next"),()=>x()("session.combat.next"),()=>x()("session.combat.end")]),d(l,v)};h(C,l=>{a(kt).active?l(ke,!1):l(w)})}e(b),e(m);var qe=s(m,2);{var at=l=>{var v=pi(),u=t(v);{var p=f=>{ls(f,{get tier(){return a(je)},get totalDifficulty(){return a(ye)}})},q=f=>{ds(f,{get tier(){return a(je)},get totalDifficulty(){return a(ye)},get playerCount(){return a(Me)}})};h(u,f=>{r.campaign?.system==="sofdl"?f(p):f(q,!1)})}e(v),d(l,v)};h(qe,l=>{a(ae).length>0&&l(at)})}var et=s(qe,2),Ct=t(et);Qe(Ct,25,()=>a(Xe),l=>l.type==="player"?l.id:l.instanceId,(l,v)=>{var u=gi(),p=t(u);Br(p,{get entity(){return a(v)},get campaignId(){return r.campaign.id},updateEnemy:Ze,removeFromCombat:We,updatePlayer:ft}),e(u),Hs(u,()=>Wr,()=>({duration:300})),d(l,u)});var jt=s(Ct,2);{var Ht=l=>{var v=hi(),u=t(v,!0);e(v),_(p=>i(u,p),[()=>x()("session.combat.empty")]),d(l,v)};h(jt,l=>{a(Xe).length===0&&l(Ht)})}e(et),e(At);var Rt=s(At,2),Bt=t(Rt);{var Jt=l=>{var v=It(),u=Fe(v);{var p=f=>{ls(f,{get tier(){return a(je)},get totalDifficulty(){return a(ye)}})},q=f=>{ds(f,{get tier(){return a(je)},get totalDifficulty(){return a(ye)},get playerCount(){return a(Me)}})};h(u,f=>{r.campaign?.system==="sofdl"?f(p):f(q,!1)})}d(l,v)};h(Bt,l=>{a(ae).length>0&&l(Jt)})}e(Rt),e(rt);var Xt=s(rt,2);{var ta=l=>{var v=ki();v.__click=Ae=>{Ae.target===Ae.currentTarget&&z(R,!1)};var u=t(v),p=t(u),q=t(p),f=t(q);Zs(f,{size:24}),e(q);var y=s(q,2),g=t(y),re=t(g,!0);e(g);var H=s(g,2),K=t(H,!0);e(H),e(y),e(p);var X=s(p,2);Qe(X,21,()=>a(j),Ot,(Ae,wt)=>{var gt=wi(),Je=t(gt),it=t(Je);Ca(it,{size:14,class:"text-slate-500"});var Et=s(it);e(Je);var qt=s(Je,2);Qe(qt,21,()=>a(wt).effects,Ot,($t,Nt)=>{var Lt=yi(),Yt=t(Lt),Kt=t(Yt);e(Yt);var va=s(Yt,2),wa=t(va,!0);e(va),e(Lt),_(()=>{i(Kt,`${a(Nt).name??""}:`),i(wa,a(Nt).desc)}),d($t,Lt)}),e(qt),e(gt),_(()=>i(Et,` ${a(wt).name??""}`)),d(Ae,gt)}),e(X);var me=s(X,2),ie=t(me);ie.__click=()=>z(R,!1);var Te=t(ie,!0);e(ie);var ee=s(ie,2);ee.__click=Pt;var Ue=t(ee,!0);e(ee),e(me),e(u),e(v),_((Ae,wt,gt,Je)=>{i(re,Ae),i(K,wt),i(Te,gt),i(Ue,Je)},[()=>x()("session.end_of_round.title"),()=>x()("session.end_of_round.summary"),()=>x()("common.buttons.cancel"),()=>x()("session.end_of_round.advance")]),d(l,v)};h(Xt,l=>{a(R)&&l(ta)})}var Gt=s(Xt,2);{var Wt=l=>{var v=ji();v.__click=ee=>{ee.target===ee.currentTarget&&z(S,!1)};var u=t(v),p=t(u),q=t(p),f=t(q),y=t(f,!0);e(f);var g=s(f,2),re=t(g,!0);e(g),e(q);var H=s(q,2);H.__click=()=>z(S,!1);var K=t(H);ya(K,{size:16}),e(H),e(p);var X=s(p,2),me=t(X);Qe(me,17,()=>a(ne),Ot,(ee,Ue)=>{var Ae=zi();Ae.__click=()=>_t(a(Ue).id);var wt=t(Ae),gt=t(wt,!0);e(wt);var Je=s(wt,2),it=t(Je),Et=t(it,!0);e(it);var qt=s(it,2),$t=t(qt);e(qt),e(Je);var Nt=s(Je,2),Lt=t(Nt);ra(Lt,{size:16}),e(Nt),e(Ae),_((Yt,Kt)=>{i(gt,Yt),i(Et,a(Ue).name),i($t,`${Kt??""} ${a(Ue).level??""} • ${a(Ue).ancestry??""}`)},[()=>a(Ue).name.charAt(0),()=>x()("common.labels.level")]),d(ee,Ae)});var ie=s(me,2);{var Te=ee=>{var Ue=Ci(),Ae=t(Ue),wt=t(Ae);Ca(wt,{size:24}),e(Ae);var gt=s(Ae,2),Je=t(gt,!0);e(gt);var it=s(gt,2),Et=t(it,!0);e(it),e(Ue),_((qt,$t)=>{i(Je,qt),i(Et,$t)},[()=>x()("session.manage_session.no_available"),()=>x()("session.manage_session.all_in_session")]),d(ee,Ue)};h(ie,ee=>{a(ne).length===0&&ee(Te)})}e(X),e(u),e(v),_((ee,Ue)=>{i(y,ee),i(re,Ue)},[()=>x()("session.manage_session.title"),()=>x()("session.manage_session.description")]),d(l,v)};h(Gt,l=>{a(S)&&l(Wt)})}var Qt=s(Gt,2);{var ca=l=>{var v=Ri();v.__click=Je=>{Je.target===Je.currentTarget&&z(T,!1)};var u=t(v),p=t(u),q=t(p),f=t(q);Ca(f,{size:16});var y=s(f);e(q);var g=s(q,2);g.__click=()=>z(T,!1);var re=t(g);ya(re,{size:18}),e(g),e(p);var H=s(p,2),K=t(H);K.__click=()=>z(I,"enemies");var X=t(K);Ca(X,{size:14});var me=s(X);e(K);var ie=s(K,2);ie.__click=()=>z(I,"encounters");var Te=t(ie);Ka(Te,{size:14});var ee=s(Te);e(ie),e(H);var Ue=s(H,2),Ae=t(Ue);{var wt=Je=>{var it=Ei(),Et=Fe(it);Qe(Et,17,()=>a(ve),Nt=>Nt.id,(Nt,Lt)=>{var Yt=Mi(),Kt=t(Yt),va=t(Kt),wa=t(va),qa=s(wa);{var Ba=na=>{pa(na,{size:10,class:"text-indigo-400"})};h(qa,na=>{a(Lt).global&&na(Ba)})}e(va);var Sa=s(va,2),Wa=t(Sa);e(Sa),e(Kt);var ka=s(Kt,2);ka.__click=()=>{st(a(Lt)),z(T,!1)};var Ga=t(ka);ra(Ga,{size:16}),e(ka),e(Yt),_(na=>{i(wa,`${a(Lt).name??""} `),i(Wa,`${na??""} ${a(Lt).difficulty??""}`)},[()=>x()("session.enemies.difficulty")]),d(Nt,Yt)});var qt=s(Et,2);{var $t=Nt=>{var Lt=Oi(),Yt=t(Lt,!0);e(Lt),_(Kt=>i(Yt,Kt),[()=>x()("session.enemies.none")]),d(Nt,Lt)};h(qt,Nt=>{a(ve).length===0&&Nt($t)})}d(Je,it)},gt=Je=>{var it=Di(),Et=Fe(it);Qe(Et,17,()=>a(Oe),Nt=>Nt.id,(Nt,Lt)=>{var Yt=Si(),Kt=t(Yt),va=t(Kt),wa=t(va),qa=s(wa);{var Ba=na=>{pa(na,{size:10,class:"text-indigo-400"})};h(qa,na=>{a(Lt).global&&na(Ba)})}e(va);var Sa=s(va,2),Wa=t(Sa);e(Sa),e(Kt);var ka=s(Kt,2);ka.__click=()=>{St(a(Lt)),z(T,!1)};var Ga=t(ka);Xa(Ga,{size:16}),e(ka),e(Yt),_((na,Ja)=>{i(wa,`${a(Lt).name??""} `),i(Wa,`${na??""} ${Ja??""}`)},[()=>a(Lt).enemies?.reduce((na,Ja)=>na+Ja.count,0)||0,()=>x()("session.enemies.title")]),d(Nt,Yt)});var qt=s(Et,2);{var $t=Nt=>{var Lt=Ii(),Yt=t(Lt,!0);e(Lt),_(Kt=>i(Yt,Kt),[()=>x()("session.enemies.no_encounters")]),d(Nt,Lt)};h(qt,Nt=>{a(Oe).length===0&&Nt($t)})}d(Je,it)};h(Ae,Je=>{a(I)==="enemies"?Je(wt):Je(gt,!1)})}e(Ue),e(u),e(v),_((Je,it,Et)=>{i(y,` ${Je??""}`),Ve(K,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(I)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(me,` ${it??""}`),Ve(ie,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(I)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(ee,` ${Et??""}`)},[()=>x()("session.enemies.title"),()=>x()("session.enemies.title"),()=>x()("session.enemies.encounters")]),d(l,v)};h(Qt,l=>{a(T)&&l(ca)})}var Zt=s(Qt,2);Zt.__click=()=>z(T,!0);var pt=t(Zt);Ca(pt,{size:24}),e(Zt);var Tt=s(Zt,2);ms(Tt,{get isOpen(){return E()},onClose:()=>Ma.set(!1)});var ia=s(Tt,2);zs(ia,{get isOpen(){return a(Q).isOpen},get title(){return a(Q).title},get message(){return a(Q).message},get onConfirm(){return a(Q).onConfirm},onCancel:()=>a(Q).isOpen=!1}),_((l,v,u,p)=>{i(Y,` ${l??""} `),i(Ke,v),Ve(Z,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(I)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(xe,` ${u??""}`),Ve(Le,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(I)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(vt,` ${p??""}`)},[()=>x()("session.players.title"),()=>a(S)?x()("session.players.close"):x()("session.players.add"),()=>x()("session.enemies.title"),()=>x()("session.enemies.encounters")]),ja("dragover",At,he),ja("drop",At,Pe),d(J,ce),la(),o()}ba(["click"]);var Ai=c('<span class="text-[10px] text-indigo-300 uppercase font-bold mb-2 block"> </span>'),Ti=c('<div><!> <div class="flex items-center justify-between bg-black/40 rounded-xl p-1.5 border border-white/5"><button type="button" class="w-10 h-10 flex items-center justify-center bg-slate-800 hover:bg-slate-700 text-slate-300 rounded-lg transition-all active:scale-90 disabled:opacity-50 disabled:cursor-not-allowed"><!></button> <div class="flex flex-col items-center min-w-[3rem]"><span class="text-2xl font-black text-white leading-none tracking-tighter"> </span></div> <button type="button" class="w-10 h-10 flex items-center justify-center bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-all active:scale-90 shadow-lg shadow-indigo-500/20 disabled:opacity-50 disabled:cursor-not-allowed"><!></button></div></div>');function Os(J,r){oa(r,!0);const n=()=>Ut(aa,"$t",se),[se,D]=da();function x(){const U=r.steps.indexOf(r.value);if(U>0)r.onUpdate(r.steps[U-1]);else if(U===-1){const Se=[...r.steps].reverse().find(ze=>ze<r.value);Se!==void 0?r.onUpdate(Se):r.onUpdate(r.steps[0])}}function E(){const U=r.steps.indexOf(r.value);if(U!==-1&&U<r.steps.length-1)r.onUpdate(r.steps[U+1]);else if(U===-1){const Se=r.steps.find(ze=>ze>r.value);Se!==void 0?r.onUpdate(Se):r.onUpdate(r.steps[r.steps.length-1])}}var $=Ti(),o=t($);{var S=U=>{var Se=Ai(),ze=t(Se,!0);e(Se),_(()=>i(ze,r.label)),d(U,Se)};h(o,U=>{r.label&&U(S)})}var T=s(o,2),te=t(T);te.__click=x;var Ie=t(te);xs(Ie,{size:18}),e(te);var fe=s(te,2),I=t(fe),R=t(I,!0);e(I),e(fe);var j=s(fe,2);j.__click=E;var Q=t(j);ra(Q,{size:18}),e(j),e(T),e($),_((U,Se)=>{le(te,"aria-label",U),te.disabled=r.value<=r.steps[0],i(R,r.value),le(j,"aria-label",Se),j.disabled=r.value>=r.steps[r.steps.length-1]},[()=>n()("common.buttons.decrease"),()=>n()("common.buttons.increase")]),d(J,$),la(),D()}ba(["click"]);var Ui=c('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),Pi=c('<div class="text-xs text-slate-500 italic mt-2 leading-relaxed opacity-75"> </div>'),Fi=c('<span class="text-slate-400"> </span>'),Hi=c('<span class="text-slate-400"> </span>'),Li=c('<div class="text-sm mb-4"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span></div>'),qi=c('<div class="mb-3 text-sm"><span class="font-bold text-indigo-400"> </span> <span class="text-slate-300 ml-1"> </span></div>'),Bi=c('<span class="text-slate-300"> </span>'),Wi=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span> <span class="text-white ml-1"> </span> <!></div>'),Gi=c('<div class="mt-4"><h4 class="text-red-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Ji=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),Vi=c('<div class="mt-4"><h4 class="text-orange-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Qi=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),Yi=c('<div class="mt-4"><h4 class="text-yellow-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Zi=c('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl"><div class="flex items-start gap-3 mb-4"><!> <div class="flex-1 min-w-0"><div class="flex items-baseline gap-2"><h2 class="text-xl font-bold text-white font-serif tracking-wide"> </h2> <span class="text-red-500 font-bold text-sm"> </span></div> <div class="text-sm text-slate-400 mt-1"> </div> <!></div></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <span class="text-slate-500 font-bold ml-3"> </span> <span class="text-white ml-1"> </span></div> <div class="text-sm mb-3"><span class="text-white"><span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> </span></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <!> <div class="border-t border-slate-700 my-4"></div> <!> <!> <!> <!></div>'),Xi=c('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc-text" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc-text" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-desc" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div class="flex items-center gap-2 mt-4"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),Ki=c('<div class="bg-slate-900 p-3 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),en=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div class="flex flex-col"><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-perception" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-perception" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-speed-notes" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed-notes" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-senses" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[80px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div></div></div>'),tn=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),an=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-2"><div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <select class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm"><option> </option><option> </option></select></div> <div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/> <input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/></div> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),sn=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),rn=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),nn=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="p-4 bg-slate-900 rounded border border-indigo-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-indigo-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-red-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-red-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-orange-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-orange-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-yellow-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-yellow-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div></div>'),on=c('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),ln=c('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" aria-label="Close" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-start justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function dn(J,r){oa(r,!0);const n=()=>Ut(aa,"$t",se),[se,D]=da(),x=P=>{var ne=Zi(),ve=t(ne),Oe=t(ve);{var we=b=>{var C=Ui(),w=t(C);Da(w,{get hash(){return a(o).imageUrl},get alt(){return a(o).name},size:"custom"}),e(C),d(b,C)};h(Oe,b=>{a(o).imageUrl&&b(we)})}var _t=s(Oe,2),nt=t(_t),ot=t(nt),xt=t(ot,!0);e(ot);var st=s(ot,2),St=t(st);e(st),e(nt);var ht=s(nt,2),mt=t(ht);e(ht);var Pt=s(ht,2);{var yt=b=>{var C=Pi(),w=t(C,!0);e(C),_(()=>i(w,a(o).description)),d(b,C)};h(Pt,b=>{a(o).description&&b(yt)})}e(_t),e(ve);var We=s(ve,2),Ze=t(We),Ee=t(Ze,!0);e(Ze);var De=s(Ze,2),Xe=t(De);e(De);var Ye=s(De,2);{var ft=b=>{var C=Fi(),w=t(C);e(C),_(()=>i(w,`; ${a(o).senses??""}`)),d(b,C)};h(Ye,b=>{a(o).senses&&b(ft)})}e(We);var W=s(We,2),he=t(W),Pe=t(he,!0);e(he);var ce=s(he,2),rt=t(ce,!0);e(ce);var Ge=s(ce,2),lt=t(Ge,!0);e(Ge);var k=s(Ge,2),M=t(k,!0);e(k),e(W);var N=s(W,2),Y=t(N),pe=t(Y),ue=t(pe,!0);e(pe);var Re=s(pe),Ke=s(Re),tt=t(Ke,!0);e(Ke);var zt=s(Ke),He=s(zt),A=t(He,!0);e(He);var F=s(He),O=s(F),oe=t(O,!0);e(O);var L=s(O);e(Y),e(N);var B=s(N,2),G=t(B),$e=t(G,!0);e(G);var de=s(G,2),be=t(de,!0);e(de);var Z=s(de,2);{var Ne=b=>{var C=Hi(),w=t(C);e(C),_(()=>i(w,`; ${a(o).speedNotes??""}`)),d(b,C)};h(Z,b=>{a(o).speedNotes&&b(Ne)})}e(B);var xe=s(B,2);{var Le=b=>{var C=Li(),w=t(C),ke=t(w,!0);e(w);var qe=s(w,2),at=t(qe,!0);e(qe),e(C),_(et=>{i(ke,et),i(at,a(o).immunities)},[()=>n()("session.enemy_modal.immunities")]),d(b,C)};h(xe,b=>{a(o).immunities&&b(Le)})}var dt=s(xe,4);{var vt=b=>{var C=It(),w=Fe(C);Qe(w,17,()=>a(o).traits,Ot,(ke,qe)=>{var at=qi(),et=t(at),Ct=t(et,!0);e(et);var jt=s(et,2),Ht=t(jt,!0);e(jt),e(at),_(()=>{i(Ct,a(qe).name),i(Ht,a(qe).desc)}),d(ke,at)}),d(b,C)};h(dt,b=>{a(o).traits.length>0&&b(vt)})}var ct=s(dt,2);{var Ft=b=>{var C=Gi(),w=t(C),ke=t(w,!0);e(w);var qe=s(w,2);Qe(qe,17,()=>a(o).attackOptions,Ot,(at,et)=>{var Ct=Wi(),jt=t(Ct),Ht=t(jt,!0);e(jt);var Rt=s(jt,2),Bt=t(Rt);e(Rt);var Jt=s(Rt,2),Xt=t(Jt);e(Jt);var ta=s(Jt,2);{var Gt=Wt=>{var Qt=Bi(),ca=t(Qt);e(Qt),_(()=>i(ca,`; ${a(et).desc??""}`)),d(Wt,Qt)};h(ta,Wt=>{a(et).desc&&Wt(Gt)})}e(Ct),_(Wt=>{i(Ht,a(et).name),i(Bt,`(${Wt??""})`),i(Xt,`${a(et).attackRoll??""} (${a(et).damage??""})`)},[()=>a(et).type==="melee"?n()("session.enemy_modal.melee").toLowerCase():n()("session.enemy_modal.ranged").toLowerCase()]),d(at,Ct)}),e(C),_(at=>i(ke,at),[()=>n()("session.enemy_modal.attack_options")]),d(b,C)};h(ct,b=>{a(o).attackOptions.length>0&&b(Ft)})}var Dt=s(ct,2);{var Vt=b=>{var C=Vi(),w=t(C),ke=t(w,!0);e(w);var qe=s(w,2);Qe(qe,17,()=>a(o).specialAttacks,Ot,(at,et)=>{var Ct=Ji(),jt=t(Ct),Ht=t(jt,!0);e(jt);var Rt=s(jt,2),Bt=t(Rt,!0);e(Rt),e(Ct),_(()=>{i(Ht,a(et).name),i(Bt,a(et).desc)}),d(at,Ct)}),e(C),_(at=>i(ke,at),[()=>n()("session.enemy_modal.special_attacks")]),d(b,C)};h(Dt,b=>{a(o).specialAttacks.length>0&&b(Vt)})}var At=s(Dt,2);{var m=b=>{var C=Yi(),w=t(C),ke=t(w,!0);e(w);var qe=s(w,2);Qe(qe,17,()=>a(o).endOfRound,Ot,(at,et)=>{var Ct=Qi(),jt=t(Ct),Ht=t(jt,!0);e(jt);var Rt=s(jt,2),Bt=t(Rt,!0);e(Rt),e(Ct),_(()=>{i(Ht,a(et).name),i(Bt,a(et).desc)}),d(at,Ct)}),e(C),_(at=>i(ke,at),[()=>n()("session.enemy_modal.end_of_round")]),d(b,C)};h(At,b=>{a(o).endOfRound.length>0&&b(m)})}e(ne),_((b,C,w,ke,qe,at,et,Ct,jt,Ht,Rt,Bt,Jt,Xt,ta,Gt,Wt)=>{i(xt,b),i(St,`${C??""} ${a(o).difficulty??""}`),i(mt,`${w??""} ${ke??""} ${a(o).descriptors??""}`),i(Ee,qe),i(Xe,`${a(o).perception??""} (${at??""})`),i(Pe,et),i(rt,a(o).defense),i(lt,Ct),i(M,a(o).health),i(ue,jt),i(Re,` ${a(o).attributes.strength??""} (${Ht??""}), `),i(tt,Rt),i(zt,` ${a(o).attributes.agility??""} (${Bt??""}), `),i(A,Jt),i(F,` ${a(o).attributes.intellect??""} (${Xt??""}), `),i(oe,ta),i(L,` ${a(o).attributes.will??""} (${Gt??""})`),i($e,Wt),i(be,a(o).speed)},[()=>a(o).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemies.difficulty").toUpperCase(),()=>n()("session.enemy_modal.size"),()=>Q(a(o).size),()=>n()("sofdl.attributes.perception"),()=>j(a(o).perception),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("sofdl.attributes.strength"),()=>j(a(o).attributes.strength),()=>n()("sofdl.attributes.agility"),()=>j(a(o).attributes.agility),()=>n()("sofdl.attributes.intellect"),()=>j(a(o).attributes.intellect),()=>n()("sofdl.attributes.will"),()=>j(a(o).attributes.will),()=>n()("session.enemy_modal.speed")]),d(P,ne)};let E=sa(r,"isOpen",3,!1),$=sa(r,"initialData",3,"{}"),o=bt(ga(R())),S=bt("general"),T=bt(!1),te=bt(""),Ie=bt(void 0);function fe(P){const ne=P.target.files;if(ne&&ne.length>0){const ve=ne[0],Oe=new FileReader;Oe.onload=()=>{z(te,Oe.result,!0),z(T,!0)},Oe.readAsDataURL(ve)}P.target&&(P.target.value="")}async function I(P){try{const ne=await hs(P);a(o).imageUrl=ne,z(T,!1)}catch(ne){console.error(ne),alert(ne.message||"Erro ao salvar imagem")}}function R(){return{name:"",difficulty:1,size:1,description:"",descriptors:"",perception:10,senses:"",defense:10,health:10,attributes:{strength:10,agility:10,intellect:10,will:10},speed:10,speedNotes:"",immunities:"",traits:[],attackOptions:[],specialAttacks:[],endOfRound:[],imageUrl:"",global:!1}}function j(P){const ne=P-10;return ne>=0?`+${ne}`:`${ne}`}function Q(P){return P===.125?"1/8":P===.5?"1/2":P}Fa(()=>{if(E()&&$())try{const P=JSON.parse($());Object.keys(P).length===0?z(o,R(),!0):z(o,{...R(),...P},!0)}catch{z(o,R(),!0)}});function U(){a(o).traits=[...a(o).traits,{name:"",desc:""}]}function Se(P){a(o).traits=a(o).traits.filter((ne,ve)=>ve!==P)}function ze(){a(o).attackOptions=[...a(o).attackOptions,{name:"",type:"melee",attackRoll:"+0",damage:"1d6",desc:""}]}function kt(P){a(o).attackOptions=a(o).attackOptions.filter((ne,ve)=>ve!==P)}function ae(){a(o).specialAttacks=[...a(o).specialAttacks,{name:"",desc:""}]}function Ce(P){a(o).specialAttacks=a(o).specialAttacks.filter((ne,ve)=>ve!==P)}function _e(){a(o).endOfRound=[...a(o).endOfRound,{name:"",desc:""}]}function je(P){a(o).endOfRound=a(o).endOfRound.filter((ne,ve)=>ve!==P)}function ye(P){}var Me=It(),Be=Fe(Me);{var ge=P=>{var ne=ln(),ve=Fe(ne);ve.__click=ye;var Oe=t(ve),we=t(Oe),_t=t(we),nt=t(_t),ot=t(nt);ot.__click=function(...He){r.onClose?.apply(this,He)};var xt=t(ot);La(xt,{size:24}),e(ot);var st=s(ot,2),St=t(st,!0);e(st),e(nt);var ht=s(nt,2);ht.__click=function(...He){r.onClose?.apply(this,He)};var mt=t(ht);ya(mt,{size:20}),e(ht),e(_t);var Pt=s(_t,2),yt=t(Pt);yt.__click=()=>z(S,"general");var We=t(yt,!0);e(yt);var Ze=s(yt,2);Ze.__click=()=>z(S,"stats");var Ee=t(Ze,!0);e(Ze);var De=s(Ze,2);De.__click=()=>z(S,"abilities");var Xe=t(De,!0);e(De);var Ye=s(De,2);Ye.__click=()=>z(S,"preview");var ft=t(Ye,!0);e(Ye),e(Pt);var W=s(Pt,2),he=t(W);{var Pe=He=>{var A=Xi(),F=t(A),O=t(F);O.__click=()=>a(Ie)?.click();var oe=t(O),L=t(oe);ts(L,()=>a(o).imageUrl,w=>{Da(w,{get hash(){return a(o).imageUrl},get alt(){return a(o).name},size:"custom",fallbackText:"?"})}),e(oe);var B=s(oe,2),G=t(B);ps(G,{size:20,class:"text-white"}),e(B),e(O);var $e=s(O,2),de=t($e),be=t(de,!0);e(de);var Z=s(de,2);Mt(Z),e($e),e(F);var Ne=s(F,2),xe=t(Ne),Le=t(xe,!0);e(xe);var dt=s(xe,2);ha(dt),e(Ne);var vt=s(Ne,2),ct=t(vt),Ft=t(ct,!0);e(ct);var Dt=s(ct,2);Mt(Dt),e(vt);var Vt=s(vt,2),At=t(Vt);Mt(At);var m=s(At,2),b=t(m);pa(b,{size:14});var C=s(b);e(m),e(Vt),e(A),_((w,ke,qe,at,et,Ct)=>{i(be,w),i(Le,ke),le(dt,"placeholder",qe),i(Ft,at),le(Dt,"placeholder",et),i(C,` ${Ct??""}`)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.descriptors"),()=>n()("session.enemy_modal.descriptors_placeholder"),()=>n()("session.enemy_modal.global_enemy")]),ut(Z,()=>a(o).name,w=>a(o).name=w),ut(dt,()=>a(o).description,w=>a(o).description=w),ut(Dt,()=>a(o).descriptors,w=>a(o).descriptors=w),vs(At,()=>a(o).global,w=>a(o).global=w),d(He,A)},ce=He=>{var A=It(),F=Fe(A);{var O=L=>{var B=en(),G=t(B),$e=t(G),de=t($e),be=t(de,!0);e(de);var Z=s(de,2);{let f=V(()=>a(o).difficulty??0);Os(Z,{get value(){return a(f)},onUpdate:y=>a(o).difficulty=y,steps:[0,1,5,10,25,50,100,250,500,750,1e3]})}e($e);var Ne=s($e,2),xe=t(Ne),Le=t(xe,!0);e(xe);var dt=s(xe,2);{let f=V(()=>a(o).size||1);gs(dt,{get value(){return a(f)},onUpdate:y=>a(o).size=y})}e(Ne),e(G);var vt=s(G,2),ct=t(vt),Ft=t(ct),Dt=t(Ft,!0);e(Ft);var Vt=s(Ft,2);Mt(Vt),e(ct);var At=s(ct,2),m=t(At),b=t(m,!0);e(m);var C=s(m,2);Mt(C),e(At),e(vt);var w=s(vt,2),ke=t(w),qe=t(ke),at=t(qe,!0);e(qe);var et=s(qe,2);Mt(et),e(ke);var Ct=s(ke,2),jt=t(Ct),Ht=t(jt,!0);e(jt);var Rt=s(jt,2);Mt(Rt),e(Ct),e(w);var Bt=s(w,2),Jt=t(Bt),Xt=t(Jt,!0);e(Jt);var ta=s(Jt,2);Qe(ta,5,()=>[{key:"strength",label:n()("sofdl.attributes.strength")},{key:"agility",label:n()("sofdl.attributes.agility")},{key:"intellect",label:n()("sofdl.attributes.intellect")},{key:"will",label:n()("sofdl.attributes.will")}],Ot,(f,y)=>{var g=Ki(),re=t(g),H=t(re,!0);e(re);var K=s(re,2);Mt(K);var X=s(K,2),me=t(X,!0);e(X),e(g),_((ie,Te)=>{le(re,"for",`attr-${a(y).key??""}`),le(re,"title",a(y).label),i(H,ie),le(K,"id",`attr-${a(y).key??""}`),Ve(X,1,`text-xs font-bold ${a(o).attributes[a(y).key]-10>=0?"text-green-500":"text-red-500"}`),i(me,Te)},[()=>a(y).label.substring(0,3),()=>j(a(o).attributes[a(y).key])]),ut(K,()=>a(o).attributes[a(y).key],ie=>a(o).attributes[a(y).key]=ie),d(f,g)}),e(ta),e(Bt);var Gt=s(Bt,2),Wt=t(Gt),Qt=t(Wt),ca=t(Qt,!0);e(Qt);var Zt=s(Qt,2);Mt(Zt),e(Wt);var pt=s(Wt,2),Tt=t(pt),ia=t(Tt,!0);e(Tt);var l=s(Tt,2);Mt(l),e(pt);var v=s(pt,2),u=t(v),p=t(u,!0);e(u);var q=s(u,2);ha(q),e(v),e(Gt),e(B),_((f,y,g,re,H,K,X,me,ie,Te,ee,Ue,Ae)=>{i(be,f),i(Le,y),i(Dt,g),i(b,re),i(at,H),i(Ht,K),i(Xt,X),i(ca,me),le(Zt,"placeholder",ie),i(ia,Te),le(l,"placeholder",ee),i(p,Ue),le(q,"placeholder",Ae)},[()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.defense"),()=>n()("sofdl.attributes.perception"),()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.speed_notes"),()=>n()("session.enemy_modal.speed_notes_placeholder"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder_sotdl"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder_sotdl")]),ut(Vt,()=>a(o).speed,f=>a(o).speed=f),ut(C,()=>a(o).health,f=>a(o).health=f),ut(et,()=>a(o).defense,f=>a(o).defense=f),ut(Rt,()=>a(o).perception,f=>a(o).perception=f),ut(Zt,()=>a(o).speedNotes,f=>a(o).speedNotes=f),ut(l,()=>a(o).senses,f=>a(o).senses=f),ut(q,()=>a(o).immunities,f=>a(o).immunities=f),d(L,B)},oe=L=>{var B=It(),G=Fe(B);{var $e=be=>{var Z=nn(),Ne=t(Z),xe=t(Ne),Le=t(xe),dt=t(Le,!0);e(Le),e(xe);var vt=s(xe,2),ct=t(vt);Qe(ct,17,()=>a(o).traits,Ot,(y,g,re)=>{var H=tn(),K=t(H),X=t(K);Mt(X);var me=s(X,2);ha(me),e(K);var ie=s(K,2);ie.__click=()=>Se(re);var Te=t(ie);ua(Te,{size:16}),e(ie),e(H),_((ee,Ue)=>{le(X,"placeholder",ee),le(me,"placeholder",Ue)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),ut(X,()=>a(g).name,ee=>a(g).name=ee),ut(me,()=>a(g).desc,ee=>a(g).desc=ee),d(y,H)});var Ft=s(ct,2);Ft.__click=U;var Dt=t(Ft),Vt=t(Dt);ra(Vt,{size:16}),e(Dt);var At=s(Dt);e(Ft),e(vt),e(Ne);var m=s(Ne,2),b=t(m),C=t(b),w=t(C,!0);e(C),e(b);var ke=s(b,2),qe=t(ke);Qe(qe,17,()=>a(o).attackOptions,Ot,(y,g,re)=>{var H=an(),K=t(H),X=t(K),me=t(X);Mt(me);var ie=s(me,2),Te=t(ie),ee=t(Te,!0);e(Te),Te.value=Te.__value="melee";var Ue=s(Te),Ae=t(Ue,!0);e(Ue),Ue.value=Ue.__value="ranged",e(ie),e(X);var wt=s(X,2),gt=t(wt);Mt(gt);var Je=s(gt,2);Mt(Je),e(wt);var it=s(wt,2);ha(it),e(K);var Et=s(K,2);Et.__click=()=>kt(re);var qt=t(Et);ua(qt,{size:16}),e(Et),e(H),_(($t,Nt,Lt,Yt,Kt,va)=>{le(me,"placeholder",$t),i(ee,Nt),i(Ae,Lt),le(gt,"placeholder",Yt),le(Je,"placeholder",Kt),le(it,"placeholder",va)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.melee"),()=>n()("session.enemy_modal.ranged"),()=>n()("session.enemy_modal.attack_placeholder"),()=>n()("session.enemy_modal.damage_placeholder"),()=>n()("session.enemy_modal.desc_effects_placeholder")]),ut(me,()=>a(g).name,$t=>a(g).name=$t),Is(ie,()=>a(g).type,$t=>a(g).type=$t),ut(gt,()=>a(g).attackRoll,$t=>a(g).attackRoll=$t),ut(Je,()=>a(g).damage,$t=>a(g).damage=$t),ut(it,()=>a(g).desc,$t=>a(g).desc=$t),d(y,H)});var at=s(qe,2);at.__click=ze;var et=t(at),Ct=t(et);ra(Ct,{size:16}),e(et);var jt=s(et);e(at),e(ke),e(m);var Ht=s(m,2),Rt=t(Ht),Bt=t(Rt),Jt=t(Bt,!0);e(Bt),e(Rt);var Xt=s(Rt,2),ta=t(Xt);Qe(ta,17,()=>a(o).specialAttacks,Ot,(y,g,re)=>{var H=sn(),K=t(H),X=t(K);Mt(X);var me=s(X,2);ha(me),e(K);var ie=s(K,2);ie.__click=()=>Ce(re);var Te=t(ie);ua(Te,{size:16}),e(ie),e(H),_((ee,Ue)=>{le(X,"placeholder",ee),le(me,"placeholder",Ue)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),ut(X,()=>a(g).name,ee=>a(g).name=ee),ut(me,()=>a(g).desc,ee=>a(g).desc=ee),d(y,H)});var Gt=s(ta,2);Gt.__click=ae;var Wt=t(Gt),Qt=t(Wt);ra(Qt,{size:16}),e(Wt);var ca=s(Wt);e(Gt),e(Xt),e(Ht);var Zt=s(Ht,2),pt=t(Zt),Tt=t(pt),ia=t(Tt,!0);e(Tt),e(pt);var l=s(pt,2),v=t(l);Qe(v,17,()=>a(o).endOfRound,Ot,(y,g,re)=>{var H=rn(),K=t(H),X=t(K);Mt(X);var me=s(X,2);ha(me),e(K);var ie=s(K,2);ie.__click=()=>je(re);var Te=t(ie);ua(Te,{size:16}),e(ie),e(H),_((ee,Ue)=>{le(X,"placeholder",ee),le(me,"placeholder",Ue)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),ut(X,()=>a(g).name,ee=>a(g).name=ee),ut(me,()=>a(g).desc,ee=>a(g).desc=ee),d(y,H)});var u=s(v,2);u.__click=_e;var p=t(u),q=t(p);ra(q,{size:16}),e(p);var f=s(p);e(u),e(l),e(Zt),e(Z),_((y,g,re,H,K,X,me,ie)=>{i(dt,y),i(At,` ${g??""}`),i(w,re),i(jt,` ${H??""}`),i(Jt,K),i(ca,` ${X??""}`),i(ia,me),i(f,` ${ie??""}`)},[()=>n()("session.enemy_modal.traits"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.attack_options"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.special_attacks"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.end_of_round"),()=>n()("common.buttons.add")]),d(be,Z)},de=be=>{var Z=It(),Ne=Fe(Z);{var xe=Le=>{var dt=on(),vt=t(dt);x(vt),e(dt),d(Le,dt)};h(Ne,Le=>{a(S)==="preview"&&Le(xe)},!0)}d(be,Z)};h(G,be=>{a(S)==="abilities"?be($e):be(de,!1)},!0)}d(L,B)};h(F,L=>{a(S)==="stats"?L(O):L(oe,!1)},!0)}d(He,A)};h(he,He=>{a(S)==="general"?He(Pe):He(ce,!1)})}e(W);var rt=s(W,2),Ge=t(rt);Ge.__click=()=>r.onSave(a(o));var lt=t(Ge);as(lt,{size:18});var k=s(lt);e(Ge),e(rt),e(we);var M=s(we,2),N=t(M),Y=t(N),pe=t(Y);Ha(pe,{size:14});var ue=s(pe);e(Y),e(N);var Re=s(N,2),Ke=t(Re);x(Ke),e(Re),e(M),e(Oe),e(ve);var tt=s(ve,2);tt.__change=fe,Cs(tt,He=>z(Ie,He),()=>a(Ie));var zt=s(tt,2);fs(zt,{get isOpen(){return a(T)},get imageUrl(){return a(te)},onClose:()=>z(T,!1),onCrop:I}),_((He,A,F,O,oe,L,B)=>{i(St,He),Ve(yt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(We,A),Ve(Ze,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Ee,F),Ve(De,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Xe,O),Ve(Ye,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(ft,oe),i(k,` ${L??""}`),i(ue,` ${B??""}`)},[()=>n()("session.enemy_modal.title"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_stats"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("session.enemy_modal.preview"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview")]),Ta(3,Oe,()=>Ua,()=>({y:20,duration:300})),Ta(3,ve,()=>Ua,()=>({duration:200,opacity:1})),d(P,ne)};h(Be,P=>{E()&&P(ge)})}d(J,Me),la(),D()}ba(["click","change"]);var vn=c('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),cn=c('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),un=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),bn=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),_n=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),xn=c('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),mn=c('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),fn=c('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),pn=c('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),gn=c('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),hn=c('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),yn=c('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),wn=c('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),kn=c('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div>'),zn=c('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="flex items-center gap-2"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),Cn=c('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),jn=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div class="flex flex-col"><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div> <div class="flex flex-col"><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-damage" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-damage" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 text-center border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),Mn=c('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),On=c('<div><div class="mb-3"><h4> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div>'),En=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"></div>'),Sn=c('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),In=c('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function Dn(J,r){oa(r,!0);const n=()=>Ut(aa,"$t",se),[se,D]=da(),x=ae=>{var Ce=kn(),_e=t(Ce),je=t(_e);e(_e);var ye=s(_e,2),Me=t(ye);{var Be=A=>{var F=vn(),O=t(F);Da(O,{get hash(){return a(o).imageUrl},get alt(){return a(o).name},size:"custom"}),e(F),d(A,F)};h(Me,A=>{a(o).imageUrl&&A(Be)})}var ge=s(Me,2),P=t(ge),ne=t(P,!0);e(P),Ea(2),e(ge),e(ye);var ve=s(ye,2),Oe=t(ve),we=t(Oe),_t=t(we,!0);e(we);var nt=s(we,2),ot=t(nt,!0);e(nt),e(Oe);var xt=s(Oe,2),st=t(xt),St=t(st,!0);e(st);var ht=s(st,2),mt=t(ht,!0);e(ht),e(xt);var Pt=s(xt,2),yt=t(Pt),We=t(yt,!0);e(yt);var Ze=s(yt,2),Ee=t(Ze,!0);e(Ze),e(Pt);var De=s(Pt,2),Xe=t(De),Ye=t(Xe,!0);e(Xe);var ft=s(Xe,2),W=t(ft,!0);e(ft),e(De),e(ve);var he=s(ve,2);Qe(he,20,()=>["str","agi","int","wil"],Ot,(A,F)=>{var O=cn(),oe=t(O),L=t(oe,!0);e(oe);var B=s(oe,2),G=t(B),$e=s(G),de=t($e);e($e),e(B),e(O),_(()=>{i(L,F),i(G,`${a(o).stats[F]??""} `),Ve($e,1,`text-xs ${a(o).stats[F]-10>=0?"text-green-500":"text-red-500"}`),i(de,`(${a(o).stats[F]-10>=0?"+":""}${a(o).stats[F]-10})`)}),d(A,O)}),e(he);var Pe=s(he,2),ce=t(Pe);{var rt=A=>{var F=un(),O=t(F),oe=t(O);e(O);var L=s(O,2),B=t(L,!0);e(L),e(F),_(G=>{i(oe,`${G??""}:`),i(B,a(o).senses)},[()=>n()("session.enemy_modal.senses")]),d(A,F)};h(ce,A=>{a(o).senses&&A(rt)})}var Ge=s(ce,2);{var lt=A=>{var F=bn(),O=t(F),oe=t(O);e(O);var L=s(O,2),B=t(L,!0);e(L),e(F),_(G=>{i(oe,`${G??""}:`),i(B,a(o).languages)},[()=>n()("session.enemy_modal.languages")]),d(A,F)};h(Ge,A=>{a(o).languages&&A(lt)})}var k=s(Ge,2);{var M=A=>{var F=_n(),O=t(F),oe=t(O);e(O);var L=s(O,2),B=t(L,!0);e(L),e(F),_(G=>{i(oe,`${G??""}:`),i(B,a(o).immune)},[()=>n()("session.enemy_modal.immunities")]),d(A,F)};h(k,A=>{a(o).immune&&A(M)})}e(Pe);var N=s(Pe,2),Y=t(N);{var pe=A=>{var F=mn(),O=t(F),oe=t(O,!0);e(O);var L=s(O,2);Qe(L,17,()=>a(o).traits,Ot,(B,G,$e,de)=>{var be=xn(),Z=t(be),Ne=t(Z);e(Z);var xe=s(Z,2),Le=t(xe,!0);e(xe),e(be),_(()=>{i(Ne,`${a(G).name??""}:`),i(Le,a(G).desc)}),d(B,be)}),e(F),_(B=>i(oe,B),[()=>n()("session.enemy_modal.traits")]),d(A,F)};h(Y,A=>{a(o).traits.length>0&&A(pe)})}var ue=s(Y,2);{var Re=A=>{var F=pn(),O=t(F),oe=t(O,!0);e(O);var L=s(O,2);Qe(L,17,()=>a(o).actions,Ot,(B,G,$e,de)=>{var be=fn(),Z=t(be),Ne=t(Z);e(Z);var xe=s(Z,2),Le=t(xe,!0);e(xe),e(be),_(()=>{i(Ne,`${a(G).name??""}:`),i(Le,a(G).desc)}),d(B,be)}),e(F),_(B=>i(oe,B),[()=>n()("session.enemy_modal.actions")]),d(A,F)};h(ue,A=>{a(o).actions.length>0&&A(Re)})}var Ke=s(ue,2);{var tt=A=>{var F=hn(),O=t(F),oe=t(O,!0);e(O);var L=s(O,2);Qe(L,17,()=>a(o).reactions,Ot,(B,G,$e,de)=>{var be=gn(),Z=t(be),Ne=t(Z);e(Z);var xe=s(Z,2),Le=t(xe,!0);e(xe),e(be),_(()=>{i(Ne,`${a(G).name??""}:`),i(Le,a(G).desc)}),d(B,be)}),e(F),_(B=>i(oe,B),[()=>n()("session.enemy_modal.reactions")]),d(A,F)};h(Ke,A=>{a(o).reactions.length>0&&A(tt)})}var zt=s(Ke,2);{var He=A=>{var F=wn(),O=t(F),oe=t(O,!0);e(O);var L=s(O,2);Qe(L,17,()=>a(o).endOfRound,Ot,(B,G,$e,de)=>{var be=yn(),Z=t(be),Ne=t(Z);e(Z);var xe=s(Z,2),Le=t(xe,!0);e(xe),e(be),_(()=>{i(Ne,`${a(G).name??""}:`),i(Le,a(G).desc)}),d(B,be)}),e(F),_(B=>i(oe,B),[()=>n()("session.enemy_modal.end_of_round")]),d(A,F)};h(zt,A=>{a(o).endOfRound.length>0&&A(He)})}e(N),e(Ce),_((A,F,O,oe,L,B)=>{i(je,`${A??""} ${a(o).difficulty??""}`),i(ne,F),i(_t,O),i(ot,a(o).defense),i(St,oe),i(mt,a(o).health),i(We,L),i(Ee,a(o).size),i(Ye,B),i(W,a(o).speed)},[()=>n()("session.enemy_modal.difficulty"),()=>a(o).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed")]),d(ae,Ce)};let E=sa(r,"isOpen",3,!1),$=sa(r,"initialData",3,"{}"),o=bt(ga(R())),S=bt("general"),T=bt(!1),te=bt(""),Ie=bt(void 0);function fe(ae){const Ce=ae.target.files;if(Ce&&Ce.length>0){const _e=Ce[0],je=new FileReader;je.onload=()=>{z(te,je.result,!0),z(T,!0)},je.readAsDataURL(_e)}ae.target&&(ae.target.value="")}async function I(ae){try{const Ce=await hs(ae);a(o).imageUrl=Ce,z(T,!1)}catch(Ce){console.error(Ce),alert(Ce.message||"Erro ao salvar imagem")}}function R(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[],global:!1}}Fa(()=>{if(E()&&$())try{const ae=JSON.parse($());Object.keys(ae).length===0?z(o,R(),!0):z(o,{...R(),...ae},!0)}catch{z(o,R(),!0)}});function j(ae){a(o)[ae]=[...a(o)[ae],{name:"",desc:""}]}function Q(ae,Ce){a(o)[ae]=a(o)[ae].filter((_e,je)=>je!==Ce)}function U(ae){}var Se=It(),ze=Fe(Se);{var kt=ae=>{var Ce=In(),_e=Fe(Ce);_e.__click=U;var je=t(_e),ye=t(je),Me=t(ye),Be=t(Me),ge=t(Be);ge.__click=function(...N){r.onClose?.apply(this,N)};var P=t(ge);La(P,{size:24}),e(ge);var ne=s(ge,2),ve=t(ne,!0);e(ne),e(Be);var Oe=s(Be,2);Oe.__click=function(...N){r.onClose?.apply(this,N)};var we=t(Oe);ya(we,{size:20}),e(Oe),e(Me);var _t=s(Me,2),nt=t(_t);nt.__click=()=>z(S,"general");var ot=t(nt,!0);e(nt);var xt=s(nt,2);xt.__click=()=>z(S,"stats");var st=t(xt,!0);e(xt);var St=s(xt,2);St.__click=()=>z(S,"abilities");var ht=t(St,!0);e(St);var mt=s(St,2);mt.__click=()=>z(S,"preview");var Pt=t(mt,!0);e(mt),e(_t);var yt=s(_t,2),We=t(yt);{var Ze=N=>{var Y=zn(),pe=t(Y),ue=t(pe);ue.__click=()=>a(Ie)?.click();var Re=t(ue),Ke=t(Re);ts(Ke,()=>a(o).imageUrl,xe=>{Da(xe,{get hash(){return a(o).imageUrl},get alt(){return a(o).name},size:"custom",fallbackText:"?"})}),e(Re);var tt=s(Re,2),zt=t(tt);ps(zt,{size:20,class:"text-white"}),e(tt),e(ue);var He=s(ue,2),A=t(He),F=t(A,!0);e(A);var O=s(A,2);Mt(O),e(He),e(pe);var oe=s(pe,2),L=t(oe),B=t(L,!0);e(L);var G=s(L,2);ha(G),e(oe);var $e=s(oe,2),de=t($e);Mt(de);var be=s(de,2),Z=t(be);pa(Z,{size:14});var Ne=s(Z);e(be),e($e),e(Y),_((xe,Le,dt,vt)=>{i(F,xe),i(B,Le),le(G,"placeholder",dt),i(Ne,` ${vt??""}`)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.global_enemy")]),ut(O,()=>a(o).name,xe=>a(o).name=xe),ut(G,()=>a(o).description,xe=>a(o).description=xe),vs(de,()=>a(o).global,xe=>a(o).global=xe),d(N,Y)},Ee=N=>{var Y=It(),pe=Fe(Y);{var ue=Ke=>{var tt=jn(),zt=t(tt),He=t(zt),A=t(He),F=t(A,!0);e(A);var O=s(A,2);{let pt=V(()=>a(o).difficulty??1);Os(O,{get value(){return a(pt)},onUpdate:Tt=>a(o).difficulty=Tt,steps:[1,2,4,8,16,32,64,128]})}e(He);var oe=s(He,2),L=t(oe),B=t(L,!0);e(L);var G=s(L,2);{let pt=V(()=>a(o).size||1);gs(G,{get value(){return a(pt)},onUpdate:Tt=>a(o).size=Tt})}e(oe),e(zt);var $e=s(zt,2),de=t($e),be=t(de),Z=t(be,!0);e(be);var Ne=s(be);Mt(Ne),e(de);var xe=s(de,2),Le=t(xe),dt=t(Le,!0);e(Le);var vt=s(Le);Mt(vt),e(xe),e($e);var ct=s($e,2),Ft=t(ct),Dt=t(Ft),Vt=t(Dt,!0);e(Dt);var At=s(Dt);Mt(At),e(Ft);var m=s(Ft,2),b=t(m),C=t(b,!0);e(b);var w=s(b);Mt(w),e(m),e(ct);var ke=s(ct,2),qe=t(ke),at=t(qe,!0);e(qe);var et=s(qe,2);Qe(et,20,()=>["str","agi","int","wil"],Ot,(pt,Tt)=>{var ia=Cn(),l=t(ia),v=t(l,!0);e(l);var u=s(l,2);Mt(u);var p=s(u,2),q=t(p);e(p),e(ia),_(f=>{le(l,"for",`attr-${Tt??""}`),i(v,f),le(u,"id",`attr-${Tt??""}`),Ve(p,1,`text-xs font-bold ${a(o).stats[Tt]-10>=0?"text-green-500":"text-red-500"}`),i(q,`${a(o).stats[Tt]-10>=0?"+":""}${a(o).stats[Tt]-10}`)},[()=>n()("sofww.attributes."+Tt).substring(0,3)]),ut(u,()=>a(o).stats[Tt],f=>a(o).stats[Tt]=f),d(pt,ia)}),e(et),e(ke);var Ct=s(ke,2),jt=t(Ct),Ht=t(jt),Rt=t(Ht,!0);e(Ht);var Bt=s(Ht);Mt(Bt),e(jt);var Jt=s(jt,2),Xt=t(Jt),ta=t(Xt,!0);e(Xt);var Gt=s(Xt);Mt(Gt),e(Jt);var Wt=s(Jt,2),Qt=t(Wt),ca=t(Qt,!0);e(Qt);var Zt=s(Qt);Mt(Zt),e(Wt),e(Ct),e(tt),_((pt,Tt,ia,l,v,u,p,q,f,y,g,re,H)=>{i(F,pt),i(B,Tt),i(Z,ia),i(dt,l),i(Vt,v),i(C,u),i(at,p),i(Rt,q),le(Bt,"placeholder",f),i(ta,y),le(Gt,"placeholder",g),i(ca,re),le(Zt,"placeholder",H)},[()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.damage"),()=>n()("session.enemy_modal.speed"),()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder"),()=>n()("session.enemy_modal.languages"),()=>n()("session.enemy_modal.languages_placeholder"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder")]),ut(Ne,()=>a(o).defense,pt=>a(o).defense=pt),ut(vt,()=>a(o).health,pt=>a(o).health=pt),ut(At,()=>a(o).damage,pt=>a(o).damage=pt),ut(w,()=>a(o).speed,pt=>a(o).speed=pt),ut(Bt,()=>a(o).senses,pt=>a(o).senses=pt),ut(Gt,()=>a(o).languages,pt=>a(o).languages=pt),ut(Zt,()=>a(o).immune,pt=>a(o).immune=pt),d(Ke,tt)},Re=Ke=>{var tt=It(),zt=Fe(tt);{var He=F=>{var O=En();Qe(O,20,()=>[{key:"traits",label:"traits",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",label:"actions",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",label:"reactions",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",label:"end_of_round",color:"text-yellow-400",border:"border-yellow-500/30"}],Ot,(oe,L)=>{var B=On(),G=t(B),$e=t(G),de=t($e,!0);e($e),e(G);var be=s(G,2),Z=t(be);Qe(Z,17,()=>a(o)[L.key],Ot,(vt,ct,Ft)=>{var Dt=Mn(),Vt=t(Dt),At=t(Vt);Mt(At);var m=s(At,2);ha(m),e(Vt);var b=s(Vt,2);b.__click=()=>Q(L.key,Ft);var C=t(b);ua(C,{size:16}),e(b),e(Dt),_((w,ke)=>{le(At,"placeholder",w),le(m,"placeholder",ke)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),ut(At,()=>a(ct).name,w=>a(ct).name=w),ut(m,()=>a(ct).desc,w=>a(ct).desc=w),d(vt,Dt)});var Ne=s(Z,2);Ne.__click=()=>j(L.key);var xe=t(Ne),Le=t(xe);ra(Le,{size:16}),e(xe);var dt=s(xe);e(Ne),e(be),e(B),_((vt,ct)=>{Ve(B,1,`p-4 bg-slate-900 rounded border ${L.border??""}`),Ve($e,1,`font-bold text-sm uppercase ${L.color??""}`),i(de,vt),i(dt,` ${ct??""}`)},[()=>n()("session.enemy_modal."+L.label),()=>n()("common.buttons.add")]),d(oe,B)}),e(O),d(F,O)},A=F=>{var O=It(),oe=Fe(O);{var L=B=>{var G=Sn(),$e=t(G);x($e),e(G),d(B,G)};h(oe,B=>{a(S)==="preview"&&B(L)},!0)}d(F,O)};h(zt,F=>{a(S)==="abilities"?F(He):F(A,!1)},!0)}d(Ke,tt)};h(pe,Ke=>{a(S)==="stats"?Ke(ue):Ke(Re,!1)},!0)}d(N,Y)};h(We,N=>{a(S)==="general"?N(Ze):N(Ee,!1)})}e(yt);var De=s(yt,2),Xe=t(De);Xe.__click=()=>r.onSave(a(o));var Ye=t(Xe);as(Ye,{size:18});var ft=s(Ye);e(Xe),e(De),e(ye);var W=s(ye,2),he=t(W),Pe=t(he),ce=t(Pe);Ha(ce,{size:14});var rt=s(ce);e(Pe),e(he);var Ge=s(he,2),lt=t(Ge);x(lt),e(Ge),e(W),e(je),e(_e);var k=s(_e,2);k.__change=fe,Cs(k,N=>z(Ie,N),()=>a(Ie));var M=s(k,2);fs(M,{get isOpen(){return a(T)},get imageUrl(){return a(te)},onClose:()=>z(T,!1),onCrop:I}),_((N,Y,pe,ue,Re,Ke,tt,zt)=>{le(_e,"aria-label",N),i(ve,Y),Ve(nt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(ot,pe),Ve(xt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(st,ue),Ve(St,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(ht,Re),Ve(mt,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Pt,Ke),i(ft,` ${tt??""}`),i(rt,` ${zt??""}`)},[()=>n()("session.enemy_modal.close"),()=>n()("session.enemy_modal.title"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_stats"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("session.enemy_modal.preview"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview")]),Ta(3,je,()=>Ua,()=>({y:20,duration:300})),Ta(3,_e,()=>Ua,()=>({duration:200,opacity:1})),d(ae,Ce)};h(ze,ae=>{E()&&ae(kt)})}d(J,Se),la(),D()}ba(["click","change"]);var Rn=c('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),$n=c('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),Nn=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),An=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function Tn(J,r){oa(r,!0);const n=()=>Ut(aa,"$t",D),se=()=>Ut(es,"$liveEnemies",D),[D,x]=da();let E=sa(r,"isOpen",3,!1),$=sa(r,"initialData",3,"{}"),o=bt(ga({name:"",enemies:[]}));Fa(()=>{if(E()&&$())try{const j=JSON.parse($());z(o,{name:j.name||"",enemies:j.enemies||[]},!0)}catch{z(o,{name:"",enemies:[]},!0)}});function S(j){a(o).enemies.find(U=>U.enemyId===j)?a(o).enemies=a(o).enemies.map(U=>U.enemyId===j?{...U,count:U.count+1}:U):a(o).enemies=[...a(o).enemies,{enemyId:j,count:1}]}function T(j){a(o).enemies=a(o).enemies.filter((Q,U)=>U!==j)}function te(j,Q){const U=Math.max(1,parseInt(Q)||1);a(o).enemies[j].count=U}function Ie(j){}var fe=It(),I=Fe(fe);{var R=j=>{var Q=An();Q.__click=Ie;var U=t(Q),Se=t(U),ze=t(Se),kt=t(ze,!0);e(ze);var ae=s(ze,2);ae.__click=function(...Ee){r.onClose?.apply(this,Ee)};var Ce=t(ae);ya(Ce,{size:20}),e(ae),e(Se);var _e=s(Se,2),je=t(_e),ye=t(je),Me=t(ye,!0);e(ye);var Be=s(ye,2);Mt(Be),e(je),e(_e);var ge=s(_e,2),P=t(ge),ne=t(P),ve=t(ne,!0);e(ne);var Oe=s(ne,2),we=t(Oe);Qe(we,17,()=>a(o).enemies,Ot,(Ee,De,Xe)=>{const Ye=V(()=>se().find(N=>N.id===a(De).enemyId));var ft=Rn(),W=t(ft),he=t(W),Pe=t(he,!0);e(he);var ce=s(he,2),rt=t(ce);e(ce),e(W);var Ge=s(W,2),lt=t(Ge);Mt(lt),lt.__input=N=>te(Xe,N.target.value);var k=s(lt,2);k.__click=()=>T(Xe);var M=t(k);ua(M,{size:16}),e(k),e(Ge),e(ft),_(N=>{i(Pe,N),i(rt,`Dif ${(a(Ye)?a(Ye).difficulty:"?")??""}`),Ya(lt,a(De).count)},[()=>a(Ye)?a(Ye).name:n()("session.encounter_modal.unknown")]),d(Ee,ft)});var _t=s(we,2);{var nt=Ee=>{var De=$n(),Xe=t(De,!0);e(De),_(Ye=>i(Xe,Ye),[()=>n()("session.encounter_modal.none_added")]),d(Ee,De)};h(_t,Ee=>{a(o).enemies.length===0&&Ee(nt)})}e(Oe),e(P);var ot=s(P,2),xt=t(ot),st=t(xt,!0);e(xt);var St=s(xt,2);Qe(St,5,se,Ee=>Ee.id,(Ee,De)=>{var Xe=Nn(),Ye=t(Xe),ft=t(Ye),W=t(ft,!0);e(ft);var he=s(ft,2),Pe=t(he);e(he),e(Ye);var ce=s(Ye,2);ce.__click=()=>S(a(De).id);var rt=t(ce);ra(rt,{size:16}),e(ce),e(Xe),_(()=>{i(W,a(De).name),i(Pe,`Dif ${a(De).difficulty??""}`)}),d(Ee,Xe)}),e(St),e(ot),e(ge);var ht=s(ge,2),mt=t(ht);mt.__click=function(...Ee){r.onClose?.apply(this,Ee)};var Pt=t(mt,!0);e(mt);var yt=s(mt,2);yt.__click=()=>r.onSave(a(o));var We=t(yt);as(We,{size:18});var Ze=s(We);e(yt),e(ht),e(U),e(Q),_((Ee,De,Xe,Ye,ft,W,he,Pe)=>{le(Q,"aria-label",Ee),i(kt,De),i(Me,Xe),le(Be,"placeholder",Ye),i(ve,ft),i(st,W),i(Pt,he),i(Ze,` ${Pe??""}`)},[()=>n()("session.encounter_modal.close"),()=>n()("session.encounter_modal.title"),()=>n()("session.encounter_modal.name"),()=>n()("session.encounter_modal.name_placeholder"),()=>n()("session.encounter_modal.enemies_in_encounter"),()=>n()("session.encounter_modal.add_enemies"),()=>n()("common.buttons.cancel"),()=>n()("session.encounter_modal.save_encounter")]),ut(Be,()=>a(o).name,Ee=>a(o).name=Ee),d(j,Q)};h(I,j=>{E()&&j(R)})}d(J,fe),la(),x()}ba(["click","input"]);var Un=c('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),Pn=c('<div class="text-[10px] text-slate-600 italic"> </div>'),Fn=c('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="flex items-center gap-2 mb-2"><div class="font-bold text-white text-base group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <!></div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),Hn=c('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),Ln=c('<div class="mb-4 flex-1"><p> </p> <!></div>'),qn=c('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),Bn=c('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><div class="flex items-center gap-2"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <!></div> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),Wn=c('<div class="text-center text-slate-500 italic col-span-3"> </div>'),Gn=c('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function Jn(J,r){oa(r,!0);const n=()=>Ut(es,"$liveEnemies",x),se=()=>Ut(cs,"$liveEncounters",x),D=()=>Ut(aa,"$t",x),[x,E]=da();let $=bt(!1),o=bt(null),S=bt("{}"),T=bt(!1),te=bt(null),Ie=bt("{}"),fe=bt(ga({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function I(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function R(k=null){z(o,k?k.id:null,!0),k?z(S,JSON.stringify(k),!0):a(Me)==="sofdl"?z(S,"{}"):z(S,JSON.stringify(I()),!0),z($,!0)}let j=ga(new Set);function Q(k){j.has(k)?j.delete(k):j.add(k)}function U(k){const M=a(o)||Ia(),N=ea.get(r.campId);ns.set(M,{...k,id:M,campaignId:r.campId,system:N?.system||"sofww"}),z($,!1)}function Se(k){const M=n().find(N=>N.id===k);z(fe,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${M?.name||"este inimigo"}"?`,onConfirm:()=>{ns.delete(k),a(fe).isOpen=!1}},!0)}function ze(k=null){z(te,k?k.id:null,!0),z(Ie,JSON.stringify(k||{name:"",enemies:[]}),!0),z(T,!0)}function kt(k){const M=a(te)||Ia();Qa.set(M,{...k,id:M,system:a(Me)}),z(T,!1)}function ae(k){const M=se().find(N=>N.id===k);z(fe,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${M?.name||"este encontro"}"?`,onConfirm:()=>{Qa.delete(k),a(fe).isOpen=!1}},!0)}function Ce(k){const M=ea.get(r.campId);if(!M)return;const N=M.activeEnemies||[];let Y=[];k.enemies.forEach(pe=>{const ue=n().find(Re=>Re.id===pe.enemyId);if(ue)for(let Re=0;Re<pe.count;Re++)Y.push({...ue,instanceId:Ia(),damage:0,currentHealth:ue.health,afflictions:[],acted:!1,initiative:!1})}),ea.set(r.campId,{...M,activeEnemies:[...N,...Y]})}function _e(k,M){k.dataTransfer.setData("text/plain",M.id),k.dataTransfer.effectAllowed="copy"}function je(k){return k.preventDefault(),!1}function ye(k,M){k.preventDefault();const N=k.dataTransfer.getData("text/plain");if(!N)return;const Y=M.enemies||[],pe=Y.find(Re=>Re.enemyId===N);let ue;pe?ue=Y.map(Re=>Re.enemyId===N?{...Re,count:Re.count+1}:Re):ue=[...Y,{enemyId:N,count:1}],Qa.set(M.id,{...M,enemies:ue})}let Me=V(()=>ea.get(r.campId)?.system||"sofww"),Be=V(()=>n().filter(k=>{const N=(k.system||"sofww")===a(Me),Y=k.global===!0,pe=k.campaignId===r.campId;return N&&(Y||pe)})),ge=V(()=>se().filter(k=>{const N=(k.system||"sofww")===a(Me),Y=k.global===!0,pe=k.campaignId===r.campId;return N&&(Y||pe)}));var P=Gn(),ne=t(P),ve=t(ne),Oe=t(ve),we=t(Oe);Ka(we,{size:16});var _t=s(we);e(Oe),e(ve);var nt=s(ve,2),ot=t(nt);ot.__click=()=>ze();var xt=t(ot);ra(xt,{size:28,class:"group-hover:scale-110 transition-transform"});var st=s(xt,2),St=t(st,!0);e(st),e(ot);var ht=s(ot,2);Qe(ht,17,()=>a(ge),k=>k.id,(k,M)=>{var N=Fn(),Y=t(N),pe=t(Y),ue=t(pe),Re=t(ue,!0);e(ue);var Ke=s(ue,2);{var tt=Z=>{pa(Z,{size:12,class:"text-indigo-400"})};h(Ke,Z=>{a(M).global&&Z(tt)})}e(pe);var zt=s(pe,2),He=t(zt);Qe(He,17,()=>a(M).enemies||[],Ot,(Z,Ne)=>{const xe=V(()=>n().find(Dt=>Dt.id===a(Ne).enemyId));var Le=Un(),dt=t(Le),vt=t(dt);e(dt);var ct=s(dt,2),Ft=t(ct,!0);e(ct),e(Le),_(()=>{i(vt,`${a(Ne).count??""}x`),i(Ft,a(xe)?a(xe).name:"...")}),d(Z,Le)});var A=s(He,2);{var F=Z=>{var Ne=Pn(),xe=t(Ne,!0);e(Ne),_(Le=>i(xe,Le),[()=>D()("session.bestiary.empty_encounter")]),d(Z,Ne)};h(A,Z=>{a(M).enemies?.length||Z(F)})}e(zt),e(Y);var O=s(Y,2),oe=t(O);oe.__click=()=>Ce(a(M));var L=t(oe);Xa(L,{size:12,fill:"currentColor"});var B=s(L);e(oe);var G=s(oe,2);G.__click=()=>ze(a(M));var $e=t(G);er($e,{size:14}),e(G);var de=s(G,2);de.__click=()=>ae(a(M).id);var be=t(de);ua(be,{size:14}),e(de),e(O),e(N),_(Z=>{le(N,"aria-label",`Encontro ${a(M).name??""}`),i(Re,a(M).name),i(B,` ${Z??""}`)},[()=>D()("session.bestiary.start")]),ja("dragover",N,je),ja("drop",N,Z=>ye(Z,a(M))),d(k,N)}),e(nt),e(ne);var mt=s(ne,2),Pt=t(mt),yt=t(Pt);Ca(yt,{size:16});var We=s(yt);e(Pt),e(mt);var Ze=s(mt,2),Ee=t(Ze);Ee.__click=()=>R();var De=t(Ee);ra(De,{size:32,class:"group-hover:scale-110 transition-transform"});var Xe=s(De,2),Ye=t(Xe,!0);e(Xe),e(Ee);var ft=s(Ee,2);Qe(ft,17,()=>a(Be),k=>k.id,(k,M)=>{var N=Bn(),Y=t(N),pe=t(Y),ue=t(pe),Re=t(ue,!0);e(ue);var Ke=s(ue,2);{var tt=de=>{pa(de,{size:14,class:"text-indigo-400"})};h(Ke,de=>{a(M).global&&de(tt)})}e(pe);var zt=s(pe,2),He=t(zt);e(zt),e(Y);var A=s(Y,2);{var F=de=>{var be=Ln(),Z=t(be),Ne=t(Z,!0);e(Z);var xe=s(Z,2);{var Le=dt=>{var vt=Hn();vt.__click=()=>Q(a(M).id);var ct=t(vt,!0);e(vt),_(Ft=>i(ct,Ft),[()=>j.has(a(M).id)?D()("session.bestiary.see_less"):D()("session.bestiary.see_more")]),d(dt,vt)};h(xe,dt=>{a(M).description.length>120&&dt(Le)})}e(be),_(dt=>{Ve(Z,1,`text-xs text-slate-400 leading-relaxed ${dt??""}`),i(Ne,a(M).description)},[()=>j.has(a(M).id)?"":"line-clamp-3"]),d(de,be)},O=de=>{var be=qn(),Z=t(be,!0);e(be),_(Ne=>i(Z,Ne),[()=>D()("session.bestiary.no_description")]),d(de,be)};h(A,de=>{a(M).description?de(F):de(O,!1)})}var oe=s(A,2),L=t(oe);L.__click=()=>R(a(M));var B=t(L,!0);e(L);var G=s(L,2);G.__click=()=>Se(a(M).id);var $e=t(G);ua($e,{size:14}),e(G),e(oe),e(N),_((de,be)=>{i(Re,a(M).name),i(He,`${de??""} ${a(M).difficulty??""}`),i(B,be)},[()=>D()("session.bestiary.level"),()=>D()("common.buttons.edit")]),ja("dragstart",N,de=>_e(de,a(M))),d(k,N)});var W=s(ft,2);{var he=k=>{var M=Wn(),N=t(M,!0);e(M),_(Y=>i(N,Y),[()=>D()("session.bestiary.no_enemies")]),d(k,M)};h(W,k=>{a(Be).length===0&&k(he)})}e(Ze);var Pe=s(Ze,2);{var ce=k=>{dn(k,{get isOpen(){return a($)},get initialData(){return a(S)},onClose:()=>z($,!1),onSave:U})},rt=k=>{Dn(k,{get isOpen(){return a($)},get initialData(){return a(S)},onClose:()=>z($,!1),onSave:U})};h(Pe,k=>{a(Me)==="sofdl"?k(ce):k(rt,!1)})}var Ge=s(Pe,2);Tn(Ge,{get isOpen(){return a(T)},get initialData(){return a(Ie)},onClose:()=>z(T,!1),onSave:kt});var lt=s(Ge,2);zs(lt,{get isOpen(){return a(fe).isOpen},get title(){return a(fe).title},get message(){return a(fe).message},get onConfirm(){return a(fe).onConfirm},onCancel:()=>a(fe).isOpen=!1}),e(P),_((k,M,N,Y)=>{i(_t,` ${k??""}`),i(St,M),i(We,` ${N??""}`),i(Ye,Y)},[()=>D()("session.bestiary.encounters_title"),()=>D()("session.bestiary.new_encounter"),()=>D()("session.bestiary.title"),()=>D()("session.bestiary.new_enemy")]),d(J,P),la(),E()}ba(["click"]);var Vn=c('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),Qn=c('<div class="flex items-center gap-1 text-emerald-400"><!> <span class="text-xs font-bold hidden sm:block"> </span></div> <!>',1),Yn=c('<div class="flex items-center gap-1 text-slate-500"><!> <span class="text-xs hidden sm:block"> </span></div>'),Zn=c('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),Xn=c('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group"><!> <!></button> <div class="flex flex-col"><h1 class="text-base sm:text-lg font-black text-white leading-tight truncate max-w-[140px] sm:max-w-none"> </h1> <span class="text-xs text-indigo-400 font-mono font-black uppercase tracking-wider"> </span></div></div> <div class="hidden md:flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block"> </span></button> <button><!> <span class="hidden min-[400px]:block"> </span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 sm:p-2.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all"><!></button> <button class="p-2 sm:p-2.5 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative"><!> <!></button></div></div></div></header>');function Kn(J,r){oa(r,!0);const n=()=>Ut(aa,"$t",E),se=()=>Ut($s,"$syncState",E),D=()=>Ut(Ma,"$isHistoryOpen",E),x=()=>Ut(Ns,"$hasUnreadRolls",E),[E,$]=da();let o=sa(r,"campaignName",3,""),S=sa(r,"gmName",3,"Mestre"),T=sa(r,"activeSubTab",3,"session"),te=sa(r,"onTabChange",3,()=>{}),Ie=sa(r,"onOpenSettings",3,()=>{});var fe=Xn(),I=t(fe),R=t(I),j=t(R),Q=t(j);Q.__click=()=>lr(_s("/"));var U=t(Q);La(U,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var Se=s(U,2);Js(Se,{size:18,class:"hidden sm:block opacity-50"}),e(Q);var ze=s(Q,2),kt=t(ze),ae=t(kt,!0);e(kt);var Ce=s(kt,2),_e=t(Ce,!0);e(Ce),e(ze),e(j);var je=s(j,2),ye=t(je);ye.__click=()=>te()("session");var Me=t(ye);{let We=V(()=>T()==="session"?"opacity-100":"opacity-50");ys(Me,{size:14,get class(){return a(We)}})}var Be=s(Me,2),ge=t(Be,!0);e(Be),e(ye);var P=s(ye,2);P.__click=()=>te()("bestiary");var ne=t(P);{let We=V(()=>T()==="bestiary"?"opacity-100":"opacity-50");js(ne,{size:14,get class(){return a(We)}})}var ve=s(ne,2),Oe=t(ve,!0);e(ve),e(P),e(je);var we=s(je,2),_t=t(we),nt=t(_t);{var ot=We=>{var Ze=Qn(),Ee=Fe(Ze),De=t(Ee);bs(De,{size:16});var Xe=s(De,2),Ye=t(Xe,!0);e(Xe),e(Ee);var ft=s(Ee,2);{var W=he=>{var Pe=Vn(),ce=t(Pe);us(ce,{size:14});var rt=s(ce,2),Ge=t(rt,!0);e(rt),e(Pe),_(lt=>{le(Pe,"title",lt),i(Ge,se().peers.length)},[()=>n()("common.status.peers",{values:{count:se().peers.length}})]),d(he,Pe)};h(ft,he=>{se().peers.length>0&&he(W)})}_((he,Pe)=>{le(Ee,"title",he),i(Ye,Pe)},[()=>n()("common.status.connected"),()=>n()("common.status.connected")]),d(We,Ze)},xt=We=>{var Ze=Yn(),Ee=t(Ze);dr(Ee,{size:16});var De=s(Ee,2),Xe=t(De,!0);e(De),e(Ze),_((Ye,ft)=>{le(Ze,"title",Ye),i(Xe,ft)},[()=>n()("common.status.offline"),()=>n()("common.status.offline")]),d(We,Ze)};h(nt,We=>{se().isConnected?We(ot):We(xt,!1)})}e(_t);var st=s(_t,2);st.__click=function(...We){Ie()?.apply(this,We)};var St=t(st);nr(St,{size:20}),e(st);var ht=s(st,2);ht.__click=()=>Ma.update(We=>!We);var mt=t(ht);Vs(mt,{size:20});var Pt=s(mt,2);{var yt=We=>{var Ze=Zn();d(We,Ze)};h(Pt,We=>{x()&&We(yt)})}e(ht),e(we),e(R),e(I),e(fe),_((We,Ze,Ee,De,Xe,Ye,ft,W)=>{le(Q,"aria-label",We),le(Q,"title",Ze),i(ae,o()),i(_e,S()),Ve(ye,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${T()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),le(ye,"aria-pressed",T()==="session"),i(ge,Ee),Ve(P,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${T()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),le(P,"aria-pressed",T()==="bestiary"),i(Oe,De),le(st,"aria-label",Xe),le(st,"title",Ye),le(ht,"aria-label",ft),le(ht,"title",W),le(ht,"aria-pressed",D())},[()=>n()("character.header.back_dashboard"),()=>n()("character.header.back_dashboard"),()=>n()("common.labels.session"),()=>n()("common.labels.bestiary"),()=>n()("common.buttons.settings"),()=>n()("common.buttons.settings"),()=>n()("character.header.history"),()=>n()("character.header.history")]),d(J,fe),la(),$()}ba(["click"]);var eo=c('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),to=c('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),ao=c('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),so=c('<button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d3</span> <!></button>'),ro=c('<button class="bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-indigo-500/20"><span class="text-[10px] opacity-70">d20</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d6</span> <!></button> <!> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">2d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">3d6</span> <!></button> <div class="w-px h-8 bg-white/10 mx-1"></div> <button class="bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><!></button>',1),io=c('<button class="px-3 py-2 text-left hover:bg-indigo-600/50 rounded-lg text-xs font-mono text-slate-300 transition-colors w-full"> </button>'),no=c('<div class="absolute bottom-full left-0 right-0 mb-2 bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-xl p-1 shadow-xl max-h-48 overflow-y-auto z-50 flex flex-col gap-0.5 min-w-[12rem]"></div>'),oo=c('<button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button> <div class="relative"><input type="text" class="bg-slate-800 border border-slate-700 rounded-lg pl-3 pr-2 py-2 text-sm text-white focus:outline-none focus:border-indigo-500 w-48 font-mono placeholder:text-slate-600"/> <!></div> <button class="bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white w-10 h-10 rounded-lg flex items-center justify-center transition-colors shadow-lg"><!></button>',1),lo=c('<div class="w-px h-8 bg-white/10 mx-1"></div> <button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button>',1),vo=c('<div class="fixed bottom-24 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0 z-[60] flex flex-col items-center gap-2 max-w-[95vw]"><div class="bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center gap-2 shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 duration-200 relative overflow-visible"><!> <!></div></div>  <div class="fixed inset-0 bg-black/40 z-[55]"></div>',1),co=c('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!> <!> <div class="hidden md:block fixed bottom-8 left-8 z-[60]"><button class="w-16 h-16 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-[0_0_20px_rgba(79,70,229,0.4)] flex items-center justify-center transition-all active:scale-90 border-2 border-white/10 group"><!></button></div> <nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-6 pt-2 pointer-events-none"><div class="max-w-md mx-auto relative h-16 pointer-events-auto"><div class="absolute inset-0 bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"></div></div> <div class="relative h-full flex items-center justify-around px-2"><button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none"> </span></button> <div class="relative w-16 h-16 -mt-10 flex items-center justify-center"><div class="absolute inset-0 bg-indigo-600/20 rounded-full blur-xl animate-pulse"></div> <button class="relative w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(79,70,229,0.5)] border-4 border-slate-900 transition-all active:scale-90 hover:bg-indigo-500 z-10"><!></button></div> <button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none"> </span></button></div></div></nav> <!> <div class="hidden md:block fixed bottom-8 right-8 z-[60]"><button class="w-14 h-14 bg-slate-800 hover:bg-slate-700 text-indigo-400 hover:text-white rounded-full shadow-lg flex items-center justify-center transition-all active:scale-90 border border-white/10"><!></button></div></div>');function Po(J,r){oa(r,!0);const n=()=>Ut(Us,"$page",E),se=()=>Ut(Fs,"$liveCampaigns",E),D=()=>Ut(aa,"$t",E),x=()=>Ut(Ma,"$isHistoryOpen",E),[E,$]=da();let o=bt("session"),S=bt(!1),T=V(()=>n().params.id),te=V(()=>se().find(W=>W.id===a(T))),Ie=V(()=>!!a(te));function fe(W){if(!a(T)||!a(te))return;const he={...a(te),...W};ea.set(a(T),he),Za(a(T),{name:he.name,gmName:he.gmName}),z(S,!1)}let I=bt(!1),R=bt(ga({isOpen:!1,sides:20,count:1,modifier:0,isCustom:!1,customFormula:""})),j=bt(!1),Q=bt("");const U=["1d4","1d6","1d8","1d10","1d12","1d20","1d100","2d6","3d6","1d3","1d6 + 1d3"];let Se=V(()=>U.filter(W=>W.startsWith(a(Q))&&W!==a(Q)));function ze(W,he=1){z(R,{isOpen:!0,sides:W,count:he,modifier:0,isCustom:!1,customFormula:""},!0)}function kt(){z(j,!a(j)),a(j)||z(Q,"")}function ae(W){W&&(z(R,{isOpen:!0,sides:0,count:0,modifier:0,isCustom:!0,customFormula:W},!0),z(I,!1),z(j,!1),z(Q,""))}function Ce(W,he=[],Pe){if(!a(te))return;let ce,rt="";a(R).isCustom?(ce=Vr(a(R).customFormula),ce.dice&&(rt=ce.dice.map(Y=>`${Y.count}d${Y.sides}@${Y.results.join(",")}`).join("+"))):ce=Jr(a(R).sides,a(R).count,W);let Ge="";(a(R).count>1||a(R).isCustom)&&(Ge+=`Dados: [${ce.results.join(", ")}] `),ce.bonusRolls?.length>0&&(Ge+=`Bonus Rolls: [${ce.bonusRolls.join(", ")}] -> ${Math.abs(ce.modifierTotal)}`);const lt=a(te).gmName||Aa(aa)("common.labels.master"),k=()=>{As.addToHistory({source:"GM",charName:lt,name:a(R).isCustom?ce.formula:`${a(R).count}d${a(R).sides} ${W?W>0?`+${W}`:W:""}`,description:Ge.trim()||null,total:ce.total,formula:ce.formula,crit:ce.crit}),Aa(Ts).autoOpenHistory?Ma.set(!0):Es(async()=>{const{hasUnreadRolls:Y}=await import("../chunks/CBXs46KE.js").then(pe=>pe._);return{hasUnreadRolls:Y}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url).then(({hasUnreadRolls:Y})=>{Y.set(!0)})};Pe?.suppressHistory||(k(),a(R).isOpen=!1);const M=a(R).sides===20&&a(R).count===1&&!a(R).isCustom;return{d20:M?ce.results[0]:void 0,boonBaneDice:M?ce.bonusRolls:[],damageDice:M?[]:ce.results,total:ce.total,formula:ce.formula,commit:k,notation:rt}}var _e=co(),je=t(_e);{var ye=W=>{var he=eo(),Pe=Fe(he);Kn(Pe,{get campaignName(){return a(te).name},get gmName(){return a(te).gmName},get activeSubTab(){return a(o)},onTabChange:M=>z(o,M,!0),onOpenSettings:()=>z(S,!0)});var ce=s(Pe,2);{let M=V(()=>JSON.stringify(a(te)));or(ce,{get isOpen(){return a(S)},get initialData(){return a(M)},onClose:()=>z(S,!1),onSave:fe})}var rt=s(ce,2),Ge=t(rt);{var lt=M=>{Ni(M,{get campaign(){return a(te)}})},k=M=>{var N=It(),Y=Fe(N);{var pe=ue=>{Jn(ue,{get campId(){return a(T)}})};h(Y,ue=>{a(o)==="bestiary"&&ue(pe)},!0)}d(M,N)};h(Ge,M=>{a(o)==="session"?M(lt):M(k,!1)})}e(rt),d(W,he)},Me=W=>{var he=It(),Pe=Fe(he);{var ce=Ge=>{var lt=to(),k=s(t(lt),2),M=t(k,!0);e(k);var N=s(k,2),Y=t(N,!0);e(N);var pe=s(N,2);pe.__click=()=>window.history.back();var ue=s(t(pe));e(pe),e(lt),_((Re,Ke,tt)=>{i(M,Re),i(Y,Ke),i(ue,` ${tt??""}`)},[()=>D()("campaign.not_found.title"),()=>D()("campaign.not_found.message"),()=>D()("common.buttons.back")]),d(Ge,lt)},rt=Ge=>{var lt=ao();d(Ge,lt)};h(Pe,Ge=>{a(Ie)&&!a(te)?Ge(ce):Ge(rt,!1)},!0)}d(W,he)};h(je,W=>{a(Ie)&&a(te)?W(ye):W(Me,!1)})}var Be=s(je,2);ms(Be,{get isOpen(){return x()},onClose:()=>Ma.set(!1)});var ge=s(Be,2);{var P=W=>{var he=vo(),Pe=Fe(he),ce=t(Pe),rt=t(ce);{var Ge=Y=>{var pe=ro(),ue=Fe(pe);ue.__click=()=>{ze(20),z(I,!1)};var Re=s(t(ue),2);za(Re,{size:16}),e(ue);var Ke=s(ue,2);Ke.__click=()=>{ze(6),z(I,!1)};var tt=s(t(Ke),2);za(tt,{size:16}),e(Ke);var zt=s(Ke,2);{var He=G=>{var $e=so();$e.__click=()=>{ze(3),z(I,!1)};var de=s(t($e),2);za(de,{size:16}),e($e),d(G,$e)};h(zt,G=>{a(te)?.system==="sofdl"&&G(He)})}var A=s(zt,2);A.__click=()=>{ze(6,2),z(I,!1)};var F=s(t(A),2);za(F,{size:16}),e(A);var O=s(A,2);O.__click=()=>{ze(6,3),z(I,!1)};var oe=s(t(O),2);za(oe,{size:16}),e(O);var L=s(O,4);L.__click=kt;var B=t(L);Ys(B,{size:20}),e(L),_(G=>le(L,"title",G),[()=>D()("session.quick.custom_roll")]),d(Y,pe)},lt=Y=>{var pe=oo(),ue=Fe(pe);ue.__click=kt;var Re=t(ue);tr(Re,{size:20}),e(ue);var Ke=s(ue,2),tt=t(Ke);Mt(tt),tt.__keydown=O=>O.key==="Enter"&&ae(a(Q)),Ss(tt,!0);var zt=s(tt,2);{var He=O=>{var oe=no();Qe(oe,21,()=>a(Se),Ot,(L,B)=>{var G=io();G.__click=()=>ae(a(B));var $e=t(G,!0);e(G),_(()=>i($e,a(B))),d(L,G)}),e(oe),d(O,oe)};h(zt,O=>{a(Se).length>0&&O(He)})}e(Ke);var A=s(Ke,2);A.__click=()=>ae(a(Q));var F=t(A);mr(F,{size:18}),e(A),_(O=>{le(tt,"placeholder",O),A.disabled=!a(Q)},[()=>D()("session.quick.custom_roll_placeholder")]),ut(tt,()=>a(Q),O=>z(Q,O)),d(Y,pe)};h(rt,Y=>{a(j)?Y(lt,!1):Y(Ge)})}var k=s(rt,2);{var M=Y=>{var pe=lo(),ue=s(Fe(pe),2);ue.__click=()=>z(I,!1);var Re=t(ue);ya(Re,{size:20}),e(ue),d(Y,pe)};h(k,Y=>{a(j)||Y(M)})}e(ce),e(Pe);var N=s(Pe,2);N.__click=()=>{z(I,!1),z(j,!1)},d(W,he)};h(ge,W=>{a(I)&&W(P)})}var ne=s(ge,2),ve=t(ne);ve.__click=()=>z(I,!a(I));var Oe=t(ve);za(Oe,{size:32,class:"group-hover:rotate-12 transition-transform"}),e(ve),e(ne);var we=s(ne,2),_t=t(we),nt=s(t(_t),2),ot=t(nt);ot.__click=()=>{z(o,"session"),z(I,!1)};var xt=t(ot);{let W=V(()=>a(o)==="session"?"animate-in zoom-in-75 duration-300":"");ys(xt,{size:20,get class(){return a(W)}})}var st=s(xt,2),St=t(st,!0);e(st),e(ot);var ht=s(ot,2),mt=s(t(ht),2);mt.__click=()=>z(I,!a(I));var Pt=t(mt);{let W=V(()=>a(I)?"rotate-90":"rotate-0");za(Pt,{size:28,get class(){return`text-white ${a(W)??""} transition-transform duration-300`}})}e(mt),e(ht);var yt=s(ht,2);yt.__click=()=>{z(o,"bestiary"),z(I,!1)};var We=t(yt);{let W=V(()=>a(o)==="bestiary"?"animate-in zoom-in-75 duration-300":"");js(We,{size:20,get class(){return a(W)}})}var Ze=s(We,2),Ee=t(Ze,!0);e(Ze),e(yt),e(nt),e(_t),e(we);var De=s(we,2);{let W=V(()=>a(R).isCustom?D()("session.quick.custom_roll"):`${D()("session.quick.roll_title")} (${a(R).count}d${a(R).sides})`),he=V(()=>a(R).isCustom?"":a(R).sides===20?D()("session.quick.boons_banes"):D()("session.quick.fixed_modifier"));Qs(De,{get isOpen(){return a(R).isOpen},get title(){return a(W)},get label(){return a(he)},get customFormula(){return a(R).customFormula},onClose:()=>a(R).isOpen=!1,onRoll:Ce,initialModifier:0})}var Xe=s(De,2),Ye=t(Xe);Ye.__click=()=>window.open(`/campaigns/${a(T)}/combat`,"_blank","width=500,height=700,resizable=yes,scrollbars=yes");var ft=t(Ye);Ha(ft,{size:24}),e(Ye),e(Xe),e(_e),_((W,he,Pe,ce,rt)=>{le(ve,"title",W),Ve(ot,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(o)==="session"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),i(St,he),le(mt,"aria-label",Pe),Ve(yt,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(o)==="bestiary"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),i(Ee,ce),le(Ye,"title",rt)},[()=>D()("session.quick.fab_title"),()=>D()("session.tabs.session"),()=>D()("session.quick.roll_dice"),()=>D()("session.tabs.bestiary"),()=>D()("session.combat_viewer.open")]),d(J,_e),la(),$()}ba(["click","keydown"]);export{Po as component};
