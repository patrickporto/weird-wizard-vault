import"../chunks/DsnmJJEf.js";import"../chunks/ChbcetSK.js";import{u as pe,v as U,k as p,w as ft,j as h,z as ht,A as b,D as ke,B as r,y as a,x as t,F as e,t as S,n as Tt,a9 as xa,V as ia,ak as wr,E as zt,at as yr,G as kr,L as Ja,bc as ja}from"../chunks/DfayzYqb.js";import{d as bt,o as Na,s as c,w as Ma,g as lt,e as ra}from"../chunks/Cx0o8vWd.js";import{l as mt,s as _t,i as y,p as gt}from"../chunks/C746LlRB.js";import{h as ha}from"../chunks/DcAUHn_s.js";import{a as Be,$ as jt,e as dt,s as Ae,i as St,r as tt,b as ba,h as $r,k as La}from"../chunks/Bs3V2B0j.js";import{a as Ct,s as Ue,b as Sr}from"../chunks/DukWTdxy.js";import{I as xt,s as wt}from"../chunks/tM_ceOsH.js";import{X as dr,C as Ra,b as za,S as zr,M as cr,f as Cr,a as Oa,D as Er,q as ca,A as Pr,c as Xa,P as Aa,e as Nr}from"../chunks/DmV8wAsz.js";import{t as He,b as ot,c as Fa,f as va}from"../chunks/D1-YRAfI.js";import{l as vr,a as Ha,b as Mr,c as Ir}from"../chunks/COIJJyGo.js";import{d as Lt,b as at,u as Za,q as Tr}from"../chunks/CqQomdhW.js";import{f as Zt,c as et,a as Qe,e as ya,b as ka,i as Wa}from"../chunks/CdkHlkWG.js";import{b as jr,g as $a}from"../chunks/D9e3TUDY.js";import{r as sa,C as _a,U as Qa,W as Or}from"../chunks/DZFRdR5h.js";import{S as ur,a as Ar,b as Dr,D as oa,G as Sa,C as Gr,g as Da}from"../chunks/DXWhg5s7.js";import{G as qa,S as Va,C as Br,P as er}from"../chunks/M7VHJyUj.js";import{L as Ur,U as wa,S as tr,a as Lr}from"../chunks/uRVIJNgA.js";import{c as Rr}from"../chunks/BASt3_wo.js";import{S as Fr}from"../chunks/D6v5F6iE.js";import{h as Hr}from"../chunks/BYmFNSF7.js";import{C as Wr}from"../chunks/DhygBu6m.js";import{b as qr}from"../chunks/UR9fxUxp.js";function ma(f,l){const n=mt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M5 12h14"}],["path",{d:"m12 5 7 7-7 7"}]];xt(f,_t({name:"arrow-right"},()=>n,{get iconNode(){return g},children:(i,v)=>{var o=pe(),u=U(o);wt(u,l,"default",{}),p(i,o)},$$slots:{default:!0}}))}function pr(f,l){const n=mt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M12 7v14"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z"}]];xt(f,_t({name:"book-open"},()=>n,{get iconNode(){return g},children:(i,v)=>{var o=pe(),u=U(o);wt(u,l,"default",{}),p(i,o)},$$slots:{default:!0}}))}function Vr(f,l){const n=mt(l,["children","$$slots","$$events","$$legacy"]);const g=[["circle",{cx:"12",cy:"12",r:"10"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16"}]];xt(f,_t({name:"circle-alert"},()=>n,{get iconNode(){return g},children:(i,v)=>{var o=pe(),u=U(o);wt(u,l,"default",{}),p(i,o)},$$slots:{default:!0}}))}function Kr(f,l){const n=mt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"m2 2 20 20"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07"}]];xt(f,_t({name:"cloud-off"},()=>n,{get iconNode(){return g},children:(i,v)=>{var o=pe(),u=U(o);wt(u,l,"default",{}),p(i,o)},$$slots:{default:!0}}))}function Yr(f,l){const n=mt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"}]];xt(f,_t({name:"cloud"},()=>n,{get iconNode(){return g},children:(i,v)=>{var o=pe(),u=U(o);wt(u,l,"default",{}),p(i,o)},$$slots:{default:!0}}))}function ar(f,l){const n=mt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]];xt(f,_t({name:"download"},()=>n,{get iconNode(){return g},children:(i,v)=>{var o=pe(),u=U(o);wt(u,l,"default",{}),p(i,o)},$$slots:{default:!0}}))}function Jr(f,l){const n=mt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56"}]];xt(f,_t({name:"loader-circle"},()=>n,{get iconNode(){return g},children:(i,v)=>{var o=pe(),u=U(o);wt(u,l,"default",{}),p(i,o)},$$slots:{default:!0}}))}function Xr(f,l){const n=mt(l,["children","$$slots","$$events","$$legacy"]);const g=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21"}]];xt(f,_t({name:"monitor"},()=>n,{get iconNode(){return g},children:(i,v)=>{var o=pe(),u=U(o);wt(u,l,"default",{}),p(i,o)},$$slots:{default:!0}}))}function Zr(f,l){const n=mt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor"}]];xt(f,_t({name:"palette"},()=>n,{get iconNode(){return g},children:(i,v)=>{var o=pe(),u=U(o);wt(u,l,"default",{}),p(i,o)},$$slots:{default:!0}}))}function Qr(f,l){const n=mt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]];xt(f,_t({name:"refresh-cw"},()=>n,{get iconNode(){return g},children:(i,v)=>{var o=pe(),u=U(o);wt(u,l,"default",{}),p(i,o)},$$slots:{default:!0}}))}function Ga(f,l){const n=mt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3"}]];xt(f,_t({name:"scroll"},()=>n,{get iconNode(){return g},children:(i,v)=>{var o=pe(),u=U(o);wt(u,l,"default",{}),p(i,o)},$$slots:{default:!0}}))}function es(f,l){const n=mt(l,["children","$$slots","$$events","$$legacy"]);const g=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"}],["path",{d:"M12 8v4"}],["path",{d:"M12 16h.01"}]];xt(f,_t({name:"shield-alert"},()=>n,{get iconNode(){return g},children:(i,v)=>{var o=pe(),u=U(o);wt(u,l,"default",{}),p(i,o)},$$slots:{default:!0}}))}var ts=h('<button class="fixed bottom-28 md:bottom-6 right-6 z-[60] bg-indigo-600 hover:bg-indigo-500 text-white h-14 px-4 rounded-full shadow-2xl shadow-indigo-900/50 flex items-center justify-center font-bold animate-pulse hover:animate-none transition-all active:scale-95 group"><!> <span class="text-sm uppercase tracking-wider max-w-0 overflow-hidden ml-0 group-hover:max-w-xs group-hover:ml-2 transition-all duration-300 md:max-w-xs md:ml-2 md:inline"> </span></button>'),as=h("<div><!></div>"),rs=h("<div><!></div>"),ss=h('<li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">1</span> <!></li> <li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">2</span> <div><!></div></li>',1),os=h('<li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">1</span> <div><!></div></li> <li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">2</span> <div><!></div></li>',1),is=h('<div class="fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-in fade-in"><div class="bg-slate-900 border border-slate-700 rounded-2xl p-6 max-w-sm w-full relative shadow-2xl mb-4 sm:mb-0 animate-in slide-in-from-bottom-10 sm:slide-in-from-bottom-0 sm:zoom-in-95"><button class="absolute top-4 right-4 text-slate-400 hover:text-white p-1"><!></button> <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2"><!> </h3> <ol class="space-y-4 text-slate-300 text-sm"><!></ol> <div class="mt-6 text-center"><button class="text-indigo-400 text-sm font-bold hover:text-indigo-300"> </button></div></div></div>'),ns=h("<!> <!>",1);function ls(f,l){ft(l,!0);const n=()=>Ue(jt,"$t",g),[g,i]=Ct();let v=ke(null),o=ke(!1),u=ke(!1),m=ke(!1),s=ke(!1);Na(()=>{if(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone){b(o,!1);return}const W=window.navigator.userAgent;b(m,/iPad|iPhone|iPod/.test(W)&&!window.MSStream,!0),b(s,/CriOS/i.test(W),!0),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(W)&&b(o,!0),window.addEventListener("beforeinstallprompt",z=>{z.preventDefault(),b(v,z,!0),b(o,!0)}),window.addEventListener("appinstalled",()=>{b(v,null),b(o,!1),b(u,!1)})});async function w(){if(r(v)){r(v).prompt();const{outcome:A}=await r(v).userChoice;A==="accepted"&&(b(v,null),b(o,!1))}else b(u,!0)}const M="inline w-3.5 h-3.5",O=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${M}"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" x2="12" y1="2" y2="15"/></svg>`,ae=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${M}"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M8 12h8"/><path d="M12 8v8"/></svg>`,q=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${M}"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></svg>`;function k(A,W){const X=n()(A),z=`<span class="inline-flex items-center justify-center bg-slate-800 p-1 rounded mx-1 align-middle">${W}</span>`;return X.replace("{icon}",z)}var I=ns(),D=U(I);{var G=A=>{var W=ts();W.__click=w;var X=t(W);ar(X,{size:24});var z=a(X,2),E=t(z,!0);e(z),e(W),S((C,$)=>{Be(W,"aria-label",C),c(E,$)},[()=>n()("home.install.button"),()=>n()("home.install.button")]),p(A,W)};y(D,A=>{r(o)&&A(G)})}var L=a(D,2);{var T=A=>{var W=is(),X=t(W),z=t(X);z.__click=()=>b(u,!1);var E=t(z);dr(E,{size:20}),e(z);var C=a(z,2),$=t(C);ar($,{size:24,class:"text-indigo-500"});var P=a($);e(C);var Q=a(C,2),re=t(Q);{var se=B=>{var Z=ss(),he=U(Z),Ne=a(t(he),2);{var _e=ie=>{var V=as(),K=t(V);ha(K,()=>k("home.install.ios_chrome_step1",O)),e(V),p(ie,V)},F=ie=>{var V=rs(),K=t(V);ha(K,()=>k("home.install.ios_step1",O)),e(V),p(ie,V)};y(Ne,ie=>{r(s)?ie(_e):ie(F,!1)})}e(he);var H=a(he,2),ee=a(t(H),2),Le=t(ee);ha(Le,()=>k("home.install.ios_step2",ae)),e(ee),e(H),p(B,Z)},ge=B=>{var Z=os(),he=U(Z),Ne=a(t(he),2),_e=t(Ne);ha(_e,()=>k("home.install.android_step1",q)),e(Ne),e(he);var F=a(he,2),H=a(t(F),2),ee=t(H);ha(ee,()=>n()("home.install.android_step2")),e(H),e(F),p(B,Z)};y(re,B=>{r(m)?B(se):B(ge,!1)})}e(Q);var oe=a(Q,2),$e=t(oe);$e.__click=()=>b(u,!1);var R=t($e,!0);e($e),e(oe),e(X),e(W),S((B,Z)=>{c(P,` ${B??""}`),c(R,Z)},[()=>n()("home.install.title"),()=>n()("home.install.close")]),p(A,W)};y(L,A=>{r(u)&&A(T)})}p(f,I),ht(),i()}bt(["click"]);var ds=h('<div class="absolute top-4 right-4 bg-black/50 p-2 rounded-full backdrop-blur-sm border border-white/10"><!></div>'),cs=h('<div class="absolute top-4 right-4 bg-indigo-500 p-2 rounded-full shadow-lg shadow-indigo-500/40 animate-in zoom-in duration-200"><!></div>'),vs=h('<div><div class="absolute inset-0 bg-slate-900"><img/> <div class="absolute inset-0 bg-gradient-to-t from-black via-black/80 to-transparent"></div></div> <div class="relative p-6 h-full flex flex-col justify-end min-h-[200px]"><!> <!> <div><h3 class="text-xl font-black text-white uppercase leading-tight mb-2 group-hover:text-indigo-400 transition-colors"> </h3> <p class="text-xs text-slate-400 font-medium leading-relaxed max-w-[90%]"> </p></div></div> <div class="absolute inset-0 bg-indigo-500/10 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"></div></div>'),us=h('<div class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>');function gr(f,l){ft(l,!0);const n=()=>Ue(jt,"$t",g),[g,i]=Ct(),v={sofdl:sa("/artworks/books/sofdl-core.webp"),sofww:sa("/artworks/books/sofww-core.webp"),dle:sa("/artworks/books/dle-core.webp")},o={dle:"object-[center_75%]",sofww:"object-center",sofdl:"object-center"};function u(w){return v[w]||""}function m(w){return o[w]||"object-center"}var s=us();dt(s,21,()=>ur,St,(w,M)=>{var O=vs();O.__click=()=>!r(M).disabled&&l.onSelect(r(M).id);var ae=t(O),q=t(ae);Tt(2),e(ae);var k=a(ae,2),I=t(k);{var D=E=>{var C=ds(),$=t(C);Ur($,{size:16,class:"text-slate-400"}),e(C),p(E,C)};y(I,E=>{r(M).disabled&&E(D)})}var G=a(I,2);{var L=E=>{var C=cs(),$=t(C);_a($,{size:16,class:"text-white"}),e(C),p(E,C)};y(G,E=>{l.selectedSystem===r(M).id&&E(L)})}var T=a(G,2),A=t(T),W=t(A,!0);e(A);var X=a(A,2),z=t(X,!0);e(X),e(T),e(k),Tt(2),e(O),S((E,C,$,P,Q)=>{Ae(O,1,`group relative rounded-2xl overflow-hidden cursor-pointer transition-all duration-300 border-2
            ${l.selectedSystem===r(M).id?"border-indigo-500 ring-2 ring-indigo-500/50 scale-[1.02]":"border-transparent hover:border-white/20 hover:scale-[1.01]"}
            ${r(M).disabled?"opacity-50 cursor-not-allowed grayscale":""}`),Be(q,"src",E),Be(q,"alt",C),Ae(q,1,`w-full h-full object-cover ${$??""} opacity-40 group-hover:opacity-60 transition-opacity duration-500`),c(W,P),c(z,Q)},[()=>u(r(M).id),()=>n()(r(M).nameKey),()=>m(r(M).id),()=>n()(r(M).nameKey),()=>n()(r(M).descriptionKey)]),p(w,O)}),e(s),p(f,s),ht(),i()}bt(["click"]);const ps=["Alistair","Baelor","Caelum","Daeron","Eldric","Fenris","Gareth","Havelock","Ignis","Jarek","Kaelen","Lucius","Malacor","Nyx","Orion","Pireus","Quintus","Rurik","Severus","Thorne","Ulric","Valerius","Wulfric","Xander","Yoric","Zephyr","Azura","Bellatrix","Celeste","Dahlia"],gs=["Aethelgard","Bramble","Cinder","Driftwood","Ember","Fable","Gossamer","Hollow","Ivy","Juniper","Kestrel","Lark","Moss","Nettle","Omen","Pebble","Quill","Rowan","Sage","Thistle","Umber","Vesper","Willow","Yarrow","Zephyr","Ash","Birch","Crow","Dusk"],rr=["the Brave","the Cursed","the Swift","the Wise","the Fool","the Strong","the Shadow","the Light","of the North","of the South","the Wanderer","the Lost","the Broken","the Eternal","the Mad"];function fr(f="person"){const l=Math.random()>.5?ps:gs,n=l[Math.floor(Math.random()*l.length)];if(f==="person")return Math.random()>.7?`${n} ${rr[Math.floor(Math.random()*rr.length)]}`:n;{const g=["Shadow","Legacy","Curse","Fall","Rise","Revenge","Secret","Tale","Legend","Doom"],i=["of","of the","from","and"];return`The ${g[Math.floor(Math.random()*g.length)]} ${i[Math.floor(Math.random()*i.length)]} ${n}`}}const Ut=Ma("idle"),Ya=Ma(null),Ca=Ma(null),fs="701898444454-7ml9onnv529k99rkvgh1slhdj4a1arrm.apps.googleusercontent.com",sr="https://www.googleapis.com/auth/drive.appdata https://www.googleapis.com/auth/userinfo.profile",Ke=Ma({signedIn:!1,accessToken:null,tokenExpiry:null,userProfile:null,isInited:!1});let Ea,or=!1;const ua="wwv_google_session";function hs(){localStorage.removeItem(ua),Ke.update(f=>({...f,signedIn:!1,accessToken:null,tokenExpiry:null,userProfile:null})),console.log("Session cleared due to expired or invalid token")}async function Pa(){hs(),console.warn("OAuth token expired or invalid. Please sign in again.")}async function hr(f){try{const l=await fetch("https://www.googleapis.com/oauth2/v1/userinfo?alt=json",{headers:{Authorization:`Bearer ${f}`}});if(l.status===401){await Pa();return}if(l.ok){const n=await l.json();Ke.update(g=>({...g,userProfile:{name:n.name,picture:n.picture}})),br()}}catch(l){console.error("Failed to fetch user profile:",l)}}function bs(){try{const f=localStorage.getItem(ua);if(f){const l=JSON.parse(f);if(l.accessToken)return l.tokenExpiry&&Date.now()>l.tokenExpiry?(console.log("Stored token is expired, clearing session"),localStorage.removeItem(ua),!1):(Ke.set({signedIn:!0,accessToken:l.accessToken,tokenExpiry:l.tokenExpiry||null,userProfile:l.userProfile||null,isInited:!0}),console.log("Restored session from localStorage"),hr(l.accessToken),!0)}}catch(f){console.error("Failed to load stored session:",f)}return!1}function br(){const f=lt(Ke);f.signedIn&&f.accessToken?localStorage.setItem(ua,JSON.stringify({accessToken:f.accessToken,tokenExpiry:f.tokenExpiry,userProfile:f.userProfile})):localStorage.removeItem(ua)}async function ms(){const f=fs;if(bs()){try{await nr(),Ea=google.accounts.oauth2.initTokenClient({client_id:f,scope:sr,callback:ir}),or=!0}catch(n){console.warn("Could not initialize GIS after restoring session:",n)}return}try{await nr(),Ea=google.accounts.oauth2.initTokenClient({client_id:f,scope:sr,callback:ir}),or=!0,Ke.update(n=>({...n,isInited:!0})),console.log("Google Auth Initialized")}catch(n){console.error("Failed to initialize Google Auth:",n),Ca.set("init_failed"),Ke.update(g=>({...g,isInited:!0}))}}function ir(f){if(f.error!==void 0){console.error("Google Auth Error:",f);return}console.log("Google Auth Success",f);const l=f.expires_in||3600,n=Date.now()+l*1e3;Ke.update(g=>({...g,signedIn:!0,accessToken:f.access_token,tokenExpiry:n})),br(),hr(f.access_token)}let aa=null;function nr(){return typeof window>"u"||typeof google<"u"&&google.accounts?Promise.resolve():aa||(aa=new Promise((f,l)=>{if(document.querySelector('script[src="https://accounts.google.com/gsi/client"]')){const i=setInterval(()=>{typeof google<"u"&&google.accounts&&(clearInterval(i),f())},100);setTimeout(()=>{clearInterval(i),(typeof google>"u"||!google.accounts)&&(aa=null,l(new Error("Google Identity Services script found but failed to initialize")))},5e3);return}const g=document.createElement("script");g.src="https://accounts.google.com/gsi/client",g.async=!0,g.defer=!0,g.onload=()=>{const i=setInterval(()=>{typeof google<"u"&&google.accounts&&(clearInterval(i),f())},50);setTimeout(()=>{clearInterval(i),(typeof google>"u"||!google.accounts)&&(aa=null,l(new Error("Google object not available after script load")))},5e3)},g.onerror=()=>{aa=null;const v=!navigator.onLine?"Failed to load Google script: No internet connection":"Failed to load Google script: Blocked by browser or network error";l(new Error(v))},document.head.appendChild(g)}),aa)}function mr(){Ea?(Ca.set(null),Ea.requestAccessToken()):(console.error("Google Auth not initialized"),Ca.set("not_initialized"),Ut.set("error"))}function _s(){const f=lt(Ke).accessToken;localStorage.removeItem(ua),Ke.update(l=>({...l,signedIn:!1,accessToken:null,tokenExpiry:null,userProfile:null})),f&&typeof google<"u"&&google.accounts&&google.accounts.oauth2.revoke(f,()=>{console.log("Access token revoked")})}async function _r(){const f=lt(Ke),l=f.accessToken;if(!l)throw new Error("Not signed in");if(f.tokenExpiry&&Date.now()>f.tokenExpiry)throw await Pa(),new Error("Token expired, please sign in again");const g=`https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent("name = 'weird-wizard-backup.json' and 'appDataFolder' in parents and trashed = false")}&spaces=appDataFolder&fields=files(id, name, modifiedTime, size)`,i=await fetch(g,{headers:{Authorization:`Bearer ${l}`}});if(i.status===401)throw await Pa(),new Error("Token expired, please sign in again");if(!i.ok)throw new Error("Failed to list backups: "+i.statusText);return(await i.json()).files||[]}async function xs(f){const l=lt(Ke).accessToken;if(!l)throw new Error("Not signed in");const n=JSON.stringify(f),g="weird-wizard-backup.json",i=await _r(),v=i.length>0?i[0].id:null;if(v){const o=`https://www.googleapis.com/upload/drive/v3/files/${v}?uploadType=media`,u=await fetch(o,{method:"PATCH",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:n});if(!u.ok){const m=await u.text();throw console.error("Upload error details:",m),new Error("Upload failed: "+u.statusText)}return await u.json()}else{const o={name:g,mimeType:"application/json",parents:["appDataFolder"]},u=new FormData;u.append("metadata",new Blob([JSON.stringify(o)],{type:"application/json"})),u.append("file",new Blob([n],{type:"application/json"}));const s=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:{Authorization:`Bearer ${l}`},body:u});if(!s.ok){const w=await s.text();throw console.error("Upload error details:",w),new Error("Upload failed: "+s.statusText)}return await s.json()}}async function ws(f){const l=lt(Ke).accessToken;if(!l)throw new Error("Not signed in");const n=`https://www.googleapis.com/drive/v3/files/${f}?alt=media`,g=await fetch(n,{headers:{Authorization:`Bearer ${l}`}});if(g.status===401)throw await Pa(),new Error("Token expired, please sign in again");if(!g.ok)throw new Error("Download failed: "+g.statusText);return await g.json()}let Ba;async function Ka(){if(lt(Ke).accessToken)try{console.log("Syncing from cloud..."),Ut.set("syncing");const l=await _r();if(l.length===0){console.log("No backups found in cloud."),Ut.set("success");return}const n=l[0].id,g=await ws(n),i=new Set;if(Zt.forEach((v,o)=>{i.add(String(o)),console.log("[DEBUG] Local deleted ID entry:",{key:o,type:typeof o,val:v})}),console.log("[DEBUG] Total locally deleted IDs:",i.size),g.deletedIds&&Array.isArray(g.deletedIds)){console.log("[DEBUG] Cloud data deletedIds count:",g.deletedIds.length);for(const v of g.deletedIds){const o=String(v.id);Zt.has(o)||(Zt.set(o,v),console.log("[DEBUG] New deletion synced from cloud:",o)),i.add(o),v.type==="character"&&et.has(o)&&(et.delete(o),console.log("[DEBUG] Removed char locally based on cloud deletion:",o)),v.type==="campaign"&&Qe.has(o)&&(Qe.delete(o),console.log("[DEBUG] Removed camp locally based on cloud deletion:",o)),v.type==="enemy"&&ya.has(o)&&(ya.delete(o),console.log("[DEBUG] Removed enemy locally based on cloud deletion:",o)),v.type==="encounter"&&ka.has(o)&&(ka.delete(o),console.log("[DEBUG] Removed encounter locally based on cloud deletion:",o))}}if(g.characters&&Array.isArray(g.characters)){console.log("[DEBUG] Syncing",g.characters.length,"characters from cloud");for(const v of g.characters){const o=String(v.id);if(i.has(o)||Zt.has(o)){console.log("[DEBUG] Skipping character because it is marked as deleted:",{id:o,name:v.name}),et.has(o)&&(console.log("[DEBUG] Character found locally but marked deleted. Removing now:",o),et.delete(o));for(const w of et.keys()){const M=et.get(w);M&&M.id===o&&(console.log("[DEBUG] Mismatched key entry found for deleted char. Removing:",w),et.delete(w))}continue}const u=et.get(o),m=v.lastUpdate||0,s=u?.lastUpdate||0;if(u&&s>m){console.log("[DEBUG] Skipping cloud overwrite for character, local is newer:",{id:o,localTime:s,cloudTime:m});continue}console.log("[DEBUG] Syncing character from cloud:",{id:o,name:v.name,status:u?"OVERWRITING":"ADDING"}),et.set(o,v)}}if(g.campaigns&&Array.isArray(g.campaigns)){console.log("[DEBUG] Syncing",g.campaigns.length,"campaigns from cloud");for(const v of g.campaigns){const o=String(v.id);if(i.has(o)||Zt.has(o)){console.log("[DEBUG] Skipping campaign because it is marked as deleted:",{id:o,name:v.name}),Qe.has(o)&&(console.log("[DEBUG] Campaign found locally but marked deleted. Removing now:",o),Qe.delete(o));for(const w of Qe.keys()){const M=Qe.get(w);M&&M.id===o&&(console.log("[DEBUG] Mismatched key entry found for deleted camp. Removing:",w),Qe.delete(w))}continue}const u=Qe.get(o),m=v.lastUpdate||0,s=u?.lastUpdate||0;if(u&&s>m){console.log("[DEBUG] Skipping cloud overwrite for campaign, local is newer:",{id:o,localTime:s,cloudTime:m});continue}console.log("[DEBUG] Syncing campaign from cloud:",{id:o,name:v.name,status:Qe.has(o)?"OVERWRITING":"ADDING"}),Qe.set(o,v)}}if(g.enemies&&Array.isArray(g.enemies))for(const v of g.enemies){const o=String(v.id);!i.has(o)&&!ya.has(o)&&ya.set(o,v)}if(g.encounters&&Array.isArray(g.encounters))for(const v of g.encounters){const o=String(v.id);!i.has(o)&&!ka.has(o)&&ka.set(o,v)}if(g.images&&typeof g.images=="object"){console.log("[DEBUG] Syncing",Object.keys(g.images).length,"images from cloud");for(const[v,o]of Object.entries(g.images))Wa.has(v)||(Wa.set(v,o),console.log("[DEBUG] New image synced from cloud:",v))}if(g.appSettings){console.log("[DEBUG] Syncing app settings from cloud");const v=lt(Lt),o={...g.appSettings};!o.userName&&(o.defaultPlayerName||o.defaultGmName)&&(o.userName=o.defaultPlayerName||o.defaultGmName||"",console.log("[DEBUG] Migrated legacy settings to userName:",o.userName)),delete o.defaultPlayerName,delete o.defaultGmName;const u={...o,...v};console.log("[DEBUG] Merged settings:",{current:v,cloud:o,merged:u}),Lt.set(u)}console.log("[DEBUG] Sync from cloud complete."),Ut.set("success"),Ya.set(Date.now())}catch(l){console.error("Failed to sync from cloud:",l),Ut.set("error")}}async function Ua(){lt(Ke).accessToken&&(Ba&&clearTimeout(Ba),Ba=setTimeout(async()=>{try{console.log("Syncing to cloud..."),Ut.set("syncing");const l=[],n=new Set;Zt.forEach((s,w)=>{l.push({id:w,...s}),n.add(String(w))});const g=lt(vr).filter(s=>!n.has(String(s.id))),i=lt(Ha).filter(s=>!n.has(String(s.id))),v=lt(Mr).filter(s=>!n.has(String(s.id))),o=lt(Ir).filter(s=>!n.has(String(s.id))),u={};Wa.forEach((s,w)=>{u[w]=s});const m={characters:g,campaigns:i,enemies:v,encounters:o,images:u,deletedIds:l,appSettings:lt(Lt),timestamp:Date.now(),version:1,appName:"WeirdWizardVault"};console.log("[DEBUG] Uploading to cloud:",{charactersCount:m.characters.length,campaignsCount:m.campaigns.length,enemiesCount:v.length,imagesCount:Object.keys(u).length,deletedIdsCount:l.length}),await xs(m),console.log("Sync to cloud complete."),Ut.set("success"),Ya.set(Date.now())}catch(l){console.error("Failed to sync to cloud:",l),Ut.set("error")}},2e3))}var ys=h('<button class="p-2 -ml-2 hover:bg-white/5 rounded-full text-slate-400 hover:text-white transition-all"><!></button>'),ks=h("<div></div>"),$s=h('<div class="space-y-6 text-center"><h3 class="text-3xl md:text-4xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400 max-w-lg mx-auto mb-8"> </p> <!></div>'),Ss=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="space-y-6"><div><label class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest"> </label> <div class="relative"><input class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 text-lg font-bold text-white outline-none transition-all placeholder:text-slate-600"/> <button class="absolute right-3 top-1/2 -translate-y-1/2 p-2 text-slate-500 hover:text-indigo-400 hover:bg-indigo-500/10 rounded-lg transition-all"><!></button></div></div> <div><label class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest"> </label> <input class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 font-medium text-white outline-none transition-all placeholder:text-slate-600"/></div> <div><label class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest"> </label> <textarea class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 text-white outline-none transition-all resize-none placeholder:text-slate-600" rows="4"></textarea></div> <button class="w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> <!></button></div></div>'),zs=h('<div class="w-6 h-6 rounded-full bg-indigo-500 flex items-center justify-center shadow-[0_0_10px_rgba(99,102,241,0.5)]"><!></div>'),Cs=h('<button><div class="flex-1"><div> </div> <div class="text-xs opacity-60 mt-1 font-medium"> </div></div> <!></button>'),Es=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="space-y-3"></div> <button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> <!></button></div>'),Ps=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="bg-slate-900/50 border border-slate-800 rounded-2xl p-6 space-y-4"><label class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest flex items-center gap-2"><!> </label> <input type="password" class="w-full bg-slate-950 border border-slate-700 rounded-xl p-4 text-white outline-none focus:border-indigo-500 transition-all placeholder:text-slate-700 font-mono text-center tracking-widest text-lg" placeholder="••••••••"/> <p class="text-xs text-slate-500 leading-relaxed text-center px-4"> </p></div> <button class="w-full bg-emerald-500 hover:bg-emerald-400 text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-emerald-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> </button></div>'),Ns=h('<div class="fixed inset-0 bg-slate-950/95 backdrop-blur-md z-[100] flex flex-col overflow-hidden"><div class="px-6 py-4 flex items-center justify-between border-b border-white/5 bg-white/[0.02]"><div class="flex items-center gap-4"><!> <div><h2 class="text-xl font-black text-white uppercase tracking-tight"> </h2> <div class="flex items-center gap-2 mt-1"></div></div></div> <button class="text-slate-500 hover:text-white font-bold text-xs uppercase tracking-widest px-4 py-2 hover:bg-white/5 rounded-lg transition-all"> </button></div> <div class="flex-1 overflow-y-auto custom-scrollbar p-6 flex flex-col items-center svelte-1uk72qn"><div class="w-full max-w-2xl py-8"><!></div></div></div>');function Ms(f,l){ft(l,!0);const n=()=>Ue(Lt,"$appSettings",v),g=()=>Ue(Ke,"$googleSession",v),i=()=>Ue(jt,"$t",v),[v,o]=Ct();let u=gt(l,"isOpen",3,!1),m=ke(1),s=xa({name:"",description:"",gmName:"",password:"",system:"",tier:"starting"});ia(()=>{u()&&(b(m,1),s.system="",s.tier="starting",s.name="",s.description="",s.gmName=n().userName||g().userProfile?.name||"",s.password="")});function w(){b(m,r(m)+1)}function M(){r(m)>1&&b(m,r(m)-1)}function O(G){s.system=G,s.tier=Ar(G),w()}function ae(){l.onSave({...s})}function q(){s.name=fr("campaign")}var k=pe(),I=U(k);{var D=G=>{var L=Ns(),T=t(L),A=t(T),W=t(A);{var X=R=>{var B=ys();B.__click=M;var Z=t(B);Ra(Z,{size:24}),e(B),p(R,B)};y(W,R=>{r(m)>1&&R(X)})}var z=a(W,2),E=t(z),C=t(E,!0);e(E);var $=a(E,2);dt($,20,()=>[1,2,3,4],St,(R,B)=>{var Z=ks();S(()=>Ae(Z,1,`h-1 rounded-full transition-all duration-500 ${B<=r(m)?"w-8 bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]":"w-2 bg-slate-800"}`)),p(R,Z)}),e($),e(z),e(A);var P=a(A,2);P.__click=function(...R){l.onClose?.apply(this,R)};var Q=t(P,!0);e(P),e(T);var re=a(T,2),se=t(re),ge=t(se);{var oe=R=>{var B=$s(),Z=t(B),he=t(Z,!0);e(Z);var Ne=a(Z,2),_e=t(Ne,!0);e(Ne);var F=a(Ne,2);gr(F,{get selectedSystem(){return s.system},onSelect:O}),e(B),S((H,ee)=>{c(he,H),c(_e,ee)},[()=>i()("wizard.campaign.step1_title"),()=>i()("wizard.campaign.step1_subtitle")]),He(1,B,()=>ot,()=>({duration:300,delay:100})),p(R,B)},$e=R=>{var B=pe(),Z=U(B);{var he=_e=>{var F=Ss(),H=t(F),ee=t(H),Le=t(ee,!0);e(ee);var ie=a(ee,2),V=t(ie,!0);e(ie),e(H);var K=a(H,2),Ee=t(K),Me=t(Ee),Se=t(Me,!0);e(Me);var Ie=a(Me,2),ue=t(Ie);tt(ue);var ne=a(ue,2);ne.__click=q;var xe=t(ne);za(xe,{size:20}),e(ne),e(Ie),e(Ee);var Fe=a(Ee,2),ce=t(Fe),we=t(ce,!0);e(ce);var j=a(ce,2);tt(j),e(Fe);var ze=a(Fe,2),Pe=t(ze),Re=t(Pe,!0);e(Pe);var le=a(Pe,2);wr(le),e(ze);var Y=a(ze,2);Y.__click=w;var te=t(Y),De=a(te);ma(De,{size:20}),e(Y),e(K),e(F),S((J,ve,Te,Ge,rt,Ye,be,me,de,fe)=>{c(Le,J),c(V,ve),c(Se,Te),Be(ue,"placeholder",Ge),Be(ne,"title",rt),c(we,Ye),Be(j,"placeholder",be),c(Re,me),Be(le,"placeholder",de),Y.disabled=!s.name,c(te,`${fe??""} `)},[()=>i()("wizard.campaign.step2_title"),()=>i()("wizard.campaign.step2_subtitle"),()=>i()("wizard.campaign.step2_name_label"),()=>i()("wizard.campaign.step2_name_placeholder"),()=>i()("wizard.campaign.step2_random_name_tooltip"),()=>i()("wizard.campaign.step2_gm_label"),()=>i()("wizard.campaign.step2_gm_placeholder"),()=>i()("wizard.campaign.step2_description_label"),()=>i()("wizard.campaign.step2_description_placeholder"),()=>i()("wizard.campaign.continue")]),at(ue,()=>s.name,J=>s.name=J),at(j,()=>s.gmName,J=>s.gmName=J),at(le,()=>s.description,J=>s.description=J),He(1,F,()=>ot,()=>({duration:300,delay:100})),p(_e,F)},Ne=_e=>{var F=pe(),H=U(F);{var ee=ie=>{var V=Es(),K=t(V),Ee=t(K),Me=t(Ee,!0);e(Ee);var Se=a(Ee,2),Ie=t(Se,!0);e(Se),e(K);var ue=a(K,2);dt(ue,21,()=>Dr(s.system),St,(ce,we)=>{var j=Cs();j.__click=()=>s.tier=r(we).value;var ze=t(j),Pe=t(ze),Re=t(Pe,!0);e(Pe);var le=a(Pe,2),Y=t(le,!0);e(le),e(ze);var te=a(ze,2);{var De=J=>{var ve=zs(),Te=t(ve);_a(Te,{size:14,class:"text-white"}),e(ve),p(J,ve)};y(te,J=>{s.tier===r(we).value&&J(De)})}e(j),S((J,ve)=>{Ae(j,1,`w-full relative flex items-center p-4 rounded-xl border-2 text-left transition-all ${s.tier===r(we).value?"bg-indigo-600/10 border-indigo-500 ring-1 ring-indigo-500/50":"bg-slate-900/50 border-slate-800 text-slate-400 hover:border-slate-600 hover:bg-slate-900"}`),Ae(Pe,1,`font-black uppercase tracking-wide text-lg ${s.tier===r(we).value?"text-indigo-400":"text-slate-300"}`),c(Re,J),c(Y,ve)},[()=>i()(r(we).labelKey),()=>i()("wizard.campaign.step3_tier_description")]),p(ce,j)}),e(ue);var ne=a(ue,2);ne.__click=w;var xe=t(ne),Fe=a(xe);ma(Fe,{size:20}),e(ne),e(V),S((ce,we,j)=>{c(Me,ce),c(Ie,we),c(xe,`${j??""} `)},[()=>i()("wizard.campaign.step3_title"),()=>i()("wizard.campaign.step3_subtitle"),()=>i()("wizard.campaign.continue")]),He(1,V,()=>ot,()=>({duration:300,delay:100})),p(ie,V)},Le=ie=>{var V=pe(),K=U(V);{var Ee=Me=>{var Se=Ps(),Ie=t(Se),ue=t(Ie),ne=t(ue,!0);e(ue);var xe=a(ue,2),Fe=t(xe,!0);e(xe),e(Ie);var ce=a(Ie,2),we=t(ce),j=t(we);zr(j,{size:14});var ze=a(j);e(we);var Pe=a(we,2);tt(Pe);var Re=a(Pe,2),le=t(Re,!0);e(Re),e(ce);var Y=a(ce,2);Y.__click=ae;var te=t(Y,!0);e(Y),e(Se),S((De,J,ve,Te,Ge)=>{c(ne,De),c(Fe,J),c(ze,` ${ve??""}`),c(le,Te),c(te,Ge)},[()=>i()("wizard.campaign.step4_title"),()=>i()("wizard.campaign.step4_subtitle"),()=>i()("wizard.campaign.step4_password_label"),()=>i()("wizard.campaign.step4_password_info"),()=>i()("wizard.campaign.create")]),at(Pe,()=>s.password,De=>s.password=De),He(1,Se,()=>ot,()=>({duration:300,delay:100})),p(Me,Se)};y(K,Me=>{r(m)===4&&Me(Ee)},!0)}p(ie,V)};y(H,ie=>{r(m)===3?ie(ee):ie(Le,!1)},!0)}p(_e,F)};y(Z,_e=>{r(m)===2?_e(he):_e(Ne,!1)},!0)}p(R,B)};y(ge,R=>{r(m)===1?R(oe):R($e,!1)})}e(se),e(re),e(L),S((R,B)=>{c(C,R),c(Q,B)},[()=>i()("wizard.campaign.title"),()=>i()("wizard.campaign.cancel")]),He(3,L,()=>ot,()=>({duration:200})),p(G,L)};y(I,G=>{u()&&G(D)})}p(f,k),ht(),o()}bt(["click"]);var Is=h('<div class="space-y-4"><div><label class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest flex items-center gap-1"><!> </label> <div class="p-3 bg-slate-800 rounded-lg border border-slate-700 text-slate-300 text-sm font-bold flex items-center gap-2"> <span class="text-[9px] bg-slate-700 text-slate-400 px-1.5 py-0.5 rounded uppercase tracking-wider ml-auto"> </span></div></div> <div><label for="char-name" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest"> </label> <input id="char-name" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div> <div><label for="char-player" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest flex items-center gap-1"><!> </label> <input id="char-player" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div> <div class="grid grid-cols-2 gap-4"><div><label for="char-ancestry" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest"> </label> <input id="char-ancestry" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div> <div><label for="char-level" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest"> </label> <input id="char-level" type="number" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div></div> <div><label for="char-path" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest"> </label> <input id="char-path" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div> <div class="grid grid-cols-2 gap-4"><div><label for="char-defense" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest"> </label> <input id="char-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div> <div><label for="char-health" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest"> </label> <input id="char-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div></div></div> <div class="flex gap-3 mt-8"><button class="flex-1 bg-slate-700 hover:bg-slate-600 transition-all py-3 rounded-xl text-white font-bold active:scale-95"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 transition-all py-3 rounded-xl text-white font-bold shadow-lg shadow-indigo-900/20 active:scale-95"> </button></div>',1);function Ts(f,l){ft(l,!0);const n=()=>Ue(jt,"$t",g),[g,i]=Ct();let v=gt(l,"isOpen",3,!1),o=gt(l,"initialData",3,"{}"),u=xa({name:"",playerName:"",ancestry:"",novicePath:"",level:1,defense:10,health:24,system:oa});ia(()=>{if(v()&&o())try{const s=JSON.parse(o());u.name=s.name||"",u.playerName=s.playerName||"",u.ancestry=s.ancestry||"",u.novicePath=s.paths&&s.paths.novice?s.paths.novice:"",u.level=s.level||1,u.defense=s.defense||10,u.health=s.health||s.normalHealth||24,u.system=s.system||oa}catch{u.name="",u.playerName="",u.ancestry="",u.novicePath="",u.level=1,u.defense=10,u.health=24,u.system=oa}});function m(){l.onSave({...u})}{let s=zt(()=>n()("character.settings.title"));cr(f,{get isOpen(){return v()},get onClose(){return l.onClose},get title(){return r(s)},maxWidth:"max-w-md",children:(w,M)=>{var O=Is(),ae=U(O),q=t(ae),k=t(q),I=t(k);Sa(I,{size:12});var D=a(I);e(k);var G=a(k,2),L=t(G),T=a(L),A=t(T,!0);e(T),e(G),e(q);var W=a(q,2),X=t(W),z=t(X,!0);e(X);var E=a(X,2);tt(E),e(W);var C=a(W,2),$=t(C),P=t($);wa(P,{size:12});var Q=a(P);e($);var re=a($,2);tt(re),e(C);var se=a(C,2),ge=t(se),oe=t(ge),$e=t(oe,!0);e(oe);var R=a(oe,2);tt(R),e(ge);var B=a(ge,2),Z=t(B),he=t(Z,!0);e(Z);var Ne=a(Z,2);tt(Ne),e(B),e(se);var _e=a(se,2),F=t(_e),H=t(F,!0);e(F);var ee=a(F,2);tt(ee),e(_e);var Le=a(_e,2),ie=t(Le),V=t(ie),K=t(V,!0);e(V);var Ee=a(V,2);tt(Ee),e(ie);var Me=a(ie,2),Se=t(Me),Ie=t(Se,!0);e(Se);var ue=a(Se,2);tt(ue),e(Me),e(Le),e(ae);var ne=a(ae,2),xe=t(ne);xe.__click=function(...j){l.onClose?.apply(this,j)};var Fe=t(xe,!0);e(xe);var ce=a(xe,2);ce.__click=m;var we=t(ce,!0);e(ce),e(ne),S((j,ze,Pe,Re,le,Y,te,De,J,ve,Te,Ge,rt,Ye,be,me)=>{c(D,` ${j??""}`),c(L,`${ze??""} `),c(A,Pe),c(z,Re),Be(E,"placeholder",le),c(Q,` ${Y??""}`),Be(re,"placeholder",te),c($e,De),Be(R,"placeholder",J),c(he,ve),c(H,Te),Be(ee,"placeholder",Ge),c(K,rt),c(Ie,Ye),c(Fe,be),c(we,me)},[()=>n()("character.settings.system_label"),()=>(()=>{const j=ur.find(ze=>ze.id===u.system);return j?n()(j.nameKey):n()("character.settings.system_unknown")})(),()=>n()("character.settings.fixed"),()=>n()("character.settings.name_label"),()=>n()("character.settings.name_placeholder"),()=>n()("character.settings.player_label"),()=>n()("character.settings.player_placeholder"),()=>n()("character.settings.ancestry_label"),()=>n()("character.settings.ancestry_placeholder"),()=>n()("character.settings.level_label"),()=>n()("character.settings.path_label"),()=>n()("character.settings.path_placeholder"),()=>n()("character.settings.defense_label"),()=>n()("character.settings.health_label"),()=>n()("character.settings.cancel"),()=>n()("character.settings.save_changes")]),at(E,()=>u.name,j=>u.name=j),at(re,()=>u.playerName,j=>u.playerName=j),at(R,()=>u.ancestry,j=>u.ancestry=j),at(Ne,()=>u.level,j=>u.level=j),at(ee,()=>u.novicePath,j=>u.novicePath=j),at(Ee,()=>u.defense,j=>u.defense=j),at(ue,()=>u.health,j=>u.health=j),p(w,O)},$$slots:{default:!0}})}ht(),i()}bt(["click"]);var js=h('<button class="p-2 -ml-2 hover:bg-white/5 rounded-full text-slate-400 hover:text-white transition-all"><!></button>'),Os=h("<div></div>"),As=h('<div class="space-y-6 text-center"><h3 class="text-3xl md:text-4xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400 max-w-lg mx-auto mb-8"> </p> <!></div>'),Ds=h("<button> </button>"),Gs=h("<button> </button> <button> </button>",1),Bs=h('<div class="pt-2"><label for="other-ancestry" class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest"> </label> <input id="other-ancestry" class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 text-white outline-none transition-all placeholder:text-slate-600"/></div>'),Us=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="grid grid-cols-2 gap-3"><!></div> <!> <button class="w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> <!></button></div>'),Ls=h('<button class="p-3 rounded-xl border border-slate-800 bg-slate-900/50 hover:bg-slate-800 text-slate-300 hover:text-white font-bold text-xs uppercase tracking-widest transition-all"> </button>'),Rs=h('<div class="grid grid-cols-2 gap-2"></div>'),Fs=h("<button> </button>"),Hs=h('<div class="space-y-3"><div class="flex items-center justify-between"><button class="text-xs text-indigo-400 hover:text-indigo-300 font-bold uppercase tracking-widest flex items-center gap-1 transition-all"><!> </button></div> <div class="grid grid-cols-2 gap-2 max-h-48 overflow-y-auto custom-scrollbar pr-2 svelte-n6fmm8"></div></div>'),Ws=h('<div class="w-16 h-16 bg-slate-800 rounded-full mx-auto flex items-center justify-center mb-2"><!></div> <p class="text-xs text-slate-500"> </p>',1),qs=h('<div class="space-y-1"><div class="text-[10px] text-indigo-400 font-bold uppercase tracking-widest"> </div> <div class="text-xl font-black text-white"> </div></div>'),Vs=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="space-y-4"><!> <div class="bg-slate-900/50 border-2 border-slate-800 rounded-2xl p-6 text-center space-y-4"><!> <button class="w-full bg-white/5 hover:bg-white/10 text-white font-bold py-3 rounded-xl border border-white/10 transition-all flex items-center justify-center gap-2 hover:border-white/20 text-xs"><!> </button></div></div> <button class="w-full bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> <!></button></div>'),Ks=h("<button> </button>"),Ys=h("<button> </button>"),Js=h('<div class="pt-2"><label for="other-path" class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest"> </label> <input id="other-path" class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 text-white outline-none transition-all placeholder:text-slate-600"/></div>'),Xs=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="grid grid-cols-2 gap-3"><button class="col-span-2 p-3 text-xs text-slate-500 hover:text-white uppercase tracking-widest hover:underline"> </button> <!></div> <!> <button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> <!></button></div>'),Zs=h('<div class="space-y-8 w-full max-w-lg mx-auto"><div class="text-center"><h3 class="text-3xl font-black text-white uppercase tracking-tight mb-2"> </h3> <p class="text-slate-400"> </p></div> <div class="space-y-6"><div><label for="character-name" class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest"> </label> <div class="relative"><input id="character-name" class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 text-lg font-bold text-white outline-none transition-all placeholder:text-slate-600"/> <button class="absolute right-3 top-1/2 -translate-y-1/2 p-2 text-slate-500 hover:text-indigo-400 hover:bg-indigo-500/10 rounded-lg transition-all"><!></button></div></div> <div><label for="player-name" class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest flex items-center gap-2"><!> </label> <input id="player-name" class="w-full bg-slate-900 border-2 border-slate-800 hover:border-slate-700 focus:border-indigo-500 rounded-xl p-4 font-medium text-white outline-none transition-all placeholder:text-slate-600"/></div> <div class="bg-indigo-900/20 border border-indigo-500/20 rounded-xl p-4 flex items-start gap-3"><!> <div><h4 class="text-sm font-bold text-white mb-1"> </h4> <p class="text-xs text-slate-400"> </p></div></div> <button class="w-full bg-emerald-500 hover:bg-emerald-400 disabled:opacity-50 text-white text-lg font-black uppercase tracking-widest py-4 rounded-xl shadow-lg shadow-emerald-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"> </button></div></div>'),Qs=h('<div class="fixed inset-0 bg-slate-950/95 backdrop-blur-md z-[100] flex flex-col overflow-hidden"><div class="px-6 py-4 flex items-center justify-between border-b border-white/5 bg-white/[0.02]"><div class="flex items-center gap-4"><!> <div><h2 class="text-xl font-black text-white uppercase tracking-tight"> </h2> <div class="flex items-center gap-2 mt-1"></div></div></div> <button class="text-slate-500 hover:text-white font-bold text-xs uppercase tracking-widest px-4 py-2 hover:bg-white/5 rounded-lg transition-all"> </button></div> <div class="flex-1 overflow-y-auto custom-scrollbar p-6 flex flex-col items-center svelte-n6fmm8"><div class="w-full max-w-2xl py-8"><!></div></div></div>');function eo(f,l){ft(l,!0);const n=()=>Ue(Lt,"$appSettings",v),g=()=>Ue(Ke,"$googleSession",v),i=()=>Ue(jt,"$t",v),[v,o]=Ct();let u=gt(l,"isOpen",3,!1),m=ke(1),s=xa({name:"",playerName:"",system:"",ancestry:"",profession:"",novicePath:""}),w=ke(""),M=ke(""),O=ke("");const ae={sofdl:{Academic:["architecture","astrology","engineering","etiquette_customs","folklore","geography","heraldry","history","law","literature","magic","medicine","navigation","occult","philosophy","politics","nature","religion","science","war"],Criminal:["agitator","beggar","burglar","carouser","charlatan","cultist","fence","forger","gambler","grave_robber","informant","murderer","pickpocket","pirate","prostitute","rebel","saboteur","spy","thug","urchin"],Martial:["constable","detective","guard","jailer","officer","marine","mercenary","militia_member","patroller","peasant_conscript","slave","soldier","squire","torturer"],Wilderness:["bandit","barbarian","exile","gatherer","guide","hermit","hunter","nomad","pioneer","poacher","prospector","outlaw","refugee","spelunker","tracker","trapper","woodcutter"],Religious:["devotee","evangelist","flagellant","heretic","initiate_old_faith","minister","acolyte_new_god","inquisitor_henchman","pilgrim","street_preacher","temple_ward"],Common:["animal_trainer","apothecary","artisan","artist","boatman","butcher","cook","drover","entertainer","farmer","fisher","groom","laborer","merchant","miner","musician","sailor","servant","shopkeeper","teamster"]},sofww:{Entertainment:["acrobat","animal_handler","artist","busker","clown","dancer","fortune_teller","juggler","singer","thespian"],Military:["caravan_guard","herald","house_guard","marine","member_of_the_watch","mercenary_soldier","militia_member","soldier","squire","sworn_bodyguard"],Religious:["acolyte","aspirant","cultist","evangelist","fundamentalist","heretic","missionary","minister","prophet","scribe"],Academic:["apothecary","apprentice_magician","astrologer","doctor","folklorist","inventor","naturalist","occultist","philosopher","politician"],Aristocratic:["carouser","dilettante","merchant","landholder","influencer"],Common:["baker","bartender","carpenter","cook","exterminator","farmer","fisher","gravedigger","groom","herder","jeweler","laborer","mason","miner","sailor","servant","shopkeeper","smith","tanner","teamster"],Criminal:["bandit","burglar","charlatan","constable","detective","forger","grave_robber","jailer","mugger","rake"],Wilderness:["beggar","forester","gatherer","hunter","nomad","pilgrim","prospector","recluse","spelunker","woodcutter"]}};ia(()=>{u()&&(b(m,1),s.system="",s.name="",s.playerName=n().userName||g().userProfile?.name||"",s.ancestry="",s.profession="",s.novicePath="",b(w,""),b(M,""),b(O,""))});function q(){r(m)===2&&s.ancestry==="Other"&&!r(w)||r(m)===4&&s.novicePath==="Other"&&!r(M)||(r(m)===2&&s.ancestry==="Other"&&(s.ancestry=r(w)),r(m)===4&&s.novicePath==="Other"&&(s.novicePath=r(M)),r(m)===3&&b(O,""),b(m,r(m)+1))}function k(){r(m)>1&&b(m,r(m)-1)}function I(z){s.system=z,q()}function D(){s.name=fr("person")}function G(){const z=s.system==="sofdl"||s.system==="sofww"?s.system:"sofww",E=ae[z],C=Object.keys(E),$=C[Math.floor(Math.random()*C.length)],P=E[$],Q=P[Math.floor(Math.random()*P.length)],re=i()(`professions.${z}.${$.toLowerCase()}.${Q}`),se=i()(`professions.categories.${$.toLowerCase()}`);s.profession=`${re} (${se})`,b(O,"")}function L(z,E){const C=s.system==="sofdl"||s.system==="sofww"?s.system:"sofww",$=i()(`professions.${C}.${z.toLowerCase()}.${E}`),P=i()(`professions.categories.${z.toLowerCase()}`);s.profession=`${$} (${P})`}function T(){s.novicePath==="Other"&&(s.novicePath=r(M));const z=s.system==="sofdl"||s.system==="sofww"?s.system:"sofww";let E=s.ancestry;["Human","Changeling","Clockwork","Dwarf","Goblin","Orc"].includes(E)&&(E=i()(`ancestries.${z}.${E.toLowerCase()}`));let $=s.novicePath;["Magician","Priest","Rogue","Warrior","Fighter","Mage","Ancestry"].includes($)&&($=i()(`paths.${z}.${$.toLowerCase()}`));const Q={...s,ancestry:E,novicePath:$,level:s.system==="sofdl"?0:1,health:(s.system==="sofdl",10),defense:10};l.onSave(Q)}var A=pe(),W=U(A);{var X=z=>{var E=Qs(),C=t(E),$=t(C),P=t($);{var Q=F=>{var H=js();H.__click=k;var ee=t(H);Ra(ee,{size:24}),e(H),p(F,H)};y(P,F=>{r(m)>1&&F(Q)})}var re=a(P,2),se=t(re),ge=t(se,!0);e(se);var oe=a(se,2);dt(oe,20,()=>[1,2,3,4,5],St,(F,H)=>{var ee=Os();S(()=>Ae(ee,1,`h-1 rounded-full transition-all duration-500 ${H<=r(m)?"w-8 bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]":"w-2 bg-slate-800"}`)),p(F,ee)}),e(oe),e(re),e($);var $e=a($,2);$e.__click=function(...F){l.onClose?.apply(this,F)};var R=t($e,!0);e($e),e(C);var B=a(C,2),Z=t(B),he=t(Z);{var Ne=F=>{var H=As(),ee=t(H),Le=t(ee,!0);e(ee);var ie=a(ee,2),V=t(ie,!0);e(ie);var K=a(ie,2);gr(K,{get selectedSystem(){return s.system},onSelect:I}),e(H),S((Ee,Me)=>{c(Le,Ee),c(V,Me)},[()=>i()("wizard.character.step1_title"),()=>i()("wizard.character.step1_subtitle")]),He(1,H,()=>ot,()=>({duration:300,delay:100})),p(F,H)},_e=F=>{var H=pe(),ee=U(H);{var Le=V=>{var K=Us(),Ee=t(K),Me=t(Ee),Se=t(Me,!0);e(Me);var Ie=a(Me,2),ue=t(Ie,!0);e(Ie),e(Ee);var ne=a(Ee,2),xe=t(ne);{var Fe=le=>{var Y=pe(),te=U(Y);dt(te,16,()=>["Human","Changeling","Clockwork","Dwarf","Goblin","Orc","Other"],St,(De,J)=>{var ve=Ds();ve.__click=()=>s.ancestry=J;var Te=t(ve,!0);e(ve),S(Ge=>{Ae(ve,1,`p-4 rounded-xl border-2 text-center font-bold uppercase tracking-wider transition-all ${s.ancestry===J?"bg-indigo-600/20 border-indigo-500 text-white shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-600 hover:text-white"}`),c(Te,Ge)},[()=>i()(`ancestries.sofdl.${J.toLowerCase()}`)]),p(De,ve)}),p(le,Y)},ce=le=>{var Y=Gs(),te=U(Y);te.__click=()=>s.ancestry="Human";var De=t(te,!0);e(te);var J=a(te,2);J.__click=()=>s.ancestry="Other";var ve=t(J,!0);e(J),S((Te,Ge)=>{Ae(te,1,`p-4 rounded-xl border-2 text-center font-bold uppercase tracking-wider transition-all ${s.ancestry==="Human"?"bg-indigo-600/20 border-indigo-500 text-white shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-600 hover:text-white"}`),c(De,Te),Ae(J,1,`p-4 rounded-xl border-2 text-center font-bold uppercase tracking-wider transition-all ${s.ancestry==="Other"?"bg-indigo-600/20 border-indigo-500 text-white shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-600 hover:text-white"}`),c(ve,Ge)},[()=>i()("ancestries.sofww.human"),()=>i()("ancestries.sofww.other")]),p(le,Y)};y(xe,le=>{s.system==="sofdl"?le(Fe):le(ce,!1)})}e(ne);var we=a(ne,2);{var j=le=>{var Y=Bs(),te=t(Y),De=t(te,!0);e(te);var J=a(te,2);tt(J),e(Y),S((ve,Te)=>{c(De,ve),Be(J,"placeholder",Te)},[()=>i()("wizard.character.step2_other_label"),()=>i()("wizard.character.step2_other_placeholder")]),at(J,()=>r(w),ve=>b(w,ve)),He(1,Y,()=>Fa),p(le,Y)};y(we,le=>{s.ancestry==="Other"&&le(j)})}var ze=a(we,2);ze.__click=q;var Pe=t(ze),Re=a(Pe);ma(Re,{size:20}),e(ze),e(K),S((le,Y,te)=>{c(Se,le),c(ue,Y),ze.disabled=!s.ancestry||s.ancestry==="Other"&&!r(w),c(Pe,`${te??""} `)},[()=>i()("wizard.character.step2_title"),()=>i()("wizard.character.step2_subtitle"),()=>i()("wizard.character.continue")]),He(1,K,()=>ot,()=>({duration:300,delay:100})),p(V,K)},ie=V=>{var K=pe(),Ee=U(K);{var Me=Ie=>{var ue=Vs(),ne=t(ue),xe=t(ne),Fe=t(xe,!0);e(xe);var ce=a(xe,2),we=t(ce,!0);e(ce),e(ne);var j=a(ne,2),ze=t(j);{var Pe=be=>{var me=Rs();dt(me,21,()=>Object.keys(ae[s.system==="sofdl"?"sofdl":"sofww"]),St,(de,fe)=>{var ye=Ls();ye.__click=()=>b(O,r(fe),!0);var We=t(ye,!0);e(ye),S(Oe=>c(We,Oe),[()=>i()(`professions.categories.${r(fe).toLowerCase()}`)]),p(de,ye)}),e(me),p(be,me)},Re=be=>{var me=Hs(),de=t(me),fe=t(de);fe.__click=()=>b(O,"");var ye=t(fe);Ra(ye,{size:14});var We=a(ye);e(fe),e(de);var Oe=a(de,2);dt(Oe,21,()=>ae[s.system==="sofdl"?"sofdl":"sofww"][r(O)],St,(je,Je)=>{const it=zt(()=>i()(`professions.${s.system==="sofdl"?"sofdl":"sofww"}.${r(O).toLowerCase()}.${r(Je)}`));var ut=Fs();ut.__click=()=>L(r(O),r(Je));var d=t(ut,!0);e(ut),S(x=>{Ae(ut,1,`p-2.5 rounded-lg border text-left text-xs font-bold transition-all ${x??""}`),c(d,r(it))},[()=>s.profession.includes(r(it))?"bg-indigo-600/20 border-indigo-500 text-white shadow-[0_0_10px_rgba(99,102,241,0.2)]":"bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-700 hover:text-slate-200"]),p(je,ut)}),e(Oe),e(me),S(je=>c(We,` ${je??""}`),[()=>i()(`professions.categories.${r(O).toLowerCase()}`)]),He(1,me,()=>ot,()=>({duration:200})),p(be,me)};y(ze,be=>{r(O)?be(Re,!1):be(Pe)})}var le=a(ze,2),Y=t(le);{var te=be=>{var me=Ws(),de=U(me),fe=t(de);pr(fe,{size:28,class:"text-slate-600"}),e(de);var ye=a(de,2),We=t(ye,!0);e(ye),S(Oe=>c(We,Oe),[()=>i()("wizard.character.step3_empty_message")]),p(be,me)},De=be=>{var me=qs(),de=t(me),fe=t(de,!0);e(de);var ye=a(de,2),We=t(ye,!0);e(ye),e(me),S(Oe=>{c(fe,Oe),c(We,s.profession)},[()=>i()("wizard.character.step3_your_profession")]),He(1,me,()=>ot),p(be,me)};y(Y,be=>{s.profession?be(De,!1):be(te)})}var J=a(Y,2);J.__click=G;var ve=t(J);za(ve,{size:16});var Te=a(ve);e(J),e(le),e(j);var Ge=a(j,2);Ge.__click=q;var rt=t(Ge),Ye=a(rt);ma(Ye,{size:20}),e(Ge),e(ue),S((be,me,de,fe)=>{c(Fe,be),c(we,me),c(Te,` ${de??""}`),Ge.disabled=!s.profession,c(rt,`${fe??""} `)},[()=>i()("wizard.character.step3_title"),()=>i()("wizard.character.step3_subtitle"),()=>s.profession?i()("wizard.character.step3_roll_again"):i()("wizard.character.step3_roll"),()=>i()("wizard.character.continue")]),He(1,ue,()=>ot,()=>({duration:300,delay:100})),p(Ie,ue)},Se=Ie=>{var ue=pe(),ne=U(ue);{var xe=ce=>{var we=Xs(),j=t(we),ze=t(j),Pe=t(ze,!0);e(ze);var Re=a(ze,2),le=t(Re,!0);e(Re),e(j);var Y=a(j,2),te=t(Y);te.__click=()=>s.novicePath="";var De=t(te,!0);e(te);var J=a(te,2);{var ve=de=>{var fe=pe(),ye=U(fe);dt(ye,16,()=>["Magician","Priest","Rogue","Warrior","Other"],St,(We,Oe)=>{var je=Ks();je.__click=()=>s.novicePath=Oe;var Je=t(je,!0);e(je),S(it=>{Ae(je,1,`p-4 rounded-xl border-2 text-center font-bold uppercase tracking-wider transition-all ${s.novicePath===Oe?"bg-indigo-600/20 border-indigo-500 text-white shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-600 hover:text-white"}`),c(Je,it)},[()=>i()(`paths.sofdl.${Oe.toLowerCase()}`)]),p(We,je)}),p(de,fe)},Te=de=>{var fe=pe(),ye=U(fe);dt(ye,16,()=>["Fighter","Mage","Priest","Rogue","Ancestry","Other"],St,(We,Oe)=>{var je=Ys();je.__click=()=>s.novicePath=Oe;var Je=t(je,!0);e(je),S(it=>{Ae(je,1,`p-4 rounded-xl border-2 text-center font-bold uppercase tracking-wider transition-all ${s.novicePath===Oe?"bg-indigo-600/20 border-indigo-500 text-white shadow-[0_0_15px_rgba(99,102,241,0.3)]":"bg-slate-900 border-slate-800 text-slate-400 hover:border-slate-600 hover:text-white"}`),c(Je,it)},[()=>i()(`paths.sofww.${Oe.toLowerCase()}`)]),p(We,je)}),p(de,fe)};y(J,de=>{s.system==="sofdl"?de(ve):de(Te,!1)})}e(Y);var Ge=a(Y,2);{var rt=de=>{var fe=Js(),ye=t(fe),We=t(ye,!0);e(ye);var Oe=a(ye,2);tt(Oe),e(fe),S((je,Je)=>{c(We,je),Be(Oe,"placeholder",Je)},[()=>i()("wizard.character.step4_other_label"),()=>i()("wizard.character.step4_other_placeholder")]),at(Oe,()=>r(M),je=>b(M,je)),He(1,fe,()=>Fa),p(de,fe)};y(Ge,de=>{s.novicePath==="Other"&&de(rt)})}var Ye=a(Ge,2);Ye.__click=q;var be=t(Ye),me=a(be);ma(me,{size:20}),e(Ye),e(we),S((de,fe,ye,We)=>{c(Pe,de),c(le,fe),c(De,ye),c(be,`${We??""} `)},[()=>i()("wizard.character.step4_title"),()=>i()("wizard.character.step4_subtitle"),()=>i()("wizard.character.step4_skip"),()=>i()("wizard.character.continue")]),He(1,we,()=>ot,()=>({duration:300,delay:100})),p(ce,we)},Fe=ce=>{var we=pe(),j=U(we);{var ze=Pe=>{var Re=Zs(),le=t(Re),Y=t(le),te=t(Y,!0);e(Y);var De=a(Y,2),J=t(De,!0);e(De),e(le);var ve=a(le,2),Te=t(ve),Ge=t(Te),rt=t(Ge,!0);e(Ge);var Ye=a(Ge,2),be=t(Ye);tt(be);var me=a(be,2);me.__click=D;var de=t(me);za(de,{size:20}),e(me),e(Ye),e(Te);var fe=a(Te,2),ye=t(fe),We=t(ye);wa(We,{size:14});var Oe=a(We);e(ye);var je=a(ye,2);tt(je),e(fe);var Je=a(fe,2),it=t(Je);Cr(it,{size:20,class:"text-indigo-400 shrink-0 mt-0.5"});var ut=a(it,2),d=t(ut),x=t(d,!0);e(d);var _=a(d,2),N=t(_,!0);e(_),e(ut),e(Je);var Ce=a(Je,2);Ce.__click=T;var Ve=t(Ce,!0);e(Ce),e(ve),e(Re),S((st,Et,ct,Xe,yt,Rt,Ft,Qt,na,Ht)=>{c(te,st),c(J,Et),c(rt,ct),Be(be,"placeholder",Xe),Be(me,"title",yt),c(Oe,` ${Rt??""}`),Be(je,"placeholder",Ft),c(x,Qt),c(N,na),Ce.disabled=!s.name,c(Ve,Ht)},[()=>i()("wizard.character.step5_title"),()=>i()("wizard.character.step5_subtitle"),()=>i()("wizard.character.step5_character_name_label"),()=>i()("wizard.character.step5_character_name_placeholder"),()=>i()("wizard.character.step5_random_name_tooltip"),()=>i()("wizard.character.step5_player_name_label"),()=>i()("wizard.character.step5_player_name_placeholder"),()=>i()("wizard.character.step5_ready_title"),()=>i()("wizard.character.step5_ready_message"),()=>i()("wizard.character.create")]),at(be,()=>s.name,st=>s.name=st),at(je,()=>s.playerName,st=>s.playerName=st),He(1,Re,()=>ot,()=>({duration:300,delay:100})),p(Pe,Re)};y(j,Pe=>{r(m)===5&&Pe(ze)},!0)}p(ce,we)};y(ne,ce=>{r(m)===4?ce(xe):ce(Fe,!1)},!0)}p(Ie,ue)};y(Ee,Ie=>{r(m)===3?Ie(Me):Ie(Se,!1)},!0)}p(V,K)};y(ee,V=>{r(m)===2?V(Le):V(ie,!1)},!0)}p(F,H)};y(he,F=>{r(m)===1?F(Ne):F(_e,!1)})}e(Z),e(B),e(E),S((F,H)=>{c(ge,F),c(R,H)},[()=>i()("wizard.character.title"),()=>i()("wizard.character.cancel")]),He(3,E,()=>ot,()=>({duration:200})),p(z,E)};y(W,z=>{u()&&z(X)})}p(f,A),ht(),o()}bt(["click"]);var to=h('<div class="ml-auto flex items-center h-full self-center"><div class="w-3 h-3 rounded-full bg-indigo-500 shadow-[0_0_10px_rgba(99,102,241,0.5)]"></div></div>'),ao=h('<button><div><!></div> <div class="flex-1"><h4 class="font-bold text-sm mb-1"> </h4> <p class="text-[10px] opacity-70 leading-relaxed"> </p></div> <!></button>'),ro=h('<div class="space-y-3 pt-4 border-t border-slate-800"><label class="text-xs font-black uppercase tracking-widest text-slate-500 flex items-center gap-2"><!> </label> <div class="grid grid-cols-1 gap-3"></div></div>'),so=h('<div class="space-y-6"><div><label for="settings-player-name" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest flex items-center gap-1"><!> </label> <input id="settings-player-name" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors" placeholder="Seu nome ou apelido"/> <p class="text-[10px] text-slate-500 mt-1">O nome do jogador associado a este personagem.</p></div> <!></div> <div class="flex flex-col-reverse sm:flex-row gap-3 mt-8"><button class="flex-1 bg-slate-700 hover:bg-slate-600 transition-all py-4 sm:py-3 rounded-xl text-white font-bold active:scale-95"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 transition-all py-4 sm:py-3 rounded-xl text-white font-bold shadow-lg shadow-indigo-900/20 active:scale-95"> </button></div>',1);function oo(f,l){ft(l,!0);const n=()=>Ue(jt,"$t",g),[g,i]=Ct();let v=gt(l,"isOpen",3,!1),o=gt(l,"characterData",3,null),u=ke(""),m=ke("standard"),s=[{value:"standard",label:"Standard",desc:"Sistema de magia padrão do Shadow of the Demon Lord.",icon:pr,disabled:!1},{value:"forbidden_rules",label:"Forbidden Rules",desc:"Coming Soon",icon:Fr,disabled:!0},{value:"uncanny_arcana",label:"Uncanny Arcana",desc:"Coming Soon",icon:tr,disabled:!0}];ia(()=>{v()&&o()&&(b(u,o().playerName||"",!0),b(m,o().magicSystem||"standard",!0))});function w(){l.onSave({playerName:r(u),magicSystem:r(m)})}{let M=zt(()=>n()("character.settings.title_label"));cr(f,{get isOpen(){return v()},get onClose(){return l.onClose},get title(){return`⚙️ ${r(M)??""}`},maxWidth:"max-w-md",children:(O,ae)=>{var q=so(),k=U(q),I=t(k),D=t(I),G=t(D);wa(G,{size:12});var L=a(G);e(D);var T=a(D,2);tt(T),Tt(2),e(I);var A=a(I,2);{var W=P=>{var Q=ro(),re=t(Q),se=t(re);tr(se,{size:14});var ge=a(se);e(re);var oe=a(re,2);dt(oe,21,()=>s,St,($e,R)=>{var B=ao();B.__click=()=>!r(R).disabled&&b(m,r(R).value,!0);var Z=t(B),he=t(Z);Rr(he,()=>r(R).icon,(V,K)=>{K(V,{size:20})}),e(Z);var Ne=a(Z,2),_e=t(Ne),F=t(_e,!0);e(_e);var H=a(_e,2),ee=t(H,!0);e(H),e(Ne);var Le=a(Ne,2);{var ie=V=>{var K=to();p(V,K)};y(Le,V=>{r(m)===r(R).value&&V(ie)})}e(B),S(()=>{Ae(B,1,`flex items-start gap-4 p-4 rounded-xl border text-left transition-all ${r(m)===r(R).value?"bg-indigo-600/20 border-indigo-500 text-white":"bg-slate-900 border-slate-700 text-slate-400 hover:border-slate-600"} ${r(R).disabled?"opacity-50 cursor-not-allowed":""}`),B.disabled=r(R).disabled,Ae(Z,1,`mt-1 p-2 rounded-lg bg-slate-800 ${r(m)===r(R).value?"text-indigo-400":"text-slate-500"}`),c(F,r(R).label),c(ee,r(R).desc)}),p($e,B)}),e(oe),e(Q),S($e=>c(ge,` ${$e??""}`),[()=>n()("character.settings.magic_system")]),p(P,Q)};y(A,P=>{o()?.system==="sofdl"&&P(W)})}e(k);var X=a(k,2),z=t(X);z.__click=function(...P){l.onClose?.apply(this,P)};var E=t(z,!0);e(z);var C=a(z,2);C.__click=w;var $=t(C,!0);e(C),e(X),S((P,Q,re)=>{c(L,` ${P??""}`),c(E,Q),c($,re)},[()=>n()("character.settings.player_name"),()=>n()("common.buttons.cancel")||"Cancelar",()=>n()("common.buttons.save")||"Salvar"]),at(T,()=>r(u),P=>b(u,P)),p(O,q)},$$slots:{default:!0}})}ht(),i()}bt(["click"]);var io=h('<img alt="Avatar" class="w-10 h-10 rounded-full border-2 border-indigo-500/50 shadow-lg object-cover"/>'),no=h('<div class="w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center text-white border-2 border-indigo-400/30 shadow-lg"><span class="font-bold text-lg"><!></span></div>'),lo=h('<div class="absolute right-0 top-full mt-2 w-48 bg-slate-800 rounded-xl shadow-xl border border-slate-700 p-2 z-50 animate-in fade-in slide-in-from-top-2"><div class="px-3 py-2 border-b border-slate-700 mb-2"><p class="text-xs text-slate-400"> </p> <p class="text-sm font-bold text-white truncate"> </p></div> <button class="w-full flex items-center gap-2 px-3 py-2 text-slate-300 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors text-sm"><!> </button></div>  <div class="fixed inset-0 z-40"></div>',1),co=h('<div class="relative"><button><!> <div class="absolute bottom-1 right-1 w-3 h-3 bg-emerald-500 rounded-full border-2 border-slate-900"></div></button> <!></div>'),vo=h('<div class="w-4 h-4 rounded-full border-2 border-slate-300 border-t-slate-600 animate-spin"></div>'),uo=yr('<svg class="w-4 h-4" viewBox="0 0 24 24"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg>'),po=h("<button><!> <span> </span></button>");function go(f,l){ft(l,!0);const n=()=>Ue(Ke,"$googleSession",i),g=()=>Ue(jt,"$t",i),[i,v]=Ct();let o=gt(l,"className",3,""),u=ke(!1);var m=pe(),s=U(m);{var w=O=>{var ae=co(),q=t(ae);q.__click=()=>b(u,!r(u));var k=t(q);{var I=T=>{var A=io();S(()=>Be(A,"src",n().userProfile.picture)),p(T,A)},D=T=>{var A=no(),W=t(A),X=t(W);{var z=C=>{var $=kr();S(P=>c($,P),[()=>n().userProfile.name[0].toUpperCase()]),p(C,$)},E=C=>{wa(C,{size:20})};y(X,C=>{n().userProfile?.name?C(z):C(E,!1)})}e(W),e(A),p(T,A)};y(k,T=>{n().userProfile?.picture?T(I):T(D,!1)})}Tt(2),e(q);var G=a(q,2);{var L=T=>{var A=lo(),W=U(A),X=t(W),z=t(X),E=t(z,!0);e(z);var C=a(z,2),$=t(C,!0);e(C),e(X);var P=a(X,2);P.__click=()=>{_s(),b(u,!1)};var Q=t(P);Lr(Q,{size:14});var re=a(Q);e(P),e(W);var se=a(W,2);se.__click=()=>b(u,!1),S((ge,oe,$e)=>{c(E,ge),c($,oe),c(re,` ${$e??""}`)},[()=>g()("common.auth.signed_in_as"),()=>n().userProfile?.name??g()("common.auth.user"),()=>g()("common.auth.logout")]),p(T,A)};y(G,T=>{r(u)&&T(L)})}e(ae),S(T=>{Ae(q,1,`flex items-center gap-2 p-1 rounded-full hover:bg-slate-800 transition-colors border border-transparent hover:border-slate-700 ${o()??""}`),Be(q,"title",T)},[()=>n().userProfile?.name||g()("common.auth.user")]),p(O,ae)},M=O=>{var ae=po();ae.__click=function(...L){mr?.apply(this,L)};var q=t(ae);{var k=L=>{var T=vo();p(L,T)},I=L=>{var T=uo();p(L,T)};y(q,L=>{n().isInited?L(I,!1):L(k)})}var D=a(q,2),G=t(D,!0);e(D),e(ae),S(L=>{ae.disabled=!n().isInited,Ae(ae,1,`flex items-center gap-2 px-4 py-2 bg-white text-slate-900 hover:bg-slate-100 rounded-full font-bold text-xs transition-all shadow-lg hover:shadow-xl hover:scale-105 disabled:opacity-50 disabled:cursor-wait disabled:scale-100 disabled:shadow-none ${o()??""}`),c(G,L)},[()=>g()("common.auth.login")]),p(O,ae)};y(s,O=>{n().signedIn?O(w):O(M,!1)})}p(f,m),ht(),v()}bt(["click"]);var fo=h('<span class="w-2 h-2 rounded-full bg-amber-500"></span> <span class="text-amber-400">Auth: Init Failed</span>',1),ho=h('<span class="w-2 h-2 rounded-full bg-amber-500"></span> <span class="text-amber-400">Auth: Not Ready</span>',1),bo=h('<span class="w-2 h-2 rounded-full bg-slate-600"></span> <span> </span>',1),mo=h('<span class="w-2 h-2 rounded-full bg-indigo-500 animate-pulse"></span> <span> </span>',1),_o=h('<span class="w-2 h-2 rounded-full bg-emerald-500"></span> <span> </span>',1),xo=h('<span class="w-2 h-2 rounded-full bg-red-500"></span> <span> </span>',1),wo=h('<span class="w-2 h-2 rounded-full bg-slate-500"></span> <span> </span>',1),yo=h('<div class="mt-1.5 pt-1.5 border-t border-slate-800 text-[9px] text-slate-400 opacity-80 font-medium flex justify-between items-center gap-4"><span> </span> <span> </span></div>'),ko=h('<div class="mt-1 text-[9px] text-slate-400 opacity-60 italic"> </div>'),$o=h('<div class="absolute top-full right-0 mt-3 whitespace-nowrap bg-slate-900/95 backdrop-blur-md text-white text-[10px] font-bold py-2 px-3 rounded-lg shadow-2xl border border-slate-700/50 z-[100] pointer-events-none min-w-[120px]"><div class="flex items-center gap-2"><!></div> <!></div>'),So=h('<div class="relative flex items-center"><button class="flex items-center justify-center p-2 rounded-xl hover:bg-slate-800/50 transition-all active:scale-95 group focus:outline-none"><!></button> <!></div>');function zo(f,l){ft(l,!0);const n=()=>Ue(Ke,"$googleSession",u),g=()=>Ue(jt,"$t",u),i=()=>Ue(Ca,"$authError",u),v=()=>Ue(Ut,"$syncStatus",u),o=()=>Ue(Ya,"$lastSyncTime",u),[u,m]=Ct();let s=ke(!1);function w(G){return new Date(G).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}var M=So(),O=t(M);O.__click=()=>n().signedIn?Ka():mr();var ae=t(O);{var q=G=>{es(G,{size:20,class:"text-amber-500"})},k=G=>{var L=pe(),T=U(L);{var A=X=>{Kr(X,{size:20,class:"text-slate-600 group-hover:text-slate-400"})},W=X=>{var z=pe(),E=U(z);{var C=P=>{Qr(P,{size:20,class:"animate-spin text-indigo-400"})},$=P=>{var Q=pe(),re=U(Q);{var se=oe=>{Wr(oe,{size:20,class:"text-emerald-400 group-hover:text-emerald-300"})},ge=oe=>{var $e=pe(),R=U($e);{var B=he=>{Vr(he,{size:20,class:"text-red-400"})},Z=he=>{Yr(he,{size:20,class:"text-slate-400 group-hover:text-slate-300"})};y(R,he=>{v()==="error"?he(B):he(Z,!1)},!0)}p(oe,$e)};y(re,oe=>{v()==="success"?oe(se):oe(ge,!1)},!0)}p(P,Q)};y(E,P=>{v()==="syncing"?P(C):P($,!1)},!0)}p(X,z)};y(T,X=>{n().signedIn?X(W,!1):X(A)},!0)}p(G,L)};y(ae,G=>{i()?G(q):G(k,!1)})}e(O);var I=a(O,2);{var D=G=>{var L=$o(),T=t(L),A=t(T);{var W=$=>{var P=fo();Tt(2),p($,P)},X=$=>{var P=pe(),Q=U(P);{var re=ge=>{var oe=ho();Tt(2),p(ge,oe)},se=ge=>{var oe=pe(),$e=U(oe);{var R=Z=>{var he=bo(),Ne=a(U(he),2),_e=t(Ne,!0);e(Ne),S(F=>c(_e,F),[()=>g()("common.status.offline")]),p(Z,he)},B=Z=>{var he=pe(),Ne=U(he);{var _e=H=>{var ee=mo(),Le=a(U(ee),2),ie=t(Le,!0);e(Le),S(V=>c(ie,V),[()=>g()("common.status.syncing")]),p(H,ee)},F=H=>{var ee=pe(),Le=U(ee);{var ie=K=>{var Ee=_o(),Me=a(U(Ee),2),Se=t(Me,!0);e(Me),S(Ie=>c(Se,Ie),[()=>g()("common.status.saved")]),p(K,Ee)},V=K=>{var Ee=pe(),Me=U(Ee);{var Se=ue=>{var ne=xo(),xe=a(U(ne),2),Fe=t(xe,!0);e(xe),S(ce=>c(Fe,ce),[()=>g()("common.status.error")]),p(ue,ne)},Ie=ue=>{var ne=wo(),xe=a(U(ne),2),Fe=t(xe,!0);e(xe),S(ce=>c(Fe,ce),[()=>g()("common.status.synced")]),p(ue,ne)};y(Me,ue=>{v()==="error"?ue(Se):ue(Ie,!1)},!0)}p(K,Ee)};y(Le,K=>{v()==="success"?K(ie):K(V,!1)},!0)}p(H,ee)};y(Ne,H=>{v()==="syncing"?H(_e):H(F,!1)},!0)}p(Z,he)};y($e,Z=>{n().signedIn?Z(B,!1):Z(R)},!0)}p(ge,oe)};y(Q,ge=>{i()==="not_initialized"?ge(re):ge(se,!1)},!0)}p($,P)};y(A,$=>{i()==="init_failed"?$(W):$(X,!1)})}e(T);var z=a(T,2);{var E=$=>{var P=yo(),Q=t(P),re=t(Q,!0);e(Q);var se=a(Q,2),ge=t(se,!0);e(se),e(P),S((oe,$e)=>{c(re,oe),c(ge,$e)},[()=>g()("common.status.last_sync"),()=>w(o())]),p($,P)},C=$=>{var P=pe(),Q=U(P);{var re=se=>{var ge=ko(),oe=t(ge,!0);e(ge),S($e=>c(oe,$e),[()=>g()("common.auth.login")]),p(se,ge)};y(Q,se=>{n().signedIn||se(re)},!0)}p($,P)};y(z,$=>{n().signedIn&&o()?$(E):$(C,!1)})}e(L),He(3,L,()=>ot,()=>({duration:150})),p(G,L)};y(I,G=>{r(s)&&G(D)})}e(M),S(G=>Be(O,"aria-label",G),[()=>g()("common.status.label")]),ra("mouseenter",O,()=>b(s,!0)),ra("mouseleave",O,()=>b(s,!1)),ra("focus",O,()=>b(s,!0)),ra("blur",O,()=>b(s,!1)),p(f,M),ht(),m()}bt(["click"]);var Co=h('<span class="text-[10px] text-slate-500 font-medium leading-tight mt-0.5"> </span>'),Eo=h('<div class="flex flex-col"><span> </span> <!></div>'),Po=h('<div class="absolute inset-0 flex items-center justify-center"><div class="w-1.5 h-1.5 rounded-full bg-indigo-600"></div></div>'),No=h("<div><!> <div><div><!></div></div></div>");function lr(f,l){ft(l,!0);let n=gt(l,"checked",3,!1),g=gt(l,"label",3,""),i=gt(l,"description",3,""),v=gt(l,"disabled",3,!1);function o(){v()||l.onToggle(!n())}var u=No();u.__click=o;var m=t(u);{var s=q=>{var k=Eo(),I=t(k),D=t(I,!0);e(I);var G=a(I,2);{var L=T=>{var A=Co(),W=t(A,!0);e(A),S(()=>c(W,i())),p(T,A)};y(G,T=>{i()&&T(L)})}e(k),S(()=>{Ae(I,1,`text-sm font-black uppercase tracking-widest transition-colors ${n()?"text-indigo-400":"text-slate-300 group-hover:text-white"}`),c(D,g())}),p(q,k)};y(m,q=>{(g()||i())&&q(s)})}var w=a(m,2),M=t(w),O=t(M);{var ae=q=>{var k=Po();p(q,k)};y(O,q=>{n()&&q(ae)})}e(M),e(w),e(u),S(()=>{Ae(u,1,`flex items-center justify-between gap-4 p-1 group ${v()?"opacity-50 grayscale":"cursor-pointer"}`),Ae(w,1,`relative w-12 h-6 rounded-full transition-all duration-300 ease-in-out ${n()?"bg-indigo-600 shadow-[0_0_15px_rgba(79,70,229,0.4)]":"bg-slate-800 border border-white/5"}`),Ae(M,1,`absolute top-1 left-1 w-4 h-4 rounded-full bg-white transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)] shadow-md ${n()?"translate-x-6":"translate-x-0"}`)}),p(f,u),ht()}bt(["click"]);var Mo=h('<div class="absolute top-2 right-2 text-primary-400"><!></div>'),Io=h('<button><div class="w-12 h-12 rounded-full shadow-lg relative border-2 border-white/10 overflow-hidden"><div class="absolute inset-0 flex items-center justify-center font-bold text-sm">20</div></div> <span> </span> <!></button>'),To=h('<div class="h-full flex flex-col"><div class="h-48 bg-black/30 rounded-xl relative overflow-hidden shrink-0 mb-4 border border-white/5"><div class="w-full h-full"></div> <div class="absolute bottom-2 left-2 text-xs text-white/50 bg-black/50 px-2 py-1 rounded">Preview</div></div> <div class="flex-1 overflow-y-auto pr-2 custom-scrollbar"><div class="grid grid-cols-2 sm:grid-cols-3 gap-3"></div></div></div>');function jo(f,l){ft(l,!0);const n=()=>Ue(Lt,"$appSettings",g),[g,i]=Ct();let v,o;const u=Object.entries(Oa).map(([k,I])=>({id:k,...I}));let m=ke(xa(n().diceTheme||"default"));Na(async()=>{o=new Er(v,{assetPath:"/assets/dice-box/",scale:6,theme_surface:r(m),theme_customColorset:Oa[r(m)]?.dice,theme_colorset:r(m),gravity_multiplier:400,baseScale:45,strength:1,onRollComplete:()=>{}}),await o.initialize(),await o.showSelector(["d20",{type:"d6",style:"boon"},{type:"d6",style:"bane"}])});async function s(k){b(m,k,!0),Sr(Lt,Ja(n).diceTheme=k,Ja(n));const I=Oa[k];o&&I&&(await o.updateConfig({theme_surface:k,theme_colorset:k,theme_customColorset:I.dice}),await o.showSelector(["d20",{type:"d6",style:"boon"},{type:"d6",style:"bane"}]))}var w=To(),M=t(w),O=t(M);qr(O,k=>v=k,()=>v),Tt(2),e(M);var ae=a(M,2),q=t(ae);dt(q,21,()=>u,St,(k,I)=>{var D=Io();D.__click=()=>s(r(I).id);var G=t(D),L=t(G);e(G);var T=a(G,2);let A;var W=t(T,!0);e(T);var X=a(T,2);{var z=E=>{var C=Mo(),$=t(C);_a($,{size:14}),e(C),p(E,C)};y(X,E=>{r(m)===r(I).id&&E(z)})}e(D),S((E,C)=>{Ae(D,1,`relative group flex flex-col items-center gap-2 p-3 rounded-xl border transition-all duration-200
                    ${r(m)===r(I).id?"bg-primary/20 border-primary/50 ring-1 ring-primary/50":"bg-white/5 border-white/5 hover:bg-white/10 hover:border-white/10"}`),Be(D,"aria-label",`Select theme ${r(I).name??""}`),ba(G,`background: ${E??""};`),ba(L,`color: ${C??""};`),A=Ae(T,1,"text-xs font-medium text-center truncate w-full px-1",null,A,{"text-primary-300":r(m)===r(I).id,"text-zinc-400":r(m)!==r(I).id}),c(W,r(I).name)},[()=>Array.isArray(r(I).dice.background)?r(I).dice.background[0]:r(I).dice.background,()=>Array.isArray(r(I).dice.foreground)?r(I).dice.foreground[0]:r(I).dice.foreground]),p(k,D)}),e(q),e(ae),e(w),p(f,w),ht(),i()}bt(["click"]);var Oo=h('<button class="p-2 -ml-2 hover:bg-white/5 rounded-full text-slate-400 hover:text-white transition-all active:scale-95"><!></button>'),Ao=h('<div class="p-2 bg-indigo-500/10 rounded-xl border border-indigo-500/20"><!></div>'),Do=h('<button class="p-2 hover:bg-white/5 rounded-full text-slate-400 hover:text-white transition-all active:scale-95"><!></button>'),Go=h('<div class="space-y-4"><div class="flex items-center gap-2 mb-2 text-pink-400"><!> <h3 class="text-xs font-black uppercase tracking-widest"> </h3></div> <div class="bg-white/5 rounded-2xl p-4 border border-white/5 h-[500px] overflow-hidden"><!></div></div>'),Bo=h('<button class="absolute right-2 top-1/2 -translate-y-1/2 text-xs text-indigo-400 hover:text-white bg-indigo-500/10 hover:bg-indigo-500 px-2 py-1 rounded transition-all">Google</button>'),Uo=h('<div class="p-4 bg-white/[0.02] border-t border-white/5"><button class="w-full bg-slate-800 hover:bg-slate-700 text-white font-black uppercase tracking-widest py-3 rounded-2xl transition-all active:scale-[0.98] text-sm"> </button></div>'),Lo=h('<div class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] flex items-center justify-center md:p-4"><div class="bg-slate-900 border-white/10 w-full md:max-w-md md:rounded-3xl shadow-2xl overflow-hidden flex flex-col h-full md:h-auto md:max-h-[90vh]"><div class="px-6 py-6 border-b border-white/5 flex items-center justify-between bg-white/[0.02]"><div class="flex items-center gap-3"><!> <div><h2 class="text-lg font-black text-white uppercase tracking-tight"> </h2> <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest"> </p></div></div> <!></div> <div class="flex-1 p-6 space-y-8 overflow-y-auto custom-scrollbar pb-32 md:pb-6 svelte-14b6qd9"><div class="space-y-4"><div class="flex items-center gap-2 mb-2 text-indigo-400"><!> <h3 class="text-xs font-black uppercase tracking-widest"> </h3></div> <div class="space-y-6"><!> <!></div></div> <!> <div class="space-y-4"><div class="flex items-center gap-2 mb-2 text-amber-400"><!> <h3 class="text-xs font-black uppercase tracking-widest"> </h3></div> <div class="grid grid-cols-1 gap-2"><button><div class="flex items-center gap-3"><span class="text-xl">🇧🇷</span> <span class="font-bold">Português (Brasil)</span></div> <!></button> <button><div class="flex items-center gap-3"><span class="text-xl">🇺🇸</span> <span class="font-bold">English (US)</span></div> <!></button></div></div> <div class="space-y-4"><div class="flex items-center gap-2 mb-2 text-indigo-400"><!> <h3 class="text-xs font-black uppercase tracking-widest"> </h3></div> <div class="grid grid-cols-1 gap-4"><div><label for="settings-user-name" class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-1"> </label> <div class="relative"><input id="settings-user-name" type="text" class="w-full bg-slate-800 border border-slate-700 rounded-lg p-3 pr-10 text-white focus:border-indigo-500 outline-none transition-all"/> <!></div></div></div></div> <div class="space-y-4"><div class="flex items-center gap-2 mb-2 text-emerald-400"><!> <h3 class="text-xs font-black uppercase tracking-widest"> </h3></div> <div class="bg-white/5 rounded-2xl p-4 border border-white/5"><div class="flex justify-between items-center opacity-50 cursor-not-allowed"><div class="flex flex-col"><span class="text-sm font-black uppercase tracking-widest text-slate-400"> </span> <span class="text-[10px] text-slate-500"> </span></div> <div class="w-12 h-6 bg-slate-800 rounded-full border border-white/5 p-1 relative"><div class="w-4 h-4 bg-slate-600 rounded-full"></div></div></div></div></div> <div class="pt-4 border-t border-white/5 flex flex-col items-center gap-4 text-center"><p class="text-[10px] text-slate-500 leading-relaxed max-w-[250px]"> </p></div></div> <!></div></div>');function Ro(f,l){ft(l,!0);const n=()=>Ue(jt,"$t",o),g=()=>Ue(Lt,"$appSettings",o),i=()=>Ue(La,"$locale",o),v=()=>Ue(Ke,"$googleSession",o),[o,u]=Ct();let m=gt(l,"isOpen",3,!1),s=ke(!1);Na(()=>{const k=()=>b(s,window.innerWidth<768);return k(),window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)});function w(k,I){Lt.update(D=>({...D,[k]:I}))}function M(k){La.set(k),localStorage.setItem("user_locale",k)}var O=pe(),ae=U(O);{var q=k=>{var I=Lo();I.__click=function(...d){l.onClose?.apply(this,d)};var D=t(I);D.__click=d=>d.stopPropagation();var G=t(D),L=t(G),T=t(L);{var A=d=>{var x=Oo();x.__click=function(...N){l.onClose?.apply(this,N)};var _=t(x);Pr(_,{size:24}),e(x),p(d,x)},W=d=>{var x=Ao(),_=t(x);Va(_,{size:20,class:"text-indigo-400"}),e(x),p(d,x)};y(T,d=>{r(s)?d(A):d(W,!1)})}var X=a(T,2),z=t(X),E=t(z,!0);e(z);var C=a(z,2),$=t(C,!0);e(C),e(X),e(L);var P=a(L,2);{var Q=d=>{var x=Do();x.__click=function(...N){l.onClose?.apply(this,N)};var _=t(x);dr(_,{size:24}),e(x),p(d,x)};y(P,d=>{r(s)||d(Q)})}e(G);var re=a(G,2),se=t(re),ge=t(se),oe=t(ge);Xr(oe,{size:16});var $e=a(oe,2),R=t($e,!0);e($e),e(ge);var B=a(ge,2),Z=t(B);{let d=zt(()=>n()("settings.options.auto_open_history.label")),x=zt(()=>n()("settings.options.auto_open_history.description"));lr(Z,{get checked(){return g().autoOpenHistory},onToggle:_=>w("autoOpenHistory",_),get label(){return r(d)},get description(){return r(x)}})}var he=a(Z,2);{let d=zt(()=>n()("settings.options.enable_3d_dice.label")),x=zt(()=>n()("settings.options.enable_3d_dice.description"));lr(he,{get checked(){return g().enable3DDice},onToggle:_=>w("enable3DDice",_),get label(){return r(d)},get description(){return r(x)}})}e(B),e(se);var Ne=a(se,2);{var _e=d=>{var x=Go(),_=t(x),N=t(_);za(N,{size:16});var Ce=a(N,2),Ve=t(Ce,!0);e(Ce),e(_);var st=a(_,2),Et=t(st);jo(Et,{}),e(st),e(x),S(ct=>c(Ve,ct),[()=>n()("settings.sections.dice_theme")]),He(3,x,()=>Fa),p(d,x)};y(Ne,d=>{g().enable3DDice&&d(_e)})}var F=a(Ne,2),H=t(F),ee=t(H);qa(ee,{size:16});var Le=a(ee,2),ie=t(Le,!0);e(Le),e(H);var V=a(H,2),K=t(V);K.__click=()=>M("pt");var Ee=a(t(K),2);{var Me=d=>{_a(d,{size:18,class:"text-indigo-400"})};y(Ee,d=>{i()==="pt"&&d(Me)})}e(K);var Se=a(K,2);Se.__click=()=>M("en");var Ie=a(t(Se),2);{var ue=d=>{_a(d,{size:18,class:"text-indigo-400"})};y(Ie,d=>{i()==="en"&&d(ue)})}e(Se),e(V),e(F);var ne=a(F,2),xe=t(ne),Fe=t(xe);wa(Fe,{size:16});var ce=a(Fe,2),we=t(ce,!0);e(ce),e(xe);var j=a(xe,2),ze=t(j),Pe=t(ze),Re=t(Pe,!0);e(Pe);var le=a(Pe,2),Y=t(le);tt(Y),Y.__input=d=>w("userName",d.currentTarget.value);var te=a(Y,2);{var De=d=>{var x=Bo();x.__click=()=>w("userName",v().userProfile?.name),p(d,x)};y(te,d=>{!g().userName&&v().userProfile&&d(De)})}e(le),e(ze),e(j),e(ne);var J=a(ne,2),ve=t(J),Te=t(ve);Zr(Te,{size:16});var Ge=a(Te,2),rt=t(Ge,!0);e(Ge),e(ve);var Ye=a(ve,2),be=t(Ye),me=t(be),de=t(me),fe=t(de,!0);e(de);var ye=a(de,2),We=t(ye,!0);e(ye),e(me),Tt(2),e(be),e(Ye),e(J);var Oe=a(J,2),je=t(Oe),Je=t(je,!0);e(je),e(Oe),e(re);var it=a(re,2);{var ut=d=>{var x=Uo(),_=t(x);_.__click=function(...Ce){l.onClose?.apply(this,Ce)};var N=t(_,!0);e(_),e(x),S(Ce=>c(N,Ce),[()=>n()("common.buttons.close")]),p(d,x)};y(it,d=>{r(s)||d(ut)})}e(D),e(I),S((d,x,_,N,Ce,Ve,st,Et,ct,Xe,yt)=>{c(E,d),c($,x),c(R,_),c(ie,N),Ae(K,1,`flex items-center justify-between px-4 py-3 rounded-2xl border transition-all ${i()==="pt"?"bg-indigo-600/10 border-indigo-500/50 text-white":"bg-white/5 border-white/5 text-slate-400 hover:bg-white/10"}`),Ae(Se,1,`flex items-center justify-between px-4 py-3 rounded-2xl border transition-all ${i()==="en"?"bg-indigo-600/10 border-indigo-500/50 text-white":"bg-white/5 border-white/5 text-slate-400 hover:bg-white/10"}`),c(we,Ce),c(Re,Ve),Be(Y,"placeholder",st),$r(Y,g().userName||""),c(rt,Et),c(fe,ct),c(We,Xe),c(Je,yt)},[()=>n()("settings.title"),()=>n()("settings.description"),()=>n()("settings.sections.interface"),()=>n()("common.labels.language")||"Language",()=>n()("settings.sections.identity"),()=>n()("settings.options.user_name.label"),()=>n()("settings.options.user_name.placeholder"),()=>n()("settings.sections.appearance"),()=>n()("settings.options.theme.label"),()=>n()("settings.options.theme.description"),()=>n()("settings.sync_info")]),He(1,D,()=>va,()=>r(s)?{x:"100%",duration:600,easing:ca}:{y:20,duration:300}),He(2,D,()=>va,()=>r(s)?{x:"100%",duration:600,easing:ca}:{y:20,duration:300}),He(3,I,()=>ot,()=>({duration:200})),p(k,I)};y(ae,k=>{m()&&k(q)})}p(f,O),ht(),u()}bt(["click","input"]);var Fo=h('<span class="text-[10px] text-slate-400 font-medium"> </span>'),Ho=h('<div class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hover:border-indigo-500/40 transition-all relative group flex flex-col shadow-lg hover:shadow-indigo-500/10 border-t-white/5"><div class="flex justify-between items-start mb-4"><div class="flex-1"><h3 class="font-black text-xl text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate pr-16"> </h3> <div class="flex items-center gap-2 mt-1 flex-wrap"><span class="text-[10px] bg-indigo-500/10 text-indigo-400 font-black px-2 py-0.5 rounded uppercase tracking-wider"> </span> <span class="text-[10px] text-slate-500 font-bold uppercase tracking-widest"> </span> <!></div> <div class="mt-2 flex items-center gap-2"><div class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800 text-[9px] text-slate-400 border border-slate-700 font-bold uppercase tracking-wider"><!> </div></div></div> <div class="flex items-center gap-1"><button class="text-slate-700 hover:text-indigo-400 p-2 rounded-xl hover:bg-indigo-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button> <button class="text-slate-700 hover:text-red-400 p-2 rounded-xl hover:bg-red-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button></div></div> <div class="space-y-3 mb-6"><div class="flex items-center justify-between text-xs text-slate-400"><span class="flex items-center gap-1.5 opacity-60"><!> </span> <span class="font-bold text-slate-300 truncate max-w-[150px]"> </span></div></div> <button class="w-full bg-slate-800 hover:bg-indigo-600 text-white py-3 rounded-2xl font-bold transition-all active:scale-[0.98] border border-slate-700 hover:border-indigo-400/30 flex items-center justify-center gap-2"> <!></button></div>'),Wo=h('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 col-start-1 row-start-1 w-full"><!> <button class="h-full min-h-[160px] border-2 border-dashed border-slate-800 rounded-3xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-500 transition-all hover:bg-indigo-500/5 gap-2 group shadow-sm bg-slate-900/20"><div class="w-12 h-12 rounded-full bg-slate-800 flex items-center justify-center group-hover:bg-indigo-500/10 group-hover:scale-110 transition-all"><!></div> <span class="font-bold"> </span></button></div>'),qo=h('<span class="text-[9px] bg-emerald-500/10 text-emerald-400 px-2 py-0.5 rounded-full border border-emerald-500/20 font-black uppercase tracking-widest flex items-center gap-1"><!> </span>'),Vo=h('<div class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hover:border-indigo-500/40 transition-all group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10 border-t-white/5"><div class="mb-4"><div class="flex justify-between items-start mb-1"><h3 class="font-black text-2xl text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight"> </h3> <div class="flex items-center gap-1"><!> <button class="text-slate-700 hover:text-indigo-400 p-2 rounded-xl hover:bg-indigo-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button> <button class="text-slate-700 hover:text-red-400 p-2 rounded-xl hover:bg-red-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button></div></div> <p class="text-indigo-400 text-[10px] font-black uppercase tracking-[0.2em] mb-3"> </p> <div class="mb-3"><div class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800 text-[9px] text-slate-400 border border-slate-700 font-bold uppercase tracking-wider"><!> </div></div> <p class="text-sm text-slate-400 line-clamp-2 leading-relaxed h-10"> </p></div> <button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-2xl font-bold flex items-center justify-center gap-2 border border-indigo-400/20 shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98]"><!> </button></div>'),Ko=h('<div class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hover:border-emerald-500/40 transition-all group relative flex flex-col justify-between shadow-xl border-t-white/5"><div><h3 class="font-black text-2xl text-white group-hover:text-emerald-400 mb-2 uppercase tracking-tight"> </h3> <div class="flex items-center gap-2 mb-4"><div class="px-2 py-0.5 bg-slate-800 rounded text-[9px] text-slate-400 font-black uppercase tracking-widest"> </div> <div class="flex items-center gap-1 px-2 py-0.5 bg-emerald-500/10 rounded text-[9px] text-emerald-400 font-black uppercase tracking-wider"><div class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></div> </div></div> <div class="mb-4"><div class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800/50 text-[9px] text-slate-400 border border-slate-700/50 font-bold uppercase tracking-wider"><!> </div></div> <p class="text-sm text-slate-400 line-clamp-3 leading-relaxed mb-6 h-15"> </p></div> <button class="w-full bg-emerald-600 hover:bg-emerald-500 text-white py-3 rounded-2xl font-black uppercase text-xs tracking-[0.1em] flex items-center justify-center gap-2 border border-emerald-400/20 transition-all active:scale-[0.98] group"> <!></button></div>'),Yo=h('<div class="col-span-full py-12 flex flex-col items-center text-center opacity-40"><div class="w-16 h-16 bg-slate-800/50 rounded-full flex items-center justify-center text-slate-600 mb-3 border border-slate-700 border-dashed"><!></div> <h3 class="text-lg font-black uppercase tracking-widest text-slate-500"> </h3> <p class="text-slate-600 max-w-sm mt-2 text-sm"> </p></div>'),Jo=h('<div class="space-y-8 col-start-1 row-start-1 w-full"><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><!> <button class="h-full min-h-[160px] border-2 border-dashed border-slate-800 rounded-3xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-500 transition-all hover:bg-indigo-500/5 gap-2 group shadow-sm bg-slate-900/20"><div class="w-12 h-12 rounded-full bg-slate-800 flex items-center justify-center group-hover:bg-indigo-500/10 group-hover:scale-110 transition-all"><!></div> <span class="font-bold"> </span></button></div> <div><div class="flex items-center gap-3 mb-4"><div class="h-px flex-1 bg-slate-800"></div> <h3 class="text-xs font-black uppercase tracking-widest text-emerald-400 flex items-center gap-2"><!> </h3> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><!> <!></div></div></div>'),Xo=h('<div class="fixed top-0 left-0 w-full flex justify-center items-center pointer-events-none z-[100] transition-all duration-300"><div class="bg-indigo-600 rounded-full p-2.5 shadow-xl border border-indigo-500/50 text-white"><!></div></div> <div class="animate-in fade-in px-4 md:px-8 max-w-7xl mx-auto pb-32 md:pb-20"><header class="mb-8 flex justify-between items-center border-b border-slate-800/50 pt-4 md:pt-8 pb-4 sticky top-0 bg-slate-950/80 backdrop-blur-md z-40 -mx-4 px-4 md:-mx-8 md:px-8 transition-all"><div class="flex items-center gap-3"><img alt="Schwalb Vault Logo" class="h-10 md:h-14 w-auto rounded-xl"/> <h1 class="text-xl md:text-3xl font-bold text-white flex items-center gap-2 text-gradient m-0 leading-none"><span class="hidden md:inline">Schwalb Vault</span> <span class="md:hidden">Schwalb Vault</span></h1></div> <div class="hidden md:flex absolute left-1/2 -translate-x-1/2 bg-slate-900/50 p-1.5 rounded-2xl border border-slate-800 glass shadow-xl backdrop-blur-md"><div class="relative flex"><div class="absolute inset-y-0 w-1/2 bg-indigo-600 rounded-xl transition-transform duration-300 ease-out shadow-lg shadow-indigo-500/20"></div> <button><!> </button> <button><!> </button></div></div> <div class="flex items-center justify-end min-w-[40px] gap-3"><!> <button class="p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-all"><!></button> <!></div></header> <div class="md:hidden fixed bottom-0 left-0 right-0 bg-slate-900/90 backdrop-blur-xl border-t border-slate-800 shadow-2xl rounded-t-2xl z-50 p-2 pb-safe"><div class="relative flex justify-between"><div class="absolute inset-y-0 w-1/2 bg-indigo-600/20 rounded-xl transition-transform duration-300 ease-out"></div> <button><!> <span class="transition-all duration-300"> </span></button> <button><!> <span class="transition-all duration-300"> </span></button></div></div> <div class="min-h-[500px] grid items-start relative"><!></div> <!> <!> <!> <!> <!> <!> <!></div>',1);function Zo(f,l){ft(l,!0);const n=()=>Ue(Ke,"$googleSession",u),g=()=>Ue(vr,"$liveCharacters",u),i=()=>Ue(Ha,"$liveCampaigns",u),v=()=>Ue(jt,"$t",u),o=()=>Ue(Tr,"$publicCampaigns",u),[u,m]=Ct();let s=ke(0),w=ke(0),M=ke(!1),O=ke(!1);const ae=80;function q(d){window.scrollY===0&&(b(s,d.touches[0].clientY,!0),b(M,!0))}function k(d){if(!r(M))return;const _=d.touches[0].clientY-r(s);_>0&&window.scrollY<=0?b(w,Math.min(_*.4,120),!0):(b(M,!1),b(w,0))}async function I(){if(r(M))if(b(M,!1),r(w)>ae){b(O,!0),b(w,60);try{navigator&&navigator.vibrate&&navigator.vibrate(50),await Ka()}finally{setTimeout(()=>{b(O,!1),b(w,0)},1e3)}}else b(w,0)}Na(()=>{ms();const d=localStorage.getItem("user_locale");return d&&La.set(d),document.addEventListener("touchmove",k,{passive:!1}),()=>{document.removeEventListener("touchmove",k)}});let D=ke("characters"),G=ke("characters"),L=ke(!1);ia(()=>{r(D)!==r(G)&&b(G,r(D),!0)}),ia(()=>{n().signedIn&&Ka()}),ia(()=>{n().signedIn&&(g(),i(),Ua())});let T=ke(!1),A=ke(null);function W(d){b(A,d,!0),b(T,!0)}function X(d){if(!r(A))return;const x=r(A).id,N={...et.get(x),...d};et.set(x,N),b(T,!1)}let z=ke(!1),E=ke(!1),C="{}";function $(){b(E,!0)}async function P(d){const x=d.id||Za(),_=et.get(x)||{};let N;d.system==="sofdl"?N={..._,id:x,system:"sofdl",name:d.name,playerName:d.playerName||"",ancestry:d.ancestry,level:d.level,attributes:d.attributes||_.attributes||{strength:10,agility:10,intellect:10,will:10},perception:d.perception||_.perception||10,defense:d.defense||10,health:d.health||10,healingRate:d.healingRate||_.healingRate||Math.floor((d.health||10)/4),size:_.size||1,speed:_.speed||10,power:_.power||0,damage:_.damage||0,insanity:_.insanity||0,corruption:_.corruption||0,description:_.description||"",notes:_.notes||"",paths:d.paths||_.paths||{novice:d.novicePath||"",expert:"",master:""},professions:d.professions||_.professions||(d.profession?[d.profession]:[]),languages:_.languages||["Common"],talents:_.talents||[],spells:_.spells||[],equipment:_.equipment||[],effects:_.effects||[]}:(N={..._,id:x,name:d.name,playerName:d.playerName||"",ancestry:d.ancestry,level:d.level,defense:d.defense,system:d.system||oa,paths:d.paths||_.paths||{novice:d.novicePath||"-",expert:"-",master:"-"},attributes:_.attributes||[{name:v()("modals.mod_targets.str"),value:10,key:"str"},{name:v()("modals.mod_targets.agi"),value:10,key:"agi"},{name:v()("modals.mod_targets.int"),value:10,key:"int"},{name:v()("modals.mod_targets.wil"),value:10,key:"wil"}],speed:_.speed||5,health:d.health,currentHealth:_.currentHealth||d.health,spells:_.spells||[],talents:_.talents||[],equipment:_.equipment||[],afflictions:_.afflictions||[],effects:_.effects||[],currency:_.currency||{gp:0,sp:0,cp:0},languages:_.languages||["Common"]},d.profession&&!N.professions?.includes(d.profession)&&(N.professions=[...N.professions||[],d.profession])),et.set(x,N),b(z,!1),b(E,!1),$a(sa("/characters/[id]",{id:x}))}let Q=ke(!1),re=ke(!1),se=ke(null),ge=ke("{}");function oe(d=null){d?(b(se,d.id,!0),b(ge,JSON.stringify(d),!0),b(Q,!0)):b(re,!0)}async function $e(d){const x=r(se)||Za(),_=r(se)?Qe.get(x):{},N={..._,id:x,name:d.name,description:d.description,gmName:d.gmName,players:_.players||[],backupEnabled:d.backupEnabled||!1,backupHash:d.backupHash||"",system:d.system||oa};d.removePassword?delete N.passwordHash:d.password&&(N.passwordHash=await Hr(d.password)),Qe.set(x,N),b(Q,!1),b(re,!1)}let R=ke(!1),B=ke(xa({title:"",message:"",onConfirm:()=>{}}));function Z(d){b(B,{title:v()("dashboard.campaigns.delete_title"),message:v()("dashboard.campaigns.delete_message"),onConfirm:()=>{console.log("[DEBUG] Deleting campaign with ID:",d);let x=0;for(const _ of Qe.keys()){const N=Qe.get(_);(_===d||N&&N.id===d)&&(console.log("[DEBUG] Found match for deletion - Key:",_,"Camp ID:",N?.id),Qe.delete(_),x++)}console.log("[DEBUG] Total entries deleted from map:",x),Zt.set(d,{type:"campaign",deletedAt:Date.now()}),console.log("[DEBUG] Deletion tracked in deletedIdsMap"),Ua(),b(R,!1)}},!0),b(R,!0)}function he(d){b(B,{title:v()("dashboard.characters.delete_title"),message:v()("dashboard.characters.delete_message"),onConfirm:()=>{lt(Ha).forEach(N=>{let Ce=!1;N.members&&N.members.some(Ve=>Ve.id===d)&&(N.members=N.members.filter(Ve=>Ve.id!==d),Ce=!0),N.sessionRoster&&N.sessionRoster.includes(d)&&(N.sessionRoster=N.sessionRoster.filter(Ve=>Ve!==d),Ce=!0),N.activeEnemies&&N.activeEnemies.some(Ve=>Ve.id===d)&&(N.activeEnemies=N.activeEnemies.filter(Ve=>Ve.id!==d),Ce=!0),Ce&&Qe.set(N.id,N)}),console.log("[DEBUG] Deleting character with ID:",d);let _=0;for(const N of et.keys()){const Ce=et.get(N);(N===d||Ce&&Ce.id===d)&&(console.log("[DEBUG] Found match for deletion - Key:",N,"Char ID:",Ce?.id),et.delete(N),_++)}console.log("[DEBUG] Total entries deleted from map:",_),Zt.set(d,{type:"character",deletedAt:Date.now()}),console.log("[DEBUG] Deletion tracked in deletedIdsMap"),Ua(),b(R,!1)}},!0),b(R,!0)}var Ne=Xo();ra("touchstart",ja,q),ra("touchmove",ja,k),ra("touchend",ja,I);var _e=U(Ne),F=t(_e),H=t(F);{let d=zt(()=>r(O)?"animate-spin":""),x=zt(()=>r(w)*2);Jr(H,{get class(){return r(d)},size:20,get style(){return`transform: rotate(${r(x)??""}deg)`}})}e(F),e(_e);var ee=a(_e,2),Le=t(ee),ie=t(Le),V=t(ie);Tt(2),e(ie);var K=a(ie,2),Ee=t(K),Me=t(Ee),Se=a(Me,2);Se.__click=()=>b(D,"characters");var Ie=t(Se);Qa(Ie,{size:18});var ue=a(Ie);e(Se);var ne=a(Se,2);ne.__click=()=>b(D,"campaigns");var xe=t(ne);Ga(xe,{size:18});var Fe=a(xe);e(ne),e(Ee),e(K);var ce=a(K,2),we=t(ce);zo(we,{});var j=a(we,2);j.__click=()=>b(L,!0);var ze=t(j);Va(ze,{size:20}),e(j);var Pe=a(j,2);go(Pe,{}),e(ce),e(Le);var Re=a(Le,2),le=t(Re),Y=t(le),te=a(Y,2);te.__click=()=>b(D,"characters");var De=t(te);{let d=zt(()=>r(D)==="characters"?2.5:2);Qa(De,{size:20,get strokeWidth(){return r(d)},class:"transition-all duration-300"})}var J=a(De,2),ve=t(J,!0);e(J),e(te);var Te=a(te,2);Te.__click=()=>b(D,"campaigns");var Ge=t(Te);{let d=zt(()=>r(D)==="campaigns"?2.5:2);Ga(Ge,{size:20,get strokeWidth(){return r(d)},class:"transition-all duration-300"})}var rt=a(Ge,2),Ye=t(rt,!0);e(rt),e(Te),e(le),e(Re);var be=a(Re,2),me=t(be);{var de=d=>{var x=Wo(),_=t(x);dt(_,1,g,ct=>ct.id,(ct,Xe)=>{var yt=Ho(),Rt=t(yt),Ft=t(Rt),Qt=t(Ft),na=t(Qt,!0);e(Qt);var Ht=a(Qt,2),pa=t(Ht),Ia=t(pa,!0);e(pa);var Ze=a(pa,2),qe=t(Ze);e(Ze);var vt=a(Ze,2);{var kt=It=>{var Gt=Fo(),Bt=t(Gt);e(Gt),S(()=>c(Bt,`• ${r(Xe).playerName??""}`)),p(It,Gt)};y(vt,It=>{r(Xe).playerName&&It(kt)})}e(Ht);var nt=a(Ht,2),Pt=t(nt),$t=t(Pt);Sa($t,{size:10});var Nt=a($t);e(Pt),e(nt),e(Ft);var Ot=a(Ft,2),pt=t(Ot);pt.__click=()=>W(r(Xe));var At=t(pt);Va(At,{size:16}),e(pt);var Mt=a(pt,2);Mt.__click=()=>he(r(Xe).id);var Dt=t(Mt);Xa(Dt,{size:16}),e(Mt),e(Ot),e(Rt);var Wt=a(Rt,2),qt=t(Wt),Vt=t(qt),Kt=t(Vt);Ga(Kt,{size:12});var Yt=a(Kt);e(Vt);var Jt=a(Vt,2),ga=t(Jt,!0);e(Jt),e(qt),e(Wt);var Xt=a(Wt,2);Xt.__click=()=>$a(sa("/characters/[id]",{id:r(Xe).id}));var la=t(Xt),ea=a(la);er(ea,{size:14,fill:"currentColor"}),e(Xt),e(yt),S((It,Gt,Bt,ta,da,fa)=>{c(na,r(Xe).name),c(Ia,r(Xe).ancestry||"Human"),c(qe,`${It??""} ${r(Xe).level??""}`),c(Nt,` ${Gt??""}`),Be(pt,"title",Bt),Be(Mt,"title",ta),c(Yt,` ${da??""}`),c(ga,r(Xe).paths?.novice||"-"),c(la,`${fa??""} `)},[()=>v()("common.labels.level"),()=>v()(Da(r(Xe).system).nameKey),()=>v()("common.buttons.settings"),()=>v()("common.buttons.delete"),()=>v()("dashboard.characters.paths"),()=>v()("dashboard.characters.open_sheet")]),p(ct,yt)});var N=a(_,2);N.__click=()=>$();var Ce=t(N),Ve=t(Ce);Aa(Ve,{size:32}),e(Ce);var st=a(Ce,2),Et=t(st,!0);e(st),e(N),e(x),S(ct=>c(Et,ct),[()=>v()("dashboard.characters.new_character")]),He(1,x,()=>va,()=>({x:-100,duration:300,easing:ca})),He(2,x,()=>va,()=>({x:-100,duration:300,easing:ca})),p(d,x)},fe=d=>{var x=Jo(),_=t(x),N=t(_);dt(N,1,i,Ze=>Ze.id,(Ze,qe)=>{var vt=Vo(),kt=t(vt),nt=t(kt),Pt=t(nt),$t=t(Pt,!0);e(Pt);var Nt=a(Pt,2),Ot=t(Nt);{var pt=Bt=>{var ta=qo(),da=t(ta);qa(da,{size:10});var fa=a(da);e(ta),S(Ta=>c(fa,` ${Ta??""}`),[()=>v()("dashboard.campaigns.published")]),p(Bt,ta)};y(Ot,Bt=>{r(qe).isPublished&&Bt(pt)})}var At=a(Ot,2);At.__click=()=>oe(r(qe));var Mt=t(At);Nr(Mt,{size:16}),e(At);var Dt=a(At,2);Dt.__click=()=>Z(r(qe).id);var Wt=t(Dt);Xa(Wt,{size:16}),e(Dt),e(Nt),e(nt);var qt=a(nt,2),Vt=t(qt,!0);e(qt);var Kt=a(qt,2),Yt=t(Kt),Jt=t(Yt);Sa(Jt,{size:10});var ga=a(Jt);e(Yt),e(Kt);var Xt=a(Kt,2),la=t(Xt,!0);e(Xt),e(kt);var ea=a(kt,2);ea.__click=()=>$a(sa("/campaigns/[id]",{id:r(qe).id}));var It=t(ea);er(It,{size:18,fill:"currentColor"});var Gt=a(It);e(ea),e(vt),S((Bt,ta,da,fa,Ta,xr)=>{c($t,r(qe).name),Be(At,"title",Bt),Be(Dt,"title",ta),c(Vt,da),c(ga,` ${fa??""}`),c(la,Ta),c(Gt,` ${xr??""}`)},[()=>v()("common.buttons.edit"),()=>v()("common.buttons.delete"),()=>r(qe).gmName||v()("common.labels.master"),()=>v()(Da(r(qe).system||oa).nameKey),()=>r(qe).description||v()("dashboard.campaigns.no_description"),()=>v()("dashboard.campaigns.start_session")]),p(Ze,vt)});var Ce=a(N,2);Ce.__click=()=>oe();var Ve=t(Ce),st=t(Ve);Aa(st,{size:32}),e(Ve);var Et=a(Ve,2),ct=t(Et,!0);e(Et),e(Ce),e(_);var Xe=a(_,2),yt=t(Xe),Rt=a(t(yt),2),Ft=t(Rt);qa(Ft,{size:14});var Qt=a(Ft);e(Rt),Tt(2),e(yt);var na=a(yt,2),Ht=t(na);dt(Ht,1,o,Ze=>Ze.id,(Ze,qe)=>{var vt=Ko(),kt=t(vt),nt=t(kt),Pt=t(nt,!0);e(nt);var $t=a(nt,2),Nt=t($t),Ot=t(Nt,!0);e(Nt);var pt=a(Nt,2),At=a(t(pt));e(pt),e($t);var Mt=a($t,2),Dt=t(Mt),Wt=t(Dt);Sa(Wt,{size:10});var qt=a(Wt);e(Dt),e(Mt);var Vt=a(Mt,2),Kt=t(Vt,!0);e(Vt),e(kt);var Yt=a(kt,2);Yt.__click=()=>$a(sa("/campaigns/[id]/invite",{id:r(qe).id}));var Jt=t(Yt),ga=a(Jt);Aa(ga,{size:18,class:"group-hover:rotate-90 transition-transform"}),e(Yt),e(vt),S((Xt,la,ea,It,Gt)=>{c(Pt,r(qe).name),c(Ot,Xt),c(At,` ${la??""}`),c(qt,` ${ea??""}`),c(Kt,It),c(Jt,`${Gt??""} `)},[()=>r(qe).gmName||v()("common.labels.master"),()=>v()("dashboard.campaigns.online"),()=>v()(Da(r(qe).system||oa).nameKey),()=>r(qe).description||v()("dashboard.campaigns.public_description"),()=>v()("dashboard.campaigns.join_adventure")]),p(Ze,vt)});var pa=a(Ht,2);{var Ia=Ze=>{var qe=Yo(),vt=t(qe),kt=t(vt);Or(kt,{size:32}),e(vt);var nt=a(vt,2),Pt=t(nt,!0);e(nt);var $t=a(nt,2),Nt=t($t,!0);e($t),e(qe),S((Ot,pt)=>{c(Pt,Ot),c(Nt,pt)},[()=>v()("dashboard.campaigns.no_online_campaigns"),()=>v()("dashboard.campaigns.no_online_description")]),p(Ze,qe)};y(pa,Ze=>{o().length===0&&Ze(Ia)})}e(na),e(Xe),e(x),S((Ze,qe)=>{c(ct,Ze),c(Qt,` ${qe??""}`)},[()=>v()("dashboard.campaigns.new_campaign"),()=>v()("dashboard.campaigns.public_campaigns")]),He(1,x,()=>va,()=>({x:100,duration:300,easing:ca})),He(2,x,()=>va,()=>({x:100,duration:300,easing:ca})),p(d,x)};y(me,d=>{r(D)==="characters"?d(de):d(fe,!1)})}e(be);var ye=a(be,2);eo(ye,{get isOpen(){return r(E)},onClose:()=>b(E,!1),onSave:P});var We=a(ye,2);Ms(We,{get isOpen(){return r(re)},onClose:()=>b(re,!1),onSave:$e});var Oe=a(We,2);Ts(Oe,{get isOpen(){return r(z)},initialData:C,onClose:()=>b(z,!1),onSave:P});var je=a(Oe,2);Br(je,{get isOpen(){return r(Q)},get initialData(){return r(ge)},onClose:()=>b(Q,!1),onSave:$e});var Je=a(je,2);Gr(Je,{get isOpen(){return r(R)},get title(){return r(B).title},get message(){return r(B).message},get onConfirm(){return r(B).onConfirm},onCancel:()=>b(R,!1)});var it=a(Je,2);oo(it,{get isOpen(){return r(T)},get characterData(){return r(A)},onClose:()=>b(T,!1),onSave:X});var ut=a(it,2);Ro(ut,{get isOpen(){return r(L)},onClose:()=>b(L,!1)}),e(ee),S((d,x,_,N,Ce)=>{ba(_e,`transform: translateY(${(r(O)?60:r(w))??""}px); opacity: ${r(w)>0?1:0}`),Be(V,"src",`${jr??""}/logo-black.webp`),ba(Me,`transform: translateX(${r(D)==="campaigns"?"100%":"0%"})`),Ae(Se,1,`relative z-10 px-6 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 flex items-center gap-2 ${r(D)==="characters"?"text-white":"text-slate-400 hover:text-white"}`),c(ue,` ${d??""}`),Ae(ne,1,`relative z-10 px-6 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 flex items-center gap-2 ${r(D)==="campaigns"?"text-white":"text-slate-400 hover:text-white"}`),c(Fe,` ${x??""}`),Be(j,"title",_),ba(Y,`transform: translateX(${r(D)==="campaigns"?"100%":"0%"})`),Ae(te,1,`relative flex-1 py-3 rounded-xl text-xs font-bold transition-all duration-300 flex flex-col items-center justify-center gap-1 z-10 ${r(D)==="characters"?"text-indigo-400":"text-slate-500"}`),c(ve,N),Ae(Te,1,`relative flex-1 py-3 rounded-xl text-xs font-bold transition-all duration-300 flex flex-col items-center justify-center gap-1 z-10 ${r(D)==="campaigns"?"text-indigo-400":"text-slate-500"}`),c(Ye,Ce)},[()=>v()("dashboard.tabs.characters"),()=>v()("dashboard.tabs.campaigns"),()=>v()("settings.title"),()=>v()("dashboard.tabs.characters"),()=>v()("dashboard.tabs.campaigns")]),p(f,Ne),ht(),m()}bt(["click"]);var Qo=h("<!> <!>",1);function $i(f){var l=Qo(),n=U(l);ls(n,{});var g=a(n,2);Zo(g,{}),p(f,l)}export{$i as component};
