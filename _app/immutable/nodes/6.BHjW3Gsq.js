const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/CdkHlkWG.js","../chunks/Bs3V2B0j.js","../chunks/DfayzYqb.js","../chunks/Cx0o8vWd.js"])))=>i.map(i=>d[i]);
import{_ as Ve}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import{d as We,o as qe,s as l}from"../chunks/Cx0o8vWd.js";import{w as Be,j as g,v as K,x as r,y as s,t as x,k as f,z as Ye,A as u,B as e,D as j,E as C,F as i,u as Qe,G as Xe}from"../chunks/DfayzYqb.js";import{e as Ze,$ as et,s as fe,i as tt,r as at,a as rt}from"../chunks/Bs3V2B0j.js";import{i as w}from"../chunks/C746LlRB.js";import{c as it,j as st,i as ot,b as nt}from"../chunks/CBXs46KE.js";import{s as P,a as lt}from"../chunks/DukWTdxy.js";import{p as dt}from"../chunks/BA-_nZYE.js";import{l as vt}from"../chunks/COIJJyGo.js";import{G as xe,C as ct,g as ie,D as W}from"../chunks/DXWhg5s7.js";import{g as ue}from"../chunks/C8s4V3gi.js";import{U as mt,r as ge,C as pt,W as _t}from"../chunks/BCFArNzm.js";import{v as ft}from"../chunks/BYmFNSF7.js";import{T as be}from"../chunks/STxRiL7d.js";var xt=g('<span class="block text-xs mt-1 uppercase tracking-widest text-slate-500 font-black"> </span>'),ut=g('<div class="mt-4 px-3 py-1 bg-amber-500/10 border border-amber-500/20 rounded-full text-[10px] text-amber-500 font-bold uppercase tracking-wider animate-pulse flex items-center gap-2"><!> </div>'),gt=g('<div class="mb-6 bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center gap-3"><!> <p class="text-red-400 text-sm font-bold"> </p></div>'),bt=g('<p class="text-red-400 text-xs mt-1"> </p>'),ht=g('<div class="mb-6 bg-slate-950/50 p-4 rounded-xl border border-slate-800"><label for="campaign-pwd-input" class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-indigo-500 animate-pulse"></div> </label> <input id="campaign-pwd-input" type="password"/> <!></div>'),wt=g('<button><div class="w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-xs font-bold"> </div> <div class="flex-1 text-left"><div class="font-bold text-sm"> </div> <div class="text-[10px] opacity-60 flex items-center gap-1"> <span class="w-1 h-1 rounded-full bg-slate-600"></span> <!> </div></div> <!></button>'),yt=g("<div> </div> <div> </div>",1),$t=g('<div class="text-xs text-slate-500 max-w-[200px]"> </div>'),kt=g('<div class="text-xs text-slate-500"> </div>'),Ct=g('<div class="flex flex-col items-center gap-2"><!> <div class="text-amber-500 font-bold"> </div> <!></div>'),zt=g('<div class="text-center py-8 text-slate-600 italic text-sm space-y-2"><!></div>'),It=g('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> ',1),jt=g('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> ',1),Et=g('<div class="min-h-screen bg-slate-950 flex items-center justify-center p-4"><div class="max-w-md w-full bg-slate-900 border border-slate-800 rounded-2xl p-8 shadow-2xl"><div class="flex flex-col items-center text-center mb-8"><div class="w-16 h-16 bg-indigo-600/20 rounded-full flex items-center justify-center text-indigo-400 mb-4 border border-indigo-500/30"><!></div> <h1 class="text-2xl font-bold text-white mb-2"> </h1> <p class="text-slate-400"> <span class="text-indigo-400 font-bold"> </span> <!></p> <div class="mt-4 inline-flex items-center gap-1.5 px-3 py-1 rounded bg-slate-800 text-[10px] text-slate-400 border border-slate-700 font-bold uppercase tracking-wider"><!> </div> <!></div> <!> <!> <div class="space-y-4 mb-8"><label for="char-selector" class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2"> </label> <div id="char-selector" class="space-y-2 max-h-60 overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div> <div class="flex gap-3"><button class="flex-1 py-3 rounded-xl bg-slate-800 hover:bg-slate-700 text-white font-bold transition-all"> </button> <button class="flex-1 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold transition-all shadow-lg shadow-indigo-900/20 flex items-center justify-center gap-2"><!></button></div></div></div> <!>',1);function Rt(he,we){Be(we,!0);const ye=()=>P(dt,"$page",E),U=()=>P(it,"$character",E),n=()=>P(et,"$t",E),z=()=>P(vt,"$liveCharacters",E),$e=()=>P(ot,"$isGmOnline",E),[E,ke]=lt(),G=ye().params.id;let N=C(()=>U().campaignName||n()("invite.searching")),q=C(()=>U().gmName||"..."),F=C(()=>U().passwordHash),H=C(()=>U().system||W),se=C(()=>z().filter(a=>!a.campaignId&&(a.system||W)===e(H))),Ce=C(()=>z().some(a=>!a.campaignId&&(a.system||W)!==e(H))),h=j(null),J=j(!1),A=j(""),M=j(!1),L=j(!1),I=j("");qe(()=>{G&&st(G,!1)});async function ze(){if(u(I,""),!e(h)||!G)return;if(z().find(t=>t.id===e(h))?.campaignId){u(I,n()("invite.already_in_campaign"),!0);return}if(e(F)){if(!e(A)){u(M,!0);return}u(L,!0);const t=await ft(e(A),e(F));if(u(L,!1),!t){u(M,!0);return}}u(M,!1),u(J,!0)}function Ie(){if(!e(h)||!G)return;const a=z().find(t=>t.id===e(h));if(a){if(a.campaignId){u(I,n()("invite.already_in_campaign"),!0),u(J,!1);return}Ve(async()=>{const{charactersMap:t}=await import("../chunks/CdkHlkWG.js").then(o=>o.g);return{charactersMap:t}},__vite__mapDeps([0,1,2,3]),import.meta.url).then(({charactersMap:t})=>{t.set(e(h),{...a,campaignId:G,campaignName:e(N),gmName:e(q),campaignApproval:"pending"}),ue(ge("/characters/[id]",{id:e(h)}))})}}var oe=Et(),B=K(oe),ne=r(B),Y=r(ne),Q=r(Y),je=r(Q);mt(je,{size:32}),i(Q);var X=s(Q,2),Ee=r(X,!0);i(X);var Z=s(X,2),le=r(Z),ee=s(le),Ge=r(ee,!0);i(ee);var Ne=s(ee,2);{var Ae=a=>{var t=xt(),o=r(t);i(t),x(v=>l(o,`${v??""}: ${e(q)??""}`),[()=>n()("common.labels.master")]),f(a,t)};w(Ne,a=>{e(q)!=="..."&&a(Ae)})}i(Z);var te=s(Z,2),de=r(te);xe(de,{size:12});var Me=s(de);i(te);var Oe=s(te,2);{var Se=a=>{var t=ut(),o=r(t);_t(o,{size:12});var v=s(o);i(t),x(p=>l(v,` ${p??""}`),[()=>n()("invite.waiting_gm")]),f(a,t)};w(Oe,a=>{$e()||a(Se)})}i(Y);var ve=s(Y,2);{var Te=a=>{var t=gt(),o=r(t);be(o,{size:20,class:"text-red-500 mb-0.5"});var v=s(o,2),p=r(v,!0);i(v),i(t),x(()=>l(p,e(I))),f(a,t)};w(ve,a=>{e(I)&&a(Te)})}var ce=s(ve,2);{var De=a=>{var t=ht(),o=r(t),v=s(r(o));i(o);var p=s(o,2);at(p);var d=s(p,2);{var m=c=>{var _=bt(),$=r(_,!0);i(_),x(k=>l($,k),[()=>n()("invite.password.incorrect")]),f(c,_)};w(d,c=>{e(M)&&c(m)})}i(t),x((c,_)=>{l(v,` ${c??""}`),rt(p,"placeholder",_),fe(p,1,`w-full bg-slate-900 border ${e(M)?"border-red-500":"border-slate-700"} rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors`)},[()=>n()("invite.password.required"),()=>n()("invite.password.placeholder")]),nt(p,()=>e(A),c=>u(A,c)),f(a,t)};w(ce,a=>{e(F)&&a(De)})}var ae=s(ce,2),re=r(ae),Ke=r(re,!0);i(re);var me=s(re,2),pe=r(me);Ze(pe,17,()=>e(se),tt,(a,t)=>{var o=wt();o.__click=()=>{u(h,e(t).id,!0),u(I,"")};var v=r(o),p=r(v,!0);i(v);var d=s(v,2),m=r(d),c=r(m,!0);i(m);var _=s(m,2),$=r(_),k=s($,3);xe(k,{size:8});var O=s(k);i(_),i(d);var S=s(d,2);{var y=b=>{pt(b,{size:16,class:"text-indigo-400"})};w(S,b=>{e(h)===e(t).id&&b(y)})}i(o),x((b,T,D)=>{fe(o,1,`w-full flex items-center gap-3 p-3 rounded-xl border transition-all ${e(h)===e(t).id?"bg-indigo-600/20 border-indigo-500 text-white":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`),l(p,b),l(c,e(t).name),l($,`${T??""} ${e(t).level??""} â€¢ ${e(t).ancestry??""} `),l(O,` ${D??""}`)},[()=>e(t).name.charAt(0),()=>n()("common.labels.level"),()=>n()(ie(e(t).system||W).nameKey)]),f(a,o)});var Pe=s(pe,2);{var Ue=a=>{var t=zt(),o=r(t);{var v=d=>{var m=yt(),c=K(m),_=r(c,!0);i(c);var $=s(c,2),k=r($,!0);i($),x((O,S)=>{l(_,O),l(k,S)},[()=>n()("invite.no_characters"),()=>n()("invite.create_first")]),f(d,m)},p=d=>{var m=Ct(),c=r(m);be(c,{size:24,class:"text-amber-500"});var _=s(c,2),$=r(_,!0);i(_);var k=s(_,2);{var O=y=>{var b=$t(),T=r(b,!0);i(b),x(D=>l(T,D),[()=>n()("invite.system_mismatch_info",{values:{system:n()(ie(e(H)).nameKey)}})]),f(y,b)},S=y=>{var b=kt(),T=r(b,!0);i(b),x(D=>l(T,D),[()=>n()("invite.create_or_leave")]),f(y,b)};w(k,y=>{e(Ce)?y(O):y(S,!1)})}i(m),x(y=>l($,y),[()=>n()("invite.all_in_campaigns")]),f(d,m)};w(o,d=>{z().length===0?d(v):d(p,!1)})}i(t),f(a,t)};w(Pe,a=>{e(se).length===0&&a(Ue)})}i(me),i(ae);var _e=s(ae,2),R=r(_e);R.__click=()=>ue(ge("/"));var Fe=r(R,!0);i(R);var V=s(R,2);V.__click=ze;var He=r(V);{var Je=a=>{var t=It(),o=s(K(t));x(v=>l(o,` ${v??""}`),[()=>n()("invite.validating")]),f(a,t)},Le=a=>{var t=Qe(),o=K(t);{var v=d=>{var m=jt(),c=s(K(m));x(_=>l(c,` ${_??""}`),[()=>n()("invite.loading")]),f(d,m)},p=d=>{var m=Xe();x(c=>l(m,c),[()=>n()("invite.accept")]),f(d,m)};w(o,d=>{e(N)===n()("invite.searching")?d(v):d(p,!1)},!0)}f(a,t)};w(He,a=>{e(L)?a(Je):a(Le,!1)})}i(V),i(_e),i(ne),i(B);var Re=s(B,2);{let a=C(()=>n()("invite.confirm_title")),t=C(()=>n()("invite.confirm_message",{values:{campaign:e(N),character:z().find(o=>o.id===e(h))?.name}}));ct(Re,{get isOpen(){return e(J)},get title(){return e(a)},get message(){return e(t)},onConfirm:Ie,onCancel:()=>u(J,!1)})}x((a,t,o,v,p,d)=>{l(Ee,a),l(le,`${t??""} `),l(Ge,e(N)),l(Me,` ${o??""}`),l(Ke,v),l(Fe,p),V.disabled=d},[()=>n()("invite.title"),()=>n()("invite.invited_to"),()=>n()(ie(e(H)).nameKey),()=>n()("invite.select_character"),()=>n()("invite.decline"),()=>!e(h)||e(L)||!!e(F)&&!e(A)||e(N)===n()("invite.searching")]),f(he,oe),Ye(),ke()}We(["click"]);export{Rt as component};
