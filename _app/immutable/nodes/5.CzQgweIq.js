const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BPjVGcEY.js","../chunks/X4qjwA50.js","../chunks/JmLgoKLb.js","../chunks/CjDeeOcX.js","../chunks/Da70ei3y.js"])))=>i.map(i=>d[i]);
import{s as K,a as Ve,_ as We}from"../chunks/CjDeeOcX.js";import"../chunks/DsnmJJEf.js";import{d as Be,o as Fe,s as l}from"../chunks/JmLgoKLb.js";import{p as Ye,j as b,o as P,q as r,u as s,t as x,k as f,v as Qe,w as u,x as e,y as j,z as C,A as i,B as Xe,D as Ze}from"../chunks/X4qjwA50.js";import{e as et,$ as tt,s as fe,i as at,r as rt,a as it}from"../chunks/Da70ei3y.js";import{i as w}from"../chunks/BGpg0XVn.js";import{c as st,j as ot,i as nt,b as lt}from"../chunks/BPjVGcEY.js";import{p as dt}from"../chunks/BW9HaG-_.js";import{G as xe,C as vt,g as ie,l as ct,D as W}from"../chunks/Cq1FyKpK.js";import{g as ue}from"../chunks/xs3qUsLd.js";import{U as mt,r as be,C as pt,W as _t}from"../chunks/VkDrW_dJ.js";import{v as ft}from"../chunks/BYmFNSF7.js";import{T as ge}from"../chunks/CE4ZhIuC.js";var xt=b('<span class="block text-xs mt-1 uppercase tracking-widest text-slate-500 font-black"> </span>'),ut=b('<div class="mt-4 px-3 py-1 bg-amber-500/10 border border-amber-500/20 rounded-full text-[10px] text-amber-500 font-bold uppercase tracking-wider animate-pulse flex items-center gap-2"><!> </div>'),bt=b('<div class="mb-6 bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center gap-3"><!> <p class="text-red-400 text-sm font-bold"> </p></div>'),gt=b('<p class="text-red-400 text-xs mt-1"> </p>'),ht=b('<div class="mb-6 bg-slate-950/50 p-4 rounded-xl border border-slate-800"><label for="campaign-pwd-input" class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-indigo-500 animate-pulse"></div> </label> <input id="campaign-pwd-input" type="password"/> <!></div>'),wt=b('<button><div class="w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-xs font-bold"> </div> <div class="flex-1 text-left"><div class="font-bold text-sm"> </div> <div class="text-[10px] opacity-60 flex items-center gap-1"> <span class="w-1 h-1 rounded-full bg-slate-600"></span> <!> </div></div> <!></button>'),yt=b("<div> </div> <div> </div>",1),$t=b('<div class="text-xs text-slate-500 max-w-[200px]"> </div>'),kt=b('<div class="text-xs text-slate-500"> </div>'),Ct=b('<div class="flex flex-col items-center gap-2"><!> <div class="text-amber-500 font-bold"> </div> <!></div>'),zt=b('<div class="text-center py-8 text-slate-600 italic text-sm space-y-2"><!></div>'),It=b('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> ',1),jt=b('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> ',1),Et=b('<div class="min-h-screen bg-slate-950 flex items-center justify-center p-4"><div class="max-w-md w-full bg-slate-900 border border-slate-800 rounded-2xl p-8 shadow-2xl"><div class="flex flex-col items-center text-center mb-8"><div class="w-16 h-16 bg-indigo-600/20 rounded-full flex items-center justify-center text-indigo-400 mb-4 border border-indigo-500/30"><!></div> <h1 class="text-2xl font-bold text-white mb-2"> </h1> <p class="text-slate-400"> <span class="text-indigo-400 font-bold"> </span> <!></p> <div class="mt-4 inline-flex items-center gap-1.5 px-3 py-1 rounded bg-slate-800 text-[10px] text-slate-400 border border-slate-700 font-bold uppercase tracking-wider"><!> </div> <!></div> <!> <!> <div class="space-y-4 mb-8"><label for="char-selector" class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2"> </label> <div id="char-selector" class="space-y-2 max-h-60 overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div> <div class="flex gap-3"><button class="flex-1 py-3 rounded-xl bg-slate-800 hover:bg-slate-700 text-white font-bold transition-all"> </button> <button class="flex-1 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold transition-all shadow-lg shadow-indigo-900/20 flex items-center justify-center gap-2"><!></button></div></div></div> <!>',1);function Jt(he,we){Ye(we,!0);const ye=()=>K(dt,"$page",E),U=()=>K(st,"$character",E),n=()=>K(tt,"$t",E),z=()=>K(ct,"$liveCharacters",E),$e=()=>K(nt,"$isGmOnline",E),[E,ke]=Ve(),N=ye().params.id;let A=C(()=>U().campaignName||n()("invite.searching")),B=C(()=>U().gmName||"..."),q=C(()=>U().passwordHash),H=C(()=>U().system||W),se=C(()=>z().filter(a=>!a.campaignId&&(a.system||W)===e(H))),Ce=C(()=>z().some(a=>!a.campaignId&&(a.system||W)!==e(H))),h=j(null),J=j(!1),G=j(""),M=j(!1),L=j(!1),I=j("");Fe(()=>{N&&ot(N,!1)});async function ze(){if(u(I,""),!e(h)||!N)return;if(z().find(t=>t.id===e(h))?.campaignId){u(I,n()("invite.already_in_campaign"),!0);return}if(e(q)){if(!e(G)){u(M,!0);return}u(L,!0);const t=await ft(e(G),e(q));if(u(L,!1),!t){u(M,!0);return}}u(M,!1),u(J,!0)}function Ie(){if(!e(h)||!N)return;const a=z().find(t=>t.id===e(h));if(a){if(a.campaignId){u(I,n()("invite.already_in_campaign"),!0),u(J,!1);return}We(async()=>{const{charactersMap:t}=await import("../chunks/BPjVGcEY.js").then(o=>o.a5);return{charactersMap:t}},__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(({charactersMap:t})=>{t.set(e(h),{...a,campaignId:N,campaignName:e(A),gmName:e(B),campaignApproval:"pending"}),ue(be("/characters/[id]",{id:e(h)}))})}}var oe=Et(),F=P(oe),ne=r(F),Y=r(ne),Q=r(Y),je=r(Q);mt(je,{size:32}),i(Q);var X=s(Q,2),Ee=r(X,!0);i(X);var Z=s(X,2),le=r(Z),ee=s(le),Ne=r(ee,!0);i(ee);var Ae=s(ee,2);{var Ge=a=>{var t=xt(),o=r(t);i(t),x(v=>l(o,`${v??""}: ${e(B)??""}`),[()=>n()("common.labels.master")]),f(a,t)};w(Ae,a=>{e(B)!=="..."&&a(Ge)})}i(Z);var te=s(Z,2),de=r(te);xe(de,{size:12});var Me=s(de);i(te);var Oe=s(te,2);{var Se=a=>{var t=ut(),o=r(t);_t(o,{size:12});var v=s(o);i(t),x(p=>l(v,` ${p??""}`),[()=>n()("invite.waiting_gm")]),f(a,t)};w(Oe,a=>{$e()||a(Se)})}i(Y);var ve=s(Y,2);{var Te=a=>{var t=bt(),o=r(t);ge(o,{size:20,class:"text-red-500 mb-0.5"});var v=s(o,2),p=r(v,!0);i(v),i(t),x(()=>l(p,e(I))),f(a,t)};w(ve,a=>{e(I)&&a(Te)})}var ce=s(ve,2);{var De=a=>{var t=ht(),o=r(t),v=s(r(o));i(o);var p=s(o,2);rt(p);var d=s(p,2);{var m=c=>{var _=gt(),$=r(_,!0);i(_),x(k=>l($,k),[()=>n()("invite.password.incorrect")]),f(c,_)};w(d,c=>{e(M)&&c(m)})}i(t),x((c,_)=>{l(v,` ${c??""}`),it(p,"placeholder",_),fe(p,1,`w-full bg-slate-900 border ${e(M)?"border-red-500":"border-slate-700"} rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors`)},[()=>n()("invite.password.required"),()=>n()("invite.password.placeholder")]),lt(p,()=>e(G),c=>u(G,c)),f(a,t)};w(ce,a=>{e(q)&&a(De)})}var ae=s(ce,2),re=r(ae),Ke=r(re,!0);i(re);var me=s(re,2),pe=r(me);et(pe,17,()=>e(se),at,(a,t)=>{var o=wt();o.__click=()=>{u(h,e(t).id,!0),u(I,"")};var v=r(o),p=r(v,!0);i(v);var d=s(v,2),m=r(d),c=r(m,!0);i(m);var _=s(m,2),$=r(_),k=s($,3);xe(k,{size:8});var O=s(k);i(_),i(d);var S=s(d,2);{var y=g=>{pt(g,{size:16,class:"text-indigo-400"})};w(S,g=>{e(h)===e(t).id&&g(y)})}i(o),x((g,T,D)=>{fe(o,1,`w-full flex items-center gap-3 p-3 rounded-xl border transition-all ${e(h)===e(t).id?"bg-indigo-600/20 border-indigo-500 text-white":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`),l(p,g),l(c,e(t).name),l($,`${T??""} ${e(t).level??""} â€¢ ${e(t).ancestry??""} `),l(O,` ${D??""}`)},[()=>e(t).name.charAt(0),()=>n()("common.labels.level"),()=>n()(ie(e(t).system||W).nameKey)]),f(a,o)});var Pe=s(pe,2);{var Ue=a=>{var t=zt(),o=r(t);{var v=d=>{var m=yt(),c=P(m),_=r(c,!0);i(c);var $=s(c,2),k=r($,!0);i($),x((O,S)=>{l(_,O),l(k,S)},[()=>n()("invite.no_characters"),()=>n()("invite.create_first")]),f(d,m)},p=d=>{var m=Ct(),c=r(m);ge(c,{size:24,class:"text-amber-500"});var _=s(c,2),$=r(_,!0);i(_);var k=s(_,2);{var O=y=>{var g=$t(),T=r(g,!0);i(g),x(D=>l(T,D),[()=>n()("invite.system_mismatch_info",{values:{system:n()(ie(e(H)).nameKey)}})]),f(y,g)},S=y=>{var g=kt(),T=r(g,!0);i(g),x(D=>l(T,D),[()=>n()("invite.create_or_leave")]),f(y,g)};w(k,y=>{e(Ce)?y(O):y(S,!1)})}i(m),x(y=>l($,y),[()=>n()("invite.all_in_campaigns")]),f(d,m)};w(o,d=>{z().length===0?d(v):d(p,!1)})}i(t),f(a,t)};w(Pe,a=>{e(se).length===0&&a(Ue)})}i(me),i(ae);var _e=s(ae,2),R=r(_e);R.__click=()=>ue(be("/"));var qe=r(R,!0);i(R);var V=s(R,2);V.__click=ze;var He=r(V);{var Je=a=>{var t=It(),o=s(P(t));x(v=>l(o,` ${v??""}`),[()=>n()("invite.validating")]),f(a,t)},Le=a=>{var t=Xe(),o=P(t);{var v=d=>{var m=jt(),c=s(P(m));x(_=>l(c,` ${_??""}`),[()=>n()("invite.loading")]),f(d,m)},p=d=>{var m=Ze();x(c=>l(m,c),[()=>n()("invite.accept")]),f(d,m)};w(o,d=>{e(A)===n()("invite.searching")?d(v):d(p,!1)},!0)}f(a,t)};w(He,a=>{e(L)?a(Je):a(Le,!1)})}i(V),i(_e),i(ne),i(F);var Re=s(F,2);{let a=C(()=>n()("invite.confirm_title")),t=C(()=>n()("invite.confirm_message",{values:{campaign:e(A),character:z().find(o=>o.id===e(h))?.name}}));vt(Re,{get isOpen(){return e(J)},get title(){return e(a)},get message(){return e(t)},onConfirm:Ie,onCancel:()=>u(J,!1)})}x((a,t,o,v,p,d)=>{l(Ee,a),l(le,`${t??""} `),l(Ne,e(A)),l(Me,` ${o??""}`),l(Ke,v),l(qe,p),V.disabled=d},[()=>n()("invite.title"),()=>n()("invite.invited_to"),()=>n()(ie(e(H)).nameKey),()=>n()("invite.select_character"),()=>n()("invite.decline"),()=>!e(h)||e(L)||!!e(q)&&!e(G)||e(A)===n()("invite.searching")]),f(he,oe),Qe(),ke()}Be(["click"]);export{Jt as component};
