import"../chunks/DsnmJJEf.js";import{c as Re,b as se,a as n,p as qt,f as v,e as a,g as e,C as ve,s as r,r as t,t as S,n as fe,B as je,d as Ut,D as ra,h as D,S as Vt,q as _a,aj as ua}from"../chunks/jP6WwoMK.js";import{d as Gt,s as u,o as ba,e as oa}from"../chunks/CXO0ygpU.js";import{l as Ct,s as Et,p as jt,i as w}from"../chunks/AyRiqjkq.js";import{a as zt,s as ta}from"../chunks/C0R4K3qO.js";import{p as ha}from"../chunks/CsA1nCrk.js";import{a as xa,s as sa,j as Sa,b as ot,h as da,U as Ia,k as Lt,W as ja,l as ia,r as ya,f as Ra,e as fa,d as la,g as Da}from"../chunks/CN7-Of_u.js";import{C as wa,b as ca,c as ka,l as Aa,a as Pa}from"../chunks/5xqwisKp.js";import{e as ce,i as qe,d as Pt,r as kt,s as ke,f as va,g as Ta}from"../chunks/LRkey9YK.js";import{t as Ha,s as Fa,b as Va}from"../chunks/CZy9ruAA.js";import{X as ea,P as Ft,c as Ba,T as Wt,a as La}from"../chunks/BPuODlaL.js";import{S as qa,G as Ua,P as za,u as pa,C as Ga}from"../chunks/DpJH4xJP.js";import"../chunks/CTvB2Po6.js";import{I as $t,s as Mt}from"../chunks/7Og-jIZB.js";import{M as ma,G as na,D as Qa,H as Ca,C as Ea,a as Ja,L as Wa,S as Za,b as Xa,c as Ka}from"../chunks/BV5Q7KCQ.js";import{C as ga}from"../chunks/BzUzmChH.js";import{b as It}from"../chunks/Crg2OtD8.js";import{g as Ya}from"../chunks/BD5tHgVx.js";function er(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["path",{d:"m6 9 6 6 6-6"}]];$t(k,Et({name:"chevron-down"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}function tr(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["path",{d:"m18 15-6-6-6 6"}]];$t(k,Et({name:"chevron-up"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}function ar(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335"}],["path",{d:"m9 11 3 3L22 4"}]];$t(k,Et({name:"circle-check-big"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}function rr(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];$t(k,Et({name:"copy"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}function ir(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["circle",{cx:"12",cy:"12",r:"3"}]];$t(k,Et({name:"eye"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}function sr(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];$t(k,Et({name:"flame"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}function nr(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];$t(k,Et({name:"grip-vertical"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}function $a(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];$t(k,Et({name:"layers"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}function or(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];$t(k,Et({name:"library"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}function lr(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];$t(k,Et({name:"qr-code"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}function dr(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}]];$t(k,Et({name:"rotate-ccw"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}function Ma(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];$t(k,Et({name:"save"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}function Oa(k,i){const f=Ct(i,["children","$$slots","$$events","$$legacy"]);const E=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];$t(k,Et({name:"swords"},()=>f,{get iconNode(){return E},children:(l,C)=>{var c=Re(),p=se(c);Mt(p,i,"default",{}),n(l,c)},$$slots:{default:!0}}))}var vr=v('<div class="absolute top-0 right-0 bg-yellow-500/20 text-yellow-400 text-[9px] font-bold px-2 py-0.5 rounded-bl uppercase border-b border-l border-yellow-500/30">Iniciativa</div>'),cr=v('<span class="text-[10px] bg-slate-950 px-1.5 py-0.5 rounded text-slate-500 border border-slate-800"> </span>'),ur=v('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),br=v('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),xr=v('<button class="text-[9px] bg-red-900/40 text-red-300 px-1.5 py-0.5 rounded border border-red-800 flex items-center gap-1 cursor-pointer hover:bg-red-900/60 transition-colors"> <!></button>'),fr=v('<button class="w-full text-left text-xs text-slate-300 hover:text-white hover:bg-slate-700 p-1 cursor-pointer rounded" role="menuitem"> </button>'),pr=v('<button title="Tomar Iniciativa"><!></button>'),mr=v('<button class="p-1.5 rounded bg-slate-900 text-slate-400 hover:text-white border border-slate-800"><!></button> <button class="p-1.5 rounded bg-slate-900 text-slate-500 hover:text-red-400 border border-slate-800"><!></button>',1),gr=v('<div class="mb-1"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span></div>'),_r=v('<div><h5 class="text-indigo-400 font-bold uppercase text-[10px] mb-1">Traços</h5> <!></div>'),hr=v('<div class="mb-1"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span></div>'),yr=v('<div><h5 class="text-red-400 font-bold uppercase text-[10px] mb-1">Ações</h5> <!></div>'),wr=v('<div class="mb-1"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span></div>'),kr=v('<div><h5 class="text-orange-400 font-bold uppercase text-[10px] mb-1">Reações</h5> <!></div>'),zr=v('<div class="mb-1"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span></div>'),Cr=v('<div><h5 class="text-yellow-500 font-bold uppercase text-[10px] mb-1">Fim da Rodada</h5> <!></div>'),Er=v('<div class="mt-3 pt-3 border-t border-slate-800/50 text-xs"><div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-3"><div class="bg-slate-950 p-2 rounded border border-slate-800"><span class="block text-[10px] text-slate-500 uppercase font-bold">Tamanho</span><span class="text-white font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800"><span class="block text-[10px] text-slate-500 uppercase font-bold">Speed</span><span class="text-white font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 col-span-2"><span class="block text-[10px] text-slate-500 uppercase font-bold">Sentidos</span><span class="text-white"> </span></div></div> <div class="space-y-4"><!> <!> <!> <!></div></div>'),$r=v('<div><!> <div class="flex flex-col md:flex-row gap-4 items-center"><button><!></button> <div class="flex-1 min-w-[200px]"><div class="flex items-center gap-2"><span> </span> <!></div> <div class="relative w-full h-6 bg-slate-950 rounded-lg mt-1.5 overflow-hidden border border-slate-800 group shadow-inner"><div></div> <!> <!> <div class="absolute inset-0 flex items-center justify-center z-20"><span><!></span></div></div> <div class="flex flex-wrap gap-2 mt-2"><!> <div class="relative group/aff"><button class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded border border-slate-700 hover:text-white flex items-center gap-1" aria-haspopup="true"><!> Aflição</button> <div class="absolute top-full left-0 mt-1 bg-slate-800 border border-slate-700 rounded shadow-xl p-2 w-40 z-20 hidden group-hover/aff:block max-h-40 overflow-y-auto custom-scrollbar" role="menu"></div></div></div></div> <div class="flex items-center gap-2 bg-slate-950 p-2 rounded-lg border border-slate-800"><div class="text-center w-10 border-r border-slate-800 pr-2 mr-1"><div class="text-[8px] text-slate-500 uppercase font-bold">Def</div> <div class="font-mono font-bold text-white text-lg"> </div></div> <label class="text-center"><div class="text-[8px] text-red-400 uppercase font-bold mb-0.5">Dano</div> <input type="number" class="w-12 bg-slate-900 border border-slate-800 text-center text-white font-mono font-bold rounded focus:border-red-500 focus:outline-none"/></label> <label class="text-center"><div class="text-[8px] text-green-400 uppercase font-bold mb-0.5">Atual</div> <input type="number" class="w-12 bg-slate-900 border border-slate-800 text-center text-white font-mono font-bold rounded focus:border-green-500 focus:outline-none"/></label> <div class="text-center pl-2 ml-1 border-l border-slate-800"><div class="text-[8px] text-slate-500 uppercase font-bold mb-0.5">Máx</div> <div class="text-slate-400 font-mono font-bold"> </div></div></div> <div class="flex flex-col gap-1"><!></div></div> <!></div>');function Mr(k,i){qt(i,!0);let f=jt(i,"updateEnemy",3,(b,m)=>{}),E=jt(i,"updatePlayer",3,(b,m)=>{}),l=jt(i,"removeFromCombat",3,b=>{}),C=ve(()=>i.entity.type==="player"),c=ve(()=>i.entity.damage||0),p=ve(()=>i.entity.normalHealth||i.entity.health||10),T=ve(()=>i.entity.currentHealth??e(p)),A=ve(()=>e(c)>=e(T)),L=ve(()=>e(c)>=e(T)/2&&!e(A)),Ne=ve(()=>e(T)>0?Math.min(100,Math.max(0,e(c)/e(T)*100)):100),pe=je(!1);function $(b){if(i.entity.type!=="player")return;const m=xa.get(i.entity.id);m&&xa.set(i.entity.id,{...m,...b}),E()(i.entity.id,b),sa({id:i.entity.id,...b})}function ye(b){const m=parseInt(b.target.value);if(isNaN(m))return;const J={damage:Math.max(0,m)};i.entity.type==="player"?$(J):f()(i.entity.instanceId,J)}function I(b){const m=parseInt(b.target.value);if(isNaN(m))return;const O=Math.max(0,m);let J=e(c);O<e(c)&&(J=O);const _={currentHealth:O,damage:J};i.entity.type==="player"?$(_):f()(i.entity.instanceId,_)}function Q(){const b=!i.entity.acted;i.entity.type==="player"?$({acted:b}):f()(i.entity.instanceId,{acted:b})}function Y(){i.entity.type==="player"&&$({initiative:!i.entity.initiative})}function H(b){const m=i.entity.afflictions||[],J={afflictions:m.includes(b)?m.filter(_=>_!==b):[...m,b]};i.entity.type==="player"?$(J):f()(i.entity.instanceId,J)}const ee=["Blinded","Confused","Controlled","Cursed","Deafened","Frightened","Held","Impaired","Incapacitated","On Fire","Poisoned","Prone","Slowed","Stunned","Unconscious","Vulnerable","Weakened"];var me=$r(),ue=a(me);{var be=b=>{var m=vr();n(b,m)};w(ue,b=>{e(C)&&i.entity.initiative&&b(be)})}var G=r(ue,2),F=a(G);F.__click=Q;var Pe=a(F);{var R=b=>{qa(b,{size:24,class:"animate-pulse"})},Te=b=>{var m=Re(),O=se(m);{var J=h=>{ar(h,{size:24})},_=h=>{Oa(h,{size:24})};w(O,h=>{i.entity.acted?h(J):h(_,!1)},!0)}n(b,m)};w(Pe,b=>{e(A)?b(R):b(Te,!1)})}t(F);var Ve=r(F,2),De=a(Ve),Se=a(De),lt=a(Se,!0);t(Se);var dt=r(Se,2);{var Ze=b=>{var m=cr(),O=a(m);t(m),S(()=>u(O,`Dif ${i.entity.difficulty??""}`)),n(b,m)};w(dt,b=>{e(C)||b(Ze)})}t(De);var et=r(De,2),ze=a(et),ae=r(ze,2);{var Ue=b=>{var m=ur();S(()=>{ke(m,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10 ${e(A)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":e(Ne)>=80?"bg-gradient-to-r from-red-600 to-rose-500":e(L)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),Ta(m,`width: ${e(Ne)??""}%`)}),n(b,m)};w(ae,b=>{e(Ne)>0&&b(Ue)})}var Xe=r(ae,2);{var Ge=b=>{var m=br();n(b,m)};w(Xe,b=>{e(c)===0&&b(Ge)})}var q=r(Xe,2),Qe=a(q),Ke=a(Qe);{var ht=b=>{var m=ra("INCAPACITADO");n(b,m)},tt=b=>{var m=Re(),O=se(m);{var J=h=>{var j=ra("FERIDO");n(h,j)},_=h=>{var j=Re(),K=se(j);{var W=P=>{var re=ra("SAUDÁVEL");n(P,re)},U=P=>{var re=ra();S(()=>u(re,`${e(c)??""} DANO`)),n(P,re)};w(K,P=>{e(c)===0?P(W):P(U,!1)},!0)}n(h,j)};w(O,h=>{e(L)?h(J):h(_,!1)},!0)}n(b,m)};w(Ke,b=>{e(A)?b(ht):b(tt,!1)})}t(Qe),t(q),t(et);var xt=r(et,2),ft=a(xt);ce(ft,17,()=>i.entity.afflictions||[],qe,(b,m)=>{var O=xr();O.__click=()=>H(e(m));var J=a(O),_=r(J);ea(_,{size:8}),t(O),S(()=>{Pt(O,"title",`Remover ${e(m)??""}`),u(J,`${e(m)??""} `)}),n(b,O)});var vt=r(ft,2),y=a(vt),z=a(y);Ft(z,{size:8}),fe(),t(y);var B=r(y,2);ce(B,21,()=>ee,qe,(b,m)=>{var O=fr();O.__click=()=>H(e(m));var J=a(O,!0);t(O),S(()=>u(J,e(m))),n(b,O)}),t(B),t(vt),t(xt),t(Ve);var Ce=r(Ve,2),Ee=a(Ce),He=r(a(Ee),2),$e=a(He,!0);t(He),t(Ee);var Be=r(Ee,2),pt=r(a(Be),2);kt(pt),pt.__input=ye,t(Be);var mt=r(Be,2),Ot=r(a(mt),2);kt(Ot),Ot.__input=I,t(mt);var at=r(mt,2),Rt=r(a(at),2),rt=a(Rt,!0);t(Rt),t(at),t(Ce);var Dt=r(Ce,2),Fe=a(Dt);{var gt=b=>{var m=pr();m.__click=Y;var O=a(m);sr(O,{size:16}),t(m),S(()=>ke(m,1,`p-1.5 rounded transition-colors ${i.entity.initiative?"bg-yellow-900/30 text-yellow-400 border border-yellow-700":"bg-slate-800 text-slate-500 hover:text-white"}`)),n(b,m)},Je=b=>{var m=mr(),O=se(m);O.__click=()=>D(pe,!e(pe));var J=a(O);{var _=W=>{tr(W,{size:16})},h=W=>{er(W,{size:16})};w(J,W=>{e(pe)?W(_):W(h,!1)})}t(O);var j=r(O,2);j.__click=()=>l()(i.entity.instanceId);var K=a(j);ea(K,{size:16}),t(j),n(b,m)};w(Fe,b=>{e(C)?b(gt):b(Je,!1)})}t(Dt),t(G);var _t=r(G,2);{var Tt=b=>{var m=Er(),O=a(m),J=a(O),_=r(a(J)),h=a(_,!0);t(_),t(J);var j=r(J,2),K=r(a(j)),W=a(K,!0);t(K),t(j);var U=r(j,2),P=r(a(U)),re=a(P,!0);t(P),t(U),t(O);var de=r(O,2),ge=a(de);{var ct=te=>{var we=_r(),Ye=r(a(we),2);ce(Ye,17,()=>i.entity.traits,qe,(it,Ie)=>{var Me=gr(),xe=a(Me),Le=a(xe);t(xe);var st=r(xe,2),wt=a(st,!0);t(st),t(Me),S(()=>{u(Le,`${e(Ie).name??""}:`),u(wt,e(Ie).desc)}),n(it,Me)}),t(we),n(te,we)};w(ge,te=>{i.entity.traits&&te(ct)})}var Nt=r(ge,2);{var We=te=>{var we=yr(),Ye=r(a(we),2);ce(Ye,17,()=>i.entity.actions,qe,(it,Ie)=>{var Me=hr(),xe=a(Me),Le=a(xe);t(xe);var st=r(xe,2),wt=a(st,!0);t(st),t(Me),S(()=>{u(Le,`${e(Ie).name??""}:`),u(wt,e(Ie).desc)}),n(it,Me)}),t(we),n(te,we)};w(Nt,te=>{i.entity.actions&&te(We)})}var ut=r(Nt,2);{var Ae=te=>{var we=kr(),Ye=r(a(we),2);ce(Ye,17,()=>i.entity.reactions,qe,(it,Ie)=>{var Me=wr(),xe=a(Me),Le=a(xe);t(xe);var st=r(xe,2),wt=a(st,!0);t(st),t(Me),S(()=>{u(Le,`${e(Ie).name??""}:`),u(wt,e(Ie).desc)}),n(it,Me)}),t(we),n(te,we)};w(ut,te=>{i.entity.reactions&&te(Ae)})}var St=r(ut,2);{var yt=te=>{var we=Cr(),Ye=r(a(we),2);ce(Ye,17,()=>i.entity.endOfRound,qe,(it,Ie)=>{var Me=zr(),xe=a(Me),Le=a(xe);t(xe);var st=r(xe,2),wt=a(st,!0);t(st),t(Me),S(()=>{u(Le,`${e(Ie).name??""}:`),u(wt,e(Ie).desc)}),n(it,Me)}),t(we),n(te,we)};w(St,te=>{i.entity.endOfRound&&te(yt)})}t(de),t(m),S(()=>{u(h,i.entity.size||1),u(W,i.entity.speed||10),u(re,i.entity.senses||"-")}),Ha(3,m,()=>Fa),n(b,m)};w(_t,b=>{!e(C)&&e(pe)&&b(Tt)})}t(me),S(()=>{ke(me,1,`bg-slate-900 border rounded-xl p-3 relative transition-all ${i.entity.acted?"opacity-60 border-slate-800":e(C)?"border-indigo-500/30 shadow-md shadow-indigo-900/10":"border-red-900/50 shadow-md shadow-red-900/10"} ${e(A)?"ring-2 ring-red-600 bg-red-950/20":""}`),ke(F,1,`w-12 h-12 rounded-lg flex items-center justify-center border-2 transition-all shadow-lg ${e(A)?"bg-red-900/20 border-red-600 text-red-500":i.entity.acted?"bg-slate-800 border-slate-700 text-slate-500":e(C)?"bg-indigo-600 hover:bg-indigo-500 border-indigo-400 text-white":"bg-red-900/50 hover:bg-red-800 border-red-700 text-red-200"}`),Pt(F,"title",i.entity.acted?"Já agiu":"Agir"),Pt(F,"aria-label",i.entity.acted?"Já agiu":"Agir"),ke(Se,1,`font-bold text-lg ${e(C)?"text-white":"text-red-200"}`),u(lt,i.entity.name),ke(ze,1,`absolute inset-0 ${e(c)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),ke(Qe,1,`text-[11px] font-black uppercase tracking-wider drop-shadow-md ${e(A)||e(L)?"text-white":e(c)===0?"text-emerald-300":"text-white/90"}`),u($e,i.entity.defense||10),va(pt,e(c)),va(Ot,e(T)),u(rt,e(p))}),n(k,me),Ut()}Gt(["click","input"]);function Or(k,{from:i,to:f},E={}){var{delay:l=0,duration:C=be=>Math.sqrt(be)*120,easing:c=Ba}=E,p=getComputedStyle(k),T=p.transform==="none"?"":p.transform,[A,L]=p.transformOrigin.split(" ").map(parseFloat);A/=k.clientWidth,L/=k.clientHeight;var Ne=Nr(k),pe=k.clientWidth/f.width/Ne,$=k.clientHeight/f.height/Ne,ye=i.left+i.width*A,I=i.top+i.height*L,Q=f.left+f.width*A,Y=f.top+f.height*L,H=(ye-Q)*pe,ee=(I-Y)*$,me=i.width/f.width,ue=i.height/f.height;return{delay:l,duration:typeof C=="function"?C(Math.sqrt(H*H+ee*ee)):C,easing:c,css:(be,G)=>{var F=G*H,Pe=G*ee,R=be+G*me,Te=be+G*ue;return`transform: ${T} translate(${F}px, ${Pe}px) scale(${R}, ${Te});`}}}function Nr(k){if("currentCSSZoom"in k)return k.currentCSSZoom;for(var i=k,f=1;i!==null;)f*=+getComputedStyle(i).zoom,i=i.parentElement;return f}function Sr(k,i=1,f=0){const E=[];let l=0;for(let T=0;T<i;T++){const A=Math.floor(Math.random()*k)+1;E.push(A),l+=A}let C=`${i}d${k}`,c=[],p=0;if(f!==0)if(k===20){const T=Math.abs(f);for(let L=0;L<T;L++)c.push(Math.floor(Math.random()*6)+1);const A=Math.max(...c);f>0?(p=A,l+=A,C+=` + ${A} [Boon]`):(p=-A,l-=A,C+=` - ${A} [Bane]`)}else p=f,l+=f,C+=f>0?` + ${f}`:` - ${Math.abs(f)}`;return{total:l,results:E,bonusRolls:c,formula:C,crit:k===20&&E.includes(20),modifierTotal:p}}var Ir=v('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),jr=v('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter">Novo pedido de entrada</div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),Rr=v('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),Dr=v('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1">Sessão</span>'),Ar=v('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all" title="Expulsar da Campanha"><!></button></div></div>'),Pr=v('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center">Nenhum jogador na sessão.</div>'),Tr=v('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> Publicar Sessão</button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter">Torne sua sessão visível e obtenha o link de convite</p>',1),Hr=v('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img alt="QR Code de Convite" class="w-24 h-24"/></div>'),Fr=v('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> Copiado!</div>'),Vr=v('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> Sessão Pública</span></div> <button class="text-slate-500 hover:text-white transition-colors p-1" title="Ver QR Code"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative" aria-label="Copiar link"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1">Retirar de área pública</button>',1),Br=v('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all"><div class="truncate flex-1 flex items-center gap-2"><!> <div><div class="text-sm font-bold text-white truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800"><!></button></div>'),Lr=v('<div class="text-center text-slate-600 italic text-xs mt-4">Nenhum inimigo.</div>'),qr=v("<!> <!>",1),Ur=v('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800"><!></button></div>'),Gr=v('<div class="text-center text-slate-600 italic text-xs mt-4">Nenhum encontro.</div>'),Qr=v("<!> <!>",1),Jr=v('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> INICIAR COMBATE</button>'),Wr=v('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400" title="Voltar Rodada"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase">Rodada</div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2" title="Próxima Rodada"><!> Próxima</button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10">Encerrar</button></div>'),Zr=v("<div><!></div>"),Xr=v('<div class="text-center text-slate-500 italic py-10">Combate vazio.</div>'),Kr=v('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),Yr=v('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),ei=v('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl">Fim da Rodada</h3> <p class="text-slate-400 text-sm">Resumo dos efeitos que ocorrem agora.</p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm">Cancelar</button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm">Avançar Rodada</button></div></div></div>'),ti=v('<div class="fixed inset-0 z-[60] flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl border border-slate-700 shadow-2xl p-6 w-full max-w-sm" role="dialog" aria-modal="true"><h3 class="font-bold text-white text-center text-lg mb-4"> </h3> <div class="flex items-center justify-center gap-6 mb-6"><button class="w-12 h-12 rounded-full bg-slate-700 hover:bg-red-500 text-white flex items-center justify-center"><!></button> <div> </div> <button class="w-12 h-12 rounded-full bg-slate-700 hover:bg-green-500 text-white flex items-center justify-center"><!></button></div> <div class="text-xs text-center text-slate-500 mb-6 uppercase font-bold"> </div> <button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 rounded-xl shadow-lg">ROLAR AGORA</button></div></div>'),ai=v('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),ri=v('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold">Nenhum personagem disponível.</p> <p class="text-[10px] text-slate-600 mt-1">Todos os personagens da campanha já estão na sessão.</p></div>'),ii=v('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg">Gerenciar Sessão</h3> <p class="text-xs text-slate-400">Adicione personagens disponíveis à sessão.</p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),si=v('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> Personagens <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col h-[400px]"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> Inimigos</button> <button><!> Encontros</button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"></div></div> <!> <div class="fixed bottom-6 left-1/2 -translate-x-1/2 bg-slate-900/90 backdrop-blur-md border border-slate-700 rounded-2xl p-2 flex items-center gap-2 shadow-2xl z-40 animate-in slide-in-from-bottom-4"><div class="px-3 border-r border-slate-700 flex items-center gap-2 text-slate-400 font-bold text-xs uppercase"><!> Quick</div> <button class="bg-slate-800 hover:bg-indigo-600 text-white font-bold w-10 h-10 rounded-xl flex items-center justify-center transition-all hover:-translate-y-1 shadow-lg">d20</button> <button class="bg-slate-800 hover:bg-indigo-600 text-white font-bold w-10 h-10 rounded-xl flex items-center justify-center transition-all hover:-translate-y-1 shadow-lg">d6</button> <button class="bg-slate-800 hover:bg-indigo-600 text-white font-bold w-10 h-10 rounded-xl flex items-center justify-center transition-all hover:-translate-y-1 shadow-lg text-xs">2d6</button> <button class="bg-slate-800 hover:bg-indigo-600 text-white font-bold w-10 h-10 rounded-xl flex items-center justify-center transition-all hover:-translate-y-1 shadow-lg text-xs">3d6</button></div> <!> <!> <!> <!>',1);function ni(k,i){qt(i,!0);const f=()=>zt(Aa,"$liveCharacters",c),E=()=>zt(ca,"$liveEnemies",c),l=()=>zt(ka,"$liveEncounters",c),C=()=>zt(Lt,"$isHistoryOpen",c),[c,p]=ta();let T=je(!1),A=je(!1),L=je(!1);const Ne={active:!1,round:1};let pe=je("enemies"),$=je(!1),ye=je(Vt([])),I=je(Vt({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));ba(()=>{if(i.campaign?.id){Sa(i.campaign.id,!0);const s=setInterval(()=>{const o=ot.get(i.campaign.id)||i.campaign;da(i.campaign.id,{name:o.name,gmName:o.gmName||"Mestre"})},3e4);return()=>{clearInterval(s)}}});const Q=ve(()=>typeof window<"u"?`${window.location.origin}${ya("/campaigns/[id]/invite",{id:i.campaign?.id})}`:"");function Y(){e(Q)&&(navigator.clipboard.writeText(e(Q)),D(A,!0),setTimeout(()=>{D(A,!1)},2e3))}let H=ve(()=>i.campaign?.sessionRoster||[]),ee=ve(()=>i.campaign?.combat||Ne),me=ve(()=>i.campaign?.activeEnemies||[]),ue=ve(()=>i.campaign?.members||[]),be=ve(()=>Array.from(new Set([...e(H),...e(ue).map(o=>o.id)])).map(o=>{const d=f().find(N=>N.id===o),g=e(ue).find(N=>N.id===o);return d&&g?{...d,...g,lastUpdate:g.lastUpdate}:d||g}).filter(Boolean)),G=ve(()=>e(be).filter(s=>!s.campaignApproval||s.campaignApproval==="approved")),F=ve(()=>e(be).filter(s=>s.campaignApproval==="pending")),Pe=ve(()=>f().filter(s=>!e(H).includes(s.id)&&!e(ue).some(o=>o.id===s.id)));function R(s){if(!i.campaign?.id)return;const d={...ot.get(i.campaign.id)||i.campaign,...s};ot.set(i.campaign.id,d),s.combat&&ia(i.campaign.id,s.combat),(s.name||s.gmName)&&da(i.campaign.id,{name:d.name,gmName:d.gmName})}function Te(s){if(e(H).includes(s)){const o=e(H).filter(d=>d!==s);R({sessionRoster:o})}else{const o=[...e(H),s];R({sessionRoster:o})}}function Ve(s){vt(s,{campaignApproval:"approved"}),sa({id:s,campaignApproval:"approved"})}function De(s){sa({id:s,campaignApproval:"rejected",campaignId:null});const d=((ot.get(i.campaign.id)||i.campaign).members||[]).filter(g=>g.id!==s);R({members:d})}function Se(s){const o=e(be).find(d=>d.id===s);D(I,{isOpen:!0,title:"Remover da Campanha",message:`Deseja remover ${o?.name||"este personagem"} da campanha? Eles poderão entrar novamente através do link de convite.`,onConfirm:()=>{const d=ot.get(i.campaign.id)||i.campaign;sa({id:s,campaignId:null});const g=(d.sessionRoster||[]).filter(x=>x!==s),N=(d.members||[]).filter(x=>x.id!==s),M=(d.activeEnemies||[]).filter(x=>x.type!=="player"||x.id!==s);R({sessionRoster:g,members:N,activeEnemies:M}),e(I).isOpen=!1}},!0)}function lt(s){const d=(ot.get(i.campaign.id)||i.campaign).activeEnemies||[],g={...s,instanceId:`e_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,damage:0,currentHealth:s.health,afflictions:[],acted:!1,initiative:!1};R({activeEnemies:[...d,g]})}function dt(s){const d=(ot.get(i.campaign.id)||i.campaign).activeEnemies||[];let g=[];s.enemies.forEach(N=>{const M=E().find(x=>x.id===N.enemyId);if(M)for(let x=0;x<N.count;x++)g.push({...M,instanceId:`e_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,damage:0,currentHealth:M.health,afflictions:[],acted:!1,initiative:!1})}),R({activeEnemies:[...d,...g]})}function Ze(){R({combat:{active:!0,round:1}}),ia(i.campaign.id,{active:!0,round:1})}function et(){const s=e(me).filter(o=>o.damage<(o.currentHealth??o.health)&&o.endOfRound&&o.endOfRound.length>0).map(o=>({name:o.name,effects:o.endOfRound}));if(s.length>0){D(ye,s,!0),D($,!0);return}ze()}function ze(){const s=ot.get(i.campaign.id)||i.campaign,o=(s.combat?.round||1)+1,d=(s.activeEnemies||[]).map(g=>({...g,acted:!1}));R({combat:{...s.combat,round:o},activeEnemies:d}),ia(i.campaign.id,{active:!0,round:o}),D($,!1)}function ae(s){R({combat:{active:!1,round:1}}),ia(i.campaign.id,{active:!1,round:1})}function Ue(s){const o=ot.get(i.campaign.id)||i.campaign;R({activeEnemies:(o.activeEnemies||[]).filter(d=>d.instanceId!==s)})}function Xe(s,o){const d=ot.get(i.campaign.id)||i.campaign;R({activeEnemies:(d.activeEnemies||[]).map(g=>g.instanceId===s?{...g,...o}:g)})}function Ge(){const s=ot.get(i.campaign.id)||i.campaign,o=s.combat?.round||1;o>1&&R({combat:{...s.combat,round:o-1}})}let q=je(Vt({isOpen:!1,sides:20,count:1,modifier:0}));function Qe(s,o=1){D(q,{isOpen:!0,sides:s,count:o,modifier:0},!0)}function Ke(){ht(e(q).sides,e(q).count,e(q).modifier),e(q).isOpen=!1}function ht(s,o=1,d=0){const g=Sr(s,o,d);let N="";o>1&&(N+=`Dados: [${g.results.join(", ")}] `),g.bonusRolls?.length>0&&(N+=`Bonus Rolls: [${g.bonusRolls.join(", ")}] -> ${Math.abs(g.modifierTotal)}`),Ra.addToHistory({source:"GM",charName:"Mestre",name:`${o}d${s} ${d?d>0?`+${d}`:d:""}`,description:N.trim()||null,total:g.total,formula:g.formula,crit:g.crit}),Lt.set(!0)}let tt=je(Vt(Date.now()));ba(()=>{const s=setInterval(()=>{D(tt,Date.now(),!0)},1e4);return()=>clearInterval(s)});let xt=ve(()=>(()=>{const s=e(G).filter(x=>e(H).includes(x.id)),o=s.filter(x=>x&&x.initiative).map(x=>({...x,type:"player"})),d=e(me).map(x=>({...x,type:"enemy"})),g=s.filter(x=>x&&!x.initiative).map(x=>({...x,type:"player"})),N=[...o,...d,...g],M=new Set;return N.filter(x=>{if(!x)return!1;const V=x.type==="player"?x.id:x.instanceId;return M.has(V)?!1:(M.add(V),!0)})})());function ft(s){return s.lastUpdate?e(tt)-s.lastUpdate<6e4:!1}function vt(s,o){const d=ot.get(i.campaign.id)||i.campaign,g=d.members||[],N=g.findIndex(ne=>ne.id===s);let M=g;N!==-1&&(M=[...g],M[N]={...M[N],...o});const x=d.activeEnemies||[],V=x.findIndex(ne=>ne.id===s&&ne.type==="player");let Z=x;V!==-1&&(Z=[...x],Z[V]={...Z[V],...o}),R({members:M,activeEnemies:Z})}var y=si(),z=se(y),B=a(z),Ce=a(B),Ee=a(Ce),He=a(Ee),$e=a(He);Ia($e,{size:14,class:"text-indigo-500"});var Be=r($e,2);{var pt=s=>{var o=Ir(),d=a(o,!0);t(o),S(()=>u(d,e(G).length)),n(s,o)};w(Be,s=>{e(G).length>0&&s(pt)})}t(He);var mt=r(He,2);mt.__click=()=>D(T,!e(T));var Ot=a(mt,!0);t(mt),t(Ee);var at=r(Ee,2);{var Rt=s=>{var o=Rr(),d=a(o),g=r(a(d),2),N=a(g);t(g),t(d);var M=r(d,2);ce(M,17,()=>e(F),x=>x.id,(x,V)=>{var Z=jr(),ne=a(Z),X=a(ne),oe=a(X,!0);t(X),fe(2),t(ne);var ie=r(ne,2),le=a(ie);le.__click=()=>Ve(e(V).id);var Oe=a(le);ga(Oe,{size:14}),t(le);var _e=r(le,2);_e.__click=()=>De(e(V).id);var nt=a(_e);Wt(nt,{size:14}),t(_e),t(ie),t(Z),S(()=>u(oe,e(V).name)),n(x,Z)}),fe(2),t(o),S(()=>u(N,`Aguardando Aprovação (${e(F).length??""})`)),n(s,o)};w(at,s=>{e(F).length>0&&s(Rt)})}var rt=r(at,2),Dt=a(rt),Fe=a(Dt);ce(Fe,17,()=>e(G),s=>s.id,(s,o)=>{const d=ve(()=>ft(e(o))),g=ve(()=>e(H).includes(e(o).id));var N=Ar(),M=a(N),x=r(M,2),V=a(x),Z=a(V,!0);t(V);var ne=r(V,2),X=a(ne);{var oe=he=>{var Ht=Dr();n(he,Ht)};w(X,he=>{e(g)&&he(oe)})}var ie=r(X);t(ne),t(x);var le=r(x,2),Oe=a(le);Oe.__click=()=>Te(e(o).id);var _e=a(Oe);{var nt=he=>{ma(he,{size:14})},Bt=he=>{Ft(he,{size:14})};w(_e,he=>{e(g)?he(nt):he(Bt,!1)})}t(Oe);var At=r(Oe,2);At.__click=()=>Se(e(o).id);var bt=a(At);Wt(bt,{size:14}),t(At),t(le),t(N),S(()=>{ke(N,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${e(d)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${e(d)||e(g)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),ke(M,1,`w-2 h-2 rounded-full ${e(d)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),ke(V,1,`font-bold text-sm ${e(d)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),u(Z,e(o).name),u(ie,` Lvl ${e(o).level??""} • ${e(o).ancestry??""}`),ke(Oe,1,`p-1.5 rounded-lg transition-all ${e(g)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),Pt(Oe,"title",e(g)?"Remover da Sessão":"Adicionar à Sessão")}),n(s,N)});var gt=r(Fe,2);{var Je=s=>{var o=Pr();n(s,o)};w(gt,s=>{e(G).length===0&&s(Je)})}t(Dt),t(rt);var _t=r(rt,2),Tt=a(_t);{var b=s=>{var o=Tr(),d=se(o);d.__click=()=>R({isPublished:!0});var g=a(d);Ua(g,{size:14}),fe(),t(d),fe(2),n(s,o)},m=s=>{var o=Vr(),d=se(o),g=a(d),N=a(g),M=a(N);ja(M,{size:10,class:"animate-pulse"}),fe(),t(N),t(g);var x=r(g,2);x.__click=()=>D(L,!e(L));var V=a(x);lr(V,{size:14}),t(x),t(d);var Z=r(d,2);{var ne=bt=>{var he=Hr(),Ht=a(he);t(he),S(Jt=>Pt(Ht,"src",Jt),[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(e(Q))}`]),n(bt,he)};w(Z,bt=>{e(L)&&bt(ne)})}var X=r(Z,2),oe=a(X),ie=a(oe);ie.__click=Y;var le=a(ie,!0);t(ie);var Oe=r(ie,2);Oe.__click=Y;var _e=a(Oe);{var nt=bt=>{var he=Fr(),Ht=a(he);ga(Ht,{size:10,class:"inline mr-1"}),fe(),t(he),n(bt,he)};w(_e,bt=>{e(A)&&bt(nt)})}var Bt=r(_e,2);rr(Bt,{size:14}),t(Oe),t(oe),t(X);var At=r(X,2);At.__click=()=>R({isPublished:!1}),S(()=>u(le,e(Q))),n(s,o)};w(Tt,s=>{i.campaign?.isPublished?s(m,!1):s(b)})}t(_t),t(Ce);var O=r(Ce,2),J=a(O),_=a(J);_.__click=()=>D(pe,"enemies");var h=a(_);na(h,{size:14}),fe(),t(_);var j=r(_,2);j.__click=()=>D(pe,"encounters");var K=a(j);$a(K,{size:14}),fe(),t(j),t(J);var W=r(J,2),U=a(W);{var P=s=>{var o=qr(),d=se(o);ce(d,1,E,M=>M.id,(M,x)=>{var V=Br(),Z=a(V),ne=a(Z);nr(ne,{size:12,class:"text-slate-600 cursor-grab"});var X=r(ne,2),oe=a(X),ie=a(oe,!0);t(oe);var le=r(oe,2),Oe=a(le);t(le),t(X),t(Z);var _e=r(Z,2);_e.__click=()=>lt(e(x));var nt=a(_e);Ft(nt,{size:16}),t(_e),t(V),S(()=>{u(ie,e(x).name),u(Oe,`Dif ${e(x).difficulty??""}`)}),n(M,V)});var g=r(d,2);{var N=M=>{var x=Lr();n(M,x)};w(g,M=>{E().length===0&&M(N)})}n(s,o)},re=s=>{var o=Qr(),d=se(o);ce(d,1,l,M=>M.id,(M,x)=>{var V=Ur(),Z=a(V),ne=a(Z),X=a(ne,!0);t(ne);var oe=r(ne,2),ie=a(oe);t(oe),t(Z);var le=r(Z,2);le.__click=()=>dt(e(x));var Oe=a(le);za(Oe,{size:14}),t(le),t(V),S(_e=>{u(X,e(x).name),u(ie,`${_e??""} Inimigos`)},[()=>e(x).enemies?.reduce((_e,nt)=>_e+nt.count,0)||0]),n(M,V)});var g=r(d,2);{var N=M=>{var x=Gr();n(M,x)};w(g,M=>{l().length===0&&M(N)})}n(s,o)};w(U,s=>{e(pe)==="enemies"?s(P):s(re,!1)})}t(W),t(O),t(B);var de=r(B,2),ge=a(de),ct=a(ge),Nt=a(ct);{var We=s=>{var o=Jr();o.__click=Ze;var d=a(o);Oa(d,{size:20}),fe(),t(o),n(s,o)},ut=s=>{var o=Wr(),d=a(o);d.__click=Ge;var g=a(d);Ea(g,{size:20}),t(d);var N=r(d,2),M=r(a(N)),x=a(M,!0);t(M),t(N);var V=r(N,2);V.__click=et;var Z=a(V);dr(Z,{size:16}),fe(),t(V);var ne=r(V,4);ne.__click=()=>ae(),t(o),S(()=>u(x,e(ee).round)),n(s,o)};w(Nt,s=>{e(ee).active?s(ut,!1):s(We)})}t(ct),t(ge);var Ae=r(ge,2),St=a(Ae);ce(St,25,()=>e(xt),s=>s.type==="player"?s.id:s.instanceId,(s,o)=>{var d=Zr(),g=a(d);Mr(g,{get entity(){return e(o)},updateEnemy:Xe,removeFromCombat:Ue,updatePlayer:vt}),t(d),Va(d,()=>Or,()=>({duration:300})),n(s,d)});var yt=r(St,2);{var te=s=>{var o=Xr();n(s,o)};w(yt,s=>{e(xt).length===0&&s(te)})}t(Ae),t(de),fe(2),t(z);var we=r(z,2);{var Ye=s=>{var o=ei();o.__click=X=>{X.target===X.currentTarget&&D($,!1)};var d=a(o),g=a(d),N=a(g),M=a(N);Ja(M,{size:24}),t(N),fe(2),t(g);var x=r(g,2);ce(x,21,()=>e(ye),qe,(X,oe)=>{var ie=Yr(),le=a(ie),Oe=a(le);na(Oe,{size:14,class:"text-slate-500"});var _e=r(Oe);t(le);var nt=r(le,2);ce(nt,21,()=>e(oe).effects,qe,(Bt,At)=>{var bt=Kr(),he=a(bt),Ht=a(he);t(he);var Jt=r(he,2),Na=a(Jt,!0);t(Jt),t(bt),S(()=>{u(Ht,`${e(At).name??""}:`),u(Na,e(At).desc)}),n(Bt,bt)}),t(nt),t(ie),S(()=>u(_e,` ${e(oe).name??""}`)),n(X,ie)}),t(x);var V=r(x,2),Z=a(V);Z.__click=()=>D($,!1);var ne=r(Z,2);ne.__click=ze,t(V),t(d),t(o),n(s,o)};w(we,s=>{e($)&&s(Ye)})}var it=r(we,2),Ie=a(it),Me=a(Ie);Qa(Me,{size:16}),fe(),t(Ie);var xe=r(Ie,2);xe.__click=()=>Qe(20);var Le=r(xe,2);Le.__click=()=>Qe(6);var st=r(Le,2);st.__click=()=>Qe(6,2);var wt=r(st,2);wt.__click=()=>Qe(6,3),t(it);var Qt=r(it,2);{var Zt=s=>{var o=ti();o.__click=_e=>{_e.target===_e.currentTarget&&(e(q).isOpen=!1)};var d=a(o),g=a(d),N=a(g);t(g);var M=r(g,2),x=a(M);x.__click=()=>e(q).modifier--;var V=a(x);ma(V,{size:24}),t(x);var Z=r(x,2),ne=a(Z);t(Z);var X=r(Z,2);X.__click=()=>e(q).modifier++;var oe=a(X);Ft(oe,{size:24}),t(X),t(M);var ie=r(M,2),le=a(ie,!0);t(ie);var Oe=r(ie,2);Oe.__click=Ke,t(d),t(o),S(()=>{u(N,`Rolagem Rápida (${e(q).count??""}d${e(q).sides??""})`),ke(Z,1,`text-4xl font-bold ${e(q).modifier>0?"text-green-400":e(q).modifier<0?"text-red-400":"text-slate-500"}`),u(ne,`${e(q).modifier>0?"+":""}${e(q).modifier??""}`),u(le,e(q).sides===20?"Boons / Banes":"Modificador Fixo")}),n(s,o)};w(Qt,s=>{e(q).isOpen&&s(Zt)})}var Xt=r(Qt,2);{var Kt=s=>{var o=ii();o.__click=X=>{X.target===X.currentTarget&&D(T,!1)};var d=a(o),g=a(d),N=r(a(g),2);N.__click=()=>D(T,!1);var M=a(N);ea(M,{size:16}),t(N),t(g);var x=r(g,2),V=a(x);ce(V,17,()=>e(Pe),qe,(X,oe)=>{var ie=ai();ie.__click=()=>Te(e(oe).id);var le=a(ie),Oe=a(le,!0);t(le);var _e=r(le,2),nt=a(_e),Bt=a(nt,!0);t(nt);var At=r(nt,2),bt=a(At);t(At),t(_e);var he=r(_e,2),Ht=a(he);Ft(Ht,{size:16}),t(he),t(ie),S(Jt=>{u(Oe,Jt),u(Bt,e(oe).name),u(bt,`Nível ${e(oe).level??""} • ${e(oe).ancestry??""}`)},[()=>e(oe).name.charAt(0)]),n(X,ie)});var Z=r(V,2);{var ne=X=>{var oe=ri(),ie=a(oe),le=a(ie);na(le,{size:24}),t(ie),fe(4),t(oe),n(X,oe)};w(Z,X=>{e(Pe).length===0&&X(ne)})}t(x),t(d),t(o),n(s,o)};w(Xt,s=>{e(T)&&s(Kt)})}var aa=r(Xt,2);Ca(aa,{get isOpen(){return C()},onClose:()=>Lt.set(!1)});var Yt=r(aa,2);wa(Yt,{get isOpen(){return e(I).isOpen},get title(){return e(I).title},get message(){return e(I).message},get onConfirm(){return e(I).onConfirm},onCancel:()=>e(I).isOpen=!1}),S(()=>{u(Ot,e(T)?"Fechar":"Adicionar"),ke(_,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${e(pe)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),ke(j,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${e(pe)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`)}),n(k,y),Ut(),p()}Gt(["click"]);var oi=v('<div class="space-y-4"><div><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1">Nome</label><input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1">Dificuldade</label><input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1">Tamanho (Size)</label><input id="enemy-size" type="number" step="0.5" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1">Descrição</label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors" placeholder="Breve descrição ou notas sobre a criatura..."></textarea></div> <div class="grid grid-cols-1"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1">Speed</label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div></div>'),li=v('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),di=v('<div class="space-y-6"><div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3">Atributos Principais</h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1">Sentidos</label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm" placeholder="Ex: Visão no escuro"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1">Idiomas</label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm" placeholder="Ex: Comum, Élfico"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1">Imunidades</label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm" placeholder="Ex: Fogo, Veneno"/></div></div></div>'),vi=v('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none" placeholder="Nome"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2" placeholder="Descrição..."></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),ci=v('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded">Vazio</div>'),ui=v('<div><div class="flex justify-between items-center mb-3"><h4> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> Adicionar</button></div> <div class="space-y-3"><!> <!></div></div>'),bi=v('<div class="space-y-6"></div>'),xi=v('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),fi=v('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase">Sentidos:</span> <span class="text-white"> </span></div>'),pi=v('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase">Idiomas:</span> <span class="text-white"> </span></div>'),mi=v('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase">Imunidades:</span> <span class="text-white"> </span></div>'),gi=v('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),_i=v('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider">Traços</h4> <!></div>'),hi=v('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),yi=v('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider">Ações</h4> <!></div>'),wi=v('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),ki=v('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider">Reações</h4> <!></div>'),zi=v('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Ci=v('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider">Fim da Rodada</h4> <!></div>'),Ei=v('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar modal" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-6xl h-[90vh] border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><h3 id="modal-title" class="font-bold text-white text-lg">Editor de Inimigo</h3> <button class="lg:hidden text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50"><button>Geral</button> <button>Atributos</button> <button>Habilidades</button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3"><button class="px-6 py-2 rounded bg-slate-800 hover:bg-slate-700 text-white font-bold transition-colors">Cancelar</button> <button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> Salvar</button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> Pré-visualização</h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide"> </h2> <div class="h-1 w-20 bg-red-600 mb-4 rounded-full"></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]">Defesa</span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]">Vida</span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]">Tamanho</span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]">Speed</span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div></div></div></div></div>');function $i(k,i){qt(i,!0);let f=jt(i,"isOpen",3,!1),E=jt(i,"initialData",3,"{}"),l=je(Vt(c())),C=je("stats");function c(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}_a(()=>{if(f()&&E())try{const $=JSON.parse(E());Object.keys($).length===0?D(l,c(),!0):D(l,{...c(),...$},!0)}catch{D(l,c(),!0)}});function p($){e(l)[$]=[...e(l)[$],{name:"",desc:""}]}function T($,ye){e(l)[$]=e(l)[$].filter((I,Q)=>Q!==ye)}function A($){$.target===$.currentTarget&&i.onClose()}var L=Re(),Ne=se(L);{var pe=$=>{var ye=Ei();ye.__click=A;var I=a(ye),Q=a(I),Y=a(Q),H=r(a(Y),2);H.__click=function(..._){i.onClose?.apply(this,_)};var ee=a(H);ea(ee,{size:20}),t(H),t(Y);var me=r(Y,2),ue=a(me);ue.__click=()=>D(C,"stats");var be=r(ue,2);be.__click=()=>D(C,"attributes");var G=r(be,2);G.__click=()=>D(C,"abilities"),t(me);var F=r(me,2),Pe=a(F);{var R=_=>{var h=oi(),j=a(h),K=r(a(j));kt(K),t(j);var W=r(j,2),U=a(W),P=r(a(U));kt(P),t(U);var re=r(U,2),de=r(a(re));kt(de),t(re),t(W);var ge=r(W,2),ct=r(a(ge),2);ua(ct),t(ge);var Nt=r(ge,2),We=a(Nt),ut=r(a(We));kt(ut),t(We),t(Nt),t(h),It(K,()=>e(l).name,Ae=>e(l).name=Ae),It(P,()=>e(l).difficulty,Ae=>e(l).difficulty=Ae),It(de,()=>e(l).size,Ae=>e(l).size=Ae),It(ct,()=>e(l).description,Ae=>e(l).description=Ae),It(ut,()=>e(l).speed,Ae=>e(l).speed=Ae),n(_,h)},Te=_=>{var h=Re(),j=se(h);{var K=U=>{var P=di(),re=a(P),de=r(a(re),2);ce(de,20,()=>["str","agi","int","wil"],qe,(yt,te)=>{var we=li(),Ye=a(we),it=a(Ye,!0);t(Ye);var Ie=r(Ye,2);kt(Ie);var Me=r(Ie,2),xe=a(Me);t(Me),t(we),S(()=>{Pt(Ye,"for",`attr-${te??""}`),u(it,te),Pt(Ie,"id",`attr-${te??""}`),ke(Me,1,`text-xs font-bold ${e(l).stats[te]-10>=0?"text-green-500":"text-red-500"}`),u(xe,`${e(l).stats[te]-10>=0?"+":""}${e(l).stats[te]-10}`)}),It(Ie,()=>e(l).stats[te],Le=>e(l).stats[te]=Le),n(yt,we)}),t(de),t(re);var ge=r(re,2),ct=a(ge),Nt=r(a(ct));kt(Nt),t(ct);var We=r(ct,2),ut=r(a(We));kt(ut),t(We);var Ae=r(We,2),St=r(a(Ae));kt(St),t(Ae),t(ge),t(P),It(Nt,()=>e(l).senses,yt=>e(l).senses=yt),It(ut,()=>e(l).languages,yt=>e(l).languages=yt),It(St,()=>e(l).immune,yt=>e(l).immune=yt),n(U,P)},W=U=>{var P=Re(),re=se(P);{var de=ge=>{var ct=bi();ce(ct,20,()=>[{key:"traits",title:"Traços (Traits)",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",title:"Ações",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",title:"Reações",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",title:"Fim da Rodada",color:"text-yellow-400",border:"border-yellow-500/30"}],qe,(Nt,We)=>{var ut=ui(),Ae=a(ut),St=a(Ae),yt=a(St,!0);t(St);var te=r(St,2);te.__click=()=>p(We.key);var we=a(te);Ft(we,{size:12}),fe(),t(te),t(Ae);var Ye=r(Ae,2),it=a(Ye);ce(it,17,()=>e(l)[We.key],qe,(xe,Le,st)=>{var wt=vi(),Qt=a(wt),Zt=a(Qt);kt(Zt);var Xt=r(Zt,2);ua(Xt),t(Qt);var Kt=r(Qt,2);Kt.__click=()=>T(We.key,st);var aa=a(Kt);Wt(aa,{size:16}),t(Kt),t(wt),It(Zt,()=>e(Le).name,Yt=>e(Le).name=Yt),It(Xt,()=>e(Le).desc,Yt=>e(Le).desc=Yt),n(xe,wt)});var Ie=r(it,2);{var Me=xe=>{var Le=ci();n(xe,Le)};w(Ie,xe=>{e(l)[We.key].length===0&&xe(Me)})}t(Ye),t(ut),S(()=>{ke(ut,1,`p-4 bg-slate-900 rounded border ${We.border??""}`),ke(St,1,`font-bold text-sm uppercase ${We.color??""}`),u(yt,We.title)}),n(Nt,ut)}),t(ct),n(ge,ct)};w(re,ge=>{e(C)==="abilities"&&ge(de)},!0)}n(U,P)};w(j,U=>{e(C)==="attributes"?U(K):U(W,!1)},!0)}n(_,h)};w(Pe,_=>{e(C)==="stats"?_(R):_(Te,!1)})}t(F);var Ve=r(F,2),De=a(Ve);De.__click=function(..._){i.onClose?.apply(this,_)};var Se=r(De,2);Se.__click=()=>i.onSave(e(l));var lt=a(Se);Ma(lt,{size:18}),fe(),t(Se),t(Ve),t(Q);var dt=r(Q,2),Ze=a(dt),et=a(Ze),ze=a(et);ir(ze,{size:14}),fe(),t(et),t(Ze);var ae=r(Ze,2),Ue=a(ae),Xe=a(Ue),Ge=a(Xe);t(Xe);var q=r(Xe,2),Qe=a(q,!0);t(q);var Ke=r(q,4),ht=a(Ke),tt=r(a(ht),2),xt=a(tt,!0);t(tt),t(ht);var ft=r(ht,2),vt=r(a(ft),2),y=a(vt,!0);t(vt),t(ft);var z=r(ft,2),B=r(a(z),2),Ce=a(B,!0);t(B),t(z);var Ee=r(z,2),He=r(a(Ee),2),$e=a(He,!0);t(He),t(Ee),t(Ke);var Be=r(Ke,2);ce(Be,20,()=>["str","agi","int","wil"],qe,(_,h)=>{var j=xi(),K=a(j),W=a(K,!0);t(K);var U=r(K,2),P=a(U),re=r(P),de=a(re);t(re),t(U),t(j),S(()=>{u(W,h),u(P,`${e(l).stats[h]??""} `),ke(re,1,`text-xs ${e(l).stats[h]-10>=0?"text-green-500":"text-red-500"}`),u(de,`(${e(l).stats[h]-10>=0?"+":""}${e(l).stats[h]-10})`)}),n(_,j)}),t(Be);var pt=r(Be,2),mt=a(pt);{var Ot=_=>{var h=fi(),j=r(a(h),2),K=a(j,!0);t(j),t(h),S(()=>u(K,e(l).senses)),n(_,h)};w(mt,_=>{e(l).senses&&_(Ot)})}var at=r(mt,2);{var Rt=_=>{var h=pi(),j=r(a(h),2),K=a(j,!0);t(j),t(h),S(()=>u(K,e(l).languages)),n(_,h)};w(at,_=>{e(l).languages&&_(Rt)})}var rt=r(at,2);{var Dt=_=>{var h=mi(),j=r(a(h),2),K=a(j,!0);t(j),t(h),S(()=>u(K,e(l).immune)),n(_,h)};w(rt,_=>{e(l).immune&&_(Dt)})}t(pt);var Fe=r(pt,2),gt=a(Fe);{var Je=_=>{var h=_i(),j=r(a(h),2);ce(j,17,()=>e(l).traits,qe,(K,W)=>{var U=gi(),P=a(U),re=a(P);t(P);var de=r(P,2),ge=a(de,!0);t(de),t(U),S(()=>{u(re,`${e(W).name??""}:`),u(ge,e(W).desc)}),n(K,U)}),t(h),n(_,h)};w(gt,_=>{e(l).traits.length>0&&_(Je)})}var _t=r(gt,2);{var Tt=_=>{var h=yi(),j=r(a(h),2);ce(j,17,()=>e(l).actions,qe,(K,W)=>{var U=hi(),P=a(U),re=a(P);t(P);var de=r(P,2),ge=a(de,!0);t(de),t(U),S(()=>{u(re,`${e(W).name??""}:`),u(ge,e(W).desc)}),n(K,U)}),t(h),n(_,h)};w(_t,_=>{e(l).actions.length>0&&_(Tt)})}var b=r(_t,2);{var m=_=>{var h=ki(),j=r(a(h),2);ce(j,17,()=>e(l).reactions,qe,(K,W)=>{var U=wi(),P=a(U),re=a(P);t(P);var de=r(P,2),ge=a(de,!0);t(de),t(U),S(()=>{u(re,`${e(W).name??""}:`),u(ge,e(W).desc)}),n(K,U)}),t(h),n(_,h)};w(b,_=>{e(l).reactions.length>0&&_(m)})}var O=r(b,2);{var J=_=>{var h=Ci(),j=r(a(h),2);ce(j,17,()=>e(l).endOfRound,qe,(K,W)=>{var U=zi(),P=a(U),re=a(P);t(P);var de=r(P,2),ge=a(de,!0);t(de),t(U),S(()=>{u(re,`${e(W).name??""}:`),u(ge,e(W).desc)}),n(K,U)}),t(h),n(_,h)};w(O,_=>{e(l).endOfRound.length>0&&_(J)})}t(Fe),t(Ue),t(ae),t(dt),t(I),t(ye),S(()=>{ke(ue,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${e(C)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),ke(be,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${e(C)==="attributes"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),ke(G,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${e(C)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),u(Ge,`Dificuldade ${e(l).difficulty??""}`),u(Qe,e(l).name||"Inimigo"),u(xt,e(l).defense),u(y,e(l).health),u(Ce,e(l).size),u($e,e(l).speed)}),n($,ye)};w(Ne,$=>{f()&&$(pe)})}n(k,L),Ut()}Gt(["click"]);var Mi=v('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),Oi=v('<div class="text-center text-slate-600 italic text-sm py-4">Nenhum inimigo adicionado.</div>'),Ni=v('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),Si=v('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white">Criar/Editar Encontro</h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1">Nome do Encontro</label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500" placeholder="Ex: Emboscada na Cripta"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2">Inimigos no Encontro</h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2">Adicionar Inimigos</h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold">Cancelar</button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> Salvar Encontro</button></div></div></div>');function Ii(k,i){qt(i,!0);const f=()=>zt(ca,"$liveEnemies",E),[E,l]=ta();let C=jt(i,"isOpen",3,!1),c=jt(i,"initialData",3,"{}"),p=je(Vt({name:"",enemies:[]}));_a(()=>{if(C()&&c())try{const I=JSON.parse(c());D(p,{name:I.name||"",enemies:I.enemies||[]},!0)}catch{D(p,{name:"",enemies:[]},!0)}});function T(I){e(p).enemies.find(Y=>Y.enemyId===I)?e(p).enemies=e(p).enemies.map(Y=>Y.enemyId===I?{...Y,count:Y.count+1}:Y):e(p).enemies=[...e(p).enemies,{enemyId:I,count:1}]}function A(I){e(p).enemies=e(p).enemies.filter((Q,Y)=>Y!==I)}function L(I,Q){const Y=Math.max(1,parseInt(Q)||1);e(p).enemies[I].count=Y}function Ne(I){I.target===I.currentTarget&&i.onClose()}var pe=Re(),$=se(pe);{var ye=I=>{var Q=Si();Q.__click=Ne;var Y=a(Q),H=a(Y),ee=r(a(H),2);ee.__click=function(...ae){i.onClose?.apply(this,ae)};var me=a(ee);ea(me,{size:20}),t(ee),t(H);var ue=r(H,2),be=a(ue),G=r(a(be),2);kt(G),t(be),t(ue);var F=r(ue,2),Pe=a(F),R=r(a(Pe),2),Te=a(R);ce(Te,17,()=>e(p).enemies,qe,(ae,Ue,Xe)=>{const Ge=ve(()=>f().find(B=>B.id===e(Ue).enemyId));var q=Mi(),Qe=a(q),Ke=a(Qe),ht=a(Ke,!0);t(Ke);var tt=r(Ke,2),xt=a(tt);t(tt),t(Qe);var ft=r(Qe,2),vt=a(ft);kt(vt),vt.__input=B=>L(Xe,B.target.value);var y=r(vt,2);y.__click=()=>A(Xe);var z=a(y);Wt(z,{size:16}),t(y),t(ft),t(q),S(()=>{u(ht,e(Ge)?e(Ge).name:"Desconhecido"),u(xt,`Dif ${(e(Ge)?e(Ge).difficulty:"?")??""}`),va(vt,e(Ue).count)}),n(ae,q)});var Ve=r(Te,2);{var De=ae=>{var Ue=Oi();n(ae,Ue)};w(Ve,ae=>{e(p).enemies.length===0&&ae(De)})}t(R),t(Pe);var Se=r(Pe,2),lt=r(a(Se),2);ce(lt,5,f,ae=>ae.id,(ae,Ue)=>{var Xe=Ni(),Ge=a(Xe),q=a(Ge),Qe=a(q,!0);t(q);var Ke=r(q,2),ht=a(Ke);t(Ke),t(Ge);var tt=r(Ge,2);tt.__click=()=>T(e(Ue).id);var xt=a(tt);Ft(xt,{size:16}),t(tt),t(Xe),S(()=>{u(Qe,e(Ue).name),u(ht,`Dif ${e(Ue).difficulty??""}`)}),n(ae,Xe)}),t(lt),t(Se),t(F);var dt=r(F,2),Ze=a(dt);Ze.__click=function(...ae){i.onClose?.apply(this,ae)};var et=r(Ze,2);et.__click=()=>i.onSave(e(p));var ze=a(et);Ma(ze,{size:18}),fe(),t(et),t(dt),t(Y),t(Q),It(G,()=>e(p).name,ae=>e(p).name=ae),n(I,Q)};w($,I=>{C()&&I(ye)})}n(k,pe),Ut(),l()}Gt(["click","input"]);var ji=v('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),Ri=v('<div class="text-[10px] text-slate-600 italic">Vazio</div>'),Di=v('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="font-bold text-white text-base mb-2 group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> Iniciar</button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),Ai=v('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),Pi=v('<div class="mb-4 flex-1"><p> </p> <!></div>'),Ti=v('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic">Sem descrição.</div>'),Hi=v('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all">Editar</button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),Fi=v('<div class="text-center text-slate-500 italic col-span-3">Nenhum inimigo cadastrado.</div>'),Vi=v('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> Encontros Prontos</h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm">Novo Encontro</span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> Biblioteca de Inimigos</h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm">Novo Inimigo</span></button> <!> <!></div> <!> <!> <!></div>');function Bi(k,i){qt(i,!0);const f=()=>zt(ca,"$liveEnemies",C),E=()=>zt(ka,"$liveEncounters",C),l=()=>zt(ha,"$page",C),[C,c]=ta();let p=je(!1),T=je(null),A=je("{}"),L=je(!1),Ne=je(null),pe=je("{}"),$=je(Vt({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function ye(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function I(y=null){D(T,y?y.id:null,!0),D(A,JSON.stringify(y||ye()),!0),D(p,!0)}let Q=Vt(new Set);function Y(y){Q.has(y)?Q.delete(y):Q.add(y)}function H(y){const z=e(T)||pa();fa.set(z,{...y,id:z}),D(p,!1)}function ee(y){const z=f().find(B=>B.id===y);D($,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${z?.name||"este inimigo"}"?`,onConfirm:()=>{fa.delete(y),e($).isOpen=!1}},!0)}function me(y=null){D(Ne,y?y.id:null,!0),D(pe,JSON.stringify(y||{name:"",enemies:[]}),!0),D(L,!0)}function ue(y){const z=e(Ne)||pa();la.set(z,{...y,id:z}),D(L,!1)}function be(y){const z=E().find(B=>B.id===y);D($,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${z?.name||"este encontro"}"?`,onConfirm:()=>{la.delete(y),e($).isOpen=!1}},!0)}function G(y){const z=l().params.id;if(!z||!ot.has(z))return;const B=ot.get(z),Ce=B.activeEnemies||[];let Ee=[];y.enemies.forEach(He=>{const $e=f().find(Be=>Be.id===He.enemyId);if($e)for(let Be=0;Be<He.count;Be++)Ee.push({...$e,instanceId:`e_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,damage:0,currentHealth:$e.health,afflictions:[],acted:!1,initiative:!1})}),ot.set(z,{...B,activeEnemies:[...Ce,...Ee]})}function F(y,z){y.dataTransfer.setData("text/plain",z.id),y.dataTransfer.effectAllowed="copy"}function Pe(y){return y.preventDefault(),!1}function R(y,z){y.preventDefault();const B=y.dataTransfer.getData("text/plain");if(!B)return;const Ce=z.enemies||[],Ee=Ce.find($e=>$e.enemyId===B);let He;Ee?He=Ce.map($e=>$e.enemyId===B?{...$e,count:$e.count+1}:$e):He=[...Ce,{enemyId:B,count:1}],la.set(z.id,{...z,enemies:He})}var Te=Vi(),Ve=a(Te),De=a(Ve),Se=a(De),lt=a(Se);$a(lt,{size:16}),fe(),t(Se),t(De);var dt=r(De,2),Ze=a(dt);Ze.__click=()=>me();var et=a(Ze);Ft(et,{size:28,class:"group-hover:scale-110 transition-transform"}),fe(2),t(Ze);var ze=r(Ze,2);ce(ze,1,E,y=>y.id,(y,z)=>{var B=Di(),Ce=a(B),Ee=a(Ce),He=a(Ee,!0);t(Ee);var $e=r(Ee,2),Be=a($e);ce(Be,17,()=>e(z).enemies||[],qe,(Je,_t)=>{const Tt=ve(()=>f().find(h=>h.id===e(_t).enemyId));var b=ji(),m=a(b),O=a(m);t(m);var J=r(m,2),_=a(J,!0);t(J),t(b),S(()=>{u(O,`${e(_t).count??""}x`),u(_,e(Tt)?e(Tt).name:"...")}),n(Je,b)});var pt=r(Be,2);{var mt=Je=>{var _t=Ri();n(Je,_t)};w(pt,Je=>{e(z).enemies?.length||Je(mt)})}t($e),t(Ce);var Ot=r(Ce,2),at=a(Ot);at.__click=()=>G(e(z));var Rt=a(at);za(Rt,{size:12,fill:"currentColor"}),fe(),t(at);var rt=r(at,2);rt.__click=()=>me(e(z));var Dt=a(rt);La(Dt,{size:14}),t(rt);var Fe=r(rt,2);Fe.__click=()=>be(e(z).id);var gt=a(Fe);Wt(gt,{size:14}),t(Fe),t(Ot),t(B),S(()=>{Pt(B,"aria-label",`Encontro ${e(z).name??""}`),u(He,e(z).name)}),oa("dragover",B,Pe),oa("drop",B,Je=>R(Je,e(z))),n(y,B)}),t(dt),t(Ve);var ae=r(Ve,2),Ue=a(ae),Xe=a(Ue);na(Xe,{size:16}),fe(),t(Ue),t(ae);var Ge=r(ae,2),q=a(Ge);q.__click=()=>I();var Qe=a(q);Ft(Qe,{size:32,class:"group-hover:scale-110 transition-transform"}),fe(2),t(q);var Ke=r(q,2);ce(Ke,1,f,y=>y.id,(y,z)=>{var B=Hi(),Ce=a(B),Ee=a(Ce),He=a(Ee,!0);t(Ee);var $e=r(Ee,2),Be=a($e);t($e),t(Ce);var pt=r(Ce,2);{var mt=Fe=>{var gt=Pi(),Je=a(gt),_t=a(Je,!0);t(Je);var Tt=r(Je,2);{var b=m=>{var O=Ai();O.__click=()=>Y(e(z).id);var J=a(O,!0);t(O),S(_=>u(J,_),[()=>Q.has(e(z).id)?"Ver menos":"Ver mais..."]),n(m,O)};w(Tt,m=>{e(z).description.length>120&&m(b)})}t(gt),S(m=>{ke(Je,1,`text-xs text-slate-400 leading-relaxed ${m??""}`),u(_t,e(z).description)},[()=>Q.has(e(z).id)?"":"line-clamp-3"]),n(Fe,gt)},Ot=Fe=>{var gt=Ti();n(Fe,gt)};w(pt,Fe=>{e(z).description?Fe(mt):Fe(Ot,!1)})}var at=r(pt,2),Rt=a(at);Rt.__click=()=>I(e(z));var rt=r(Rt,2);rt.__click=()=>ee(e(z).id);var Dt=a(rt);Wt(Dt,{size:14}),t(rt),t(at),t(B),S(()=>{u(He,e(z).name),u(Be,`Nível ${e(z).difficulty??""}`)}),oa("dragstart",B,Fe=>F(Fe,e(z))),n(y,B)});var ht=r(Ke,2);{var tt=y=>{var z=Fi();n(y,z)};w(ht,y=>{f().length===0&&y(tt)})}t(Ge);var xt=r(Ge,2);$i(xt,{get isOpen(){return e(p)},get initialData(){return e(A)},onClose:()=>D(p,!1),onSave:H});var ft=r(xt,2);Ii(ft,{get isOpen(){return e(L)},get initialData(){return e(pe)},onClose:()=>D(L,!1),onSave:ue});var vt=r(ft,2);wa(vt,{get isOpen(){return e($).isOpen},get title(){return e($).title},get message(){return e($).message},get onConfirm(){return e($).onConfirm},onCancel:()=>e($).isOpen=!1}),t(Te),n(k,Te),Ut(),c()}Gt(["click"]);var Li=v('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),qi=v('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-2 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group" aria-label="Voltar para Dashboard" title="Voltar para Dashboard"><!> <!></button> <div class="flex flex-col"><h1 class="text-sm sm:text-base font-bold text-white leading-tight truncate max-w-[120px] sm:max-w-none"> </h1> <span class="text-[10px] text-indigo-400 font-mono font-bold uppercase tracking-wider"> </span></div></div> <div class="flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block">Sessão</span></button> <button><!> <span class="hidden min-[400px]:block">Bestiário</span></button></div> <div class="flex items-center gap-1 sm:gap-2"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all" aria-label="Configurações da Campanha" title="Configurações"><!></button> <button class="p-2 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative" aria-label="Toggle Histórico" title="Histórico"><!> <!></button></div></div></div></header>');function Ui(k,i){qt(i,!0);const f=()=>zt(Lt,"$isHistoryOpen",l),E=()=>zt(Da,"$rollHistory",l),[l,C]=ta();let c=jt(i,"campaignName",3,""),p=jt(i,"gmName",3,"Mestre"),T=jt(i,"activeSubTab",3,"session"),A=jt(i,"onTabChange",3,()=>{}),L=jt(i,"onOpenSettings",3,()=>{});var Ne=qi(),pe=a(Ne),$=a(pe),ye=a($),I=a(ye);I.__click=()=>Ya(ya("/"));var Q=a(I);Ea(Q,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var Y=r(Q,2);Wa(Y,{size:18,class:"hidden sm:block opacity-50"}),t(I);var H=r(I,2),ee=a(H),me=a(ee,!0);t(ee);var ue=r(ee,2),be=a(ue,!0);t(ue),t(H),t(ye);var G=r(ye,2),F=a(G);F.__click=()=>A()("session");var Pe=a(F);{let ze=ve(()=>T()==="session"?"opacity-100":"opacity-50");Za(Pe,{size:14,get class(){return e(ze)}})}fe(2),t(F);var R=r(F,2);R.__click=()=>A()("bestiary");var Te=a(R);{let ze=ve(()=>T()==="bestiary"?"opacity-100":"opacity-50");or(Te,{size:14,get class(){return e(ze)}})}fe(2),t(R),t(G);var Ve=r(G,2),De=a(Ve);De.__click=function(...ze){L()?.apply(this,ze)};var Se=a(De);Xa(Se,{size:18}),t(De);var lt=r(De,2);lt.__click=()=>Lt.update(ze=>!ze);var dt=a(lt);Ka(dt,{size:18});var Ze=r(dt,2);{var et=ze=>{var ae=Li();n(ze,ae)};w(Ze,ze=>{E()&&E().length>0&&ze(et)})}t(lt),t(Ve),t($),t(pe),t(Ne),S(()=>{u(me,c()),u(be,p()),ke(F,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${T()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),Pt(F,"aria-pressed",T()==="session"),ke(R,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${T()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),Pt(R,"aria-pressed",T()==="bestiary"),Pt(lt,"aria-pressed",f())}),n(k,Ne),Ut(),C()}Gt(["click"]);var Gi=v('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),Qi=v('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight">Campanha Não Encontrada</h1> <p class="text-slate-400 mb-8 max-w-md">Esta campanha não existe na sua base local ou foi removida. Crie uma nova campanha através da página inicial.</p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> Voltar</button></div>'),Ji=v('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),Wi=v('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!></div>');function xs(k,i){qt(i,!0);const f=()=>zt(ha,"$page",C),E=()=>zt(Pa,"$liveCampaigns",C),l=()=>zt(Lt,"$isHistoryOpen",C),[C,c]=ta();let p=je("session"),T=je(!1),A=ve(()=>f().params.id),L=ve(()=>E().find(H=>H.id===e(A))),Ne=ve(()=>!!e(L));function pe(H){if(!e(A)||!e(L))return;const ee={...e(L),...H};ot.set(e(A),ee),da(e(A),{name:ee.name,gmName:ee.gmName}),D(T,!1)}var $=Wi(),ye=a($);{var I=H=>{var ee=Gi(),me=se(ee);Ui(me,{get campaignName(){return e(L).name},get gmName(){return e(L).gmName},get activeSubTab(){return e(p)},onTabChange:R=>D(p,R,!0),onOpenSettings:()=>D(T,!0)});var ue=r(me,2);{let R=ve(()=>JSON.stringify(e(L)));Ga(ue,{get isOpen(){return e(T)},get initialData(){return e(R)},onClose:()=>D(T,!1),onSave:pe})}var be=r(ue,2),G=a(be);{var F=R=>{ni(R,{get campaign(){return e(L)}})},Pe=R=>{var Te=Re(),Ve=se(Te);{var De=Se=>{Bi(Se,{})};w(Ve,Se=>{e(p)==="bestiary"&&Se(De)},!0)}n(R,Te)};w(G,R=>{e(p)==="session"?R(F):R(Pe,!1)})}t(be),n(H,ee)},Q=H=>{var ee=Re(),me=se(ee);{var ue=G=>{var F=Qi(),Pe=r(a(F),6);Pe.__click=()=>window.history.back(),t(F),n(G,F)},be=G=>{var F=Ji();n(G,F)};w(me,G=>{e(Ne)&&!e(L)?G(ue):G(be,!1)},!0)}n(H,ee)};w(ye,H=>{e(Ne)&&e(L)?H(I):H(Q,!1)})}var Y=r(ye,2);Ca(Y,{get isOpen(){return l()},onClose:()=>Lt.set(!1)}),t($),n(k,$),Ut(),c()}Gt(["click"]);export{xs as component};
