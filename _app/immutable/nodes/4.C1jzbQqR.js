import"../chunks/DsnmJJEf.js";import{B as Ot,o as qe,k as d,p as la,v as oa,j as u,q as t,x as a,u as s,z as F,A as e,t as x,O as Pa,w as C,y as mt,n as ya,D as Ja,a2 as ga,at as ha}from"../chunks/CeF9Pysg.js";import{d as ba,s as i,o as ss,g as Qa,e as ja}from"../chunks/CG7HK1rV.js";import{l as xa,s as _a,i as w,p as sa}from"../chunks/dZMd9PJ3.js";import{e as Be,s as Fe,i as kt,$ as aa,r as wt,a as Ce,h as Va,g as Na,j as Es}from"../chunks/BdIRB7Hx.js";import{a as va,s as Lt}from"../chunks/CIaeXpBv.js";import{p as Ss}from"../chunks/BIPRdgeB.js";import{d as rs,m as $a,j as Is,c as is,e as ea,n as Ya,o as Ds,q as Ma,t as Ra,u as Ia,b as ut,v as vs,f as ns,g as Ga,x as Rs,y as Ns,z as $s}from"../chunks/DOdbJzaW.js";import{C as cs,D as Oa,l as As,d as Ka,e as us,a as Ts,c as Us}from"../chunks/BXBeGz03.js";import{b as Ps,t as Aa,f as Ta}from"../chunks/xr51uyWC.js";import{U as bs,C as ls,W as xs,r as _s}from"../chunks/DtThqFTQ.js";import{A as Ls,a as Hs,b as Da,B as Fs,T as qs,E as es,M as fs,G as Ca,H as ms,C as La,R as Bs,c as Ws,I as ps,s as gs,d as hs,S as ys,L as Js,e as ws,f as Gs,D as Ea,g as Qs}from"../chunks/Bmx-abdj.js";import{k as ts}from"../chunks/Kfm9o0Gg.js";import{M as Vs,X as wa,P as ra,a as Ua,d as Ys,b as ua,c as Zs}from"../chunks/DUisz7Bf.js";import{C as ks,G as pa,P as Za,S as Xs,a as Ks}from"../chunks/BIzY1cZT.js";import"../chunks/C3FPqVk7.js";import{I as fa,s as ma}from"../chunks/DhGkR45b.js";import{b as zs}from"../chunks/CWVXqVlC.js";import{g as er}from"../chunks/BAw0feI9.js";import{W as tr}from"../chunks/BdfQ1NTG.js";function ar(U,r){const l=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["path",{d:"m6 9 6 6 6-6"}]];fa(U,_a({name:"chevron-down"},()=>l,{get iconNode(){return K},children:(D,_)=>{var j=Ot(),S=qe(j);ma(S,r,"default",{}),d(D,j)},$$slots:{default:!0}}))}function sr(U,r){const l=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["path",{d:"m18 15-6-6-6 6"}]];fa(U,_a({name:"chevron-up"},()=>l,{get iconNode(){return K},children:(D,_)=>{var j=Ot(),S=qe(j);ma(S,r,"default",{}),d(D,j)},$$slots:{default:!0}}))}function rr(U,r){const l=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];fa(U,_a({name:"copy"},()=>l,{get iconNode(){return K},children:(D,_)=>{var j=Ot(),S=qe(j);ma(S,r,"default",{}),d(D,j)},$$slots:{default:!0}}))}function ir(U,r){const l=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];fa(U,_a({name:"flame"},()=>l,{get iconNode(){return K},children:(D,_)=>{var j=Ot(),S=qe(j);ma(S,r,"default",{}),d(D,j)},$$slots:{default:!0}}))}function nr(U,r){const l=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];fa(U,_a({name:"grip-vertical"},()=>l,{get iconNode(){return K},children:(D,_)=>{var j=Ot(),S=qe(j);ma(S,r,"default",{}),d(D,j)},$$slots:{default:!0}}))}function Xa(U,r){const l=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];fa(U,_a({name:"layers"},()=>l,{get iconNode(){return K},children:(D,_)=>{var j=Ot(),S=qe(j);ma(S,r,"default",{}),d(D,j)},$$slots:{default:!0}}))}function Cs(U,r){const l=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];fa(U,_a({name:"library"},()=>l,{get iconNode(){return K},children:(D,_)=>{var j=Ot(),S=qe(j);ma(S,r,"default",{}),d(D,j)},$$slots:{default:!0}}))}function lr(U,r){const l=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];fa(U,_a({name:"qr-code"},()=>l,{get iconNode(){return K},children:(D,_)=>{var j=Ot(),S=qe(j);ma(S,r,"default",{}),d(D,j)},$$slots:{default:!0}}))}function as(U,r){const l=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];fa(U,_a({name:"save"},()=>l,{get iconNode(){return K},children:(D,_)=>{var j=Ot(),S=qe(j);ma(S,r,"default",{}),d(D,j)},$$slots:{default:!0}}))}function js(U,r){const l=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];fa(U,_a({name:"swords"},()=>l,{get iconNode(){return K},children:(D,_)=>{var j=Ot(),S=qe(j);ma(S,r,"default",{}),d(D,j)},$$slots:{default:!0}}))}function or(U){let r=!1;return document.body&&(document.body.appendChild(U),r=!0),{destroy(){r&&U.parentNode&&U.parentNode.removeChild(U)}}}var dr=u("<button> <!></button>"),vr=u('<p class="text-xs text-slate-600 italic"> </p>'),cr=u('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),ur=u('<div class="space-y-1"></div>'),br=u('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),xr=u("<div><!></div>");function _r(U,r){la(r,!0);const l=()=>Lt(aa,"$t",K),[K,D]=va();var _=Ot(),j=qe(_);{var S=n=>{var h=xr(),N=t(h);{let le=F(()=>l()("session.affliction_modal.title"));Vs(N,{get isOpen(){return r.isOpen},get onClose(){return r.onClose},get title(){return a(le)},maxWidth:"max-w-md",children:(re,me)=>{var A=br(),I=qe(A);Be(I,21,()=>Object.keys(Ls),kt,(ue,je)=>{const Ue=F(()=>r.afflictions.includes(a(je)));var xe=dr();xe.__click=()=>r.onToggle(a(je));var E=t(xe),X=s(E);{var _e=Me=>{ks(Me,{size:14,class:"text-red-400"})};w(X,Me=>{a(Ue)&&Me(_e)})}e(xe),x(Me=>{Fe(xe,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(Ue)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),i(E,`${Me??""} `)},[()=>l()(`character.afflictions.${a(je)}`)]),d(ue,xe)}),e(I);var O=s(I,2),ae=t(O),se=t(ae),ot=t(se,!0);e(se);var We=s(se,2);{var jt=ue=>{var je=vr(),Ue=t(je,!0);e(je),x(xe=>i(Ue,xe),[()=>l()("session.affliction_modal.none_selected")]),d(ue,je)},ie=ue=>{var je=ur();Be(je,21,()=>r.afflictions,kt,(Ue,xe)=>{var E=cr(),X=t(E),_e=t(X);e(X);var Me=s(X,2),pe=t(Me,!0);e(Me),e(E),x((bt,Ke)=>{i(_e,`${bt??""}:`),i(pe,Ke)},[()=>l()(`character.afflictions.${a(xe)}`),()=>l()(`sofww.afflictions.${a(xe).toLowerCase().replace(" ","_")}.effect`)]),d(Ue,E)}),e(je),d(ue,je)};w(We,ue=>{r.afflictions.length===0?ue(jt):ue(ie,!1)})}e(ae);var we=s(ae,2),be=t(we);be.__click=function(...ue){r.onClose?.apply(this,ue)};var ke=t(be,!0);e(be),e(we),e(O),x((ue,je)=>{i(ot,ue),i(ke,je)},[()=>l()("session.affliction_modal.effects"),()=>l()("session.affliction_modal.done")]),d(re,A)},$$slots:{default:!0}})}e(h),Hs(h,le=>or?.(le)),d(n,h)};w(j,n=>{r.isOpen&&n(S)})}d(U,_),oa(),D()}ba(["click"]);var fr=u('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),mr=u('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),pr=u('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),gr=u("<button><!></button>"),hr=u('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),yr=u('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),wr=u('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),kr=u('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),zr=u('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),Cr=u('<div class="flex flex-col items-center justify-between bg-cyan-950/20 border border-cyan-500/30 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-cyan-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div>'),jr=u('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),Mr=u('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),Or=u('<div class="grid grid-cols-2 gap-4 mb-4"><div class="p-3 rounded-xl bg-purple-950/20 border border-purple-500/30 flex justify-between items-center group/ins"><div><span class="text-[9px] text-purple-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div> <div class="p-3 rounded-xl bg-red-950/20 border border-red-500/30 flex justify-between items-center group/cor"><div><span class="text-[9px] text-red-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div></div>'),Er=u("<!> ",1),Sr=u('<div><div class="text-emerald-500 text-[10px] font-black uppercase mb-2 flex items-center gap-2"> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="flex flex-wrap gap-2"></div></div>'),Ir=u('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),Dr=u('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),Rr=u('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <!> <div class="grid grid-cols-2 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"><!> <!></div></div>'),Nr=u('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div> <!></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function $r(U,r){la(r,!0);const l=()=>Lt(aa,"$t",K),[K,D]=va();let _=sa(r,"updateEnemy",3,(f,b)=>{}),j=sa(r,"updatePlayer",3,(f,b)=>{}),S=sa(r,"removeFromCombat",3,f=>{}),n=F(()=>r.entity.type==="player"),h=F(()=>r.entity.system==="sofdl"),N=F(()=>r.entity.damage||0),le=F(()=>r.entity.normalHealth||r.entity.health||10),re=F(()=>r.entity.currentHealth??a(le)),me=F(()=>a(N)>=a(re)),A=F(()=>a(N)>=a(re)/2&&!a(me)),I=F(()=>a(re)>0?Math.min(100,Math.max(0,a(N)/a(re)*100)):100),O=mt(!1),ae=mt(!1);Pa(()=>{const f=r.entity.afflictions||[],b=f.includes("Incapacitated");if(a(me)&&!b){const k={afflictions:[...f,"Incapacitated"]};r.entity.type==="player"?se(k):_()(r.entity.instanceId,k)}else if(!a(me)&&b){const k={afflictions:f.filter(ye=>ye!=="Incapacitated")};r.entity.type==="player"?se(k):_()(r.entity.instanceId,k)}});function se(f){if(r.entity.type!=="player")return;const b=rs.get(r.entity.id);b&&rs.set(r.entity.id,{...b,...f}),j()(r.entity.id,f),$a({id:r.entity.id,...f})}function ot(f){const b=parseInt(f.target.value);if(isNaN(b))return;const k={damage:Math.max(0,b)};r.entity.type==="player"?se(k):_()(r.entity.instanceId,k)}function We(f){const b=parseInt(f.target.value);if(isNaN(b))return;const z=Math.max(0,b);let k=a(N);z<a(N)&&(k=z);const ye={currentHealth:z,damage:k};r.entity.type==="player"?se(ye):_()(r.entity.instanceId,ye)}function jt(){const f=!r.entity.acted;r.entity.type==="player"?se({acted:f}):_()(r.entity.instanceId,{acted:f})}function ie(){r.entity.type==="player"&&se({initiative:!r.entity.initiative})}function we(f){const b=r.entity.afflictions||[],k={afflictions:b.includes(f)?b.filter(ye=>ye!==f):[...b,f]};r.entity.type==="player"?se(k):_()(r.entity.instanceId,k)}var be=Nr(),ke=t(be);{var ue=f=>{var b=fr(),z=t(b,!0);e(b),x(k=>i(z,k),[()=>l()("session.combat_card.initiative")]),d(f,b)};w(ke,f=>{a(n)&&r.entity.initiative&&f(ue)})}var je=s(ke,2);{var Ue=f=>{var b=mr();d(f,b)};w(je,f=>{a(me)&&f(Ue)})}var xe=s(je,2),E=t(xe),X=t(E),_e=t(X),Me=t(_e);ts(Me,()=>r.entity.imageUrl,f=>{{let b=F(()=>r.entity.name.charAt(0));Da(f,{get hash(){return r.entity.imageUrl},get alt(){return r.entity.name},size:"custom",get fallbackText(){return a(b)}})}}),e(_e);var pe=s(_e,2);pe.__click=jt;var bt=t(pe);{var Ke=f=>{Ua(f,{size:14,class:""})},pt=f=>{var b=Ot(),z=qe(b);{var k=Te=>{ks(Te,{size:14})},ye=Te=>{js(Te,{size:14})};w(z,Te=>{r.entity.acted?Te(k):Te(ye,!1)},!0)}d(f,b)};w(bt,f=>{a(me)?f(Ke):f(pt,!1)})}e(pe),e(X);var xt=s(X,2),B=t(xt),ge=t(B),Pe=t(ge),Ve=t(Pe),_t=t(Ve,!0);e(Ve);var Ye=s(Ve,2);{var ze=f=>{var b=pr(),z=t(b);e(b),x(()=>i(z,`Dif ${r.entity.difficulty??""}`)),d(f,b)};w(Ye,f=>{a(n)||f(ze)})}e(Pe),e(ge);var Re=s(ge,2),Q=t(Re);Q.__click=()=>C(O,!a(O));var he=t(Q);{var Se=f=>{sr(f,{size:14})},$e=f=>{ar(f,{size:14})};w(he,f=>{a(O)?f(Se):f($e,!1)})}e(Q);var Le=s(Q,2);{var nt=f=>{var b=gr();b.__click=ie;var z=t(b);ir(z,{size:14}),e(b),x(k=>{Fe(b,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${r.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),Ce(b,"title",k)},[()=>l()("session.combat_card.initiative")]),d(f,b)},et=f=>{var b=hr();b.__click=()=>S()(r.entity.instanceId);var z=t(b);wa(z,{size:14}),e(b),d(f,b)};w(Le,f=>{a(n)?f(nt):f(et,!1)})}e(Re),e(B);var dt=s(B,2),zt=t(dt),Ht=s(zt,2);{var Et=f=>{var b=yr();x(()=>{Fe(b,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10
                            ${a(me)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(I)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(A)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),Na(b,`width: ${a(I)??""}%`)}),d(f,b)};w(Ht,f=>{a(I)>0&&f(Et)})}var Ft=s(Ht,2);{var M=f=>{var b=wr();d(f,b)};w(Ft,f=>{a(N)===0&&f(M)})}var q=s(Ft,2);{var P=f=>{var b=kr(),z=t(b),k=t(z,!0);e(z),e(b),x(ye=>i(k,ye),[()=>l()("session.combat_card.incapacitated")]),d(f,b)},Ne=f=>{var b=Ot(),z=qe(b);{var k=ye=>{var Te=zr(),Xe=t(Te),Qe=t(Xe,!0);e(Xe),e(Te),x(gt=>i(Qe,gt),[()=>l()("session.combat_card.injured")]),d(ye,Te)};w(z,ye=>{a(A)&&ye(k)},!0)}d(f,b)};w(q,f=>{a(me)?f(P):f(Ne,!1)})}e(dt);var tt=s(dt,2),at=t(tt),Ze=t(at),Ct=t(Ze),Mt=t(Ct,!0);e(Ct);var St=s(Ct,2),Je=t(St,!0);e(St),e(Ze);var H=s(Ze,2),T=t(H),L=t(T,!0);e(T);var fe=s(T,2);wt(fe),fe.__input=ot,ya(2),e(H);var W=s(H,2),J=t(W),ne=t(J,!0);e(J);var Ge=s(J,2),de=t(Ge);wt(de),de.__input=We;var oe=s(de,2),G=t(oe);e(oe),e(Ge),e(W);var Oe=s(W,2);{var ve=f=>{var b=Cr(),z=t(b),k=t(z,!0);e(z);var ye=s(z,2),Te=t(ye,!0);e(ye),e(b),x(Xe=>{i(k,Xe),i(Te,r.entity.perception||10)},[()=>l()("sofdl.attributes.perception")]),d(f,b)};w(Oe,f=>{a(h)&&f(ve)})}e(at);var Ae=s(at,2),rt=t(Ae);Be(rt,17,()=>r.entity.afflictions||[],kt,(f,b)=>{var z=jr();z.__click=()=>we(a(b));var k=t(z),ye=s(k);wa(ye,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(z),x(()=>i(k,`${a(b)??""} `)),d(f,z)});var it=s(rt,2);it.__click=()=>C(ae,!0);var lt=t(it);ra(lt,{size:10});var Tt=s(lt);e(it),e(Ae),e(tt),e(xt),e(E),e(xe);var It=s(xe,2);{var Qt=f=>{var b=Rr(),z=t(b),k=t(z),ye=t(k),Te=t(ye,!0);e(ye),ya(2),e(k);var Xe=s(k,2);Be(Xe,21,()=>a(h)?["strength","agility","intellect","will"]:["str","agi","int","wil"],kt,(o,v)=>{const c=F(()=>a(h)?r.entity.attributes?.[a(v)]??10:r.entity.stats?.[a(v)]??r.entity.attributes?.[a(v)]??10),p=F(()=>a(c)-10);var $=Mr(),m=t($),y=t(m,!0);e(m);var g=s(m,2),ee=t(g,!0);e(g);var R=s(g,2),Y=t(R);e(R),e($),x(V=>{i(y,V),i(ee,a(c)),Fe(R,1,`text-[9px] font-bold ${a(p)>=0?"text-emerald-500":"text-red-500"}`),i(Y,`${a(p)>=0?"+":""}${a(p)??""}`)},[()=>a(h)?a(v).slice(0,3):a(v)]),d(o,$)}),e(Xe),e(z);var Qe=s(z,2);{var gt=o=>{var v=Or(),c=t(v),p=t(c),$=t(p),m=t($,!0);e($);var y=s($,2),g=t(y,!0);e(y),e(p);var ee=s(p,2);Fs(ee,{size:20,class:"text-purple-500/30 group-hover/ins:text-purple-500 transition-colors"}),e(c);var R=s(c,2),Y=t(R),V=t(Y),ce=t(V,!0);e(V);var te=s(V,2),Ie=t(te,!0);e(te),e(Y);var Z=s(Y,2);Ua(Z,{size:20,class:"text-red-500/30 group-hover/cor:text-red-500 transition-colors"}),e(R),e(v),x((De,Ee)=>{i(m,De),i(g,r.entity.insanity||0),i(ce,Ee),i(Ie,r.entity.corruption||0)},[()=>l()("sofdl.attributes.insanity"),()=>l()("sofdl.attributes.corruption")]),d(o,v)};w(Qe,o=>{a(h)&&o(gt)})}var ht=s(Qe,2),Ut=t(ht),Dt=t(Ut),Bt=t(Dt,!0);e(Dt);var Gt=s(Dt,2),Xt=t(Gt,!0);e(Gt),e(Ut);var ta=s(Ut,2),Jt=t(ta),Wt=t(Jt,!0);e(Jt);var Vt=s(Jt,2),ca=t(Vt,!0);e(Vt),e(ta),e(ht);var Zt=s(ht,2),vt=t(Zt);{var At=o=>{var v=Sr(),c=t(v),p=t(c);ya(),e(c);var $=s(c,2);Be($,21,()=>r.entity.senses,kt,(m,y)=>{const g=F(()=>{const[Y,V]=a(y).split(":");return{key:Y,val:V}}),ee=F(()=>l()(`character.senses.list.${a(g).key}`)+(a(g).val?` ${a(g).val}`:"")),R=F(()=>l()(`character.senses.descriptions.${a(g).key}`));qs(m,{get text(){return a(R)},class:"text-xs bg-emerald-950/30 text-emerald-200 px-3 py-1.5 rounded border border-emerald-900/50 font-bold flex items-center gap-2 cursor-help whitespace-nowrap",children:(Y,V)=>{var ce=Er(),te=qe(ce);es(te,{size:12,class:"text-emerald-500 flex-shrink-0"});var Ie=s(te);x(()=>i(Ie,` ${a(ee)??""}`)),d(Y,ce)},$$slots:{default:!0}})}),e($),e(v),x(m=>i(p,`${m??""} `),[()=>l()("character.senses.title")]),d(o,v)};w(vt,o=>{r.entity.senses&&r.entity.senses.length>0&&o(At)})}var ia=s(vt,2);Be(ia,16,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],kt,(o,v)=>{var c=Ot(),p=qe(c);{var $=m=>{var y=Dr(),g=t(y),ee=t(g);ya(),e(g);var R=s(g,2);Be(R,21,()=>r.entity[v.key],kt,(Y,V)=>{var ce=Ir(),te=t(ce),Ie=t(te,!0);e(te);var Z=s(te,2),De=t(Z,!0);e(Z),e(ce),x(()=>{i(Ie,a(V).name),i(De,a(V).description||a(V).effect)}),d(Y,ce)}),e(R),e(y),x(()=>{Fe(g,1,`${v.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),i(ee,`${v.label??""} `)}),d(m,y)};w(p,m=>{r.entity[v.key]&&r.entity[v.key].length>0&&m($)})}d(o,c)}),e(Zt),e(b),x((o,v,c)=>{i(Te,o),i(Bt,v),i(Xt,r.entity.size||1),i(Wt,c),i(ca,r.entity.speed||10)},[()=>l()("session.combat_card.attributes"),()=>l()("session.combat_card.size"),()=>l()("session.combat_card.speed")]),d(f,b)};w(It,f=>{a(O)&&f(Qt)})}var $t=s(It,2);{let f=F(()=>r.entity.afflictions||[]);_r($t,{get isOpen(){return a(ae)},onClose:()=>C(ae,!1),get afflictions(){return a(f)},onToggle:we})}e(be),x((f,b,z,k,ye)=>{Fe(be,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(n)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),Fe(_e,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(me)?"border-red-600 grayscale brightness-50":a(n)?"border-indigo-500/50":"border-red-900/50"}`),Fe(pe,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${r.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(n)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),Ce(pe,"title",f),Fe(Ve,1,`text-base font-bold truncate leading-snug ${a(n)?"text-white":"text-red-100 font-serif tracking-wide"}`),i(_t,r.entity.name),Fe(zt,1,`absolute inset-0 w-full ${a(N)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),i(Mt,b),i(Je,r.entity.defense||10),i(L,z),Va(fe,a(N)),Fe(W,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(me)?"bg-red-950/50 border-red-500":a(A)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),Fe(J,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(me)?"text-red-400":a(A)?"text-orange-400":"text-emerald-400"}`),i(ne,k),Va(de,a(re)),i(G,`/${a(le)??""}`),i(Tt,` ${ye??""}`)},[()=>r.entity.acted?l()("session.combat_card.acted"):l()("session.combat_card.act"),()=>l()("session.combat_card.defense"),()=>l()("session.combat_card.damage"),()=>l()("session.combat_card.health"),()=>l()("session.combat_card.add_affliction")]),d(U,be),oa(),D()}ba(["click","input"]);function Ar(U,{from:r,to:l},K={}){var{delay:D=0,duration:_=ie=>Math.sqrt(ie)*120,easing:j=Ys}=K,S=getComputedStyle(U),n=S.transform==="none"?"":S.transform,[h,N]=S.transformOrigin.split(" ").map(parseFloat);h/=U.clientWidth,N/=U.clientHeight;var le=Tr(U),re=U.clientWidth/l.width/le,me=U.clientHeight/l.height/le,A=r.left+r.width*h,I=r.top+r.height*N,O=l.left+l.width*h,ae=l.top+l.height*N,se=(A-O)*re,ot=(I-ae)*me,We=r.width/l.width,jt=r.height/l.height;return{delay:D,duration:typeof _=="function"?_(Math.sqrt(se*se+ot*ot)):_,easing:j,css:(ie,we)=>{var be=we*se,ke=we*ot,ue=ie+we*We,je=ie+we*jt;return`transform: ${n} translate(${be}px, ${ke}px) scale(${ue}, ${je});`}}}function Tr(U){if("currentCSSZoom"in U)return U.currentCSSZoom;for(var r=U,l=1;r!==null;)l*=+getComputedStyle(r).zoom,r=r.parentElement;return l}function Ur(U,r=1,l=0){const K=[];let D=0;for(let n=0;n<r;n++){const h=Math.floor(Math.random()*U)+1;K.push(h),D+=h}let _=`${r}d${U}`,j=[],S=0;if(l!==0)if(U===20){const n=Math.abs(l);for(let N=0;N<n;N++)j.push(Math.floor(Math.random()*6)+1);const h=Math.max(...j);l>0?(S=h,D+=h,_+=` + ${h} [Boon]`):(S=-h,D-=h,_+=` - ${h} [Bane]`)}else S=l,D+=l,_+=l>0?` + ${l}`:` - ${Math.abs(l)}`;return{total:D,results:K,bonusRolls:j,formula:_,crit:U===20&&K.includes(20),modifierTotal:S}}function Pr(U,r,l){const K=l.map(n=>({...n,type:"enemy"}));if(U==="standard"){const n=r.filter(re=>re.initiative).map(re=>({...re,type:"player",isFast:!0})),h=r.filter(re=>!re.initiative).map(re=>({...re,type:"player",isFast:!1})),N=K.filter(re=>re.initiative).map(re=>({...re,isFast:!0})),le=K.filter(re=>!re.initiative).map(re=>({...re,isFast:!1}));return[...n,...N,...h,...le]}if(U==="individual")return[...r.map(h=>({...h,type:"player",totalInit:(h.initiativeRoll||0)+(h.attributes?.agility||10)-10})),...K.map(h=>({...h,type:"enemy",totalInit:(h.initiativeRoll||0)+(h.attributes?.agility||10)-10}))].sort((h,N)=>N.totalInit-h.totalInit);const D=r.filter(n=>n&&n.initiative).map(n=>({...n,type:"player"})),_=r.filter(n=>n&&!n.initiative).map(n=>({...n,type:"player"})),j=[...D,...K,..._],S=new Set;return j.filter(n=>{if(!n)return!1;const h=n.type==="player"?n.id:n.instanceId;return S.has(h)?!1:(S.add(h),!0)})}var Lr=u('<div class="h-full border-r border-slate-900/30 last:border-0"></div>'),Hr=u('<div class="flex flex-col items-center"><span> </span> <span class="text-[8px] font-mono text-slate-600"><!></span></div>'),Fr=u('<div class="space-y-4 w-full"><div class="relative h-3 w-full bg-slate-800 rounded-full overflow-hidden border border-slate-700/50 shadow-inner"><div class="absolute inset-0 flex"></div> <div><div class="absolute inset-0 bg-white/10 animate-pulse"></div></div></div> <div class="flex justify-between w-full px-1"></div></div>');function Ms(U,r){la(r,!0);const l=()=>Lt(aa,"$t",K),[K,D]=va();let _=F(()=>()=>{for(let A=0;A<r.segments.length;A++)if(r.value<=r.segments[A].max)return A;return r.segments.length-1}),j=F(()=>()=>{const A=a(_)(),I=A===0?0:r.segments[A-1].max,O=r.segments[A].max;if(A===r.segments.length-1&&r.value>O)return 1;const ae=O-I;return ae===0?1:Math.min(1,Math.max(0,(r.value-I)/ae))}),S=F(()=>()=>{const A=a(_)(),I=100/r.segments.length;return A*I+a(j)()*I}),n=F(()=>r.segments[a(_)()].color);var h=Fr(),N=t(h),le=t(N);Be(le,21,()=>r.segments,kt,(A,I)=>{var O=Lr();x(()=>Na(O,`width: ${100/r.segments.length}%`)),d(A,O)}),e(le);var re=s(le,2);e(N);var me=s(N,2);Be(me,21,()=>r.segments,kt,(A,I,O)=>{var ae=Hr(),se=t(ae),ot=t(se,!0);e(se);var We=s(se,2),jt=t(We);{var ie=be=>{var ke=Ja();x(()=>i(ke,`${r.segments[O-1].max+1}+`)),d(be,ke)},we=be=>{var ke=Ot(),ue=qe(ke);{var je=xe=>{var E=Ja();x(()=>i(E,a(I).max)),d(xe,E)},Ue=xe=>{var E=Ja();x(()=>i(E,a(I).max)),d(xe,E)};w(ue,xe=>{O===0?xe(je):xe(Ue,!1)},!0)}d(be,ke)};w(jt,be=>{O===r.segments.length-1?be(ie):be(we,!1)})}e(We),e(ae),x((be,ke)=>{Na(ae,`width: ${100/r.segments.length}%`),Fe(se,1,`text-[9px] font-black uppercase tracking-tighter transition-colors ${be??""}`,"svelte-1ix6916"),i(ot,ke)},[()=>O===a(_)()?a(n).replace("bg-","text-"):"text-slate-500",()=>l()("campaign.difficulty."+a(I).key)]),d(A,ae)}),e(me),e(h),x(A=>{Fe(re,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out rounded-full ${a(n)??""}`,"svelte-1ix6916"),Na(re,`width: ${A??""}%`)},[()=>a(S)()]),d(U,h),oa(),D()}var qr=u('<div><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-2"><!> <span class="text-xs font-black uppercase tracking-widest"> </span></div> <div class="text-xs font-bold uppercase opacity-70"> </div></div> <div class="flex items-center justify-between mb-6"><div><div class="text-3xl font-black leading-none"> </div> <div class="text-[10px] font-bold uppercase opacity-50 mt-1"> </div></div> <div class="text-right"><div class="text-sm font-black uppercase"> </div> <div class="text-[10px] font-bold opacity-40 mt-1 flex items-center justify-end gap-1"><span class="uppercase tracking-tighter"> </span> <span> </span></div></div></div> <!></div>');function os(U,r){la(r,!0);const l=()=>Lt(aa,"$t",K),[K,D]=va(),_={starting:{easy:3,avgMin:4,avgMax:15,challMin:16,challMax:30,hard:31,maxCreature:25},novice:{easy:10,avgMin:11,avgMax:30,challMin:31,challMax:50,hard:51,maxCreature:100},expert:{easy:30,avgMin:31,avgMax:50,challMin:51,challMax:125,hard:126,maxCreature:250},master:{easy:50,avgMin:51,avgMax:125,challMin:126,challMax:200,hard:201,maxCreature:null}};let j=F(()=>_[r.tier]||_.starting),S=F(()=>()=>r.totalDifficulty<=a(j).easy?"easy":r.totalDifficulty<=a(j).avgMax?"average":r.totalDifficulty<=a(j).challMax?"challenging":"hard"),n=F(()=>[{key:"easy",max:a(j).easy,color:"bg-green-500"},{key:"average",max:a(j).avgMax,color:"bg-yellow-500"},{key:"challenging",max:a(j).challMax,color:"bg-orange-500"},{key:"hard",max:a(j).challMax*1.5,color:"bg-red-500"}]),h=F(()=>()=>{switch(a(S)()){case"easy":return"text-green-400 bg-green-500/10 border-green-500/30";case"average":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/30";case"challenging":return"text-orange-400 bg-orange-500/10 border-orange-500/30";case"hard":return"text-red-400 bg-red-500/10 border-red-500/30";default:return"text-slate-400 bg-slate-500/10 border-slate-500/30"}});var N=qr(),le=t(N),re=t(le),me=t(re);Ua(me,{size:18});var A=s(me,2),I=t(A,!0);e(A),e(re);var O=s(re,2),ae=t(O,!0);e(O),e(le);var se=s(le,2),ot=t(se),We=t(ot),jt=t(We,!0);e(We);var ie=s(We,2),we=t(ie,!0);e(ie),e(ot);var be=s(ot,2),ke=t(be),ue=t(ke,!0);e(ke);var je=s(ke,2),Ue=t(je),xe=t(Ue);e(Ue);var E=s(Ue,2),X=t(E,!0);e(E),e(je),e(be),e(se);var _e=s(se,2);Ms(_e,{get value(){return r.totalDifficulty},get segments(){return a(n)}}),e(N),x((Me,pe,bt,Ke,pt,xt,B)=>{Fe(N,1,`rounded-xl border p-4 ${Me??""} shadow-lg`),i(I,pe),i(ae,bt),i(jt,r.totalDifficulty),i(we,Ke),i(ue,pt),i(xe,`${xt??""}:`),i(X,B)},[()=>a(h)(),()=>l()("campaign.difficulty.title"),()=>l()("campaign.settings.tiers."+r.tier),()=>l()("campaign.difficulty.total"),()=>l()("campaign.difficulty."+a(S)()),()=>l()("campaign.difficulty.max_creature"),()=>a(j).maxCreature??l()("campaign.difficulty.none")]),d(U,N),oa(),D()}var Br=u('<div><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-2"><!> <span class="text-xs font-black uppercase tracking-widest"> </span></div> <div class="flex items-center gap-2 text-xs font-bold uppercase opacity-70"><span> </span> <span class="text-[10px] bg-black/20 px-2 py-0.5 rounded"> </span></div></div> <div class="flex items-center justify-between mb-6"><div><div class="text-3xl font-black leading-none"> </div> <div class="text-[10px] font-bold uppercase opacity-50 mt-1"> </div></div> <div class="text-right"><div class="text-sm font-black uppercase"> </div> <div class="text-[10px] font-medium opacity-50 mt-1 uppercase tracking-tighter"> </div></div></div> <!></div>');function ds(U,r){la(r,!0);const l=()=>Lt(aa,"$t",K),[K,D]=va(),_={starting:{easy:.5,average:1,hard:1.5},novice:{easy:1,average:2,hard:3},expert:{easy:2,average:4,hard:6},master:{easy:4,average:8,hard:12}};let j=F(()=>_[r.tier]||_.novice),S=F(()=>({easy:a(j).easy*r.playerCount,average:a(j).average*r.playerCount,hard:a(j).hard*r.playerCount})),n=F(()=>()=>r.totalDifficulty<=a(S).easy?"easy":r.totalDifficulty<=a(S).average?"average":"hard"),h=F(()=>[{key:"easy",max:a(S).easy,color:"bg-green-500"},{key:"average",max:a(S).average,color:"bg-yellow-500"},{key:"hard",max:a(S).hard*1.5,color:"bg-red-500"}]),N=F(()=>()=>{switch(a(n)()){case"easy":return"text-green-400 bg-green-500/10 border-green-500/30";case"average":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/30";case"hard":return"text-red-400 bg-red-500/10 border-red-500/30";default:return"text-slate-400 bg-slate-500/10 border-slate-500/30"}});var le=Br(),re=t(le),me=t(re),A=t(me);Ua(A,{size:18});var I=s(A,2),O=t(I,!0);e(I),e(me);var ae=s(me,2),se=t(ae),ot=t(se,!0);e(se);var We=s(se,2),jt=t(We,!0);e(We),e(ae),e(re);var ie=s(re,2),we=t(ie),be=t(we),ke=t(be,!0);e(be);var ue=s(be,2),je=t(ue,!0);e(ue),e(we);var Ue=s(we,2),xe=t(Ue),E=t(xe,!0);e(xe);var X=s(xe,2),_e=t(X);e(X),e(Ue),e(ie);var Me=s(ie,2);Ms(Me,{get value(){return r.totalDifficulty},get segments(){return a(h)}}),e(le),x((pe,bt,Ke,pt,xt,B,ge)=>{Fe(le,1,`rounded-xl border p-4 ${pe??""} shadow-lg`),i(O,bt),i(ot,Ke),i(jt,pt),i(ke,r.totalDifficulty),i(je,xt),i(E,B),i(_e,`${a(j).average??""}/${ge??""}`)},[()=>a(N)(),()=>l()("campaign.difficulty.title"),()=>l()("campaign.settings.tiers."+r.tier),()=>l()("campaign.difficulty.players",{values:{count:r.playerCount}}),()=>l()("campaign.difficulty.total"),()=>l()("campaign.difficulty."+a(n)()),()=>l()("common.labels.master")]),d(U,le),oa(),D()}var Wr=u('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),Jr=u('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),Gr=u('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),Qr=u('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),Vr=u('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),Yr=u('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),Zr=u('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),Xr=u('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),Kr=u('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),ei=u('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),ti=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1 flex items-center gap-2"><!> <div class="min-w-0 flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),ai=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),si=u("<!> <!>",1),ri=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),ii=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),ni=u("<!> <!>",1),li=u('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),oi=u('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),di=u('<div class="lg:hidden"><!></div>'),vi=u("<div><!></div>"),ci=u('<div class="text-center text-slate-500 italic py-10"> </div>'),ui=u('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),bi=u('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),xi=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),_i=u('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),fi=u('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),mi=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),pi=u('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1 flex flex-col"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),gi=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),hi=u("<!> <!>",1),yi=u('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),wi=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),ki=u("<!> <!>",1),zi=u('<div class="fixed inset-0 z-50 flex justify-end bg-black/60"><div class="w-full max-w-[300px] h-full bg-slate-900 border-l border-slate-800 p-4 shadow-2xl animate-in slide-in-from-right duration-300"><div class="flex justify-between items-center mb-4"><h3 class="font-bold text-white uppercase tracking-widest text-sm flex items-center gap-2"><!> </h3> <button class="bg-slate-800 p-2 rounded-lg text-slate-400 hover:text-white"><!></button></div> <div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="h-[calc(100%-100px)] overflow-y-auto custom-scrollbar space-y-2"><!></div></div></div>'),Ci=u('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="hidden lg:flex flex-col h-[400px] bg-slate-900 border border-slate-800 rounded-xl p-4"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4" role="region" aria-label="Combat Zone"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <!> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"><!></div></div> <!> <!> <!> <button class="lg:hidden fixed bottom-24 right-4 bg-slate-800 text-white p-3 rounded-full shadow-lg border border-slate-700 z-40 active:scale-90 transition-transform" aria-label="Add Enemy"><!></button> <!> <!>',1);function ji(U,r){la(r,!0);const l=()=>Lt(As,"$liveCharacters",S),K=()=>Lt(Ka,"$liveEnemies",S),D=()=>Lt(us,"$liveEncounters",S),_=()=>Lt(aa,"$t",S),j=()=>Lt(Ma,"$isHistoryOpen",S),[S,n]=va();let h=mt(!1),N=mt(!1),le=mt(!1),re=mt(!1);const me={active:!1,round:1};let A=mt("enemies"),I=mt(!1),O=mt(ga([])),ae=mt(ga({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));ss(()=>{if(r.campaign?.id){Is(r.campaign.id,!0);const o=Qa(aa)("common.labels.master");is.update(c=>({...c,campaignId:r.campaign.id,name:r.campaign.gmName||o}));const v=setInterval(()=>{const c=ea.get(r.campaign.id)||r.campaign,p=Qa(aa)("common.labels.master");Ya(r.campaign.id,{name:c.name,gmName:c.gmName||p})},3e4);return()=>{clearInterval(v),Ds(),is.update(c=>({...c,campaignId:null}))}}});const se=F(()=>typeof window<"u"?`${window.location.origin}${_s("/campaigns/[id]/invite",{id:r.campaign?.id})}`:"");function ot(){a(se)&&(navigator.clipboard.writeText(a(se)),C(le,!0),setTimeout(()=>{C(le,!1)},2e3))}let We=F(()=>r.campaign?.sessionRoster||[]),jt=F(()=>r.campaign?.combat||me),ie=F(()=>r.campaign?.activeEnemies||[]),we=F(()=>r.campaign?.members||[]),be=F(()=>r.campaign?.initiativeStyle||"dle"),ke=F(()=>r.campaign?.tier||Ts(r.campaign?.system)),ue=F(()=>a(ie).reduce((o,v)=>o+(v.difficulty||0),0)),je=F(()=>a(We).length||1),Ue=F(()=>Array.from(new Set([...a(We),...a(we).map(v=>v.id)])).map(v=>{const c=l().find($=>$.id===v),p=a(we).find($=>$.id===v);return c&&p?{...c,...p,lastUpdate:p.lastUpdate}:c||p}).filter(Boolean)),xe=F(()=>a(Ue).filter(o=>!o.campaignApproval||o.campaignApproval==="approved")),E=F(()=>a(Ue).filter(o=>o.campaignApproval==="pending")),X=F(()=>l().filter(o=>!a(We).includes(o.id)&&!a(we).some(v=>v.id===o.id)&&(o.system||Oa)===(r.campaign?.system||Oa))),_e=F(()=>K().filter(o=>{const v=(o.system||Oa)===(r.campaign?.system||Oa),c=o.campaignId===r.campaign?.id||o.global;return v&&c})),Me=F(()=>D().filter(o=>(o.system||Oa)===(r.campaign?.system||Oa)&&!0));function pe(o){if(!r.campaign?.id)return;const c={...ea.get(r.campaign.id)||r.campaign,...o};ea.set(r.campaign.id,c),o.combat&&Ra(r.campaign.id,o.combat),(o.name||o.gmName)&&Ya(r.campaign.id,{name:c.name,gmName:c.gmName})}function bt(o){if(a(We).includes(o)){const v=a(We).filter(c=>c!==o);pe({sessionRoster:v})}else{const v=[...a(We),o];pe({sessionRoster:v})}}function Ke(o){Le(o,{campaignApproval:"approved"}),$a({id:o,campaignApproval:"approved"})}function pt(o){$a({id:o,campaignApproval:"rejected",campaignId:null});const c=((ea.get(r.campaign.id)||r.campaign).members||[]).filter(p=>p.id!==o);pe({members:c})}function xt(o){const v=a(Ue).find(c=>c.id===o);C(ae,{isOpen:!0,title:_()("session.players.remove_title"),message:_()("session.players.remove_message",{values:{name:v?.name||"este personagem"}}),onConfirm:()=>{const c=ea.get(r.campaign.id)||r.campaign;$a({id:o,campaignId:null});const p=(c.sessionRoster||[]).filter(y=>y!==o),$=(c.members||[]).filter(y=>y.id!==o),m=(c.activeEnemies||[]).filter(y=>y.type!=="player"||y.id!==o);pe({sessionRoster:p,members:$,activeEnemies:m}),a(ae).isOpen=!1}},!0)}function B(o){const c=(ea.get(r.campaign.id)||r.campaign).activeEnemies||[],p={...o,instanceId:Ia(),damage:0,currentHealth:o.health,afflictions:[],acted:!1,initiative:!1};pe({activeEnemies:[...c,p]})}function ge(o){const c=(ea.get(r.campaign.id)||r.campaign).activeEnemies||[];let p=[];o.enemies.forEach($=>{const m=K().find(y=>y.id===$.enemyId);if(m)for(let y=0;y<$.count;y++)p.push({...m,instanceId:Ia(),damage:0,currentHealth:m.health,afflictions:[],acted:!1,initiative:!1})}),pe({activeEnemies:[...c,...p]})}function Pe(){pe({combat:{active:!0,round:1}}),Ra(r.campaign.id,{active:!0,round:1})}function Ve(){const o=a(ie).filter(v=>v.damage<(v.currentHealth??v.health)&&v.endOfRound&&v.endOfRound.length>0).map(v=>({name:v.name,effects:v.endOfRound}));if(o.length>0){C(O,o,!0),C(I,!0);return}_t()}function _t(){const o=ea.get(r.campaign.id)||r.campaign,v=(o.combat?.round||1)+1,c=(o.activeEnemies||[]).map(p=>({...p,acted:!1}));pe({combat:{...o.combat,round:v},activeEnemies:c}),Ra(r.campaign.id,{active:!0,round:v}),C(I,!1)}function Ye(o){pe({combat:{active:!1,round:1}}),Ra(r.campaign.id,{active:!1,round:1})}function ze(o){const v=ea.get(r.campaign.id)||r.campaign;pe({activeEnemies:(v.activeEnemies||[]).filter(c=>c.instanceId!==o)})}function Re(o,v){const c=ea.get(r.campaign.id)||r.campaign;pe({activeEnemies:(c.activeEnemies||[]).map(p=>p.instanceId===o?{...p,...v}:p)})}function Q(){const o=ea.get(r.campaign.id)||r.campaign,v=o.combat?.round||1;v>1&&pe({combat:{...o.combat,round:v-1}})}let he=mt(ga(Date.now()));ss(()=>{const o=setInterval(()=>{C(he,Date.now(),!0)},1e4);return()=>clearInterval(o)});let Se=F(()=>(()=>{const o=a(xe).filter(v=>a(We).includes(v.id));return Pr(a(be),o,a(ie))})());function $e(o){return o.lastUpdate?a(he)-o.lastUpdate<6e4:!1}function Le(o,v){const c=ea.get(r.campaign.id)||r.campaign,p=c.members||[],$=p.findIndex(R=>R.id===o);let m=p;$!==-1&&(m=[...p],m[$]={...m[$],...v});const y=c.activeEnemies||[],g=y.findIndex(R=>R.id===o&&R.type==="player");let ee=y;g!==-1&&(ee=[...y],ee[g]={...ee[g],...v}),pe({members:m,activeEnemies:ee})}function nt(o,v,c){o.dataTransfer&&(o.dataTransfer.setData("application/json",JSON.stringify({item:v,type:c})),o.dataTransfer.effectAllowed="copy")}function et(o){return o.preventDefault(),!1}function dt(o){o.preventDefault();const v=o.dataTransfer?.getData("application/json");if(v)try{const{item:c,type:p}=JSON.parse(v);p==="enemy"?B(c):p==="encounter"&&ge(c)}catch(c){console.error("Drop error",c)}}var zt=Ci(),Ht=qe(zt),Et=t(Ht),Ft=t(Et),M=t(Ft),q=t(M),P=t(q);bs(P,{size:14,class:"text-indigo-500"});var Ne=s(P),tt=s(Ne);{var at=o=>{var v=Wr(),c=t(v,!0);e(v),x(()=>i(c,a(xe).length)),d(o,v)};w(tt,o=>{a(xe).length>0&&o(at)})}e(q);var Ze=s(q,2);Ze.__click=()=>C(h,!a(h));var Ct=t(Ze,!0);e(Ze),e(M);var Mt=s(M,2);{var St=o=>{var v=Gr(),c=t(v),p=s(t(c),2),$=t(p);e(p),e(c);var m=s(c,2);Be(m,17,()=>a(E),y=>y.id,(y,g)=>{var ee=Jr(),R=t(ee),Y=t(R),V=t(Y,!0);e(Y);var ce=s(Y,2),te=t(ce,!0);e(ce),e(R);var Ie=s(R,2),Z=t(Ie);Z.__click=()=>Ke(a(g).id);var De=t(Z);ls(De,{size:14}),e(Z);var Ee=s(Z,2);Ee.__click=()=>pt(a(g).id);var ft=t(Ee);ua(ft,{size:14}),e(Ee),e(Ie),e(ee),x(ct=>{i(V,a(g).name),i(te,ct)},[()=>_()("session.players.new_request")]),d(y,ee)}),ya(2),e(v),x(y=>i($,`${y??""} (${a(E).length??""})`),[()=>_()("session.players.waiting_approval")]),d(o,v)};w(Mt,o=>{a(E).length>0&&o(St)})}var Je=s(Mt,2),H=t(Je),T=t(H);Be(T,17,()=>a(xe),o=>o.id,(o,v)=>{const c=F(()=>$e(a(v))),p=F(()=>a(We).includes(a(v).id));var $=Vr(),m=t($),y=s(m,2),g=t(y),ee=t(g,!0);e(g);var R=s(g,2),Y=t(R);{var V=He=>{var st=Qr(),yt=t(st,!0);e(st),x(qt=>i(yt,qt),[()=>_()("common.labels.session")]),d(He,st)};w(Y,He=>{a(p)&&He(V)})}var ce=s(Y);e(R),e(y);var te=s(y,2),Ie=t(te);Ie.__click=()=>bt(a(v).id);var Z=t(Ie);{var De=He=>{fs(He,{size:14})},Ee=He=>{ra(He,{size:14})};w(Z,He=>{a(p)?He(De):He(Ee,!1)})}e(Ie);var ft=s(Ie,2);ft.__click=()=>xt(a(v).id);var ct=t(ft);ua(ct,{size:14}),e(ft),e(te),e($),x((He,st,yt)=>{Fe($,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(c)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(c)||a(p)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),Fe(m,1,`w-2 h-2 rounded-full ${a(c)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),Fe(g,1,`font-bold text-sm ${a(c)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),i(ee,a(v).name),i(ce,` ${He??""} ${a(v).level??""} • ${a(v).ancestry??""}`),Fe(Ie,1,`p-1.5 rounded-lg transition-all ${a(p)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),Ce(Ie,"title",st),Ce(ft,"title",yt)},[()=>_()("common.labels.level"),()=>a(p)?_()("session.players.remove_from_session"):_()("session.players.add_to_session"),()=>_()("session.players.kick_from_campaign")]),d(o,$)});var L=s(T,2);{var fe=o=>{var v=Yr(),c=t(v,!0);e(v),x(p=>i(c,p),[()=>_()("session.players.none")]),d(o,v)};w(L,o=>{a(xe).length===0&&o(fe)})}e(H),e(Je);var W=s(Je,2),J=t(W);{var ne=o=>{var v=Zr(),c=qe(v);c.__click=()=>pe({isPublished:!0});var p=t(c);pa(p,{size:14});var $=s(p);e(c);var m=s(c,2),y=t(m,!0);e(m),x((g,ee)=>{i($,` ${g??""}`),i(y,ee)},[()=>_()("session.publish.publish_session"),()=>_()("session.publish.make_visible")]),d(o,v)},Ge=o=>{var v=ei(),c=qe(v),p=t(c),$=t(p),m=t($);xs(m,{size:10,class:"animate-pulse"});var y=s(m);e($),e(p);var g=s(p,2);g.__click=()=>C(re,!a(re));var ee=t(g);lr(ee,{size:14}),e(g),e(c);var R=s(c,2);{var Y=st=>{var yt=Xr(),qt=t(yt);e(yt),x((Rt,Nt)=>{Ce(qt,"src",Rt),Ce(qt,"alt",Nt)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(se))}`,()=>_()("session.publish.qr_alt")]),d(st,yt)};w(R,st=>{a(re)&&st(Y)})}var V=s(R,2),ce=t(V),te=t(ce);te.__click=ot;var Ie=t(te,!0);e(te);var Z=s(te,2);Z.__click=ot;var De=t(Z);{var Ee=st=>{var yt=Kr(),qt=t(yt);ls(qt,{size:10,class:"inline mr-1"});var Rt=s(qt);e(yt),x(Nt=>i(Rt,` ${Nt??""}`),[()=>_()("common.buttons.copied")]),d(st,yt)};w(De,st=>{a(le)&&st(Ee)})}var ft=s(De,2);rr(ft,{size:14}),e(Z),e(ce),e(V);var ct=s(V,2);ct.__click=()=>pe({isPublished:!1});var He=t(ct,!0);e(ct),x((st,yt,qt,Rt)=>{i(y,` ${st??""}`),Ce(g,"title",yt),i(Ie,a(se)),Ce(Z,"aria-label",qt),i(He,Rt)},[()=>_()("session.publish.public_session"),()=>_()("session.publish.qr_code"),()=>_()("session.publish.copy_link"),()=>_()("session.publish.remove_public")]),d(o,v)};w(J,o=>{r.campaign?.isPublished?o(Ge,!1):o(ne)})}e(W),e(Ft);var de=s(Ft,2),oe=t(de),G=t(oe);G.__click=()=>C(A,"enemies");var Oe=t(G);Ca(Oe,{size:14});var ve=s(Oe);e(G);var Ae=s(G,2);Ae.__click=()=>C(A,"encounters");var rt=t(Ae);Xa(rt,{size:14});var it=s(rt);e(Ae),e(oe);var lt=s(oe,2),Tt=t(lt);{var It=o=>{var v=si(),c=qe(v);Be(c,17,()=>a(_e),m=>m.id,(m,y)=>{var g=ti(),ee=t(g),R=t(ee);nr(R,{size:12,class:"text-slate-600 cursor-grab"});var Y=s(R,2),V=t(Y),ce=t(V),te=s(ce);{var Ie=ct=>{pa(ct,{size:10,class:"text-indigo-400"})};w(te,ct=>{a(y).global&&ct(Ie)})}e(V);var Z=s(V,2),De=t(Z);e(Z),e(Y),e(ee);var Ee=s(ee,2);Ee.__click=()=>B(a(y));var ft=t(Ee);ra(ft,{size:16}),e(Ee),e(g),x(ct=>{i(ce,`${a(y).name??""} `),i(De,`${ct??""} ${a(y).difficulty??""}`)},[()=>_()("session.enemies.difficulty")]),ja("dragstart",g,ct=>nt(ct,a(y),"enemy")),d(m,g)});var p=s(c,2);{var $=m=>{var y=ai(),g=t(y,!0);e(y),x(ee=>i(g,ee),[()=>_()("session.enemies.none")]),d(m,y)};w(p,m=>{a(_e).length===0&&m($)})}d(o,v)},Qt=o=>{var v=ni(),c=qe(v);Be(c,17,()=>a(Me),m=>m.id,(m,y)=>{var g=ri(),ee=t(g),R=t(ee),Y=t(R),V=s(Y);{var ce=Ee=>{pa(Ee,{size:10,class:"text-indigo-400"})};w(V,Ee=>{a(y).global&&Ee(ce)})}e(R);var te=s(R,2),Ie=t(te);e(te),e(ee);var Z=s(ee,2);Z.__click=()=>ge(a(y));var De=t(Z);Za(De,{size:14}),e(Z),e(g),x((Ee,ft)=>{i(Y,`${a(y).name??""} `),i(Ie,`${Ee??""} ${ft??""}`)},[()=>a(y).enemies?.reduce((Ee,ft)=>Ee+ft.count,0)||0,()=>_()("session.enemies.title")]),ja("dragstart",g,Ee=>nt(Ee,a(y),"encounter")),d(m,g)});var p=s(c,2);{var $=m=>{var y=ii(),g=t(y,!0);e(y),x(ee=>i(g,ee),[()=>_()("session.enemies.no_encounters")]),d(m,y)};w(p,m=>{a(Me).length===0&&m($)})}d(o,v)};w(Tt,o=>{a(A)==="enemies"?o(It):o(Qt,!1)})}e(lt),e(de),e(Et);var $t=s(Et,2),f=t($t),b=t(f),z=t(b);{var k=o=>{var v=li();v.__click=Pe;var c=t(v);js(c,{size:20});var p=s(c);e(v),x($=>i(p,` ${$??""}`),[()=>_()("session.combat.start")]),d(o,v)},ye=o=>{var v=oi(),c=t(v);c.__click=Q;var p=t(c);La(p,{size:20}),e(c);var $=s(c,2),m=t($),y=t(m,!0);e(m);var g=s(m),ee=t(g,!0);e(g),e($);var R=s($,2);R.__click=Ve;var Y=t(R);Bs(Y,{size:16});var V=s(Y);e(R);var ce=s(R,4);ce.__click=()=>Ye();var te=t(ce,!0);e(ce),e(v),x((Ie,Z,De,Ee,ft)=>{Ce(c,"title",Ie),i(y,Z),i(ee,a(jt).round),Ce(R,"title",De),i(V,` ${Ee??""}`),i(te,ft)},[()=>_()("session.combat.previous"),()=>_()("session.combat.round"),()=>_()("session.combat.next"),()=>_()("session.combat.next"),()=>_()("session.combat.end")]),d(o,v)};w(z,o=>{a(jt).active?o(ye,!1):o(k)})}e(b),e(f);var Te=s(f,2);{var Xe=o=>{var v=di(),c=t(v);{var p=m=>{os(m,{get tier(){return a(ke)},get totalDifficulty(){return a(ue)}})},$=m=>{ds(m,{get tier(){return a(ke)},get totalDifficulty(){return a(ue)},get playerCount(){return a(je)}})};w(c,m=>{r.campaign?.system==="sofdl"?m(p):m($,!1)})}e(v),d(o,v)};w(Te,o=>{a(ie).length>0&&o(Xe)})}var Qe=s(Te,2),gt=t(Qe);Be(gt,25,()=>a(Se),o=>o.type==="player"?o.id:o.instanceId,(o,v)=>{var c=vi(),p=t(c);$r(p,{get entity(){return a(v)},updateEnemy:Re,removeFromCombat:ze,updatePlayer:Le}),e(c),Ps(c,()=>Ar,()=>({duration:300})),d(o,c)});var ht=s(gt,2);{var Ut=o=>{var v=ci(),c=t(v,!0);e(v),x(p=>i(c,p),[()=>_()("session.combat.empty")]),d(o,v)};w(ht,o=>{a(Se).length===0&&o(Ut)})}e(Qe),e($t);var Dt=s($t,2),Bt=t(Dt);{var Gt=o=>{var v=Ot(),c=qe(v);{var p=m=>{os(m,{get tier(){return a(ke)},get totalDifficulty(){return a(ue)}})},$=m=>{ds(m,{get tier(){return a(ke)},get totalDifficulty(){return a(ue)},get playerCount(){return a(je)}})};w(c,m=>{r.campaign?.system==="sofdl"?m(p):m($,!1)})}d(o,v)};w(Bt,o=>{a(ie).length>0&&o(Gt)})}e(Dt),e(Ht);var Xt=s(Ht,2);{var ta=o=>{var v=xi();v.__click=Ee=>{Ee.target===Ee.currentTarget&&C(I,!1)};var c=t(v),p=t(c),$=t(p),m=t($);Ws(m,{size:24}),e($);var y=s($,2),g=t(y),ee=t(g,!0);e(g);var R=s(g,2),Y=t(R,!0);e(R),e(y),e(p);var V=s(p,2);Be(V,21,()=>a(O),kt,(Ee,ft)=>{var ct=bi(),He=t(ct),st=t(He);Ca(st,{size:14,class:"text-slate-500"});var yt=s(st);e(He);var qt=s(He,2);Be(qt,21,()=>a(ft).effects,kt,(Rt,Nt)=>{var Pt=ui(),Yt=t(Pt),Kt=t(Yt);e(Yt);var da=s(Yt,2),ka=t(da,!0);e(da),e(Pt),x(()=>{i(Kt,`${a(Nt).name??""}:`),i(ka,a(Nt).desc)}),d(Rt,Pt)}),e(qt),e(ct),x(()=>i(yt,` ${a(ft).name??""}`)),d(Ee,ct)}),e(V);var ce=s(V,2),te=t(ce);te.__click=()=>C(I,!1);var Ie=t(te,!0);e(te);var Z=s(te,2);Z.__click=_t;var De=t(Z,!0);e(Z),e(ce),e(c),e(v),x((Ee,ft,ct,He)=>{i(ee,Ee),i(Y,ft),i(Ie,ct),i(De,He)},[()=>_()("session.end_of_round.title"),()=>_()("session.end_of_round.summary"),()=>_()("common.buttons.cancel"),()=>_()("session.end_of_round.advance")]),d(o,v)};w(Xt,o=>{a(I)&&o(ta)})}var Jt=s(Xt,2);{var Wt=o=>{var v=mi();v.__click=Z=>{Z.target===Z.currentTarget&&C(h,!1)};var c=t(v),p=t(c),$=t(p),m=t($),y=t(m,!0);e(m);var g=s(m,2),ee=t(g,!0);e(g),e($);var R=s($,2);R.__click=()=>C(h,!1);var Y=t(R);wa(Y,{size:16}),e(R),e(p);var V=s(p,2),ce=t(V);Be(ce,17,()=>a(X),kt,(Z,De)=>{var Ee=_i();Ee.__click=()=>bt(a(De).id);var ft=t(Ee),ct=t(ft,!0);e(ft);var He=s(ft,2),st=t(He),yt=t(st,!0);e(st);var qt=s(st,2),Rt=t(qt);e(qt),e(He);var Nt=s(He,2),Pt=t(Nt);ra(Pt,{size:16}),e(Nt),e(Ee),x((Yt,Kt)=>{i(ct,Yt),i(yt,a(De).name),i(Rt,`${Kt??""} ${a(De).level??""} • ${a(De).ancestry??""}`)},[()=>a(De).name.charAt(0),()=>_()("common.labels.level")]),d(Z,Ee)});var te=s(ce,2);{var Ie=Z=>{var De=fi(),Ee=t(De),ft=t(Ee);Ca(ft,{size:24}),e(Ee);var ct=s(Ee,2),He=t(ct,!0);e(ct);var st=s(ct,2),yt=t(st,!0);e(st),e(De),x((qt,Rt)=>{i(He,qt),i(yt,Rt)},[()=>_()("session.manage_session.no_available"),()=>_()("session.manage_session.all_in_session")]),d(Z,De)};w(te,Z=>{a(X).length===0&&Z(Ie)})}e(V),e(c),e(v),x((Z,De)=>{i(y,Z),i(ee,De)},[()=>_()("session.manage_session.title"),()=>_()("session.manage_session.description")]),d(o,v)};w(Jt,o=>{a(h)&&o(Wt)})}var Vt=s(Jt,2);{var ca=o=>{var v=zi();v.__click=He=>{He.target===He.currentTarget&&C(N,!1)};var c=t(v),p=t(c),$=t(p),m=t($);Ca(m,{size:16});var y=s(m);e($);var g=s($,2);g.__click=()=>C(N,!1);var ee=t(g);wa(ee,{size:18}),e(g),e(p);var R=s(p,2),Y=t(R);Y.__click=()=>C(A,"enemies");var V=t(Y);Ca(V,{size:14});var ce=s(V);e(Y);var te=s(Y,2);te.__click=()=>C(A,"encounters");var Ie=t(te);Xa(Ie,{size:14});var Z=s(Ie);e(te),e(R);var De=s(R,2),Ee=t(De);{var ft=He=>{var st=hi(),yt=qe(st);Be(yt,17,()=>a(_e),Nt=>Nt.id,(Nt,Pt)=>{var Yt=pi(),Kt=t(Yt),da=t(Kt),ka=t(da),Ha=s(ka);{var Fa=na=>{pa(na,{size:10,class:"text-indigo-400"})};w(Ha,na=>{a(Pt).global&&na(Fa)})}e(da);var Sa=s(da,2),qa=t(Sa);e(Sa),e(Kt);var za=s(Kt,2);za.__click=()=>{B(a(Pt)),C(N,!1)};var Ba=t(za);ra(Ba,{size:16}),e(za),e(Yt),x(na=>{i(ka,`${a(Pt).name??""} `),i(qa,`${na??""} ${a(Pt).difficulty??""}`)},[()=>_()("session.enemies.difficulty")]),d(Nt,Yt)});var qt=s(yt,2);{var Rt=Nt=>{var Pt=gi(),Yt=t(Pt,!0);e(Pt),x(Kt=>i(Yt,Kt),[()=>_()("session.enemies.none")]),d(Nt,Pt)};w(qt,Nt=>{a(_e).length===0&&Nt(Rt)})}d(He,st)},ct=He=>{var st=ki(),yt=qe(st);Be(yt,17,()=>a(Me),Nt=>Nt.id,(Nt,Pt)=>{var Yt=yi(),Kt=t(Yt),da=t(Kt),ka=t(da),Ha=s(ka);{var Fa=na=>{pa(na,{size:10,class:"text-indigo-400"})};w(Ha,na=>{a(Pt).global&&na(Fa)})}e(da);var Sa=s(da,2),qa=t(Sa);e(Sa),e(Kt);var za=s(Kt,2);za.__click=()=>{ge(a(Pt)),C(N,!1)};var Ba=t(za);Za(Ba,{size:16}),e(za),e(Yt),x((na,Wa)=>{i(ka,`${a(Pt).name??""} `),i(qa,`${na??""} ${Wa??""}`)},[()=>a(Pt).enemies?.reduce((na,Wa)=>na+Wa.count,0)||0,()=>_()("session.enemies.title")]),d(Nt,Yt)});var qt=s(yt,2);{var Rt=Nt=>{var Pt=wi(),Yt=t(Pt,!0);e(Pt),x(Kt=>i(Yt,Kt),[()=>_()("session.enemies.no_encounters")]),d(Nt,Pt)};w(qt,Nt=>{a(Me).length===0&&Nt(Rt)})}d(He,st)};w(Ee,He=>{a(A)==="enemies"?He(ft):He(ct,!1)})}e(De),e(c),e(v),x((He,st,yt)=>{i(y,` ${He??""}`),Fe(Y,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(A)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(ce,` ${st??""}`),Fe(te,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(A)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(Z,` ${yt??""}`)},[()=>_()("session.enemies.title"),()=>_()("session.enemies.title"),()=>_()("session.enemies.encounters")]),d(o,v)};w(Vt,o=>{a(N)&&o(ca)})}var Zt=s(Vt,2);Zt.__click=()=>C(N,!0);var vt=t(Zt);Ca(vt,{size:24}),e(Zt);var At=s(Zt,2);ms(At,{get isOpen(){return j()},onClose:()=>Ma.set(!1)});var ia=s(At,2);cs(ia,{get isOpen(){return a(ae).isOpen},get title(){return a(ae).title},get message(){return a(ae).message},get onConfirm(){return a(ae).onConfirm},onCancel:()=>a(ae).isOpen=!1}),x((o,v,c,p)=>{i(Ne,` ${o??""} `),i(Ct,v),Fe(G,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(A)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(ve,` ${c??""}`),Fe(Ae,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(A)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(it,` ${p??""}`)},[()=>_()("session.players.title"),()=>a(h)?_()("session.players.close"):_()("session.players.add"),()=>_()("session.enemies.title"),()=>_()("session.enemies.encounters")]),ja("dragover",$t,et),ja("drop",$t,dt),d(U,zt),oa(),n()}ba(["click"]);var Mi=u('<span class="text-[10px] text-indigo-300 uppercase font-bold mb-2 block"> </span>'),Oi=u('<div><!> <div class="flex items-center justify-between bg-black/40 rounded-xl p-1.5 border border-white/5"><button type="button" class="w-10 h-10 flex items-center justify-center bg-slate-800 hover:bg-slate-700 text-slate-300 rounded-lg transition-all active:scale-90 disabled:opacity-50 disabled:cursor-not-allowed" aria-label="Diminuir"><!></button> <div class="flex flex-col items-center min-w-[3rem]"><span class="text-2xl font-black text-white leading-none tracking-tighter"> </span></div> <button type="button" class="w-10 h-10 flex items-center justify-center bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-all active:scale-90 shadow-lg shadow-indigo-500/20 disabled:opacity-50 disabled:cursor-not-allowed" aria-label="Aumentar"><!></button></div></div>');function Os(U,r){la(r,!0);function l(){const I=r.steps.indexOf(r.value);if(I>0)r.onUpdate(r.steps[I-1]);else if(I===-1){const O=[...r.steps].reverse().find(ae=>ae<r.value);O!==void 0?r.onUpdate(O):r.onUpdate(r.steps[0])}}function K(){const I=r.steps.indexOf(r.value);if(I!==-1&&I<r.steps.length-1)r.onUpdate(r.steps[I+1]);else if(I===-1){const O=r.steps.find(ae=>ae>r.value);O!==void 0?r.onUpdate(O):r.onUpdate(r.steps[r.steps.length-1])}}var D=Oi(),_=t(D);{var j=I=>{var O=Mi(),ae=t(O,!0);e(O),x(()=>i(ae,r.label)),d(I,O)};w(_,I=>{r.label&&I(j)})}var S=s(_,2),n=t(S);n.__click=l;var h=t(n);fs(h,{size:18}),e(n);var N=s(n,2),le=t(N),re=t(le,!0);e(le),e(N);var me=s(N,2);me.__click=K;var A=t(me);ra(A,{size:18}),e(me),e(S),e(D),x(()=>{n.disabled=r.value<=r.steps[0],i(re,r.value),me.disabled=r.value>=r.steps[r.steps.length-1]}),d(U,D),oa()}ba(["click"]);var Ei=u('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),Si=u('<div class="text-xs text-slate-500 italic mt-2 leading-relaxed opacity-75"> </div>'),Ii=u('<span class="text-slate-400"> </span>'),Di=u('<span class="text-slate-400"> </span>'),Ri=u('<div class="text-sm mb-4"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span></div>'),Ni=u('<div class="mb-3 text-sm"><span class="font-bold text-indigo-400"> </span> <span class="text-slate-300 ml-1"> </span></div>'),$i=u('<span class="text-slate-300"> </span>'),Ai=u('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span> <span class="text-white ml-1"> </span> <!></div>'),Ti=u('<div class="mt-4"><h4 class="text-red-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Ui=u('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),Pi=u('<div class="mt-4"><h4 class="text-orange-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Li=u('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),Hi=u('<div class="mt-4"><h4 class="text-yellow-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Fi=u('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl"><div class="flex items-start gap-3 mb-4"><!> <div class="flex-1 min-w-0"><div class="flex items-baseline gap-2"><h2 class="text-xl font-bold text-white font-serif tracking-wide"> </h2> <span class="text-red-500 font-bold text-sm"> </span></div> <div class="text-sm text-slate-400 mt-1"> </div> <!></div></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <span class="text-slate-500 font-bold ml-3"> </span> <span class="text-white ml-1"> </span></div> <div class="text-sm mb-3"><span class="text-white"><span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> </span></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <!> <div class="border-t border-slate-700 my-4"></div> <!> <!> <!> <!></div>'),qi=u('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc-text" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc-text" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-desc" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div class="flex items-center gap-2 mt-4"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),Bi=u('<div class="bg-slate-900 p-3 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Wi=u('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div class="flex flex-col"><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-perception" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-perception" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-speed-notes" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed-notes" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-senses" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[80px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div></div></div>'),Ji=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Gi=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-2"><div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <select class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm"><option> </option><option> </option></select></div> <div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/> <input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/></div> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Qi=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Vi=u('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Yi=u('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="p-4 bg-slate-900 rounded border border-indigo-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-indigo-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-red-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-red-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-orange-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-orange-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-yellow-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-yellow-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div></div>'),Zi=u('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),Xi=u('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" aria-label="Close" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-start justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function Ki(U,r){la(r,!0);const l=()=>Lt(aa,"$t",K),[K,D]=va(),_=E=>{var X=Fi(),_e=t(X),Me=t(_e);{var pe=b=>{var z=Ei(),k=t(z);Da(k,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom"}),e(z),d(b,z)};w(Me,b=>{a(n).imageUrl&&b(pe)})}var bt=s(Me,2),Ke=t(bt),pt=t(Ke),xt=t(pt,!0);e(pt);var B=s(pt,2),ge=t(B);e(B),e(Ke);var Pe=s(Ke,2),Ve=t(Pe);e(Pe);var _t=s(Pe,2);{var Ye=b=>{var z=Si(),k=t(z,!0);e(z),x(()=>i(k,a(n).description)),d(b,z)};w(_t,b=>{a(n).description&&b(Ye)})}e(bt),e(_e);var ze=s(_e,2),Re=t(ze),Q=t(Re,!0);e(Re);var he=s(Re,2),Se=t(he);e(he);var $e=s(he,2);{var Le=b=>{var z=Ii(),k=t(z);e(z),x(()=>i(k,`; ${a(n).senses??""}`)),d(b,z)};w($e,b=>{a(n).senses&&b(Le)})}e(ze);var nt=s(ze,2),et=t(nt),dt=t(et,!0);e(et);var zt=s(et,2),Ht=t(zt,!0);e(zt);var Et=s(zt,2),Ft=t(Et,!0);e(Et);var M=s(Et,2),q=t(M,!0);e(M),e(nt);var P=s(nt,2),Ne=t(P),tt=t(Ne),at=t(tt,!0);e(tt);var Ze=s(tt),Ct=s(Ze),Mt=t(Ct,!0);e(Ct);var St=s(Ct),Je=s(St),H=t(Je,!0);e(Je);var T=s(Je),L=s(T),fe=t(L,!0);e(L);var W=s(L);e(Ne),e(P);var J=s(P,2),ne=t(J),Ge=t(ne,!0);e(ne);var de=s(ne,2),oe=t(de,!0);e(de);var G=s(de,2);{var Oe=b=>{var z=Di(),k=t(z);e(z),x(()=>i(k,`; ${a(n).speedNotes??""}`)),d(b,z)};w(G,b=>{a(n).speedNotes&&b(Oe)})}e(J);var ve=s(J,2);{var Ae=b=>{var z=Ri(),k=t(z),ye=t(k,!0);e(k);var Te=s(k,2),Xe=t(Te,!0);e(Te),e(z),x(Qe=>{i(ye,Qe),i(Xe,a(n).immunities)},[()=>l()("session.enemy_modal.immunities")]),d(b,z)};w(ve,b=>{a(n).immunities&&b(Ae)})}var rt=s(ve,4);{var it=b=>{var z=Ot(),k=qe(z);Be(k,17,()=>a(n).traits,kt,(ye,Te)=>{var Xe=Ni(),Qe=t(Xe),gt=t(Qe,!0);e(Qe);var ht=s(Qe,2),Ut=t(ht,!0);e(ht),e(Xe),x(()=>{i(gt,a(Te).name),i(Ut,a(Te).desc)}),d(ye,Xe)}),d(b,z)};w(rt,b=>{a(n).traits.length>0&&b(it)})}var lt=s(rt,2);{var Tt=b=>{var z=Ti(),k=t(z),ye=t(k,!0);e(k);var Te=s(k,2);Be(Te,17,()=>a(n).attackOptions,kt,(Xe,Qe)=>{var gt=Ai(),ht=t(gt),Ut=t(ht,!0);e(ht);var Dt=s(ht,2),Bt=t(Dt);e(Dt);var Gt=s(Dt,2),Xt=t(Gt);e(Gt);var ta=s(Gt,2);{var Jt=Wt=>{var Vt=$i(),ca=t(Vt);e(Vt),x(()=>i(ca,`; ${a(Qe).desc??""}`)),d(Wt,Vt)};w(ta,Wt=>{a(Qe).desc&&Wt(Jt)})}e(gt),x(Wt=>{i(Ut,a(Qe).name),i(Bt,`(${Wt??""})`),i(Xt,`${a(Qe).attackRoll??""} (${a(Qe).damage??""})`)},[()=>a(Qe).type==="melee"?l()("session.enemy_modal.melee").toLowerCase():l()("session.enemy_modal.ranged").toLowerCase()]),d(Xe,gt)}),e(z),x(Xe=>i(ye,Xe),[()=>l()("session.enemy_modal.attack_options")]),d(b,z)};w(lt,b=>{a(n).attackOptions.length>0&&b(Tt)})}var It=s(lt,2);{var Qt=b=>{var z=Pi(),k=t(z),ye=t(k,!0);e(k);var Te=s(k,2);Be(Te,17,()=>a(n).specialAttacks,kt,(Xe,Qe)=>{var gt=Ui(),ht=t(gt),Ut=t(ht,!0);e(ht);var Dt=s(ht,2),Bt=t(Dt,!0);e(Dt),e(gt),x(()=>{i(Ut,a(Qe).name),i(Bt,a(Qe).desc)}),d(Xe,gt)}),e(z),x(Xe=>i(ye,Xe),[()=>l()("session.enemy_modal.special_attacks")]),d(b,z)};w(It,b=>{a(n).specialAttacks.length>0&&b(Qt)})}var $t=s(It,2);{var f=b=>{var z=Hi(),k=t(z),ye=t(k,!0);e(k);var Te=s(k,2);Be(Te,17,()=>a(n).endOfRound,kt,(Xe,Qe)=>{var gt=Li(),ht=t(gt),Ut=t(ht,!0);e(ht);var Dt=s(ht,2),Bt=t(Dt,!0);e(Dt),e(gt),x(()=>{i(Ut,a(Qe).name),i(Bt,a(Qe).desc)}),d(Xe,gt)}),e(z),x(Xe=>i(ye,Xe),[()=>l()("session.enemy_modal.end_of_round")]),d(b,z)};w($t,b=>{a(n).endOfRound.length>0&&b(f)})}e(X),x((b,z,k,ye,Te,Xe,Qe,gt,ht,Ut,Dt,Bt,Gt,Xt,ta,Jt,Wt)=>{i(xt,b),i(ge,`${z??""} ${a(n).difficulty??""}`),i(Ve,`${k??""} ${ye??""} ${a(n).descriptors??""}`),i(Q,Te),i(Se,`${a(n).perception??""} (${Xe??""})`),i(dt,Qe),i(Ht,a(n).defense),i(Ft,gt),i(q,a(n).health),i(at,ht),i(Ze,` ${a(n).attributes.strength??""} (${Ut??""}), `),i(Mt,Dt),i(St,` ${a(n).attributes.agility??""} (${Bt??""}), `),i(H,Gt),i(T,` ${a(n).attributes.intellect??""} (${Xt??""}), `),i(fe,ta),i(W,` ${a(n).attributes.will??""} (${Jt??""})`),i(Ge,Wt),i(oe,a(n).speed)},[()=>a(n).name||l()("session.enemy_modal.enemy_default"),()=>l()("session.enemies.difficulty").toUpperCase(),()=>l()("session.enemy_modal.size"),()=>ae(a(n).size),()=>l()("sofdl.attributes.perception"),()=>O(a(n).perception),()=>l()("session.enemy_modal.defense"),()=>l()("session.enemy_modal.health"),()=>l()("sofdl.attributes.strength"),()=>O(a(n).attributes.strength),()=>l()("sofdl.attributes.agility"),()=>O(a(n).attributes.agility),()=>l()("sofdl.attributes.intellect"),()=>O(a(n).attributes.intellect),()=>l()("sofdl.attributes.will"),()=>O(a(n).attributes.will),()=>l()("session.enemy_modal.speed")]),d(E,X)};let j=sa(r,"isOpen",3,!1),S=sa(r,"initialData",3,"{}"),n=mt(ga(I())),h=mt("general"),N=mt(!1),le=mt(""),re=mt(void 0);function me(E){const X=E.target.files;if(X&&X.length>0){const _e=X[0],Me=new FileReader;Me.onload=()=>{C(le,Me.result,!0),C(N,!0)},Me.readAsDataURL(_e)}E.target&&(E.target.value="")}async function A(E){try{const X=await gs(E);a(n).imageUrl=X,C(N,!1)}catch(X){console.error(X),alert(X.message||"Erro ao salvar imagem")}}function I(){return{name:"",difficulty:1,size:1,description:"",descriptors:"",perception:10,senses:"",defense:10,health:10,attributes:{strength:10,agility:10,intellect:10,will:10},speed:10,speedNotes:"",immunities:"",traits:[],attackOptions:[],specialAttacks:[],endOfRound:[],imageUrl:"",global:!1}}function O(E){const X=E-10;return X>=0?`+${X}`:`${X}`}function ae(E){return E===.125?"1/8":E===.5?"1/2":E}Pa(()=>{if(j()&&S())try{const E=JSON.parse(S());Object.keys(E).length===0?C(n,I(),!0):C(n,{...I(),...E},!0)}catch{C(n,I(),!0)}});function se(){a(n).traits=[...a(n).traits,{name:"",desc:""}]}function ot(E){a(n).traits=a(n).traits.filter((X,_e)=>_e!==E)}function We(){a(n).attackOptions=[...a(n).attackOptions,{name:"",type:"melee",attackRoll:"+0",damage:"1d6",desc:""}]}function jt(E){a(n).attackOptions=a(n).attackOptions.filter((X,_e)=>_e!==E)}function ie(){a(n).specialAttacks=[...a(n).specialAttacks,{name:"",desc:""}]}function we(E){a(n).specialAttacks=a(n).specialAttacks.filter((X,_e)=>_e!==E)}function be(){a(n).endOfRound=[...a(n).endOfRound,{name:"",desc:""}]}function ke(E){a(n).endOfRound=a(n).endOfRound.filter((X,_e)=>_e!==E)}function ue(E){}var je=Ot(),Ue=qe(je);{var xe=E=>{var X=Xi(),_e=qe(X);_e.__click=ue;var Me=t(_e),pe=t(Me),bt=t(pe),Ke=t(bt),pt=t(Ke);pt.__click=function(...Je){r.onClose?.apply(this,Je)};var xt=t(pt);La(xt,{size:24}),e(pt);var B=s(pt,2),ge=t(B,!0);e(B),e(Ke);var Pe=s(Ke,2);Pe.__click=function(...Je){r.onClose?.apply(this,Je)};var Ve=t(Pe);wa(Ve,{size:20}),e(Pe),e(bt);var _t=s(bt,2),Ye=t(_t);Ye.__click=()=>C(h,"general");var ze=t(Ye,!0);e(Ye);var Re=s(Ye,2);Re.__click=()=>C(h,"stats");var Q=t(Re,!0);e(Re);var he=s(Re,2);he.__click=()=>C(h,"abilities");var Se=t(he,!0);e(he);var $e=s(he,2);$e.__click=()=>C(h,"preview");var Le=t($e,!0);e($e),e(_t);var nt=s(_t,2),et=t(nt);{var dt=Je=>{var H=qi(),T=t(H),L=t(T);L.__click=()=>a(re)?.click();var fe=t(L),W=t(fe);ts(W,()=>a(n).imageUrl,k=>{Da(k,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom",fallbackText:"?"})}),e(fe);var J=s(fe,2),ne=t(J);hs(ne,{size:20,class:"text-white"}),e(J),e(L);var Ge=s(L,2),de=t(Ge),oe=t(de,!0);e(de);var G=s(de,2);wt(G),e(Ge),e(T);var Oe=s(T,2),ve=t(Oe),Ae=t(ve,!0);e(ve);var rt=s(ve,2);ha(rt),e(Oe);var it=s(Oe,2),lt=t(it),Tt=t(lt,!0);e(lt);var It=s(lt,2);wt(It),e(it);var Qt=s(it,2),$t=t(Qt);wt($t);var f=s($t,2),b=t(f);pa(b,{size:14});var z=s(b);e(f),e(Qt),e(H),x((k,ye,Te,Xe,Qe,gt)=>{i(oe,k),i(Ae,ye),Ce(rt,"placeholder",Te),i(Tt,Xe),Ce(It,"placeholder",Qe),i(z,` ${gt??""}`)},[()=>l()("session.enemy_modal.name"),()=>l()("session.enemy_modal.description"),()=>l()("session.enemy_modal.description_placeholder"),()=>l()("session.enemy_modal.descriptors"),()=>l()("session.enemy_modal.descriptors_placeholder"),()=>l()("session.enemy_modal.global_enemy")]),ut(G,()=>a(n).name,k=>a(n).name=k),ut(rt,()=>a(n).description,k=>a(n).description=k),ut(It,()=>a(n).descriptors,k=>a(n).descriptors=k),vs($t,()=>a(n).global,k=>a(n).global=k),d(Je,H)},zt=Je=>{var H=Ot(),T=qe(H);{var L=W=>{var J=Wi(),ne=t(J),Ge=t(ne),de=t(Ge),oe=t(de,!0);e(de);var G=s(de,2);{let m=F(()=>a(n).difficulty??0);Os(G,{get value(){return a(m)},onUpdate:y=>a(n).difficulty=y,steps:[0,1,5,10,25,50,100,250,500,750,1e3]})}e(Ge);var Oe=s(Ge,2),ve=t(Oe),Ae=t(ve,!0);e(ve);var rt=s(ve,2);{let m=F(()=>a(n).size||1);ys(rt,{get value(){return a(m)},onUpdate:y=>a(n).size=y})}e(Oe),e(ne);var it=s(ne,2),lt=t(it),Tt=t(lt),It=t(Tt,!0);e(Tt);var Qt=s(Tt,2);wt(Qt),e(lt);var $t=s(lt,2),f=t($t),b=t(f,!0);e(f);var z=s(f,2);wt(z),e($t),e(it);var k=s(it,2),ye=t(k),Te=t(ye),Xe=t(Te,!0);e(Te);var Qe=s(Te,2);wt(Qe),e(ye);var gt=s(ye,2),ht=t(gt),Ut=t(ht,!0);e(ht);var Dt=s(ht,2);wt(Dt),e(gt),e(k);var Bt=s(k,2),Gt=t(Bt),Xt=t(Gt,!0);e(Gt);var ta=s(Gt,2);Be(ta,5,()=>[{key:"strength",label:l()("sofdl.attributes.strength")},{key:"agility",label:l()("sofdl.attributes.agility")},{key:"intellect",label:l()("sofdl.attributes.intellect")},{key:"will",label:l()("sofdl.attributes.will")}],kt,(m,y)=>{var g=Bi(),ee=t(g),R=t(ee,!0);e(ee);var Y=s(ee,2);wt(Y);var V=s(Y,2),ce=t(V,!0);e(V),e(g),x((te,Ie)=>{Ce(ee,"for",`attr-${a(y).key??""}`),Ce(ee,"title",a(y).label),i(R,te),Ce(Y,"id",`attr-${a(y).key??""}`),Fe(V,1,`text-xs font-bold ${a(n).attributes[a(y).key]-10>=0?"text-green-500":"text-red-500"}`),i(ce,Ie)},[()=>a(y).label.substring(0,3),()=>O(a(n).attributes[a(y).key])]),ut(Y,()=>a(n).attributes[a(y).key],te=>a(n).attributes[a(y).key]=te),d(m,g)}),e(ta),e(Bt);var Jt=s(Bt,2),Wt=t(Jt),Vt=t(Wt),ca=t(Vt,!0);e(Vt);var Zt=s(Vt,2);wt(Zt),e(Wt);var vt=s(Wt,2),At=t(vt),ia=t(At,!0);e(At);var o=s(At,2);wt(o),e(vt);var v=s(vt,2),c=t(v),p=t(c,!0);e(c);var $=s(c,2);ha($),e(v),e(Jt),e(J),x((m,y,g,ee,R,Y,V,ce,te,Ie,Z,De,Ee)=>{i(oe,m),i(Ae,y),i(It,g),i(b,ee),i(Xe,R),i(Ut,Y),i(Xt,V),i(ca,ce),Ce(Zt,"placeholder",te),i(ia,Ie),Ce(o,"placeholder",Z),i(p,De),Ce($,"placeholder",Ee)},[()=>l()("session.enemy_modal.difficulty"),()=>l()("session.enemy_modal.size"),()=>l()("session.enemy_modal.speed"),()=>l()("session.enemy_modal.health"),()=>l()("session.enemy_modal.defense"),()=>l()("sofdl.attributes.perception"),()=>l()("session.enemy_modal.main_attributes"),()=>l()("session.enemy_modal.speed_notes"),()=>l()("session.enemy_modal.speed_notes_placeholder"),()=>l()("session.enemy_modal.senses"),()=>l()("session.enemy_modal.senses_placeholder_sotdl"),()=>l()("session.enemy_modal.immunities"),()=>l()("session.enemy_modal.immunities_placeholder_sotdl")]),ut(Qt,()=>a(n).speed,m=>a(n).speed=m),ut(z,()=>a(n).health,m=>a(n).health=m),ut(Qe,()=>a(n).defense,m=>a(n).defense=m),ut(Dt,()=>a(n).perception,m=>a(n).perception=m),ut(Zt,()=>a(n).speedNotes,m=>a(n).speedNotes=m),ut(o,()=>a(n).senses,m=>a(n).senses=m),ut($,()=>a(n).immunities,m=>a(n).immunities=m),d(W,J)},fe=W=>{var J=Ot(),ne=qe(J);{var Ge=oe=>{var G=Yi(),Oe=t(G),ve=t(Oe),Ae=t(ve),rt=t(Ae,!0);e(Ae),e(ve);var it=s(ve,2),lt=t(it);Be(lt,17,()=>a(n).traits,kt,(y,g,ee)=>{var R=Ji(),Y=t(R),V=t(Y);wt(V);var ce=s(V,2);ha(ce),e(Y);var te=s(Y,2);te.__click=()=>ot(ee);var Ie=t(te);ua(Ie,{size:16}),e(te),e(R),x((Z,De)=>{Ce(V,"placeholder",Z),Ce(ce,"placeholder",De)},[()=>l()("session.enemy_modal.name_placeholder"),()=>l()("session.enemy_modal.desc_placeholder")]),ut(V,()=>a(g).name,Z=>a(g).name=Z),ut(ce,()=>a(g).desc,Z=>a(g).desc=Z),d(y,R)});var Tt=s(lt,2);Tt.__click=se;var It=t(Tt),Qt=t(It);ra(Qt,{size:16}),e(It);var $t=s(It);e(Tt),e(it),e(Oe);var f=s(Oe,2),b=t(f),z=t(b),k=t(z,!0);e(z),e(b);var ye=s(b,2),Te=t(ye);Be(Te,17,()=>a(n).attackOptions,kt,(y,g,ee)=>{var R=Gi(),Y=t(R),V=t(Y),ce=t(V);wt(ce);var te=s(ce,2),Ie=t(te),Z=t(Ie,!0);e(Ie),Ie.value=Ie.__value="melee";var De=s(Ie),Ee=t(De,!0);e(De),De.value=De.__value="ranged",e(te),e(V);var ft=s(V,2),ct=t(ft);wt(ct);var He=s(ct,2);wt(He),e(ft);var st=s(ft,2);ha(st),e(Y);var yt=s(Y,2);yt.__click=()=>jt(ee);var qt=t(yt);ua(qt,{size:16}),e(yt),e(R),x((Rt,Nt,Pt,Yt,Kt,da)=>{Ce(ce,"placeholder",Rt),i(Z,Nt),i(Ee,Pt),Ce(ct,"placeholder",Yt),Ce(He,"placeholder",Kt),Ce(st,"placeholder",da)},[()=>l()("session.enemy_modal.name_placeholder"),()=>l()("session.enemy_modal.melee"),()=>l()("session.enemy_modal.ranged"),()=>l()("session.enemy_modal.attack_placeholder"),()=>l()("session.enemy_modal.damage_placeholder"),()=>l()("session.enemy_modal.desc_effects_placeholder")]),ut(ce,()=>a(g).name,Rt=>a(g).name=Rt),Es(te,()=>a(g).type,Rt=>a(g).type=Rt),ut(ct,()=>a(g).attackRoll,Rt=>a(g).attackRoll=Rt),ut(He,()=>a(g).damage,Rt=>a(g).damage=Rt),ut(st,()=>a(g).desc,Rt=>a(g).desc=Rt),d(y,R)});var Xe=s(Te,2);Xe.__click=We;var Qe=t(Xe),gt=t(Qe);ra(gt,{size:16}),e(Qe);var ht=s(Qe);e(Xe),e(ye),e(f);var Ut=s(f,2),Dt=t(Ut),Bt=t(Dt),Gt=t(Bt,!0);e(Bt),e(Dt);var Xt=s(Dt,2),ta=t(Xt);Be(ta,17,()=>a(n).specialAttacks,kt,(y,g,ee)=>{var R=Qi(),Y=t(R),V=t(Y);wt(V);var ce=s(V,2);ha(ce),e(Y);var te=s(Y,2);te.__click=()=>we(ee);var Ie=t(te);ua(Ie,{size:16}),e(te),e(R),x((Z,De)=>{Ce(V,"placeholder",Z),Ce(ce,"placeholder",De)},[()=>l()("session.enemy_modal.name_placeholder"),()=>l()("session.enemy_modal.desc_placeholder")]),ut(V,()=>a(g).name,Z=>a(g).name=Z),ut(ce,()=>a(g).desc,Z=>a(g).desc=Z),d(y,R)});var Jt=s(ta,2);Jt.__click=ie;var Wt=t(Jt),Vt=t(Wt);ra(Vt,{size:16}),e(Wt);var ca=s(Wt);e(Jt),e(Xt),e(Ut);var Zt=s(Ut,2),vt=t(Zt),At=t(vt),ia=t(At,!0);e(At),e(vt);var o=s(vt,2),v=t(o);Be(v,17,()=>a(n).endOfRound,kt,(y,g,ee)=>{var R=Vi(),Y=t(R),V=t(Y);wt(V);var ce=s(V,2);ha(ce),e(Y);var te=s(Y,2);te.__click=()=>ke(ee);var Ie=t(te);ua(Ie,{size:16}),e(te),e(R),x((Z,De)=>{Ce(V,"placeholder",Z),Ce(ce,"placeholder",De)},[()=>l()("session.enemy_modal.name_placeholder"),()=>l()("session.enemy_modal.desc_placeholder")]),ut(V,()=>a(g).name,Z=>a(g).name=Z),ut(ce,()=>a(g).desc,Z=>a(g).desc=Z),d(y,R)});var c=s(v,2);c.__click=be;var p=t(c),$=t(p);ra($,{size:16}),e(p);var m=s(p);e(c),e(o),e(Zt),e(G),x((y,g,ee,R,Y,V,ce,te)=>{i(rt,y),i($t,` ${g??""}`),i(k,ee),i(ht,` ${R??""}`),i(Gt,Y),i(ca,` ${V??""}`),i(ia,ce),i(m,` ${te??""}`)},[()=>l()("session.enemy_modal.traits"),()=>l()("common.buttons.add"),()=>l()("session.enemy_modal.attack_options"),()=>l()("common.buttons.add"),()=>l()("session.enemy_modal.special_attacks"),()=>l()("common.buttons.add"),()=>l()("session.enemy_modal.end_of_round"),()=>l()("common.buttons.add")]),d(oe,G)},de=oe=>{var G=Ot(),Oe=qe(G);{var ve=Ae=>{var rt=Zi(),it=t(rt);_(it),e(rt),d(Ae,rt)};w(Oe,Ae=>{a(h)==="preview"&&Ae(ve)},!0)}d(oe,G)};w(ne,oe=>{a(h)==="abilities"?oe(Ge):oe(de,!1)},!0)}d(W,J)};w(T,W=>{a(h)==="stats"?W(L):W(fe,!1)},!0)}d(Je,H)};w(et,Je=>{a(h)==="general"?Je(dt):Je(zt,!1)})}e(nt);var Ht=s(nt,2),Et=t(Ht);Et.__click=()=>r.onSave(a(n));var Ft=t(Et);as(Ft,{size:18});var M=s(Ft);e(Et),e(Ht),e(pe);var q=s(pe,2),P=t(q),Ne=t(P),tt=t(Ne);es(tt,{size:14});var at=s(tt);e(Ne),e(P);var Ze=s(P,2),Ct=t(Ze);_(Ct),e(Ze),e(q),e(Me),e(_e);var Mt=s(_e,2);Mt.__change=me,zs(Mt,Je=>C(re,Je),()=>a(re));var St=s(Mt,2);ps(St,{get isOpen(){return a(N)},get imageUrl(){return a(le)},onClose:()=>C(N,!1),onCrop:A}),x((Je,H,T,L,fe,W,J)=>{i(ge,Je),Fe(Ye,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(h)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(ze,H),Fe(Re,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(h)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Q,T),Fe(he,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(h)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Se,L),Fe($e,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(h)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Le,fe),i(M,` ${W??""}`),i(at,` ${J??""}`)},[()=>l()("session.enemy_modal.title"),()=>l()("session.enemy_modal.tab_general"),()=>l()("session.enemy_modal.tab_stats"),()=>l()("session.enemy_modal.tab_abilities"),()=>l()("session.enemy_modal.preview"),()=>l()("common.buttons.save"),()=>l()("session.enemy_modal.preview")]),Aa(3,Me,()=>Ta,()=>({y:20,duration:300})),Aa(3,_e,()=>Ta,()=>({duration:200,opacity:1})),d(E,X)};w(Ue,E=>{j()&&E(xe)})}d(U,je),oa(),D()}ba(["click","change"]);var en=u('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),tn=u('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),an=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),sn=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),rn=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),nn=u('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),ln=u('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),on=u('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),dn=u('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),vn=u('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),cn=u('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),un=u('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),bn=u('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),xn=u('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div>'),_n=u('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="flex items-center gap-2"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),fn=u('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),mn=u('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div class="flex flex-col"><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div> <div class="flex flex-col"><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-damage" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-damage" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 text-center border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),pn=u('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),gn=u('<div><div class="mb-3"><h4> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div>'),hn=u('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"></div>'),yn=u('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),wn=u('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function kn(U,r){la(r,!0);const l=()=>Lt(aa,"$t",K),[K,D]=va(),_=ie=>{var we=xn(),be=t(we),ke=t(be);e(be);var ue=s(be,2),je=t(ue);{var Ue=H=>{var T=en(),L=t(T);Da(L,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom"}),e(T),d(H,T)};w(je,H=>{a(n).imageUrl&&H(Ue)})}var xe=s(je,2),E=t(xe),X=t(E,!0);e(E),ya(2),e(xe),e(ue);var _e=s(ue,2),Me=t(_e),pe=t(Me),bt=t(pe,!0);e(pe);var Ke=s(pe,2),pt=t(Ke,!0);e(Ke),e(Me);var xt=s(Me,2),B=t(xt),ge=t(B,!0);e(B);var Pe=s(B,2),Ve=t(Pe,!0);e(Pe),e(xt);var _t=s(xt,2),Ye=t(_t),ze=t(Ye,!0);e(Ye);var Re=s(Ye,2),Q=t(Re,!0);e(Re),e(_t);var he=s(_t,2),Se=t(he),$e=t(Se,!0);e(Se);var Le=s(Se,2),nt=t(Le,!0);e(Le),e(he),e(_e);var et=s(_e,2);Be(et,20,()=>["str","agi","int","wil"],kt,(H,T)=>{var L=tn(),fe=t(L),W=t(fe,!0);e(fe);var J=s(fe,2),ne=t(J),Ge=s(ne),de=t(Ge);e(Ge),e(J),e(L),x(()=>{i(W,T),i(ne,`${a(n).stats[T]??""} `),Fe(Ge,1,`text-xs ${a(n).stats[T]-10>=0?"text-green-500":"text-red-500"}`),i(de,`(${a(n).stats[T]-10>=0?"+":""}${a(n).stats[T]-10})`)}),d(H,L)}),e(et);var dt=s(et,2),zt=t(dt);{var Ht=H=>{var T=an(),L=t(T),fe=t(L);e(L);var W=s(L,2),J=t(W,!0);e(W),e(T),x(ne=>{i(fe,`${ne??""}:`),i(J,a(n).senses)},[()=>l()("session.enemy_modal.senses")]),d(H,T)};w(zt,H=>{a(n).senses&&H(Ht)})}var Et=s(zt,2);{var Ft=H=>{var T=sn(),L=t(T),fe=t(L);e(L);var W=s(L,2),J=t(W,!0);e(W),e(T),x(ne=>{i(fe,`${ne??""}:`),i(J,a(n).languages)},[()=>l()("session.enemy_modal.languages")]),d(H,T)};w(Et,H=>{a(n).languages&&H(Ft)})}var M=s(Et,2);{var q=H=>{var T=rn(),L=t(T),fe=t(L);e(L);var W=s(L,2),J=t(W,!0);e(W),e(T),x(ne=>{i(fe,`${ne??""}:`),i(J,a(n).immune)},[()=>l()("session.enemy_modal.immunities")]),d(H,T)};w(M,H=>{a(n).immune&&H(q)})}e(dt);var P=s(dt,2),Ne=t(P);{var tt=H=>{var T=ln(),L=t(T),fe=t(L,!0);e(L);var W=s(L,2);Be(W,17,()=>a(n).traits,kt,(J,ne,Ge,de)=>{var oe=nn(),G=t(oe),Oe=t(G);e(G);var ve=s(G,2),Ae=t(ve,!0);e(ve),e(oe),x(()=>{i(Oe,`${a(ne).name??""}:`),i(Ae,a(ne).desc)}),d(J,oe)}),e(T),x(J=>i(fe,J),[()=>l()("session.enemy_modal.traits")]),d(H,T)};w(Ne,H=>{a(n).traits.length>0&&H(tt)})}var at=s(Ne,2);{var Ze=H=>{var T=dn(),L=t(T),fe=t(L,!0);e(L);var W=s(L,2);Be(W,17,()=>a(n).actions,kt,(J,ne,Ge,de)=>{var oe=on(),G=t(oe),Oe=t(G);e(G);var ve=s(G,2),Ae=t(ve,!0);e(ve),e(oe),x(()=>{i(Oe,`${a(ne).name??""}:`),i(Ae,a(ne).desc)}),d(J,oe)}),e(T),x(J=>i(fe,J),[()=>l()("session.enemy_modal.actions")]),d(H,T)};w(at,H=>{a(n).actions.length>0&&H(Ze)})}var Ct=s(at,2);{var Mt=H=>{var T=cn(),L=t(T),fe=t(L,!0);e(L);var W=s(L,2);Be(W,17,()=>a(n).reactions,kt,(J,ne,Ge,de)=>{var oe=vn(),G=t(oe),Oe=t(G);e(G);var ve=s(G,2),Ae=t(ve,!0);e(ve),e(oe),x(()=>{i(Oe,`${a(ne).name??""}:`),i(Ae,a(ne).desc)}),d(J,oe)}),e(T),x(J=>i(fe,J),[()=>l()("session.enemy_modal.reactions")]),d(H,T)};w(Ct,H=>{a(n).reactions.length>0&&H(Mt)})}var St=s(Ct,2);{var Je=H=>{var T=bn(),L=t(T),fe=t(L,!0);e(L);var W=s(L,2);Be(W,17,()=>a(n).endOfRound,kt,(J,ne,Ge,de)=>{var oe=un(),G=t(oe),Oe=t(G);e(G);var ve=s(G,2),Ae=t(ve,!0);e(ve),e(oe),x(()=>{i(Oe,`${a(ne).name??""}:`),i(Ae,a(ne).desc)}),d(J,oe)}),e(T),x(J=>i(fe,J),[()=>l()("session.enemy_modal.end_of_round")]),d(H,T)};w(St,H=>{a(n).endOfRound.length>0&&H(Je)})}e(P),e(we),x((H,T,L,fe,W,J)=>{i(ke,`${H??""} ${a(n).difficulty??""}`),i(X,T),i(bt,L),i(pt,a(n).defense),i(ge,fe),i(Ve,a(n).health),i(ze,W),i(Q,a(n).size),i($e,J),i(nt,a(n).speed)},[()=>l()("session.enemy_modal.difficulty"),()=>a(n).name||l()("session.enemy_modal.enemy_default"),()=>l()("session.enemy_modal.defense"),()=>l()("session.enemy_modal.health"),()=>l()("session.enemy_modal.size"),()=>l()("session.enemy_modal.speed")]),d(ie,we)};let j=sa(r,"isOpen",3,!1),S=sa(r,"initialData",3,"{}"),n=mt(ga(I())),h=mt("general"),N=mt(!1),le=mt(""),re=mt(void 0);function me(ie){const we=ie.target.files;if(we&&we.length>0){const be=we[0],ke=new FileReader;ke.onload=()=>{C(le,ke.result,!0),C(N,!0)},ke.readAsDataURL(be)}ie.target&&(ie.target.value="")}async function A(ie){try{const we=await gs(ie);a(n).imageUrl=we,C(N,!1)}catch(we){console.error(we),alert(we.message||"Erro ao salvar imagem")}}function I(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[],global:!1}}Pa(()=>{if(j()&&S())try{const ie=JSON.parse(S());Object.keys(ie).length===0?C(n,I(),!0):C(n,{...I(),...ie},!0)}catch{C(n,I(),!0)}});function O(ie){a(n)[ie]=[...a(n)[ie],{name:"",desc:""}]}function ae(ie,we){a(n)[ie]=a(n)[ie].filter((be,ke)=>ke!==we)}function se(ie){}var ot=Ot(),We=qe(ot);{var jt=ie=>{var we=wn(),be=qe(we);be.__click=se;var ke=t(be),ue=t(ke),je=t(ue),Ue=t(je),xe=t(Ue);xe.__click=function(...P){r.onClose?.apply(this,P)};var E=t(xe);La(E,{size:24}),e(xe);var X=s(xe,2),_e=t(X,!0);e(X),e(Ue);var Me=s(Ue,2);Me.__click=function(...P){r.onClose?.apply(this,P)};var pe=t(Me);wa(pe,{size:20}),e(Me),e(je);var bt=s(je,2),Ke=t(bt);Ke.__click=()=>C(h,"general");var pt=t(Ke,!0);e(Ke);var xt=s(Ke,2);xt.__click=()=>C(h,"stats");var B=t(xt,!0);e(xt);var ge=s(xt,2);ge.__click=()=>C(h,"abilities");var Pe=t(ge,!0);e(ge);var Ve=s(ge,2);Ve.__click=()=>C(h,"preview");var _t=t(Ve,!0);e(Ve),e(bt);var Ye=s(bt,2),ze=t(Ye);{var Re=P=>{var Ne=_n(),tt=t(Ne),at=t(tt);at.__click=()=>a(re)?.click();var Ze=t(at),Ct=t(Ze);ts(Ct,()=>a(n).imageUrl,ve=>{Da(ve,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom",fallbackText:"?"})}),e(Ze);var Mt=s(Ze,2),St=t(Mt);hs(St,{size:20,class:"text-white"}),e(Mt),e(at);var Je=s(at,2),H=t(Je),T=t(H,!0);e(H);var L=s(H,2);wt(L),e(Je),e(tt);var fe=s(tt,2),W=t(fe),J=t(W,!0);e(W);var ne=s(W,2);ha(ne),e(fe);var Ge=s(fe,2),de=t(Ge);wt(de);var oe=s(de,2),G=t(oe);pa(G,{size:14});var Oe=s(G);e(oe),e(Ge),e(Ne),x((ve,Ae,rt,it)=>{i(T,ve),i(J,Ae),Ce(ne,"placeholder",rt),i(Oe,` ${it??""}`)},[()=>l()("session.enemy_modal.name"),()=>l()("session.enemy_modal.description"),()=>l()("session.enemy_modal.description_placeholder"),()=>l()("session.enemy_modal.global_enemy")]),ut(L,()=>a(n).name,ve=>a(n).name=ve),ut(ne,()=>a(n).description,ve=>a(n).description=ve),vs(de,()=>a(n).global,ve=>a(n).global=ve),d(P,Ne)},Q=P=>{var Ne=Ot(),tt=qe(Ne);{var at=Ct=>{var Mt=mn(),St=t(Mt),Je=t(St),H=t(Je),T=t(H,!0);e(H);var L=s(H,2);{let vt=F(()=>a(n).difficulty??1);Os(L,{get value(){return a(vt)},onUpdate:At=>a(n).difficulty=At,steps:[1,2,4,8,16,32,64,128]})}e(Je);var fe=s(Je,2),W=t(fe),J=t(W,!0);e(W);var ne=s(W,2);{let vt=F(()=>a(n).size||1);ys(ne,{get value(){return a(vt)},onUpdate:At=>a(n).size=At})}e(fe),e(St);var Ge=s(St,2),de=t(Ge),oe=t(de),G=t(oe,!0);e(oe);var Oe=s(oe);wt(Oe),e(de);var ve=s(de,2),Ae=t(ve),rt=t(Ae,!0);e(Ae);var it=s(Ae);wt(it),e(ve),e(Ge);var lt=s(Ge,2),Tt=t(lt),It=t(Tt),Qt=t(It,!0);e(It);var $t=s(It);wt($t),e(Tt);var f=s(Tt,2),b=t(f),z=t(b,!0);e(b);var k=s(b);wt(k),e(f),e(lt);var ye=s(lt,2),Te=t(ye),Xe=t(Te,!0);e(Te);var Qe=s(Te,2);Be(Qe,20,()=>["str","agi","int","wil"],kt,(vt,At)=>{var ia=fn(),o=t(ia),v=t(o,!0);e(o);var c=s(o,2);wt(c);var p=s(c,2),$=t(p);e(p),e(ia),x(m=>{Ce(o,"for",`attr-${At??""}`),i(v,m),Ce(c,"id",`attr-${At??""}`),Fe(p,1,`text-xs font-bold ${a(n).stats[At]-10>=0?"text-green-500":"text-red-500"}`),i($,`${a(n).stats[At]-10>=0?"+":""}${a(n).stats[At]-10}`)},[()=>l()("sofww.attributes."+At).substring(0,3)]),ut(c,()=>a(n).stats[At],m=>a(n).stats[At]=m),d(vt,ia)}),e(Qe),e(ye);var gt=s(ye,2),ht=t(gt),Ut=t(ht),Dt=t(Ut,!0);e(Ut);var Bt=s(Ut);wt(Bt),e(ht);var Gt=s(ht,2),Xt=t(Gt),ta=t(Xt,!0);e(Xt);var Jt=s(Xt);wt(Jt),e(Gt);var Wt=s(Gt,2),Vt=t(Wt),ca=t(Vt,!0);e(Vt);var Zt=s(Vt);wt(Zt),e(Wt),e(gt),e(Mt),x((vt,At,ia,o,v,c,p,$,m,y,g,ee,R)=>{i(T,vt),i(J,At),i(G,ia),i(rt,o),i(Qt,v),i(z,c),i(Xe,p),i(Dt,$),Ce(Bt,"placeholder",m),i(ta,y),Ce(Jt,"placeholder",g),i(ca,ee),Ce(Zt,"placeholder",R)},[()=>l()("session.enemy_modal.difficulty"),()=>l()("session.enemy_modal.size"),()=>l()("session.enemy_modal.defense"),()=>l()("session.enemy_modal.health"),()=>l()("session.enemy_modal.damage"),()=>l()("session.enemy_modal.speed"),()=>l()("session.enemy_modal.main_attributes"),()=>l()("session.enemy_modal.senses"),()=>l()("session.enemy_modal.senses_placeholder"),()=>l()("session.enemy_modal.languages"),()=>l()("session.enemy_modal.languages_placeholder"),()=>l()("session.enemy_modal.immunities"),()=>l()("session.enemy_modal.immunities_placeholder")]),ut(Oe,()=>a(n).defense,vt=>a(n).defense=vt),ut(it,()=>a(n).health,vt=>a(n).health=vt),ut($t,()=>a(n).damage,vt=>a(n).damage=vt),ut(k,()=>a(n).speed,vt=>a(n).speed=vt),ut(Bt,()=>a(n).senses,vt=>a(n).senses=vt),ut(Jt,()=>a(n).languages,vt=>a(n).languages=vt),ut(Zt,()=>a(n).immune,vt=>a(n).immune=vt),d(Ct,Mt)},Ze=Ct=>{var Mt=Ot(),St=qe(Mt);{var Je=T=>{var L=hn();Be(L,20,()=>[{key:"traits",label:"traits",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",label:"actions",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",label:"reactions",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",label:"end_of_round",color:"text-yellow-400",border:"border-yellow-500/30"}],kt,(fe,W)=>{var J=gn(),ne=t(J),Ge=t(ne),de=t(Ge,!0);e(Ge),e(ne);var oe=s(ne,2),G=t(oe);Be(G,17,()=>a(n)[W.key],kt,(it,lt,Tt)=>{var It=pn(),Qt=t(It),$t=t(Qt);wt($t);var f=s($t,2);ha(f),e(Qt);var b=s(Qt,2);b.__click=()=>ae(W.key,Tt);var z=t(b);ua(z,{size:16}),e(b),e(It),x((k,ye)=>{Ce($t,"placeholder",k),Ce(f,"placeholder",ye)},[()=>l()("session.enemy_modal.name_placeholder"),()=>l()("session.enemy_modal.desc_placeholder")]),ut($t,()=>a(lt).name,k=>a(lt).name=k),ut(f,()=>a(lt).desc,k=>a(lt).desc=k),d(it,It)});var Oe=s(G,2);Oe.__click=()=>O(W.key);var ve=t(Oe),Ae=t(ve);ra(Ae,{size:16}),e(ve);var rt=s(ve);e(Oe),e(oe),e(J),x((it,lt)=>{Fe(J,1,`p-4 bg-slate-900 rounded border ${W.border??""}`),Fe(Ge,1,`font-bold text-sm uppercase ${W.color??""}`),i(de,it),i(rt,` ${lt??""}`)},[()=>l()("session.enemy_modal."+W.label),()=>l()("common.buttons.add")]),d(fe,J)}),e(L),d(T,L)},H=T=>{var L=Ot(),fe=qe(L);{var W=J=>{var ne=yn(),Ge=t(ne);_(Ge),e(ne),d(J,ne)};w(fe,J=>{a(h)==="preview"&&J(W)},!0)}d(T,L)};w(St,T=>{a(h)==="abilities"?T(Je):T(H,!1)},!0)}d(Ct,Mt)};w(tt,Ct=>{a(h)==="stats"?Ct(at):Ct(Ze,!1)},!0)}d(P,Ne)};w(ze,P=>{a(h)==="general"?P(Re):P(Q,!1)})}e(Ye);var he=s(Ye,2),Se=t(he);Se.__click=()=>r.onSave(a(n));var $e=t(Se);as($e,{size:18});var Le=s($e);e(Se),e(he),e(ue);var nt=s(ue,2),et=t(nt),dt=t(et),zt=t(dt);es(zt,{size:14});var Ht=s(zt);e(dt),e(et);var Et=s(et,2),Ft=t(Et);_(Ft),e(Et),e(nt),e(ke),e(be);var M=s(be,2);M.__change=me,zs(M,P=>C(re,P),()=>a(re));var q=s(M,2);ps(q,{get isOpen(){return a(N)},get imageUrl(){return a(le)},onClose:()=>C(N,!1),onCrop:A}),x((P,Ne,tt,at,Ze,Ct,Mt,St)=>{Ce(be,"aria-label",P),i(_e,Ne),Fe(Ke,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(h)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(pt,tt),Fe(xt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(h)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(B,at),Fe(ge,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(h)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Pe,Ze),Fe(Ve,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(h)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(_t,Ct),i(Le,` ${Mt??""}`),i(Ht,` ${St??""}`)},[()=>l()("session.enemy_modal.close"),()=>l()("session.enemy_modal.title"),()=>l()("session.enemy_modal.tab_general"),()=>l()("session.enemy_modal.tab_stats"),()=>l()("session.enemy_modal.tab_abilities"),()=>l()("session.enemy_modal.preview"),()=>l()("common.buttons.save"),()=>l()("session.enemy_modal.preview")]),Aa(3,ke,()=>Ta,()=>({y:20,duration:300})),Aa(3,be,()=>Ta,()=>({duration:200,opacity:1})),d(ie,we)};w(We,ie=>{j()&&ie(jt)})}d(U,ot),oa(),D()}ba(["click","change"]);var zn=u('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),Cn=u('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),jn=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),Mn=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function On(U,r){la(r,!0);const l=()=>Lt(aa,"$t",D),K=()=>Lt(Ka,"$liveEnemies",D),[D,_]=va();let j=sa(r,"isOpen",3,!1),S=sa(r,"initialData",3,"{}"),n=mt(ga({name:"",enemies:[]}));Pa(()=>{if(j()&&S())try{const O=JSON.parse(S());C(n,{name:O.name||"",enemies:O.enemies||[]},!0)}catch{C(n,{name:"",enemies:[]},!0)}});function h(O){a(n).enemies.find(se=>se.enemyId===O)?a(n).enemies=a(n).enemies.map(se=>se.enemyId===O?{...se,count:se.count+1}:se):a(n).enemies=[...a(n).enemies,{enemyId:O,count:1}]}function N(O){a(n).enemies=a(n).enemies.filter((ae,se)=>se!==O)}function le(O,ae){const se=Math.max(1,parseInt(ae)||1);a(n).enemies[O].count=se}function re(O){}var me=Ot(),A=qe(me);{var I=O=>{var ae=Mn();ae.__click=re;var se=t(ae),ot=t(se),We=t(ot),jt=t(We,!0);e(We);var ie=s(We,2);ie.__click=function(...Q){r.onClose?.apply(this,Q)};var we=t(ie);wa(we,{size:20}),e(ie),e(ot);var be=s(ot,2),ke=t(be),ue=t(ke),je=t(ue,!0);e(ue);var Ue=s(ue,2);wt(Ue),e(ke),e(be);var xe=s(be,2),E=t(xe),X=t(E),_e=t(X,!0);e(X);var Me=s(X,2),pe=t(Me);Be(pe,17,()=>a(n).enemies,kt,(Q,he,Se)=>{const $e=F(()=>K().find(P=>P.id===a(he).enemyId));var Le=zn(),nt=t(Le),et=t(nt),dt=t(et,!0);e(et);var zt=s(et,2),Ht=t(zt);e(zt),e(nt);var Et=s(nt,2),Ft=t(Et);wt(Ft),Ft.__input=P=>le(Se,P.target.value);var M=s(Ft,2);M.__click=()=>N(Se);var q=t(M);ua(q,{size:16}),e(M),e(Et),e(Le),x(P=>{i(dt,P),i(Ht,`Dif ${(a($e)?a($e).difficulty:"?")??""}`),Va(Ft,a(he).count)},[()=>a($e)?a($e).name:l()("session.encounter_modal.unknown")]),d(Q,Le)});var bt=s(pe,2);{var Ke=Q=>{var he=Cn(),Se=t(he,!0);e(he),x($e=>i(Se,$e),[()=>l()("session.encounter_modal.none_added")]),d(Q,he)};w(bt,Q=>{a(n).enemies.length===0&&Q(Ke)})}e(Me),e(E);var pt=s(E,2),xt=t(pt),B=t(xt,!0);e(xt);var ge=s(xt,2);Be(ge,5,K,Q=>Q.id,(Q,he)=>{var Se=jn(),$e=t(Se),Le=t($e),nt=t(Le,!0);e(Le);var et=s(Le,2),dt=t(et);e(et),e($e);var zt=s($e,2);zt.__click=()=>h(a(he).id);var Ht=t(zt);ra(Ht,{size:16}),e(zt),e(Se),x(()=>{i(nt,a(he).name),i(dt,`Dif ${a(he).difficulty??""}`)}),d(Q,Se)}),e(ge),e(pt),e(xe);var Pe=s(xe,2),Ve=t(Pe);Ve.__click=function(...Q){r.onClose?.apply(this,Q)};var _t=t(Ve,!0);e(Ve);var Ye=s(Ve,2);Ye.__click=()=>r.onSave(a(n));var ze=t(Ye);as(ze,{size:18});var Re=s(ze);e(Ye),e(Pe),e(se),e(ae),x((Q,he,Se,$e,Le,nt,et,dt)=>{Ce(ae,"aria-label",Q),i(jt,he),i(je,Se),Ce(Ue,"placeholder",$e),i(_e,Le),i(B,nt),i(_t,et),i(Re,` ${dt??""}`)},[()=>l()("session.encounter_modal.close"),()=>l()("session.encounter_modal.title"),()=>l()("session.encounter_modal.name"),()=>l()("session.encounter_modal.name_placeholder"),()=>l()("session.encounter_modal.enemies_in_encounter"),()=>l()("session.encounter_modal.add_enemies"),()=>l()("common.buttons.cancel"),()=>l()("session.encounter_modal.save_encounter")]),ut(Ue,()=>a(n).name,Q=>a(n).name=Q),d(O,ae)};w(A,O=>{j()&&O(I)})}d(U,me),oa(),_()}ba(["click","input"]);var En=u('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),Sn=u('<div class="text-[10px] text-slate-600 italic"> </div>'),In=u('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="flex items-center gap-2 mb-2"><div class="font-bold text-white text-base group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <!></div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),Dn=u('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),Rn=u('<div class="mb-4 flex-1"><p> </p> <!></div>'),Nn=u('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),$n=u('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><div class="flex items-center gap-2"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <!></div> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),An=u('<div class="text-center text-slate-500 italic col-span-3"> </div>'),Tn=u('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function Un(U,r){la(r,!0);const l=()=>Lt(Ka,"$liveEnemies",_),K=()=>Lt(us,"$liveEncounters",_),D=()=>Lt(aa,"$t",_),[_,j]=va();let S=mt(!1),n=mt(null),h=mt("{}"),N=mt(!1),le=mt(null),re=mt("{}"),me=mt(ga({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function A(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function I(M=null){C(n,M?M.id:null,!0),M?C(h,JSON.stringify(M),!0):a(je)==="sofdl"?C(h,"{}"):C(h,JSON.stringify(A()),!0),C(S,!0)}let O=ga(new Set);function ae(M){O.has(M)?O.delete(M):O.add(M)}function se(M){const q=a(n)||Ia(),P=ea.get(r.campId);ns.set(q,{...M,id:q,campaignId:r.campId,system:P?.system||"sofww"}),C(S,!1)}function ot(M){const q=l().find(P=>P.id===M);C(me,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${q?.name||"este inimigo"}"?`,onConfirm:()=>{ns.delete(M),a(me).isOpen=!1}},!0)}function We(M=null){C(le,M?M.id:null,!0),C(re,JSON.stringify(M||{name:"",enemies:[]}),!0),C(N,!0)}function jt(M){const q=a(le)||Ia();Ga.set(q,{...M,id:q,system:a(je)}),C(N,!1)}function ie(M){const q=K().find(P=>P.id===M);C(me,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${q?.name||"este encontro"}"?`,onConfirm:()=>{Ga.delete(M),a(me).isOpen=!1}},!0)}function we(M){const q=ea.get(r.campId);if(!q)return;const P=q.activeEnemies||[];let Ne=[];M.enemies.forEach(tt=>{const at=l().find(Ze=>Ze.id===tt.enemyId);if(at)for(let Ze=0;Ze<tt.count;Ze++)Ne.push({...at,instanceId:Ia(),damage:0,currentHealth:at.health,afflictions:[],acted:!1,initiative:!1})}),ea.set(r.campId,{...q,activeEnemies:[...P,...Ne]})}function be(M,q){M.dataTransfer.setData("text/plain",q.id),M.dataTransfer.effectAllowed="copy"}function ke(M){return M.preventDefault(),!1}function ue(M,q){M.preventDefault();const P=M.dataTransfer.getData("text/plain");if(!P)return;const Ne=q.enemies||[],tt=Ne.find(Ze=>Ze.enemyId===P);let at;tt?at=Ne.map(Ze=>Ze.enemyId===P?{...Ze,count:Ze.count+1}:Ze):at=[...Ne,{enemyId:P,count:1}],Ga.set(q.id,{...q,enemies:at})}let je=F(()=>ea.get(r.campId)?.system||"sofww"),Ue=F(()=>l().filter(M=>{const P=(M.system||"sofww")===a(je),Ne=M.global===!0,tt=M.campaignId===r.campId;return P&&(Ne||tt)})),xe=F(()=>K().filter(M=>{const P=(M.system||"sofww")===a(je),Ne=M.global===!0,tt=M.campaignId===r.campId;return P&&(Ne||tt)}));var E=Tn(),X=t(E),_e=t(X),Me=t(_e),pe=t(Me);Xa(pe,{size:16});var bt=s(pe);e(Me),e(_e);var Ke=s(_e,2),pt=t(Ke);pt.__click=()=>We();var xt=t(pt);ra(xt,{size:28,class:"group-hover:scale-110 transition-transform"});var B=s(xt,2),ge=t(B,!0);e(B),e(pt);var Pe=s(pt,2);Be(Pe,17,()=>a(xe),M=>M.id,(M,q)=>{var P=In(),Ne=t(P),tt=t(Ne),at=t(tt),Ze=t(at,!0);e(at);var Ct=s(at,2);{var Mt=G=>{pa(G,{size:12,class:"text-indigo-400"})};w(Ct,G=>{a(q).global&&G(Mt)})}e(tt);var St=s(tt,2),Je=t(St);Be(Je,17,()=>a(q).enemies||[],kt,(G,Oe)=>{const ve=F(()=>l().find(It=>It.id===a(Oe).enemyId));var Ae=En(),rt=t(Ae),it=t(rt);e(rt);var lt=s(rt,2),Tt=t(lt,!0);e(lt),e(Ae),x(()=>{i(it,`${a(Oe).count??""}x`),i(Tt,a(ve)?a(ve).name:"...")}),d(G,Ae)});var H=s(Je,2);{var T=G=>{var Oe=Sn(),ve=t(Oe,!0);e(Oe),x(Ae=>i(ve,Ae),[()=>D()("session.bestiary.empty_encounter")]),d(G,Oe)};w(H,G=>{a(q).enemies?.length||G(T)})}e(St),e(Ne);var L=s(Ne,2),fe=t(L);fe.__click=()=>we(a(q));var W=t(fe);Za(W,{size:12,fill:"currentColor"});var J=s(W);e(fe);var ne=s(fe,2);ne.__click=()=>We(a(q));var Ge=t(ne);Zs(Ge,{size:14}),e(ne);var de=s(ne,2);de.__click=()=>ie(a(q).id);var oe=t(de);ua(oe,{size:14}),e(de),e(L),e(P),x(G=>{Ce(P,"aria-label",`Encontro ${a(q).name??""}`),i(Ze,a(q).name),i(J,` ${G??""}`)},[()=>D()("session.bestiary.start")]),ja("dragover",P,ke),ja("drop",P,G=>ue(G,a(q))),d(M,P)}),e(Ke),e(X);var Ve=s(X,2),_t=t(Ve),Ye=t(_t);Ca(Ye,{size:16});var ze=s(Ye);e(_t),e(Ve);var Re=s(Ve,2),Q=t(Re);Q.__click=()=>I();var he=t(Q);ra(he,{size:32,class:"group-hover:scale-110 transition-transform"});var Se=s(he,2),$e=t(Se,!0);e(Se),e(Q);var Le=s(Q,2);Be(Le,17,()=>a(Ue),M=>M.id,(M,q)=>{var P=$n(),Ne=t(P),tt=t(Ne),at=t(tt),Ze=t(at,!0);e(at);var Ct=s(at,2);{var Mt=de=>{pa(de,{size:14,class:"text-indigo-400"})};w(Ct,de=>{a(q).global&&de(Mt)})}e(tt);var St=s(tt,2),Je=t(St);e(St),e(Ne);var H=s(Ne,2);{var T=de=>{var oe=Rn(),G=t(oe),Oe=t(G,!0);e(G);var ve=s(G,2);{var Ae=rt=>{var it=Dn();it.__click=()=>ae(a(q).id);var lt=t(it,!0);e(it),x(Tt=>i(lt,Tt),[()=>O.has(a(q).id)?D()("session.bestiary.see_less"):D()("session.bestiary.see_more")]),d(rt,it)};w(ve,rt=>{a(q).description.length>120&&rt(Ae)})}e(oe),x(rt=>{Fe(G,1,`text-xs text-slate-400 leading-relaxed ${rt??""}`),i(Oe,a(q).description)},[()=>O.has(a(q).id)?"":"line-clamp-3"]),d(de,oe)},L=de=>{var oe=Nn(),G=t(oe,!0);e(oe),x(Oe=>i(G,Oe),[()=>D()("session.bestiary.no_description")]),d(de,oe)};w(H,de=>{a(q).description?de(T):de(L,!1)})}var fe=s(H,2),W=t(fe);W.__click=()=>I(a(q));var J=t(W,!0);e(W);var ne=s(W,2);ne.__click=()=>ot(a(q).id);var Ge=t(ne);ua(Ge,{size:14}),e(ne),e(fe),e(P),x((de,oe)=>{i(Ze,a(q).name),i(Je,`${de??""} ${a(q).difficulty??""}`),i(J,oe)},[()=>D()("session.bestiary.level"),()=>D()("common.buttons.edit")]),ja("dragstart",P,de=>be(de,a(q))),d(M,P)});var nt=s(Le,2);{var et=M=>{var q=An(),P=t(q,!0);e(q),x(Ne=>i(P,Ne),[()=>D()("session.bestiary.no_enemies")]),d(M,q)};w(nt,M=>{a(Ue).length===0&&M(et)})}e(Re);var dt=s(Re,2);{var zt=M=>{Ki(M,{get isOpen(){return a(S)},get initialData(){return a(h)},onClose:()=>C(S,!1),onSave:se})},Ht=M=>{kn(M,{get isOpen(){return a(S)},get initialData(){return a(h)},onClose:()=>C(S,!1),onSave:se})};w(dt,M=>{a(je)==="sofdl"?M(zt):M(Ht,!1)})}var Et=s(dt,2);On(Et,{get isOpen(){return a(N)},get initialData(){return a(re)},onClose:()=>C(N,!1),onSave:jt});var Ft=s(Et,2);cs(Ft,{get isOpen(){return a(me).isOpen},get title(){return a(me).title},get message(){return a(me).message},get onConfirm(){return a(me).onConfirm},onCancel:()=>a(me).isOpen=!1}),e(E),x((M,q,P,Ne)=>{i(bt,` ${M??""}`),i(ge,q),i(ze,` ${P??""}`),i($e,Ne)},[()=>D()("session.bestiary.encounters_title"),()=>D()("session.bestiary.new_encounter"),()=>D()("session.bestiary.title"),()=>D()("session.bestiary.new_enemy")]),d(U,E),oa(),j()}ba(["click"]);var Pn=u('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),Ln=u('<div class="flex items-center gap-1 text-emerald-400"><!> <span class="text-xs font-bold hidden sm:block"> </span></div> <!>',1),Hn=u('<div class="flex items-center gap-1 text-slate-500"><!> <span class="text-xs hidden sm:block"> </span></div>'),Fn=u('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),qn=u('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group"><!> <!></button> <div class="flex flex-col"><h1 class="text-base sm:text-lg font-black text-white leading-tight truncate max-w-[140px] sm:max-w-none"> </h1> <span class="text-xs text-indigo-400 font-mono font-black uppercase tracking-wider"> </span></div></div> <div class="hidden md:flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block"> </span></button> <button><!> <span class="hidden min-[400px]:block"> </span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 sm:p-2.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all"><!></button> <button class="p-2 sm:p-2.5 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative"><!> <!></button></div></div></div></header>');function Bn(U,r){la(r,!0);const l=()=>Lt(aa,"$t",j),K=()=>Lt(Rs,"$syncState",j),D=()=>Lt(Ma,"$isHistoryOpen",j),_=()=>Lt(Ns,"$hasUnreadRolls",j),[j,S]=va();let n=sa(r,"campaignName",3,""),h=sa(r,"gmName",3,"Mestre"),N=sa(r,"activeSubTab",3,"session"),le=sa(r,"onTabChange",3,()=>{}),re=sa(r,"onOpenSettings",3,()=>{});var me=qn(),A=t(me),I=t(A),O=t(I),ae=t(O);ae.__click=()=>er(_s("/"));var se=t(ae);La(se,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var ot=s(se,2);Js(ot,{size:18,class:"hidden sm:block opacity-50"}),e(ae);var We=s(ae,2),jt=t(We),ie=t(jt,!0);e(jt);var we=s(jt,2),be=t(we,!0);e(we),e(We),e(O);var ke=s(O,2),ue=t(ke);ue.__click=()=>le()("session");var je=t(ue);{let ze=F(()=>N()==="session"?"opacity-100":"opacity-50");ws(je,{size:14,get class(){return a(ze)}})}var Ue=s(je,2),xe=t(Ue,!0);e(Ue),e(ue);var E=s(ue,2);E.__click=()=>le()("bestiary");var X=t(E);{let ze=F(()=>N()==="bestiary"?"opacity-100":"opacity-50");Cs(X,{size:14,get class(){return a(ze)}})}var _e=s(X,2),Me=t(_e,!0);e(_e),e(E),e(ke);var pe=s(ke,2),bt=t(pe),Ke=t(bt);{var pt=ze=>{var Re=Ln(),Q=qe(Re),he=t(Q);xs(he,{size:16});var Se=s(he,2),$e=t(Se,!0);e(Se),e(Q);var Le=s(Q,2);{var nt=et=>{var dt=Pn(),zt=t(dt);bs(zt,{size:14});var Ht=s(zt,2),Et=t(Ht,!0);e(Ht),e(dt),x(Ft=>{Ce(dt,"title",Ft),i(Et,K().peers.length)},[()=>l()("common.status.peers",{values:{count:K().peers.length}})]),d(et,dt)};w(Le,et=>{K().peers.length>0&&et(nt)})}x((et,dt)=>{Ce(Q,"title",et),i($e,dt)},[()=>l()("common.status.connected"),()=>l()("common.status.connected")]),d(ze,Re)},xt=ze=>{var Re=Hn(),Q=t(Re);tr(Q,{size:16});var he=s(Q,2),Se=t(he,!0);e(he),e(Re),x(($e,Le)=>{Ce(Re,"title",$e),i(Se,Le)},[()=>l()("common.status.offline"),()=>l()("common.status.offline")]),d(ze,Re)};w(Ke,ze=>{K().isConnected?ze(pt):ze(xt,!1)})}e(bt);var B=s(bt,2);B.__click=function(...ze){re()?.apply(this,ze)};var ge=t(B);Xs(ge,{size:20}),e(B);var Pe=s(B,2);Pe.__click=()=>Ma.update(ze=>!ze);var Ve=t(Pe);Gs(Ve,{size:20});var _t=s(Ve,2);{var Ye=ze=>{var Re=Fn();d(ze,Re)};w(_t,ze=>{_()&&ze(Ye)})}e(Pe),e(pe),e(I),e(A),e(me),x((ze,Re,Q,he,Se,$e,Le,nt)=>{Ce(ae,"aria-label",ze),Ce(ae,"title",Re),i(ie,n()),i(be,h()),Fe(ue,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${N()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),Ce(ue,"aria-pressed",N()==="session"),i(xe,Q),Fe(E,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${N()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),Ce(E,"aria-pressed",N()==="bestiary"),i(Me,he),Ce(B,"aria-label",Se),Ce(B,"title",$e),Ce(Pe,"aria-label",Le),Ce(Pe,"title",nt),Ce(Pe,"aria-pressed",D())},[()=>l()("character.header.back_dashboard"),()=>l()("character.header.back_dashboard"),()=>l()("common.labels.session"),()=>l()("common.labels.bestiary"),()=>l()("common.buttons.settings"),()=>l()("common.buttons.settings"),()=>l()("character.header.history"),()=>l()("character.header.history")]),d(U,me),oa(),S()}ba(["click"]);var Wn=u('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),Jn=u('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),Gn=u('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),Qn=u('<div class="fixed bottom-24 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0 z-[60] flex flex-col items-center gap-2"><div class="bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center gap-2 shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 duration-200"><button class="bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-indigo-500/20"><span class="text-[10px] opacity-70">d20</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">2d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">3d6</span> <!></button> <div class="w-px h-8 bg-white/10 mx-1"></div> <button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button></div></div>  <div class="fixed inset-0 bg-black/40 z-[55]"></div>',1),Vn=u('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!> <!> <div class="hidden md:block fixed bottom-8 left-8 z-[60]"><button class="w-16 h-16 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-[0_0_20px_rgba(79,70,229,0.4)] flex items-center justify-center transition-all active:scale-90 border-2 border-white/10 group" title="Rolagens Rápidas"><!></button></div> <nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-6 pt-2 pointer-events-none"><div class="max-w-md mx-auto relative h-16 pointer-events-auto"><div class="absolute inset-0 bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"></div></div> <div class="relative h-full flex items-center justify-around px-2"><button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Sessão</span></button> <div class="relative w-16 h-16 -mt-10 flex items-center justify-center"><div class="absolute inset-0 bg-indigo-600/20 rounded-full blur-xl animate-pulse"></div> <button class="relative w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(79,70,229,0.5)] border-4 border-slate-900 transition-all active:scale-90 hover:bg-indigo-500 z-10" aria-label="Rolar Dados"><!></button></div> <button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Bestiário</span></button></div></div></nav> <!></div>');function fl(U,r){la(r,!0);const l=()=>Lt(Ss,"$page",j),K=()=>Lt(Us,"$liveCampaigns",j),D=()=>Lt(aa,"$t",j),_=()=>Lt(Ma,"$isHistoryOpen",j),[j,S]=va();let n=mt("session"),h=mt(!1),N=F(()=>l().params.id),le=F(()=>K().find(B=>B.id===a(N))),re=F(()=>!!a(le));function me(B){if(!a(N)||!a(le))return;const ge={...a(le),...B};ea.set(a(N),ge),Ya(a(N),{name:ge.name,gmName:ge.gmName}),C(h,!1)}let A=mt(!1),I=mt(ga({isOpen:!1,sides:20,count:1,modifier:0}));function O(B,ge=1){C(I,{isOpen:!0,sides:B,count:ge,modifier:0},!0)}function ae(B){if(!a(le))return;const ge=Ur(a(I).sides,a(I).count,B);let Pe="";a(I).count>1&&(Pe+=`Dados: [${ge.results.join(", ")}] `),ge.bonusRolls?.length>0&&(Pe+=`Bonus Rolls: [${ge.bonusRolls.join(", ")}] -> ${Math.abs(ge.modifierTotal)}`);const Ve=a(le).gmName||Qa(aa)("common.labels.master");$s.addToHistory({source:"GM",charName:Ve,name:`${a(I).count}d${a(I).sides} ${B?B>0?`+${B}`:B:""}`,description:Pe.trim()||null,total:ge.total,formula:ge.formula,crit:ge.crit}),Ma.set(!0),a(I).isOpen=!1}var se=Vn(),ot=t(se);{var We=B=>{var ge=Wn(),Pe=qe(ge);Bn(Pe,{get campaignName(){return a(le).name},get gmName(){return a(le).gmName},get activeSubTab(){return a(n)},onTabChange:Q=>C(n,Q,!0),onOpenSettings:()=>C(h,!0)});var Ve=s(Pe,2);{let Q=F(()=>JSON.stringify(a(le)));Ks(Ve,{get isOpen(){return a(h)},get initialData(){return a(Q)},onClose:()=>C(h,!1),onSave:me})}var _t=s(Ve,2),Ye=t(_t);{var ze=Q=>{ji(Q,{get campaign(){return a(le)}})},Re=Q=>{var he=Ot(),Se=qe(he);{var $e=Le=>{Un(Le,{get campId(){return a(N)}})};w(Se,Le=>{a(n)==="bestiary"&&Le($e)},!0)}d(Q,he)};w(Ye,Q=>{a(n)==="session"?Q(ze):Q(Re,!1)})}e(_t),d(B,ge)},jt=B=>{var ge=Ot(),Pe=qe(ge);{var Ve=Ye=>{var ze=Jn(),Re=s(t(ze),2),Q=t(Re,!0);e(Re);var he=s(Re,2),Se=t(he,!0);e(he);var $e=s(he,2);$e.__click=()=>window.history.back();var Le=s(t($e));e($e),e(ze),x((nt,et,dt)=>{i(Q,nt),i(Se,et),i(Le,` ${dt??""}`)},[()=>D()("campaign.not_found.title"),()=>D()("campaign.not_found.message"),()=>D()("common.buttons.back")]),d(Ye,ze)},_t=Ye=>{var ze=Gn();d(Ye,ze)};w(Pe,Ye=>{a(re)&&!a(le)?Ye(Ve):Ye(_t,!1)},!0)}d(B,ge)};w(ot,B=>{a(re)&&a(le)?B(We):B(jt,!1)})}var ie=s(ot,2);ms(ie,{get isOpen(){return _()},onClose:()=>Ma.set(!1)});var we=s(ie,2);{var be=B=>{var ge=Qn(),Pe=qe(ge),Ve=t(Pe),_t=t(Ve);_t.__click=()=>{O(20),C(A,!1)};var Ye=s(t(_t),2);Ea(Ye,{size:16}),e(_t);var ze=s(_t,2);ze.__click=()=>{O(6),C(A,!1)};var Re=s(t(ze),2);Ea(Re,{size:16}),e(ze);var Q=s(ze,2);Q.__click=()=>{O(6,2),C(A,!1)};var he=s(t(Q),2);Ea(he,{size:16}),e(Q);var Se=s(Q,2);Se.__click=()=>{O(6,3),C(A,!1)};var $e=s(t(Se),2);Ea($e,{size:16}),e(Se);var Le=s(Se,4);Le.__click=()=>C(A,!1);var nt=t(Le);wa(nt,{size:20}),e(Le),e(Ve),e(Pe);var et=s(Pe,2);et.__click=()=>C(A,!1),d(B,ge)};w(we,B=>{a(A)&&B(be)})}var ke=s(we,2),ue=t(ke);ue.__click=()=>C(A,!a(A));var je=t(ue);Ea(je,{size:32,class:"group-hover:rotate-12 transition-transform"}),e(ue),e(ke);var Ue=s(ke,2),xe=t(Ue),E=s(t(xe),2),X=t(E);X.__click=()=>{C(n,"session"),C(A,!1)};var _e=t(X);{let B=F(()=>a(n)==="session"?"animate-in zoom-in-75 duration-300":"");ws(_e,{size:20,get class(){return a(B)}})}ya(2),e(X);var Me=s(X,2),pe=s(t(Me),2);pe.__click=()=>C(A,!a(A));var bt=t(pe);{let B=F(()=>a(A)?"rotate-90":"rotate-0");Ea(bt,{size:28,get class(){return`text-white ${a(B)??""} transition-transform duration-300`}})}e(pe),e(Me);var Ke=s(Me,2);Ke.__click=()=>{C(n,"bestiary"),C(A,!1)};var pt=t(Ke);{let B=F(()=>a(n)==="bestiary"?"animate-in zoom-in-75 duration-300":"");Cs(pt,{size:20,get class(){return a(B)}})}ya(2),e(Ke),e(E),e(xe),e(Ue);var xt=s(Ue,2);{let B=F(()=>`${D()("session.quick.roll_title")} (${a(I).count}d${a(I).sides})`),ge=F(()=>a(I).sides===20?D()("session.quick.boons_banes"):D()("session.quick.fixed_modifier"));Qs(xt,{get isOpen(){return a(I).isOpen},get title(){return a(B)},get label(){return a(ge)},onClose:()=>a(I).isOpen=!1,onRoll:ae,initialModifier:0})}e(se),x(()=>{Fe(X,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(n)==="session"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),Fe(Ke,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(n)==="bestiary"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`)}),d(U,se),oa(),S()}ba(["click"]);export{fl as component};
