import"../chunks/DsnmJJEf.js";import"../chunks/DdC0RNGD.js";import{v as ue,w as I,k as p,x as ut,j as _,z as pt,F as u,R as L,y as r,A as a,B as t,I as e,t as O,a2 as Ma,L as $t,n as et,ap as ao,U as oo,b7 as qt,T as Nt}from"../chunks/DzRT0qSm.js";import{d as gt,o as ja,s as g,w as ra,g as Ie,e as Qe}from"../chunks/9QvhKPlK.js";import{l as tt,s as at,i as B,p as St}from"../chunks/DV-HjJ0V.js";import{h as yt}from"../chunks/LJ4PxtSj.js";import{a as Ge,$ as Ot,e as Bt,s as je,i as so,r as Ve,f as Wt,g as Kt}from"../chunks/DmTIwYKB.js";import{s as Ft,a as xe}from"../chunks/FHgTlLI2.js";import{I as ot,s as st}from"../chunks/Byjcbj0b.js";import{X as ro,M as Ba,a as no,T as Sa,P as Xt,q as Pt,b as io}from"../chunks/BJHf1IjA.js";import{t as kt,a as lo,f as Dt}from"../chunks/5J4TPCGy.js";import{D as Be,G as Gt,S as co,l as Ga,a as oa,C as vo,g as Zt}from"../chunks/BLWIClRk.js";import{b as Ye,h as Je,d as ce,e as ve,u as Ca,p as uo}from"../chunks/WcsszTkO.js";import{g as Mt}from"../chunks/BjVE1IS8.js";import{U as Ea,r as jt,W as po}from"../chunks/CAJsI6C_.js";import{C as go,S as fo,G as Qt,a as mo,P as Ia}from"../chunks/DXVo9sSM.js";import{U as na,L as ho}from"../chunks/Dy_MTGci.js";import{h as bo}from"../chunks/BYmFNSF7.js";function xo(v,s){const i=tt(s,["children","$$slots","$$events","$$legacy"]);const d=[["circle",{cx:"12",cy:"12",r:"10"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16"}]];ot(v,at({name:"circle-alert"},()=>i,{get iconNode(){return d},children:(n,l)=>{var o=ue(),f=I(o);st(f,s,"default",{}),p(n,o)},$$slots:{default:!0}}))}function _o(v,s){const i=tt(s,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"m2 2 20 20"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07"}]];ot(v,at({name:"cloud-off"},()=>i,{get iconNode(){return d},children:(n,l)=>{var o=ue(),f=I(o);st(f,s,"default",{}),p(n,o)},$$slots:{default:!0}}))}function wo(v,s){const i=tt(s,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"}]];ot(v,at({name:"cloud"},()=>i,{get iconNode(){return d},children:(n,l)=>{var o=ue(),f=I(o);st(f,s,"default",{}),p(n,o)},$$slots:{default:!0}}))}function za(v,s){const i=tt(s,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]];ot(v,at({name:"download"},()=>i,{get iconNode(){return d},children:(n,l)=>{var o=ue(),f=I(o);st(f,s,"default",{}),p(n,o)},$$slots:{default:!0}}))}function yo(v,s){const i=tt(s,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56"}]];ot(v,at({name:"loader-circle"},()=>i,{get iconNode(){return d},children:(n,l)=>{var o=ue(),f=I(o);st(f,s,"default",{}),p(n,o)},$$slots:{default:!0}}))}function ko(v,s){const i=tt(s,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]];ot(v,at({name:"refresh-cw"},()=>i,{get iconNode(){return d},children:(n,l)=>{var o=ue(),f=I(o);st(f,s,"default",{}),p(n,o)},$$slots:{default:!0}}))}function ea(v,s){const i=tt(s,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3"}]];ot(v,at({name:"scroll"},()=>i,{get iconNode(){return d},children:(n,l)=>{var o=ue(),f=I(o);st(f,s,"default",{}),p(n,o)},$$slots:{default:!0}}))}var $o=_('<button class="fixed bottom-28 md:bottom-6 right-6 z-[60] bg-indigo-600 hover:bg-indigo-500 text-white h-14 px-4 rounded-full shadow-2xl shadow-indigo-900/50 flex items-center justify-center font-bold animate-pulse hover:animate-none transition-all active:scale-95 group"><!> <span class="text-sm uppercase tracking-wider max-w-0 overflow-hidden ml-0 group-hover:max-w-xs group-hover:ml-2 transition-all duration-300 md:max-w-xs md:ml-2 md:inline"> </span></button>'),So=_("<div><!></div>"),Co=_("<div><!></div>"),Eo=_('<li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">1</span> <!></li> <li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">2</span> <div><!></div></li>',1),Io=_('<li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">1</span> <div><!></div></li> <li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">2</span> <div><!></div></li>',1),zo=_('<div class="fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-in fade-in"><div class="bg-slate-900 border border-slate-700 rounded-2xl p-6 max-w-sm w-full relative shadow-2xl mb-4 sm:mb-0 animate-in slide-in-from-bottom-10 sm:slide-in-from-bottom-0 sm:zoom-in-95"><button class="absolute top-4 right-4 text-slate-400 hover:text-white p-1"><!></button> <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2"><!> </h3> <ol class="space-y-4 text-slate-300 text-sm"><!></ol> <div class="mt-6 text-center"><button class="text-indigo-400 text-sm font-bold hover:text-indigo-300"> </button></div></div></div>'),To=_("<!> <!>",1);function No(v,s){ut(s,!0);const i=()=>xe(Ot,"$t",d),[d,n]=Ft();let l=L(null),o=L(!1),f=L(!1),w=L(!1),z=L(!1);ja(()=>{if(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone){u(o,!1);return}const b=window.navigator.userAgent;u(w,/iPad|iPhone|iPod/.test(b)&&!window.MSStream,!0),u(z,/CriOS/i.test(b),!0),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(b)&&u(o,!0),window.addEventListener("beforeinstallprompt",N=>{N.preventDefault(),u(l,N,!0),u(o,!0)}),window.addEventListener("appinstalled",()=>{u(l,null),u(o,!1),u(f,!1)})});async function X(){if(r(l)){r(l).prompt();const{outcome:S}=await r(l).userChoice;S==="accepted"&&(u(l,null),u(o,!1))}else u(f,!0)}const $="inline w-3.5 h-3.5",Y=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${$}"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" x2="12" y1="2" y2="15"/></svg>`,F=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${$}"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M8 12h8"/><path d="M12 8v8"/></svg>`,H=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${$}"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></svg>`;function Q(S,b){const T=i()(S),N=`<span class="inline-flex items-center justify-center bg-slate-800 p-1 rounded mx-1 align-middle">${b}</span>`;return T.replace("{icon}",N)}var ee=To(),C=I(ee);{var J=S=>{var b=$o();b.__click=X;var T=t(b);za(T,{size:24});var N=a(T,2),ae=t(N,!0);e(N),e(b),O((x,y)=>{Ge(b,"aria-label",x),g(ae,y)},[()=>i()("home.install.button"),()=>i()("home.install.button")]),p(S,b)};B(C,S=>{r(o)&&S(J)})}var G=a(C,2);{var m=S=>{var b=zo(),T=t(b),N=t(T);N.__click=()=>u(f,!1);var ae=t(N);ro(ae,{size:20}),e(N);var x=a(N,2),y=t(x);za(y,{size:24,class:"text-indigo-500"});var P=a(y);e(x);var q=a(x,2),W=t(q);{var A=M=>{var j=Eo(),R=I(j),pe=a(t(R),2);{var _e=le=>{var me=So(),de=t(me);yt(de,()=>Q("home.install.ios_chrome_step1",Y)),e(me),p(le,me)},ne=le=>{var me=Co(),de=t(me);yt(de,()=>Q("home.install.ios_step1",Y)),e(me),p(le,me)};B(pe,le=>{r(z)?le(_e):le(ne,!1)})}e(R);var te=a(R,2),ie=a(t(te),2),ze=t(ie);yt(ze,()=>Q("home.install.ios_step2",F)),e(ie),e(te),p(M,j)},D=M=>{var j=Io(),R=I(j),pe=a(t(R),2),_e=t(pe);yt(_e,()=>Q("home.install.android_step1",H)),e(pe),e(R);var ne=a(R,2),te=a(t(ne),2),ie=t(te);yt(ie,()=>i()("home.install.android_step2")),e(te),e(ne),p(M,j)};B(W,M=>{r(w)?M(A):M(D,!1)})}e(q);var Z=a(q,2),fe=t(Z);fe.__click=()=>u(f,!1);var U=t(fe,!0);e(fe),e(Z),e(T),e(b),O((M,j)=>{g(P,` ${M??""}`),g(U,j)},[()=>i()("home.install.title"),()=>i()("home.install.close")]),p(S,b)};B(G,S=>{r(f)&&S(m)})}p(v,ee),pt(),n()}gt(["click"]);var Po=_('<span class="text-[9px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded uppercase tracking-wider">Em Breve</span>'),Do=_('<div class="w-2 h-2 rounded-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]"></div>'),Mo=_('<button><div class="flex-1"><div class="font-bold text-sm flex items-center gap-2"> <!></div> <div class="text-[10px] opacity-60 mt-0.5"> </div></div> <!></button>'),jo=_('<div class="space-y-4"><div><label class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest flex items-center gap-1"><!> Sistema de Jogo</label> <div class="grid grid-cols-1 gap-2"></div></div> <div><label for="char-name" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest">Nome do Personagem</label> <input id="char-name" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors" placeholder="Ex: Alaric, o Errante"/></div> <div><label for="char-player" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest flex items-center gap-1"><!> Nome do Jogador</label> <input id="char-player" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors" placeholder="Seu nome ou apelido"/></div> <div class="grid grid-cols-2 gap-4"><div><label for="char-ancestry" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest">Ancestralidade</label> <input id="char-ancestry" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors" placeholder="Ex: Humano"/></div> <div><label for="char-level" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest">NÃ­vel</label> <input id="char-level" type="number" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div></div> <div><label for="char-path" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest">Trilha Inicial (Novice)</label> <input id="char-path" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors" placeholder="Ex: Guerreiro, Mago"/></div> <div class="grid grid-cols-2 gap-4"><div><label for="char-defense" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest">Defesa</label> <input id="char-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div> <div><label for="char-health" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest">Vida MÃ¡xima</label> <input id="char-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div></div></div> <div class="flex gap-3 mt-8"><button class="flex-1 bg-slate-700 hover:bg-slate-600 transition-all py-3 rounded-xl text-white font-bold active:scale-95">Cancelar</button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 transition-all py-3 rounded-xl text-white font-bold shadow-lg shadow-indigo-900/20 active:scale-95">Criar Personagem</button></div>',1);function Bo(v,s){ut(s,!0);let i=St(s,"isOpen",3,!1),d=St(s,"initialData",3,"{}"),n=Ma({name:"",playerName:"",ancestry:"",novicePath:"",level:1,defense:10,health:24,system:Be});$t(()=>{if(i()&&d())try{const o=JSON.parse(d());n.name=o.name||"",n.playerName=o.playerName||"",n.ancestry=o.ancestry||"",n.novicePath=o.paths&&o.paths.novice?o.paths.novice:"",n.level=o.level||1,n.defense=o.defense||10,n.health=o.health||o.normalHealth||24,n.system=o.system||Be}catch{n.name="",n.playerName="",n.ancestry="",n.novicePath="",n.level=1,n.defense=10,n.health=24,n.system=Be}});function l(){s.onSave({...n})}Ba(v,{get isOpen(){return i()},get onClose(){return s.onClose},title:"Novo Personagem",maxWidth:"max-w-md",children:(o,f)=>{var w=jo(),z=I(w),X=t(z),$=t(X),Y=t($);Gt(Y,{size:12}),et(),e($);var F=a($,2);Bt(F,21,()=>co,so,(U,M)=>{var j=Mo();j.__click=()=>!r(M).disabled&&(n.system=r(M).id);var R=t(j),pe=t(R),_e=t(pe),ne=a(_e);{var te=de=>{var rt=Po();p(de,rt)};B(ne,de=>{r(M).comingSoon&&de(te)})}e(pe);var ie=a(pe,2),ze=t(ie,!0);e(ie),e(R);var le=a(R,2);{var me=de=>{var rt=Do();p(de,rt)};B(le,de=>{n.system===r(M).id&&de(me)})}e(j),O(()=>{je(j,1,`relative flex items-center p-3 rounded-lg border text-left transition-all ${n.system===r(M).id?"bg-indigo-600/20 border-indigo-500 text-white":"bg-slate-900 border-slate-700 text-slate-400 hover:border-slate-600"} ${r(M).disabled?"opacity-60 cursor-not-allowed":""}`),j.disabled=r(M).disabled,g(_e,`${r(M).name??""} `),g(ze,r(M).description)}),p(U,j)}),e(F),e(X);var H=a(X,2),Q=a(t(H),2);Ve(Q),e(H);var ee=a(H,2),C=t(ee),J=t(C);na(J,{size:12}),et(),e(C);var G=a(C,2);Ve(G),e(ee);var m=a(ee,2),S=t(m),b=a(t(S),2);Ve(b),e(S);var T=a(S,2),N=a(t(T),2);Ve(N),e(T),e(m);var ae=a(m,2),x=a(t(ae),2);Ve(x),e(ae);var y=a(ae,2),P=t(y),q=a(t(P),2);Ve(q),e(P);var W=a(P,2),A=a(t(W),2);Ve(A),e(W),e(y),e(z);var D=a(z,2),Z=t(D);Z.__click=function(...U){s.onClose?.apply(this,U)};var fe=a(Z,2);fe.__click=l,e(D),Ye(Q,()=>n.name,U=>n.name=U),Ye(G,()=>n.playerName,U=>n.playerName=U),Ye(b,()=>n.ancestry,U=>n.ancestry=U),Ye(N,()=>n.level,U=>n.level=U),Ye(x,()=>n.novicePath,U=>n.novicePath=U),Ye(q,()=>n.defense,U=>n.defense=U),Ye(A,()=>n.health,U=>n.health=U),p(o,w)},$$slots:{default:!0}}),pt()}gt(["click"]);var Go=_('<div class="space-y-5"><div><label for="settings-player-name" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest flex items-center gap-1"><!> Nome do Jogador</label> <input id="settings-player-name" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors" placeholder="Seu nome ou apelido"/> <p class="text-[10px] text-slate-500 mt-1">O nome do jogador associado a este personagem.</p></div></div> <div class="flex flex-col-reverse sm:flex-row gap-3 mt-6"><button class="flex-1 bg-slate-700 hover:bg-slate-600 transition-all py-4 sm:py-3 rounded-xl text-white font-bold active:scale-95">Cancelar</button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 transition-all py-4 sm:py-3 rounded-xl text-white font-bold shadow-lg shadow-indigo-900/20 active:scale-95">Salvar</button></div>',1);function Ao(v,s){ut(s,!0);let i=St(s,"isOpen",3,!1),d=St(s,"characterData",3,null),n=L("");$t(()=>{i()&&d()&&u(n,d().playerName||"",!0)});function l(){s.onSave({playerName:r(n)})}Ba(v,{get isOpen(){return i()},get onClose(){return s.onClose},title:"âš™ï¸ ConfiguraÃ§Ãµes do Personagem",maxWidth:"max-w-md",children:(o,f)=>{var w=Go(),z=I(w),X=t(z),$=t(X),Y=t($);na(Y,{size:12}),et(),e($);var F=a($,2);Ve(F),et(2),e(X),e(z);var H=a(z,2),Q=t(H);Q.__click=function(...C){s.onClose?.apply(this,C)};var ee=a(Q,2);ee.__click=l,e(H),Ye(F,()=>r(n),C=>u(n,C)),p(o,w)},$$slots:{default:!0}}),pt()}gt(["click"]);const qe=ra("idle"),ia=ra(null),Uo="701898444454-7ml9onnv529k99rkvgh1slhdj4a1arrm.apps.googleusercontent.com",Ta="https://www.googleapis.com/auth/drive.appdata https://www.googleapis.com/auth/userinfo.profile",re=ra({signedIn:!1,accessToken:null,tokenExpiry:null,userProfile:null,isInited:!1});let At,Na=!1;const vt="wwv_google_session";function Oo(){localStorage.removeItem(vt),re.update(v=>({...v,signedIn:!1,accessToken:null,tokenExpiry:null,userProfile:null})),console.log("Session cleared due to expired or invalid token")}async function Ut(){Oo(),console.warn("OAuth token expired or invalid. Please sign in again.")}async function Aa(v){try{const s=await fetch("https://www.googleapis.com/oauth2/v1/userinfo?alt=json",{headers:{Authorization:`Bearer ${v}`}});if(s.status===401){await Ut();return}if(s.ok){const i=await s.json();re.update(d=>({...d,userProfile:{name:i.name,picture:i.picture}})),Ua()}}catch(s){console.error("Failed to fetch user profile:",s)}}function Fo(){try{const v=localStorage.getItem(vt);if(v){const s=JSON.parse(v);if(s.accessToken)return s.tokenExpiry&&Date.now()>s.tokenExpiry?(console.log("Stored token is expired, clearing session"),localStorage.removeItem(vt),!1):(re.set({signedIn:!0,accessToken:s.accessToken,tokenExpiry:s.tokenExpiry||null,userProfile:s.userProfile||null,isInited:!0}),console.log("Restored session from localStorage"),Aa(s.accessToken),!0)}}catch(v){console.error("Failed to load stored session:",v)}return!1}function Ua(){const v=Ie(re);v.signedIn&&v.accessToken?localStorage.setItem(vt,JSON.stringify({accessToken:v.accessToken,tokenExpiry:v.tokenExpiry,userProfile:v.userProfile})):localStorage.removeItem(vt)}async function Lo(){const v=Uo;if(Fo()){try{await Da(),At=google.accounts.oauth2.initTokenClient({client_id:v,scope:Ta,callback:Pa}),Na=!0}catch(i){console.warn("Could not initialize GIS after restoring session:",i)}return}try{await Da(),At=google.accounts.oauth2.initTokenClient({client_id:v,scope:Ta,callback:Pa}),Na=!0,re.update(i=>({...i,isInited:!0})),console.log("Google Auth Initialized")}catch(i){console.error("Failed to initialize Google Auth:",i),re.update(d=>({...d,isInited:!0})),alert("Falha ao inicializar Google Auth. Verifique sua conexÃ£o/Console.")}}function Pa(v){if(v.error!==void 0){console.error("Google Auth Error:",v);return}console.log("Google Auth Success",v);const s=v.expires_in||3600,i=Date.now()+s*1e3;re.update(d=>({...d,signedIn:!0,accessToken:v.access_token,tokenExpiry:i})),Ua(),Aa(v.access_token)}function Da(){return new Promise((v,s)=>{if(typeof google<"u"&&google.accounts){v();return}const i=document.createElement("script");i.src="https://accounts.google.com/gsi/client",i.async=!0,i.defer=!0,i.onload=()=>{const d=setInterval(()=>{typeof google<"u"&&google.accounts&&(clearInterval(d),v())},50);setTimeout(()=>{clearInterval(d),(typeof google>"u"||!google.accounts)&&s(new Error("Google object not available after script load"))},3e3)},i.onerror=()=>{s(new Error("Failed to load Google Identity Services script"))},document.head.appendChild(i)})}function Oa(){At?At.requestAccessToken():(console.error("Google Auth not initialized"),alert("Google Auth ainda nÃ£o inicializou. Tente novamente em alguns segundos."))}function Ho(){const v=Ie(re).accessToken;localStorage.removeItem(vt),re.update(s=>({...s,signedIn:!1,accessToken:null,tokenExpiry:null,userProfile:null})),v&&typeof google<"u"&&google.accounts&&google.accounts.oauth2.revoke(v,()=>{console.log("Access token revoked")})}async function Fa(){const v=Ie(re),s=v.accessToken;if(!s)throw new Error("Not signed in");if(v.tokenExpiry&&Date.now()>v.tokenExpiry)throw await Ut(),new Error("Token expired, please sign in again");const d=`https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent("name = 'weird-wizard-backup.json' and 'appDataFolder' in parents and trashed = false")}&spaces=appDataFolder&fields=files(id, name, modifiedTime, size)`,n=await fetch(d,{headers:{Authorization:`Bearer ${s}`}});if(n.status===401)throw await Ut(),new Error("Token expired, please sign in again");if(!n.ok)throw new Error("Failed to list backups: "+n.statusText);return(await n.json()).files||[]}async function Ro(v){const s=Ie(re).accessToken;if(!s)throw new Error("Not signed in");const i=JSON.stringify(v),d="weird-wizard-backup.json",n=await Fa(),l=n.length>0?n[0].id:null;if(l){const o=`https://www.googleapis.com/upload/drive/v3/files/${l}?uploadType=media`,f=await fetch(o,{method:"PATCH",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:i});if(!f.ok){const w=await f.text();throw console.error("Upload error details:",w),new Error("Upload failed: "+f.statusText)}return await f.json()}else{const o={name:d,mimeType:"application/json",parents:["appDataFolder"]},f=new FormData;f.append("metadata",new Blob([JSON.stringify(o)],{type:"application/json"})),f.append("file",new Blob([i],{type:"application/json"}));const z=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:{Authorization:`Bearer ${s}`},body:f});if(!z.ok){const X=await z.text();throw console.error("Upload error details:",X),new Error("Upload failed: "+z.statusText)}return await z.json()}}async function Vo(v){const s=Ie(re).accessToken;if(!s)throw new Error("Not signed in");const i=`https://www.googleapis.com/drive/v3/files/${v}?alt=media`,d=await fetch(i,{headers:{Authorization:`Bearer ${s}`}});if(d.status===401)throw await Ut(),new Error("Token expired, please sign in again");if(!d.ok)throw new Error("Download failed: "+d.statusText);return await d.json()}let ta;async function sa(){if(Ie(re).accessToken)try{console.log("Syncing from cloud..."),qe.set("syncing");const s=await Fa();if(s.length===0){console.log("No backups found in cloud."),qe.set("success");return}const i=s[0].id,d=await Vo(i),n=new Set;if(Je.forEach((l,o)=>{n.add(String(o)),console.log("[DEBUG] Local deleted ID entry:",{key:o,type:typeof o,val:l})}),console.log("[DEBUG] Total locally deleted IDs:",n.size),d.deletedIds&&Array.isArray(d.deletedIds)){console.log("[DEBUG] Cloud data deletedIds count:",d.deletedIds.length);for(const l of d.deletedIds){const o=String(l.id);Je.has(o)||(Je.set(o,l),console.log("[DEBUG] New deletion synced from cloud:",o)),n.add(o),l.type==="character"&&ce.has(o)&&(ce.delete(o),console.log("[DEBUG] Removed char locally based on cloud deletion:",o)),l.type==="campaign"&&ve.has(o)&&(ve.delete(o),console.log("[DEBUG] Removed camp locally based on cloud deletion:",o))}}if(d.characters&&Array.isArray(d.characters)){console.log("[DEBUG] Syncing",d.characters.length,"characters from cloud");for(const l of d.characters){const o=String(l.id);if(n.has(o)||Je.has(o)){console.log("[DEBUG] Skipping character because it is marked as deleted:",{id:o,name:l.name}),ce.has(o)&&(console.log("[DEBUG] Character found locally but marked deleted. Removing now:",o),ce.delete(o));for(const w of ce.keys()){const z=ce.get(w);z&&z.id===o&&(console.log("[DEBUG] Mismatched key entry found for deleted char. Removing:",w),ce.delete(w))}continue}ce.get(o)||(console.log("[DEBUG] ADDING character from cloud (missing locally):",{id:o,name:l.name}),ce.set(o,l))}}if(d.campaigns&&Array.isArray(d.campaigns)){console.log("[DEBUG] Syncing",d.campaigns.length,"campaigns from cloud");for(const l of d.campaigns){const o=String(l.id);if(n.has(o)||Je.has(o)){console.log("[DEBUG] Skipping campaign because it is marked as deleted:",{id:o,name:l.name}),ve.has(o)&&(console.log("[DEBUG] Campaign found locally but marked deleted. Removing now:",o),ve.delete(o));for(const w of ve.keys()){const z=ve.get(w);z&&z.id===o&&(console.log("[DEBUG] Mismatched key entry found for deleted camp. Removing:",w),ve.delete(w))}continue}ve.get(o)||(console.log("[DEBUG] ADDING campaign from cloud (missing locally):",{id:o,name:l.name}),ve.set(o,l))}}console.log("[DEBUG] Sync from cloud complete."),qe.set("success"),ia.set(Date.now())}catch(s){console.error("Failed to sync from cloud:",s),qe.set("error")}}async function aa(){Ie(re).accessToken&&(ta&&clearTimeout(ta),ta=setTimeout(async()=>{try{console.log("Syncing to cloud..."),qe.set("syncing");const s=[],i=new Set;Je.forEach((o,f)=>{s.push({id:f,...o}),i.add(String(f))});const d=Ie(Ga).filter(o=>!i.has(String(o.id))),n=Ie(oa).filter(o=>!i.has(String(o.id))),l={characters:d,campaigns:n,deletedIds:s,timestamp:Date.now(),version:1,appName:"WeirdWizardVault"};console.log("[DEBUG] Uploading to cloud:",{charactersCount:l.characters.length,campaignsCount:l.campaigns.length,deletedIdsCount:s.length}),await Ro(l),console.log("Sync to cloud complete."),qe.set("success"),ia.set(Date.now())}catch(s){console.error("Failed to sync to cloud:",s),qe.set("error")}},2e3))}var Yo=_('<img alt="Avatar" class="w-10 h-10 rounded-full border-2 border-indigo-500/50 shadow-lg object-cover"/>'),Jo=_('<div class="w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center text-white border-2 border-indigo-400/30 shadow-lg"><span class="font-bold text-lg"><!></span></div>'),qo=_('<div class="absolute right-0 top-full mt-2 w-48 bg-slate-800 rounded-xl shadow-xl border border-slate-700 p-2 z-50 animate-in fade-in slide-in-from-top-2"><div class="px-3 py-2 border-b border-slate-700 mb-2"><p class="text-xs text-slate-400"> </p> <p class="text-sm font-bold text-white truncate"> </p></div> <button class="w-full flex items-center gap-2 px-3 py-2 text-slate-300 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors text-sm"><!> </button></div>  <div class="fixed inset-0 z-40"></div>',1),Wo=_('<div class="relative"><button><!> <div class="absolute bottom-1 right-1 w-3 h-3 bg-emerald-500 rounded-full border-2 border-slate-900"></div></button> <!></div>'),Ko=_('<div class="w-4 h-4 rounded-full border-2 border-slate-300 border-t-slate-600 animate-spin"></div>'),Xo=ao('<svg class="w-4 h-4" viewBox="0 0 24 24"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg>'),Zo=_("<button><!> <span> </span></button>");function Qo(v,s){ut(s,!0);const i=()=>xe(re,"$googleSession",n),d=()=>xe(Ot,"$t",n),[n,l]=Ft();let o=St(s,"className",3,""),f=L(!1);var w=ue(),z=I(w);{var X=Y=>{var F=Wo(),H=t(F);H.__click=()=>u(f,!r(f));var Q=t(H);{var ee=m=>{var S=Yo();O(()=>Ge(S,"src",i().userProfile.picture)),p(m,S)},C=m=>{var S=Jo(),b=t(S),T=t(b);{var N=x=>{var y=oo();O(P=>g(y,P),[()=>i().userProfile.name[0].toUpperCase()]),p(x,y)},ae=x=>{na(x,{size:20})};B(T,x=>{i().userProfile?.name?x(N):x(ae,!1)})}e(b),e(S),p(m,S)};B(Q,m=>{i().userProfile?.picture?m(ee):m(C,!1)})}et(2),e(H);var J=a(H,2);{var G=m=>{var S=qo(),b=I(S),T=t(b),N=t(T),ae=t(N,!0);e(N);var x=a(N,2),y=t(x,!0);e(x),e(T);var P=a(T,2);P.__click=()=>{Ho(),u(f,!1)};var q=t(P);ho(q,{size:14});var W=a(q);e(P),e(b);var A=a(b,2);A.__click=()=>u(f,!1),O((D,Z,fe)=>{g(ae,D),g(y,Z),g(W,` ${fe??""}`)},[()=>d()("common.auth.signed_in_as"),()=>i().userProfile?.name??d()("common.auth.user"),()=>d()("common.auth.logout")]),p(m,S)};B(J,m=>{r(f)&&m(G)})}e(F),O(m=>{je(H,1,`flex items-center gap-2 p-1 rounded-full hover:bg-slate-800 transition-colors border border-transparent hover:border-slate-700 ${o()??""}`),Ge(H,"title",m)},[()=>i().userProfile?.name||d()("common.auth.user")]),p(Y,F)},$=Y=>{var F=Zo();F.__click=function(...G){Oa?.apply(this,G)};var H=t(F);{var Q=G=>{var m=Ko();p(G,m)},ee=G=>{var m=Xo();p(G,m)};B(H,G=>{i().isInited?G(ee,!1):G(Q)})}var C=a(H,2),J=t(C,!0);e(C),e(F),O(G=>{F.disabled=!i().isInited,je(F,1,`flex items-center gap-2 px-4 py-2 bg-white text-slate-900 hover:bg-slate-100 rounded-full font-bold text-xs transition-all shadow-lg hover:shadow-xl hover:scale-105 disabled:opacity-50 disabled:cursor-wait disabled:scale-100 disabled:shadow-none ${o()??""}`),g(J,G)},[()=>d()("common.auth.login")]),p(Y,F)};B(z,Y=>{i().signedIn?Y(X):Y($,!1)})}p(v,w),pt(),l()}gt(["click"]);var es=_('<span class="w-2 h-2 rounded-full bg-slate-600"></span> <span> </span>',1),ts=_('<span class="w-2 h-2 rounded-full bg-indigo-500 animate-pulse"></span> <span> </span>',1),as=_('<span class="w-2 h-2 rounded-full bg-emerald-500"></span> <span> </span>',1),os=_('<span class="w-2 h-2 rounded-full bg-red-500"></span> <span> </span>',1),ss=_('<span class="w-2 h-2 rounded-full bg-slate-500"></span> <span> </span>',1),rs=_('<div class="mt-1.5 pt-1.5 border-t border-slate-800 text-[9px] text-slate-400 opacity-80 font-medium flex justify-between items-center gap-4"><span> </span> <span> </span></div>'),ns=_('<div class="mt-1 text-[9px] text-slate-400 opacity-60 italic"> </div>'),is=_('<div class="absolute top-full right-0 mt-3 whitespace-nowrap bg-slate-900/95 backdrop-blur-md text-white text-[10px] font-bold py-2 px-3 rounded-lg shadow-2xl border border-slate-700/50 z-[100] pointer-events-none min-w-[120px]"><div class="flex items-center gap-2"><!></div> <!></div>'),ls=_('<div class="relative flex items-center"><button class="flex items-center justify-center p-2 rounded-xl hover:bg-slate-800/50 transition-all active:scale-95 group focus:outline-none"><!></button> <!></div>');function ds(v,s){ut(s,!0);const i=()=>xe(re,"$googleSession",o),d=()=>xe(Ot,"$t",o),n=()=>xe(qe,"$syncStatus",o),l=()=>xe(ia,"$lastSyncTime",o),[o,f]=Ft();let w=L(!1);function z(C){return new Date(C).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}var X=ls(),$=t(X);$.__click=()=>i().signedIn?sa():Oa();var Y=t($);{var F=C=>{_o(C,{size:20,class:"text-slate-600 group-hover:text-slate-400"})},H=C=>{var J=ue(),G=I(J);{var m=b=>{ko(b,{size:20,class:"animate-spin text-indigo-400"})},S=b=>{var T=ue(),N=I(T);{var ae=y=>{go(y,{size:20,class:"text-emerald-400 group-hover:text-emerald-300"})},x=y=>{var P=ue(),q=I(P);{var W=D=>{xo(D,{size:20,class:"text-red-400"})},A=D=>{wo(D,{size:20,class:"text-slate-400 group-hover:text-slate-300"})};B(q,D=>{n()==="error"?D(W):D(A,!1)},!0)}p(y,P)};B(N,y=>{n()==="success"?y(ae):y(x,!1)},!0)}p(b,T)};B(G,b=>{n()==="syncing"?b(m):b(S,!1)},!0)}p(C,J)};B(Y,C=>{i().signedIn?C(H,!1):C(F)})}e($);var Q=a($,2);{var ee=C=>{var J=is(),G=t(J),m=t(G);{var S=x=>{var y=es(),P=a(I(y),2),q=t(P,!0);e(P),O(W=>g(q,W),[()=>d()("common.status.offline")]),p(x,y)},b=x=>{var y=ue(),P=I(y);{var q=A=>{var D=ts(),Z=a(I(D),2),fe=t(Z,!0);e(Z),O(U=>g(fe,U),[()=>d()("common.status.syncing")]),p(A,D)},W=A=>{var D=ue(),Z=I(D);{var fe=M=>{var j=as(),R=a(I(j),2),pe=t(R,!0);e(R),O(_e=>g(pe,_e),[()=>d()("common.status.saved")]),p(M,j)},U=M=>{var j=ue(),R=I(j);{var pe=ne=>{var te=os(),ie=a(I(te),2),ze=t(ie,!0);e(ie),O(le=>g(ze,le),[()=>d()("common.status.error")]),p(ne,te)},_e=ne=>{var te=ss(),ie=a(I(te),2),ze=t(ie,!0);e(ie),O(le=>g(ze,le),[()=>d()("common.status.synced")]),p(ne,te)};B(R,ne=>{n()==="error"?ne(pe):ne(_e,!1)},!0)}p(M,j)};B(Z,M=>{n()==="success"?M(fe):M(U,!1)},!0)}p(A,D)};B(P,A=>{n()==="syncing"?A(q):A(W,!1)},!0)}p(x,y)};B(m,x=>{i().signedIn?x(b,!1):x(S)})}e(G);var T=a(G,2);{var N=x=>{var y=rs(),P=t(y),q=t(P,!0);e(P);var W=a(P,2),A=t(W,!0);e(W),e(y),O((D,Z)=>{g(q,D),g(A,Z)},[()=>d()("common.status.last_sync"),()=>z(l())]),p(x,y)},ae=x=>{var y=ue(),P=I(y);{var q=W=>{var A=ns(),D=t(A,!0);e(A),O(Z=>g(D,Z),[()=>d()("common.auth.login")]),p(W,A)};B(P,W=>{i().signedIn||W(q)},!0)}p(x,y)};B(T,x=>{i().signedIn&&l()?x(N):x(ae,!1)})}e(J),kt(3,J,()=>lo,()=>({duration:150})),p(C,J)};B(Q,C=>{r(w)&&C(ee)})}e(X),O(C=>Ge($,"aria-label",C),[()=>d()("common.status.label")]),Qe("mouseenter",$,()=>u(w,!0)),Qe("mouseleave",$,()=>u(w,!1)),Qe("focus",$,()=>u(w,!0)),Qe("blur",$,()=>u(w,!1)),p(v,X),pt(),f()}gt(["click"]);var cs=_('<div class="absolute top-full right-0 mt-2 bg-slate-900 border border-slate-700 rounded-xl shadow-xl p-1.5 min-w-[120px] z-50 flex flex-col gap-1 animate-in fade-in zoom-in-95 duration-200"><button>ðŸ‡§ðŸ‡· PT-BR</button> <button>ðŸ‡ºðŸ‡¸ EN-US</button></div> <button class="fixed inset-0 z-40 cursor-default" aria-label="Close menu"></button>',1),vs=_('<span class="text-[10px] text-slate-400 font-medium"> </span>'),us=_('<div class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hover:border-indigo-500/40 transition-all relative group flex flex-col shadow-lg hover:shadow-indigo-500/10 border-t-white/5"><div class="flex justify-between items-start mb-4"><div class="flex-1"><h3 class="font-black text-xl text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate pr-16"> </h3> <div class="flex items-center gap-2 mt-1 flex-wrap"><span class="text-[10px] bg-indigo-500/10 text-indigo-400 font-black px-2 py-0.5 rounded uppercase tracking-wider"> </span> <span class="text-[10px] text-slate-500 font-bold uppercase tracking-widest"> </span> <!></div> <div class="mt-2 flex items-center gap-2"><div class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800 text-[9px] text-slate-400 border border-slate-700 font-bold uppercase tracking-wider"><!> </div></div></div> <div class="flex items-center gap-1"><button class="text-slate-700 hover:text-indigo-400 p-2 rounded-xl hover:bg-indigo-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button> <button class="text-slate-700 hover:text-red-400 p-2 rounded-xl hover:bg-red-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button></div></div> <div class="space-y-3 mb-6"><div class="flex items-center justify-between text-xs text-slate-400"><span class="flex items-center gap-1.5 opacity-60"><!> </span> <span class="font-bold text-slate-300 truncate max-w-[150px]"> </span></div></div> <button class="w-full bg-slate-800 hover:bg-indigo-600 text-white py-3 rounded-2xl font-bold transition-all active:scale-[0.98] border border-slate-700 hover:border-indigo-400/30 flex items-center justify-center gap-2"> <!></button></div>'),ps=_('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 col-start-1 row-start-1 w-full"><!> <button class="h-full min-h-[160px] border-2 border-dashed border-slate-800 rounded-3xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-500 transition-all hover:bg-indigo-500/5 gap-2 group shadow-sm bg-slate-900/20"><div class="w-12 h-12 rounded-full bg-slate-800 flex items-center justify-center group-hover:bg-indigo-500/10 group-hover:scale-110 transition-all"><!></div> <span class="font-bold"> </span></button></div>'),gs=_('<span class="text-[9px] bg-emerald-500/10 text-emerald-400 px-2 py-0.5 rounded-full border border-emerald-500/20 font-black uppercase tracking-widest flex items-center gap-1"><!> </span>'),fs=_('<div class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hover:border-indigo-500/40 transition-all group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10 border-t-white/5"><div class="mb-4"><div class="flex justify-between items-start mb-1"><h3 class="font-black text-2xl text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight"> </h3> <div class="flex items-center gap-1"><!> <button class="text-slate-700 hover:text-indigo-400 p-2 rounded-xl hover:bg-indigo-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button> <button class="text-slate-700 hover:text-red-400 p-2 rounded-xl hover:bg-red-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button></div></div> <p class="text-indigo-400 text-[10px] font-black uppercase tracking-[0.2em] mb-3"> </p> <div class="mb-3"><div class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800 text-[9px] text-slate-400 border border-slate-700 font-bold uppercase tracking-wider"><!> </div></div> <p class="text-sm text-slate-400 line-clamp-2 leading-relaxed h-10"> </p></div> <button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-2xl font-bold flex items-center justify-center gap-2 border border-indigo-400/20 shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98]"><!> </button></div>'),ms=_('<div class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hover:border-emerald-500/40 transition-all group relative flex flex-col justify-between shadow-xl border-t-white/5"><div><h3 class="font-black text-2xl text-white group-hover:text-emerald-400 mb-2 uppercase tracking-tight"> </h3> <div class="flex items-center gap-2 mb-4"><div class="px-2 py-0.5 bg-slate-800 rounded text-[9px] text-slate-400 font-black uppercase tracking-widest"> </div> <div class="flex items-center gap-1 px-2 py-0.5 bg-emerald-500/10 rounded text-[9px] text-emerald-400 font-black uppercase tracking-wider"><div class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></div> </div></div> <div class="mb-4"><div class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800/50 text-[9px] text-slate-400 border border-slate-700/50 font-bold uppercase tracking-wider"><!> </div></div> <p class="text-sm text-slate-400 line-clamp-3 leading-relaxed mb-6 h-15"> </p></div> <button class="w-full bg-emerald-600 hover:bg-emerald-500 text-white py-3 rounded-2xl font-black uppercase text-xs tracking-[0.1em] flex items-center justify-center gap-2 border border-emerald-400/20 transition-all active:scale-[0.98] group"> <!></button></div>'),hs=_('<div class="col-span-full py-12 flex flex-col items-center text-center opacity-40"><div class="w-16 h-16 bg-slate-800/50 rounded-full flex items-center justify-center text-slate-600 mb-3 border border-slate-700 border-dashed"><!></div> <h3 class="text-lg font-black uppercase tracking-widest text-slate-500"> </h3> <p class="text-slate-600 max-w-sm mt-2 text-sm"> </p></div>'),bs=_('<div class="space-y-8 col-start-1 row-start-1 w-full"><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><!> <button class="h-full min-h-[160px] border-2 border-dashed border-slate-800 rounded-3xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-500 transition-all hover:bg-indigo-500/5 gap-2 group shadow-sm bg-slate-900/20"><div class="w-12 h-12 rounded-full bg-slate-800 flex items-center justify-center group-hover:bg-indigo-500/10 group-hover:scale-110 transition-all"><!></div> <span class="font-bold"> </span></button></div> <div><div class="flex items-center gap-3 mb-4"><div class="h-px flex-1 bg-slate-800"></div> <h3 class="text-xs font-black uppercase tracking-widest text-emerald-400 flex items-center gap-2"><!> </h3> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><!> <!></div></div></div>'),xs=_('<div class="fixed top-0 left-0 w-full flex justify-center items-center pointer-events-none z-[100] transition-all duration-300"><div class="bg-indigo-600 rounded-full p-2.5 shadow-xl border border-indigo-500/50 text-white"><!></div></div> <div class="animate-in fade-in px-4 md:px-8 max-w-7xl mx-auto pb-32 md:pb-20"><header class="mb-8 flex justify-between items-center border-b border-slate-800/50 pt-4 md:pt-8 pb-4 sticky top-0 bg-slate-950/80 backdrop-blur-md z-40 -mx-4 px-4 md:-mx-8 md:px-8 transition-all"><div class="flex items-center"><h1 class="text-xl md:text-3xl font-bold text-white flex items-center gap-2 text-gradient m-0 leading-none"><!> <span class="hidden md:inline">Schwalb Vault</span> <span class="md:hidden">Schwalb Vault</span></h1></div> <div class="hidden md:flex absolute left-1/2 -translate-x-1/2 bg-slate-900/50 p-1.5 rounded-2xl border border-slate-800 glass shadow-xl backdrop-blur-md"><div class="relative flex"><div class="absolute inset-y-0 w-1/2 bg-indigo-600 rounded-xl transition-transform duration-300 ease-out shadow-lg shadow-indigo-500/20"></div> <button><!> </button> <button><!> </button></div></div> <div class="flex items-center justify-end min-w-[40px] gap-3"><!> <div class="relative"><button class="flex items-center gap-2 text-slate-400 hover:text-white transition-colors p-2 rounded-lg hover:bg-slate-800"><!> <span class="text-xs font-bold uppercase hidden md:inline"> </span></button> <!></div> <!></div></header> <div class="md:hidden fixed bottom-6 left-4 right-4 bg-slate-900/90 backdrop-blur-xl border border-slate-700/50 shadow-2xl rounded-2xl p-1.5 z-50"><div class="relative flex justify-between"><div class="absolute inset-y-0 w-1/2 bg-indigo-600/20 rounded-xl transition-transform duration-300 ease-out"></div> <button><!> <span class="transition-all duration-300"> </span></button> <button><!> <span class="transition-all duration-300"> </span></button></div></div> <div class="min-h-[500px] grid items-start relative"><!></div> <!> <!> <!> <!></div>',1);function _s(v,s){ut(s,!0);const i=()=>xe(re,"$googleSession",w),d=()=>xe(Ga,"$liveCharacters",w),n=()=>xe(oa,"$liveCampaigns",w),l=()=>xe(Ot,"$t",w),o=()=>xe(Kt,"$locale",w),f=()=>xe(uo,"$publicCampaigns",w),[w,z]=Ft();let X=L(0),$=L(0),Y=L(!1),F=L(!1);const H=80;function Q(c){window.scrollY===0&&(u(X,c.touches[0].clientY,!0),u(Y,!0))}function ee(c){if(!r(Y))return;const E=c.touches[0].clientY-r(X);E>0&&window.scrollY<=0?u($,Math.min(E*.4,120),!0):(u(Y,!1),u($,0))}async function C(){if(r(Y))if(u(Y,!1),r($)>H){u(F,!0),u($,60);try{navigator&&navigator.vibrate&&navigator.vibrate(50),await sa()}finally{setTimeout(()=>{u(F,!1),u($,0)},1e3)}}else u($,0)}ja(()=>{Lo();const c=localStorage.getItem("user_locale");return c&&Kt.set(c),document.addEventListener("touchmove",ee,{passive:!1}),()=>{document.removeEventListener("touchmove",ee)}});let J=L(!1);function G(c){Kt.set(c),localStorage.setItem("user_locale",c),u(J,!1)}let m=L("characters"),S=L("characters");$t(()=>{r(m)!==r(S)&&u(S,r(m),!0)}),$t(()=>{i().signedIn&&sa()}),$t(()=>{i().signedIn&&(d(),n(),aa())});let b=L(!1),T=L(null);function N(c){u(T,c,!0),u(b,!0)}function ae(c){if(!r(T))return;const k=r(T).id,h={...ce.get(k),...c};ce.set(k,h),u(b,!1)}let x=L(!1),y=L("{}");const P={name:"",playerName:"",ancestry:"Humano",novicePath:"",level:0,defense:8,health:5,system:Be};function q(){u(y,JSON.stringify(P),!0),u(x,!0)}async function W(c){const k=Ca(),E={id:k,name:c.name,playerName:c.playerName||"",ancestry:c.ancestry,level:c.level,defense:c.defense,system:c.system||Be,paths:{novice:c.novicePath||"-",expert:"-",master:"-"},attributes:[{name:"ForÃ§a",value:10,key:"str"},{name:"Agilidade",value:10,key:"agi"},{name:"Intelecto",value:10,key:"int"},{name:"Vontade",value:10,key:"wil"}],speed:5,health:c.health,currentHealth:c.health,spells:[],talents:[],equipment:[],afflictions:[],effects:[],currency:{gp:0,sp:0,cp:0},languages:["Comum"]};ce.set(k,E),u(x,!1),Mt(jt("/characters/[id]",{id:k}))}let A=L(!1),D=L(null),Z=L("{}");const fe={name:"",description:"",gmName:"",system:Be};function U(c=null){u(D,c?c.id:null,!0),u(Z,JSON.stringify(c||fe),!0),u(A,!0)}async function M(c){const k=r(D)||Ca(),E=r(D)?ve.get(k):{},h={...E,id:k,name:c.name,description:c.description,gmName:c.gmName,players:E.players||[],backupEnabled:c.backupEnabled||!1,backupHash:c.backupHash||"",system:c.system||Be};c.removePassword?delete h.passwordHash:c.password&&(h.passwordHash=await bo(c.password)),ve.set(k,h),u(A,!1)}let j=L(!1),R=L(Ma({title:"",message:"",onConfirm:()=>{}}));function pe(c){u(R,{title:l()("dashboard.campaigns.delete_title"),message:l()("dashboard.campaigns.delete_message"),onConfirm:()=>{console.log("[DEBUG] Deleting campaign with ID:",c);let k=0;for(const E of ve.keys()){const h=ve.get(E);(E===c||h&&h.id===c)&&(console.log("[DEBUG] Found match for deletion - Key:",E,"Camp ID:",h?.id),ve.delete(E),k++)}console.log("[DEBUG] Total entries deleted from map:",k),Je.set(c,{type:"campaign",deletedAt:Date.now()}),console.log("[DEBUG] Deletion tracked in deletedIdsMap"),aa(),u(j,!1)}},!0),u(j,!0)}function _e(c){u(R,{title:l()("dashboard.characters.delete_title"),message:l()("dashboard.characters.delete_message"),onConfirm:()=>{Ie(oa).forEach(h=>{let K=!1;h.members&&h.members.some(oe=>oe.id===c)&&(h.members=h.members.filter(oe=>oe.id!==c),K=!0),h.sessionRoster&&h.sessionRoster.includes(c)&&(h.sessionRoster=h.sessionRoster.filter(oe=>oe!==c),K=!0),h.activeEnemies&&h.activeEnemies.some(oe=>oe.id===c)&&(h.activeEnemies=h.activeEnemies.filter(oe=>oe.id!==c),K=!0),K&&ve.set(h.id,h)}),console.log("[DEBUG] Deleting character with ID:",c);let E=0;for(const h of ce.keys()){const K=ce.get(h);(h===c||K&&K.id===c)&&(console.log("[DEBUG] Found match for deletion - Key:",h,"Char ID:",K?.id),ce.delete(h),E++)}console.log("[DEBUG] Total entries deleted from map:",E),Je.set(c,{type:"character",deletedAt:Date.now()}),console.log("[DEBUG] Deletion tracked in deletedIdsMap"),aa(),u(j,!1)}},!0),u(j,!0)}var ne=xs();Qe("touchstart",qt,Q),Qe("touchmove",qt,ee),Qe("touchend",qt,C);var te=I(ne),ie=t(te),ze=t(ie);{let c=Nt(()=>r(F)?"animate-spin":""),k=Nt(()=>r($)*2);yo(ze,{get class(){return r(c)},size:20,get style(){return`transform: rotate(${r(k)??""}deg)`}})}e(ie),e(te);var le=a(te,2),me=t(le),de=t(me),rt=t(de),La=t(rt);fo(La,{class:"text-indigo-500",size:28}),et(4),e(rt),e(de);var Lt=a(de,2),la=t(Lt),da=t(la),ft=a(da,2);ft.__click=()=>u(m,"characters");var ca=t(ft);Ea(ca,{size:18});var Ha=a(ca);e(ft);var Ct=a(ft,2);Ct.__click=()=>u(m,"campaigns");var va=t(Ct);ea(va,{size:18});var Ra=a(va);e(Ct),e(la),e(Lt);var ua=a(Lt,2),pa=t(ua);ds(pa,{});var Ht=a(pa,2),mt=t(Ht);mt.__click=()=>u(J,!r(J));var ga=t(mt);Qt(ga,{size:20});var fa=a(ga,2),Va=t(fa,!0);e(fa),e(mt);var Ya=a(mt,2);{var Ja=c=>{var k=cs(),E=I(k),h=t(E);h.__click=()=>G("pt");var K=a(h,2);K.__click=()=>G("en"),e(E);var oe=a(E,2);oe.__click=()=>u(J,!1),O(()=>{je(h,1,`flex items-center gap-2 px-3 py-2 text-sm font-bold rounded-lg ${o()==="pt"?"bg-indigo-600 text-white":"text-slate-400 hover:text-white hover:bg-slate-800"}`),je(K,1,`flex items-center gap-2 px-3 py-2 text-sm font-bold rounded-lg ${o()==="en"?"bg-indigo-600 text-white":"text-slate-400 hover:text-white hover:bg-slate-800"}`)}),p(c,k)};B(Ya,c=>{r(J)&&c(Ja)})}e(Ht);var qa=a(Ht,2);Qo(qa,{}),e(ua),e(me);var Rt=a(me,2),ma=t(Rt),ha=t(ma),ht=a(ha,2);ht.__click=()=>u(m,"characters");var ba=t(ht);{let c=Nt(()=>r(m)==="characters"?2.5:2);Ea(ba,{size:20,get strokeWidth(){return r(c)},class:"transition-all duration-300"})}var xa=a(ba,2),Wa=t(xa,!0);e(xa),e(ht);var Et=a(ht,2);Et.__click=()=>u(m,"campaigns");var _a=t(Et);{let c=Nt(()=>r(m)==="campaigns"?2.5:2);ea(_a,{size:20,get strokeWidth(){return r(c)},class:"transition-all duration-300"})}var wa=a(_a,2),Ka=t(wa,!0);e(wa),e(Et),e(ma),e(Rt);var Vt=a(Rt,2),Xa=t(Vt);{var Za=c=>{var k=ps(),E=t(k);Bt(E,1,d,We=>We.id,(We,he)=>{var Ke=us(),nt=t(Ke),it=t(nt),bt=t(it),Tt=t(bt,!0);e(bt);var lt=a(bt,2),xt=t(lt),Yt=t(xt,!0);e(xt);var se=a(xt,2),V=t(se);e(se);var be=a(se,2);{var ye=Ee=>{var De=vs(),Me=t(De);e(De),O(()=>g(Me,`â€¢ ${r(he).playerName??""}`)),p(Ee,De)};B(be,Ee=>{r(he).playerName&&Ee(ye)})}e(lt);var ge=a(lt,2),$e=t(ge),ke=t($e);Gt(ke,{size:10});var Se=a(ke);e($e),e(ge),e(it);var Te=a(it,2),we=t(Te);we.__click=()=>N(r(he));var Ne=t(we);no(Ne,{size:16}),e(we);var Ce=a(we,2);Ce.__click=()=>_e(r(he).id);var Pe=t(Ce);Sa(Pe,{size:16}),e(Ce),e(Te),e(nt);var Ae=a(nt,2),Ue=t(Ae),Oe=t(Ue),Fe=t(Oe);ea(Fe,{size:12});var Le=a(Fe);e(Oe);var He=a(Oe,2),_t=t(He,!0);e(He),e(Ue),e(Ae);var Re=a(Ae,2);Re.__click=()=>Mt(jt("/characters/[id]",{id:r(he).id}));var dt=t(Re),Xe=a(dt);Ia(Xe,{size:14,fill:"currentColor"}),e(Re),e(Ke),O((Ee,De,Me,Ze,ct,wt)=>{g(Tt,r(he).name),g(Yt,r(he).ancestry||"Humano"),g(V,`${Ee??""} ${r(he).level??""}`),g(Se,` ${De??""}`),Ge(we,"title",Me),Ge(Ce,"title",Ze),g(Le,` ${ct??""}`),g(_t,r(he).paths?.novice||"-"),g(dt,`${wt??""} `)},[()=>l()("common.labels.level"),()=>Zt(r(he).system).name,()=>l()("common.buttons.settings"),()=>l()("common.buttons.delete"),()=>l()("dashboard.characters.paths"),()=>l()("dashboard.characters.open_sheet")]),p(We,Ke)});var h=a(E,2);h.__click=()=>q();var K=t(h),oe=t(K);Xt(oe,{size:32}),e(K);var It=a(K,2),zt=t(It,!0);e(It),e(h),e(k),O(We=>g(zt,We),[()=>l()("dashboard.characters.new_character")]),kt(1,k,()=>Dt,()=>({x:-100,duration:300,easing:Pt})),kt(2,k,()=>Dt,()=>({x:-100,duration:300,easing:Pt})),p(c,k)},Qa=c=>{var k=bs(),E=t(k),h=t(E);Bt(h,1,n,se=>se.id,(se,V)=>{var be=fs(),ye=t(be),ge=t(ye),$e=t(ge),ke=t($e,!0);e($e);var Se=a($e,2),Te=t(Se);{var we=Me=>{var Ze=gs(),ct=t(Ze);Qt(ct,{size:10});var wt=a(ct);e(Ze),O(Jt=>g(wt,` ${Jt??""}`),[()=>l()("dashboard.campaigns.published")]),p(Me,Ze)};B(Te,Me=>{r(V).isPublished&&Me(we)})}var Ne=a(Te,2);Ne.__click=()=>U(r(V));var Ce=t(Ne);io(Ce,{size:16}),e(Ne);var Pe=a(Ne,2);Pe.__click=()=>pe(r(V).id);var Ae=t(Pe);Sa(Ae,{size:16}),e(Pe),e(Se),e(ge);var Ue=a(ge,2),Oe=t(Ue,!0);e(Ue);var Fe=a(Ue,2),Le=t(Fe),He=t(Le);Gt(He,{size:10});var _t=a(He);e(Le),e(Fe);var Re=a(Fe,2),dt=t(Re,!0);e(Re),e(ye);var Xe=a(ye,2);Xe.__click=()=>Mt(jt("/campaigns/[id]",{id:r(V).id}));var Ee=t(Xe);Ia(Ee,{size:18,fill:"currentColor"});var De=a(Ee);e(Xe),e(be),O((Me,Ze,ct,wt,Jt,to)=>{g(ke,r(V).name),Ge(Ne,"title",Me),Ge(Pe,"title",Ze),g(Oe,ct),g(_t,` ${wt??""}`),g(dt,Jt),g(De,` ${to??""}`)},[()=>l()("common.buttons.edit"),()=>l()("common.buttons.delete"),()=>r(V).gmName||l()("common.labels.master"),()=>Zt(r(V).system||Be).name,()=>r(V).description||l()("dashboard.campaigns.no_description"),()=>l()("dashboard.campaigns.start_session")]),p(se,be)});var K=a(h,2);K.__click=()=>U();var oe=t(K),It=t(oe);Xt(It,{size:32}),e(oe);var zt=a(oe,2),We=t(zt,!0);e(zt),e(K),e(E);var he=a(E,2),Ke=t(he),nt=a(t(Ke),2),it=t(nt);Qt(it,{size:14});var bt=a(it);e(nt),et(2),e(Ke);var Tt=a(Ke,2),lt=t(Tt);Bt(lt,1,f,se=>se.id,(se,V)=>{var be=ms(),ye=t(be),ge=t(ye),$e=t(ge,!0);e(ge);var ke=a(ge,2),Se=t(ke),Te=t(Se,!0);e(Se);var we=a(Se,2),Ne=a(t(we));e(we),e(ke);var Ce=a(ke,2),Pe=t(Ce),Ae=t(Pe);Gt(Ae,{size:10});var Ue=a(Ae);e(Pe),e(Ce);var Oe=a(Ce,2),Fe=t(Oe,!0);e(Oe),e(ye);var Le=a(ye,2);Le.__click=()=>Mt(jt("/campaigns/[id]/invite",{id:r(V).id}));var He=t(Le),_t=a(He);Xt(_t,{size:18,class:"group-hover:rotate-90 transition-transform"}),e(Le),e(be),O((Re,dt,Xe,Ee,De)=>{g($e,r(V).name),g(Te,Re),g(Ne,` ${dt??""}`),g(Ue,` ${Xe??""}`),g(Fe,Ee),g(He,`${De??""} `)},[()=>r(V).gmName||l()("common.labels.master"),()=>l()("dashboard.campaigns.online"),()=>Zt(r(V).system||Be).name,()=>r(V).description||l()("dashboard.campaigns.public_description"),()=>l()("dashboard.campaigns.join_adventure")]),p(se,be)});var xt=a(lt,2);{var Yt=se=>{var V=hs(),be=t(V),ye=t(be);po(ye,{size:32}),e(be);var ge=a(be,2),$e=t(ge,!0);e(ge);var ke=a(ge,2),Se=t(ke,!0);e(ke),e(V),O((Te,we)=>{g($e,Te),g(Se,we)},[()=>l()("dashboard.campaigns.no_online_campaigns"),()=>l()("dashboard.campaigns.no_online_description")]),p(se,V)};B(xt,se=>{f().length===0&&se(Yt)})}e(Tt),e(he),e(k),O((se,V)=>{g(We,se),g(bt,` ${V??""}`)},[()=>l()("dashboard.campaigns.new_campaign"),()=>l()("dashboard.campaigns.public_campaigns")]),kt(1,k,()=>Dt,()=>({x:100,duration:300,easing:Pt})),kt(2,k,()=>Dt,()=>({x:100,duration:300,easing:Pt})),p(c,k)};B(Xa,c=>{r(m)==="characters"?c(Za):c(Qa,!1)})}e(Vt);var ya=a(Vt,2);Bo(ya,{get isOpen(){return r(x)},get initialData(){return r(y)},onClose:()=>u(x,!1),onSave:W});var ka=a(ya,2);mo(ka,{get isOpen(){return r(A)},get initialData(){return r(Z)},onClose:()=>u(A,!1),onSave:M});var $a=a(ka,2);vo($a,{get isOpen(){return r(j)},get title(){return r(R).title},get message(){return r(R).message},get onConfirm(){return r(R).onConfirm},onCancel:()=>u(j,!1)});var eo=a($a,2);Ao(eo,{get isOpen(){return r(b)},get characterData(){return r(T)},onClose:()=>u(b,!1),onSave:ae}),e(le),O((c,k,E,h,K)=>{Wt(te,`transform: translateY(${(r(F)?60:r($))??""}px); opacity: ${r($)>0?1:0}`),Wt(da,`transform: translateX(${r(m)==="campaigns"?"100%":"0%"})`),je(ft,1,`relative z-10 px-6 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 flex items-center gap-2 ${r(m)==="characters"?"text-white":"text-slate-400 hover:text-white"}`),g(Ha,` ${c??""}`),je(Ct,1,`relative z-10 px-6 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 flex items-center gap-2 ${r(m)==="campaigns"?"text-white":"text-slate-400 hover:text-white"}`),g(Ra,` ${k??""}`),Ge(mt,"title",E),g(Va,o()==="pt"?"PT":"EN"),Wt(ha,`transform: translateX(${r(m)==="campaigns"?"100%":"0%"})`),je(ht,1,`relative flex-1 py-3 rounded-xl text-xs font-bold transition-all duration-300 flex flex-col items-center justify-center gap-1 z-10 ${r(m)==="characters"?"text-indigo-400":"text-slate-500"}`),g(Wa,h),je(Et,1,`relative flex-1 py-3 rounded-xl text-xs font-bold transition-all duration-300 flex flex-col items-center justify-center gap-1 z-10 ${r(m)==="campaigns"?"text-indigo-400":"text-slate-500"}`),g(Ka,K)},[()=>l()("dashboard.tabs.characters"),()=>l()("dashboard.tabs.campaigns"),()=>l()("common.labels.language")||"Language",()=>l()("dashboard.tabs.characters"),()=>l()("dashboard.tabs.campaigns")]),p(v,ne),pt(),z()}gt(["click"]);var ws=_("<!> <!>",1);function Os(v){var s=ws(),i=I(s);No(i,{});var d=a(i,2);_s(d,{}),p(v,s)}export{Os as component};
