import"../chunks/DsnmJJEf.js";import{v as bt,w as Se,k as d,x as Yt,z as Kt,j as b,B as t,y as a,A as r,T as Z,I as e,t as p,L as za,F as R,R as Be,n as Gt,a2 as Zt,at as Ca}from"../chunks/Dw_raXzk.js";import{d as ea,s as i,o as Ea,g as ha,e as pa}from"../chunks/Dy4L3Tb7.js";import{l as Ut,s as qt,i as M,p as Pt}from"../chunks/C7jdvfZ7.js";import{e as Ue,s as De,i as ut,$ as Ht,r as St,a as je,f as ya,g as Ya}from"../chunks/DHvfXG5j.js";import{s as ta,a as dt}from"../chunks/CLDCoJG6.js";import{p as Ka}from"../chunks/DlnZKKfp.js";import{d as ja,h as _a,a as er,c as Ma,e as ht,k as wa,l as tr,m as ia,n as ma,u as xa,b as At,f as Oa,g as ga,o as ar,p as rr,q as sr}from"../chunks/DlSwpd5B.js";import{C as Na,a as $a,b as Ta,D as Ia,l as ir,c as nr}from"../chunks/DqcrA8Ma.js";import{b as or}from"../chunks/CdKeR9oO.js";import{U as Da,C as Sa,W as Aa,r as Pa}from"../chunks/DOROhDxx.js";import{A as lr,a as dr,b as ka,B as vr,T as cr,E as Ha,M as ur,G as fa,H as Fa,C as La,R as br,c as xr,I as mr,s as _r,d as fr,L as pr,S as Ua,e as gr,D as oa,f as hr}from"../chunks/Qs8yDB-u.js";import{k as qa}from"../chunks/MwG3W-Qj.js";import{M as yr,X as la,P as Xt,a as Ra,c as wr,T as da,b as kr}from"../chunks/DsV61ll_.js";import{C as Ba,G as zr,P as Wa,S as $r,a as Cr}from"../chunks/CN0pNh2C.js";import"../chunks/Dcsmm6So.js";import{I as Bt,s as Wt}from"../chunks/DjRg1Dji.js";import{b as Er}from"../chunks/Bb9Zu10p.js";import{g as jr}from"../chunks/CHHk6V25.js";import{W as Mr}from"../chunks/BirloD4D.js";function Or(N,s){const n=Ut(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"m6 9 6 6 6-6"}]];Bt(N,qt({name:"chevron-down"},()=>n,{get iconNode(){return x},children:(z,Q)=>{var O=bt(),l=Se(O);Wt(l,s,"default",{}),d(z,O)},$$slots:{default:!0}}))}function Ir(N,s){const n=Ut(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"m18 15-6-6-6 6"}]];Bt(N,qt({name:"chevron-up"},()=>n,{get iconNode(){return x},children:(z,Q)=>{var O=bt(),l=Se(O);Wt(l,s,"default",{}),d(z,O)},$$slots:{default:!0}}))}function Sr(N,s){const n=Ut(s,["children","$$slots","$$events","$$legacy"]);const x=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];Bt(N,qt({name:"copy"},()=>n,{get iconNode(){return x},children:(z,Q)=>{var O=bt(),l=Se(O);Wt(l,s,"default",{}),d(z,O)},$$slots:{default:!0}}))}function Rr(N,s){const n=Ut(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];Bt(N,qt({name:"flame"},()=>n,{get iconNode(){return x},children:(z,Q)=>{var O=bt(),l=Se(O);Wt(l,s,"default",{}),d(z,O)},$$slots:{default:!0}}))}function Nr(N,s){const n=Ut(s,["children","$$slots","$$events","$$legacy"]);const x=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];Bt(N,qt({name:"grip-vertical"},()=>n,{get iconNode(){return x},children:(z,Q)=>{var O=bt(),l=Se(O);Wt(l,s,"default",{}),d(z,O)},$$slots:{default:!0}}))}function Va(N,s){const n=Ut(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];Bt(N,qt({name:"layers"},()=>n,{get iconNode(){return x},children:(z,Q)=>{var O=bt(),l=Se(O);Wt(l,s,"default",{}),d(z,O)},$$slots:{default:!0}}))}function Ga(N,s){const n=Ut(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];Bt(N,qt({name:"library"},()=>n,{get iconNode(){return x},children:(z,Q)=>{var O=bt(),l=Se(O);Wt(l,s,"default",{}),d(z,O)},$$slots:{default:!0}}))}function Tr(N,s){const n=Ut(s,["children","$$slots","$$events","$$legacy"]);const x=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];Bt(N,qt({name:"qr-code"},()=>n,{get iconNode(){return x},children:(z,Q)=>{var O=bt(),l=Se(O);Wt(l,s,"default",{}),d(z,O)},$$slots:{default:!0}}))}function Qa(N,s){const n=Ut(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];Bt(N,qt({name:"save"},()=>n,{get iconNode(){return x},children:(z,Q)=>{var O=bt(),l=Se(O);Wt(l,s,"default",{}),d(z,O)},$$slots:{default:!0}}))}function Ja(N,s){const n=Ut(s,["children","$$slots","$$events","$$legacy"]);const x=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];Bt(N,qt({name:"swords"},()=>n,{get iconNode(){return x},children:(z,Q)=>{var O=bt(),l=Se(O);Wt(l,s,"default",{}),d(z,O)},$$slots:{default:!0}}))}function Dr(N){let s=!1;return document.body&&(document.body.appendChild(N),s=!0),{destroy(){s&&N.parentNode&&N.parentNode.removeChild(N)}}}var Ar=b("<button> <!></button>"),Pr=b('<p class="text-xs text-slate-600 italic"> </p>'),Hr=b('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),Fr=b('<div class="space-y-1"></div>'),Lr=b('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),Ur=b("<div><!></div>");function qr(N,s){Yt(s,!0);const n=()=>dt(Ht,"$t",x),[x,z]=ta();var Q=bt(),O=Se(Q);{var l=f=>{var E=Ur(),W=t(E);{let le=Z(()=>n()("session.affliction_modal.title"));yr(W,{get isOpen(){return s.isOpen},get onClose(){return s.onClose},get title(){return a(le)},maxWidth:"max-w-md",children:(de,ne)=>{var ee=Lr(),pe=Se(ee);Ue(pe,21,()=>Object.keys(lr),ut,(ae,he)=>{const oe=Z(()=>s.afflictions.includes(a(he)));var ye=Ar();ye.__click=()=>s.onToggle(a(he));var Re=t(ye),$e=r(Re);{var We=Ve=>{Ba(Ve,{size:14,class:"text-red-400"})};M($e,Ve=>{a(oe)&&Ve(We)})}e(ye),p(Ve=>{De(ye,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(oe)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),i(Re,`${Ve??""} `)},[()=>n()(`character.afflictions.${a(he)}`)]),d(ae,ye)}),e(pe);var F=r(pe,2),me=t(F),X=t(me),He=t(X,!0);e(X);var rt=r(X,2);{var ve=ae=>{var he=Pr(),oe=t(he,!0);e(he),p(ye=>i(oe,ye),[()=>n()("session.affliction_modal.none_selected")]),d(ae,he)},_e=ae=>{var he=Fr();Ue(he,21,()=>s.afflictions,ut,(oe,ye)=>{var Re=Hr(),$e=t(Re),We=t($e);e($e);var Ve=r($e,2),qe=t(Ve,!0);e(Ve),e(Re),p((_t,Ze)=>{i(We,`${_t??""}:`),i(qe,Ze)},[()=>n()(`character.afflictions.${a(ye)}`),()=>n()(`sofww.afflictions.${a(ye).toLowerCase().replace(" ","_")}.effect`)]),d(oe,Re)}),e(he),d(ae,he)};M(rt,ae=>{s.afflictions.length===0?ae(ve):ae(_e,!1)})}e(me);var Me=r(me,2),we=t(Me);we.__click=function(...ae){s.onClose?.apply(this,ae)};var Ae=t(we,!0);e(we),e(Me),e(F),p((ae,he)=>{i(He,ae),i(Ae,he)},[()=>n()("session.affliction_modal.effects"),()=>n()("session.affliction_modal.done")]),d(de,ee)},$$slots:{default:!0}})}e(E),dr(E,le=>Dr?.(le)),d(f,E)};M(O,f=>{s.isOpen&&f(l)})}d(N,Q),Kt(),z()}ea(["click"]);var Br=b('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),Wr=b('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),Vr=b('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),Gr=b("<button><!></button>"),Qr=b('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),Jr=b('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),Zr=b('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),Xr=b('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),Yr=b('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),Kr=b('<div class="flex flex-col items-center justify-between bg-cyan-950/20 border border-cyan-500/30 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-cyan-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div>'),es=b('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),ts=b('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),as=b('<div class="grid grid-cols-2 gap-4 mb-4"><div class="p-3 rounded-xl bg-purple-950/20 border border-purple-500/30 flex justify-between items-center group/ins"><div><span class="text-[9px] text-purple-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div> <div class="p-3 rounded-xl bg-red-950/20 border border-red-500/30 flex justify-between items-center group/cor"><div><span class="text-[9px] text-red-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div></div>'),rs=b("<!> ",1),ss=b('<div><div class="text-emerald-500 text-[10px] font-black uppercase mb-2 flex items-center gap-2"> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="flex flex-wrap gap-2"></div></div>'),is=b('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),ns=b('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),os=b('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <!> <div class="grid grid-cols-2 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"><!> <!></div></div>'),ls=b('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div> <!></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function ds(N,s){Yt(s,!0);const n=()=>dt(Ht,"$t",x),[x,z]=ta();let Q=Pt(s,"updateEnemy",3,(_,h)=>{}),O=Pt(s,"updatePlayer",3,(_,h)=>{}),l=Pt(s,"removeFromCombat",3,_=>{}),f=Z(()=>s.entity.type==="player"),E=Z(()=>s.entity.system==="sofdl"),W=Z(()=>s.entity.damage||0),le=Z(()=>s.entity.normalHealth||s.entity.health||10),de=Z(()=>s.entity.currentHealth??a(le)),ne=Z(()=>a(W)>=a(de)),ee=Z(()=>a(W)>=a(de)/2&&!a(ne)),pe=Z(()=>a(de)>0?Math.min(100,Math.max(0,a(W)/a(de)*100)):100),F=Be(!1),me=Be(!1);za(()=>{const _=s.entity.afflictions||[],h=_.includes("Incapacitated");if(a(ne)&&!h){const ue={afflictions:[..._,"Incapacitated"]};s.entity.type==="player"?X(ue):Q()(s.entity.instanceId,ue)}else if(!a(ne)&&h){const ue={afflictions:_.filter(Te=>Te!=="Incapacitated")};s.entity.type==="player"?X(ue):Q()(s.entity.instanceId,ue)}});function X(_){if(s.entity.type!=="player")return;const h=ja.get(s.entity.id);h&&ja.set(s.entity.id,{...h,..._}),O()(s.entity.id,_),_a({id:s.entity.id,..._})}function He(_){const h=parseInt(_.target.value);if(isNaN(h))return;const ue={damage:Math.max(0,h)};s.entity.type==="player"?X(ue):Q()(s.entity.instanceId,ue)}function rt(_){const h=parseInt(_.target.value);if(isNaN(h))return;const K=Math.max(0,h);let ue=a(W);K<a(W)&&(ue=K);const Te={currentHealth:K,damage:ue};s.entity.type==="player"?X(Te):Q()(s.entity.instanceId,Te)}function ve(){const _=!s.entity.acted;s.entity.type==="player"?X({acted:_}):Q()(s.entity.instanceId,{acted:_})}function _e(){s.entity.type==="player"&&X({initiative:!s.entity.initiative})}function Me(_){const h=s.entity.afflictions||[],ue={afflictions:h.includes(_)?h.filter(Te=>Te!==_):[...h,_]};s.entity.type==="player"?X(ue):Q()(s.entity.instanceId,ue)}var we=ls(),Ae=t(we);{var ae=_=>{var h=Br(),K=t(h,!0);e(h),p(ue=>i(K,ue),[()=>n()("session.combat_card.initiative")]),d(_,h)};M(Ae,_=>{a(f)&&s.entity.initiative&&_(ae)})}var he=r(Ae,2);{var oe=_=>{var h=Wr();d(_,h)};M(he,_=>{a(ne)&&_(oe)})}var ye=r(he,2),Re=t(ye),$e=t(Re),We=t($e),Ve=t(We);qa(Ve,()=>s.entity.imageUrl,_=>{{let h=Z(()=>s.entity.name.charAt(0));ka(_,{get hash(){return s.entity.imageUrl},get alt(){return s.entity.name},size:"custom",get fallbackText(){return a(h)}})}}),e(We);var qe=r(We,2);qe.__click=ve;var _t=t(qe);{var Ze=_=>{Ra(_,{size:14,class:""})},yt=_=>{var h=bt(),K=Se(h);{var ue=pt=>{Ba(pt,{size:14})},Te=pt=>{Ja(pt,{size:14})};M(K,pt=>{s.entity.acted?pt(ue):pt(Te,!1)},!0)}d(_,h)};M(_t,_=>{a(ne)?_(Ze):_(yt,!1)})}e(qe),e($e);var xt=r($e,2),q=t(xt),ce=t(q),ke=t(ce),Oe=t(ke),Ge=t(Oe,!0);e(Oe);var Xe=r(Oe,2);{var B=_=>{var h=Vr(),K=t(h);e(h),p(()=>i(K,`Dif ${s.entity.difficulty??""}`)),d(_,h)};M(Xe,_=>{a(f)||_(B)})}e(ke),e(ce);var ge=r(ce,2),T=t(ge);T.__click=()=>R(F,!a(F));var re=t(T);{var be=_=>{Ir(_,{size:14})},xe=_=>{Or(_,{size:14})};M(re,_=>{a(F)?_(be):_(xe,!1)})}e(T);var fe=r(T,2);{var Ye=_=>{var h=Gr();h.__click=_e;var K=t(h);Rr(K,{size:14}),e(h),p(ue=>{De(h,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${s.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),je(h,"title",ue)},[()=>n()("session.combat_card.initiative")]),d(_,h)},Pe=_=>{var h=Qr();h.__click=()=>l()(s.entity.instanceId);var K=t(h);la(K,{size:14}),e(h),d(_,h)};M(fe,_=>{a(f)?_(Ye):_(Pe,!1)})}e(ge),e(q);var Qe=r(q,2),vt=t(Qe),j=r(vt,2);{var S=_=>{var h=Jr();p(()=>{De(h,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10
                            ${a(ne)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(pe)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(ee)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),Ya(h,`width: ${a(pe)??""}%`)}),d(_,h)};M(j,_=>{a(pe)>0&&_(S)})}var Y=r(j,2);{var Fe=_=>{var h=Zr();d(_,h)};M(Y,_=>{a(W)===0&&_(Fe)})}var et=r(Y,2);{var Je=_=>{var h=Xr(),K=t(h),ue=t(K,!0);e(K),e(h),p(Te=>i(ue,Te),[()=>n()("session.combat_card.incapacitated")]),d(_,h)},Ke=_=>{var h=bt(),K=Se(h);{var ue=Te=>{var pt=Yr(),o=t(pt),v=t(o,!0);e(o),e(pt),p(u=>i(v,u),[()=>n()("session.combat_card.injured")]),d(Te,pt)};M(K,Te=>{a(ee)&&Te(ue)},!0)}d(_,h)};M(et,_=>{a(ne)?_(Je):_(Ke,!1)})}e(Qe);var Ot=r(Qe,2),$t=t(Ot),Ct=t($t),Rt=t(Ct),Et=t(Rt,!0);e(Rt);var jt=r(Rt,2),Nt=t(jt,!0);e(jt),e(Ct);var ct=r(Ct,2),kt=t(ct),st=t(kt,!0);e(kt);var mt=r(kt,2);St(mt),mt.__input=He,Gt(2),e(ct);var Ne=r(ct,2),it=t(Ne),Tt=t(it,!0);e(it);var wt=r(it,2),ft=t(wt);St(ft),ft.__input=rt;var Mt=r(ft,2),Dt=t(Mt);e(Mt),e(wt),e(Ne);var Ft=r(Ne,2);{var Lt=_=>{var h=Kr(),K=t(h),ue=t(K,!0);e(K);var Te=r(K,2),pt=t(Te,!0);e(Te),e(h),p(o=>{i(ue,o),i(pt,s.entity.perception||10)},[()=>n()("sofdl.attributes.perception")]),d(_,h)};M(Ft,_=>{a(E)&&_(Lt)})}e($t);var aa=r($t,2),Qt=t(aa);Ue(Qt,17,()=>s.entity.afflictions||[],ut,(_,h)=>{var K=es();K.__click=()=>Me(a(h));var ue=t(K),Te=r(ue);la(Te,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(K),p(()=>i(ue,`${a(h)??""} `)),d(_,K)});var Vt=r(Qt,2);Vt.__click=()=>R(me,!0);var ra=t(Vt);Xt(ra,{size:10});var na=r(ra);e(Vt),e(aa),e(Ot),e(xt),e(Re),e(ye);var Jt=r(ye,2);{var va=_=>{var h=os(),K=t(h),ue=t(K),Te=t(ue),pt=t(Te,!0);e(Te),Gt(2),e(ue);var o=r(ue,2);Ue(o,21,()=>a(E)?["strength","agility","intellect","will"]:["str","agi","int","wil"],ut,(k,C)=>{const H=Z(()=>a(E)?s.entity.attributes?.[a(C)]??10:s.entity.stats?.[a(C)]??s.entity.attributes?.[a(C)]??10),V=Z(()=>a(H)-10);var ie=ts(),te=t(ie),Ie=t(te,!0);e(te);var ze=r(te,2),nt=t(ze,!0);e(ze);var Le=r(ze,2),tt=t(Le);e(Le),e(ie),p(at=>{i(Ie,at),i(nt,a(H)),De(Le,1,`text-[9px] font-bold ${a(V)>=0?"text-emerald-500":"text-red-500"}`),i(tt,`${a(V)>=0?"+":""}${a(V)??""}`)},[()=>a(E)?a(C).slice(0,3):a(C)]),d(k,ie)}),e(o),e(K);var v=r(K,2);{var u=k=>{var C=as(),H=t(C),V=t(H),ie=t(V),te=t(ie,!0);e(ie);var Ie=r(ie,2),ze=t(Ie,!0);e(Ie),e(V);var nt=r(V,2);vr(nt,{size:20,class:"text-purple-500/30 group-hover/ins:text-purple-500 transition-colors"}),e(H);var Le=r(H,2),tt=t(Le),at=t(tt),Ce=t(at,!0);e(at);var Ee=r(at,2),gt=t(Ee,!0);e(Ee),e(tt);var lt=r(tt,2);Ra(lt,{size:20,class:"text-red-500/30 group-hover/cor:text-red-500 transition-colors"}),e(Le),e(C),p((It,zt)=>{i(te,It),i(ze,s.entity.insanity||0),i(Ce,zt),i(gt,s.entity.corruption||0)},[()=>n()("sofdl.attributes.insanity"),()=>n()("sofdl.attributes.corruption")]),d(k,C)};M(v,k=>{a(E)&&k(u)})}var y=r(v,2),U=t(y),P=t(U),c=t(P,!0);e(P);var m=r(P,2),g=t(m,!0);e(m),e(U);var $=r(U,2),L=t($),I=t(L,!0);e(L);var D=r(L,2),J=t(D,!0);e(D),e($),e(y);var se=r(y,2),w=t(se);{var A=k=>{var C=ss(),H=t(C),V=t(H);Gt(),e(H);var ie=r(H,2);Ue(ie,21,()=>s.entity.senses,ut,(te,Ie)=>{const ze=Z(()=>{const[tt,at]=a(Ie).split(":");return{key:tt,val:at}}),nt=Z(()=>n()(`character.senses.list.${a(ze).key}`)+(a(ze).val?` ${a(ze).val}`:"")),Le=Z(()=>n()(`character.senses.descriptions.${a(ze).key}`));cr(te,{get text(){return a(Le)},class:"text-xs bg-emerald-950/30 text-emerald-200 px-3 py-1.5 rounded border border-emerald-900/50 font-bold flex items-center gap-2 cursor-help whitespace-nowrap",children:(tt,at)=>{var Ce=rs(),Ee=Se(Ce);Ha(Ee,{size:12,class:"text-emerald-500 flex-shrink-0"});var gt=r(Ee);p(()=>i(gt,` ${a(nt)??""}`)),d(tt,Ce)},$$slots:{default:!0}})}),e(ie),e(C),p(te=>i(V,`${te??""} `),[()=>n()("character.senses.title")]),d(k,C)};M(w,k=>{s.entity.senses&&s.entity.senses.length>0&&k(A)})}var G=r(w,2);Ue(G,16,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],ut,(k,C)=>{var H=bt(),V=Se(H);{var ie=te=>{var Ie=ns(),ze=t(Ie),nt=t(ze);Gt(),e(ze);var Le=r(ze,2);Ue(Le,21,()=>s.entity[C.key],ut,(tt,at)=>{var Ce=is(),Ee=t(Ce),gt=t(Ee,!0);e(Ee);var lt=r(Ee,2),It=t(lt,!0);e(lt),e(Ce),p(()=>{i(gt,a(at).name),i(It,a(at).description||a(at).effect)}),d(tt,Ce)}),e(Le),e(Ie),p(()=>{De(ze,1,`${C.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),i(nt,`${C.label??""} `)}),d(te,Ie)};M(V,te=>{s.entity[C.key]&&s.entity[C.key].length>0&&te(ie)})}d(k,H)}),e(se),e(h),p((k,C,H)=>{i(pt,k),i(c,C),i(g,s.entity.size||1),i(I,H),i(J,s.entity.speed||10)},[()=>n()("session.combat_card.attributes"),()=>n()("session.combat_card.size"),()=>n()("session.combat_card.speed")]),d(_,h)};M(Jt,_=>{a(F)&&_(va)})}var ca=r(Jt,2);{let _=Z(()=>s.entity.afflictions||[]);qr(ca,{get isOpen(){return a(me)},onClose:()=>R(me,!1),get afflictions(){return a(_)},onToggle:Me})}e(we),p((_,h,K,ue,Te)=>{De(we,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(f)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),De(We,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(ne)?"border-red-600 grayscale brightness-50":a(f)?"border-indigo-500/50":"border-red-900/50"}`),De(qe,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${s.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(f)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),je(qe,"title",_),De(Oe,1,`text-base font-bold truncate leading-snug ${a(f)?"text-white":"text-red-100 font-serif tracking-wide"}`),i(Ge,s.entity.name),De(vt,1,`absolute inset-0 w-full ${a(W)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),i(Et,h),i(Nt,s.entity.defense||10),i(st,K),ya(mt,a(W)),De(Ne,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(ne)?"bg-red-950/50 border-red-500":a(ee)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),De(it,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(ne)?"text-red-400":a(ee)?"text-orange-400":"text-emerald-400"}`),i(Tt,ue),ya(ft,a(de)),i(Dt,`/${a(le)??""}`),i(na,` ${Te??""}`)},[()=>s.entity.acted?n()("session.combat_card.acted"):n()("session.combat_card.act"),()=>n()("session.combat_card.defense"),()=>n()("session.combat_card.damage"),()=>n()("session.combat_card.health"),()=>n()("session.combat_card.add_affliction")]),d(N,we),Kt(),z()}ea(["click","input"]);function vs(N,{from:s,to:n},x={}){var{delay:z=0,duration:Q=_e=>Math.sqrt(_e)*120,easing:O=wr}=x,l=getComputedStyle(N),f=l.transform==="none"?"":l.transform,[E,W]=l.transformOrigin.split(" ").map(parseFloat);E/=N.clientWidth,W/=N.clientHeight;var le=cs(N),de=N.clientWidth/n.width/le,ne=N.clientHeight/n.height/le,ee=s.left+s.width*E,pe=s.top+s.height*W,F=n.left+n.width*E,me=n.top+n.height*W,X=(ee-F)*de,He=(pe-me)*ne,rt=s.width/n.width,ve=s.height/n.height;return{delay:z,duration:typeof Q=="function"?Q(Math.sqrt(X*X+He*He)):Q,easing:O,css:(_e,Me)=>{var we=Me*X,Ae=Me*He,ae=_e+Me*rt,he=_e+Me*ve;return`transform: ${f} translate(${we}px, ${Ae}px) scale(${ae}, ${he});`}}}function cs(N){if("currentCSSZoom"in N)return N.currentCSSZoom;for(var s=N,n=1;s!==null;)n*=+getComputedStyle(s).zoom,s=s.parentElement;return n}function us(N,s=1,n=0){const x=[];let z=0;for(let f=0;f<s;f++){const E=Math.floor(Math.random()*N)+1;x.push(E),z+=E}let Q=`${s}d${N}`,O=[],l=0;if(n!==0)if(N===20){const f=Math.abs(n);for(let W=0;W<f;W++)O.push(Math.floor(Math.random()*6)+1);const E=Math.max(...O);n>0?(l=E,z+=E,Q+=` + ${E} [Boon]`):(l=-E,z-=E,Q+=` - ${E} [Bane]`)}else l=n,z+=n,Q+=n>0?` + ${n}`:` - ${Math.abs(n)}`;return{total:z,results:x,bonusRolls:O,formula:Q,crit:N===20&&x.includes(20),modifierTotal:l}}function bs(N,s,n){const x=n.map(f=>({...f,type:"enemy"}));if(N==="standard"){const f=s.filter(de=>de.initiative).map(de=>({...de,type:"player",isFast:!0})),E=s.filter(de=>!de.initiative).map(de=>({...de,type:"player",isFast:!1})),W=x.filter(de=>de.initiative).map(de=>({...de,isFast:!0})),le=x.filter(de=>!de.initiative).map(de=>({...de,isFast:!1}));return[...f,...W,...E,...le]}if(N==="individual")return[...s.map(E=>({...E,type:"player",totalInit:(E.initiativeRoll||0)+(E.attributes?.agility||10)-10})),...x.map(E=>({...E,type:"enemy",totalInit:(E.initiativeRoll||0)+(E.attributes?.agility||10)-10}))].sort((E,W)=>W.totalInit-E.totalInit);const z=s.filter(f=>f&&f.initiative).map(f=>({...f,type:"player"})),Q=s.filter(f=>f&&!f.initiative).map(f=>({...f,type:"player"})),O=[...z,...x,...Q],l=new Set;return O.filter(f=>{if(!f)return!1;const E=f.type==="player"?f.id:f.instanceId;return l.has(E)?!1:(l.add(E),!0)})}var xs=b('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),ms=b('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),_s=b('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),fs=b('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),ps=b('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),gs=b('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),hs=b('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),ys=b('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),ws=b('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),ks=b('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),zs=b('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all"><div class="truncate flex-1 flex items-center gap-2"><!> <div><div class="text-sm font-bold text-white truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800"><!></button></div>'),$s=b('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Cs=b("<!> <!>",1),Es=b('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800"><!></button></div>'),js=b('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Ms=b("<!> <!>",1),Os=b('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),Is=b('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),Ss=b("<div><!></div>"),Rs=b('<div class="text-center text-slate-500 italic py-10"> </div>'),Ns=b('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),Ts=b('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),Ds=b('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),As=b('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),Ps=b('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),Hs=b('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Fs=b('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col h-[400px]"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"></div></div> <!> <!> <!> <!>',1);function Ls(N,s){Yt(s,!0);const n=()=>dt(ir,"$liveCharacters",l),x=()=>dt(Ht,"$t",l),z=()=>dt($a,"$liveEnemies",l),Q=()=>dt(Ta,"$liveEncounters",l),O=()=>dt(ia,"$isHistoryOpen",l),[l,f]=ta();let E=Be(!1),W=Be(!1),le=Be(!1);const de={active:!1,round:1};let ne=Be("enemies"),ee=Be(!1),pe=Be(Zt([])),F=Be(Zt({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));Ea(()=>{if(s.campaign?.id){er(s.campaign.id,!0);const o=ha(Ht)("common.labels.master");Ma.update(u=>({...u,campaignId:s.campaign.id,name:s.campaign.gmName||o}));const v=setInterval(()=>{const u=ht.get(s.campaign.id)||s.campaign,y=ha(Ht)("common.labels.master");wa(s.campaign.id,{name:u.name,gmName:u.gmName||y})},3e4);return()=>{clearInterval(v),tr(),Ma.update(u=>({...u,campaignId:null}))}}});const me=Z(()=>typeof window<"u"?`${window.location.origin}${Pa("/campaigns/[id]/invite",{id:s.campaign?.id})}`:"");function X(){a(me)&&(navigator.clipboard.writeText(a(me)),R(W,!0),setTimeout(()=>{R(W,!1)},2e3))}let He=Z(()=>s.campaign?.sessionRoster||[]),rt=Z(()=>s.campaign?.combat||de),ve=Z(()=>s.campaign?.activeEnemies||[]),_e=Z(()=>s.campaign?.members||[]),Me=Z(()=>s.campaign?.initiativeStyle||"dle"),we=Z(()=>Array.from(new Set([...a(He),...a(_e).map(v=>v.id)])).map(v=>{const u=n().find(U=>U.id===v),y=a(_e).find(U=>U.id===v);return u&&y?{...u,...y,lastUpdate:y.lastUpdate}:u||y}).filter(Boolean)),Ae=Z(()=>a(we).filter(o=>!o.campaignApproval||o.campaignApproval==="approved")),ae=Z(()=>a(we).filter(o=>o.campaignApproval==="pending")),he=Z(()=>n().filter(o=>!a(He).includes(o.id)&&!a(_e).some(v=>v.id===o.id)&&(o.system||Ia)===(s.campaign?.system||Ia)));function oe(o){if(!s.campaign?.id)return;const u={...ht.get(s.campaign.id)||s.campaign,...o};ht.set(s.campaign.id,u),o.combat&&ma(s.campaign.id,o.combat),(o.name||o.gmName)&&wa(s.campaign.id,{name:u.name,gmName:u.gmName})}function ye(o){if(a(He).includes(o)){const v=a(He).filter(u=>u!==o);oe({sessionRoster:v})}else{const v=[...a(He),o];oe({sessionRoster:v})}}function Re(o){B(o,{campaignApproval:"approved"}),_a({id:o,campaignApproval:"approved"})}function $e(o){_a({id:o,campaignApproval:"rejected",campaignId:null});const u=((ht.get(s.campaign.id)||s.campaign).members||[]).filter(y=>y.id!==o);oe({members:u})}function We(o){const v=a(we).find(u=>u.id===o);R(F,{isOpen:!0,title:x()("session.players.remove_title"),message:x()("session.players.remove_message",{values:{name:v?.name||"este personagem"}}),onConfirm:()=>{const u=ht.get(s.campaign.id)||s.campaign;_a({id:o,campaignId:null});const y=(u.sessionRoster||[]).filter(c=>c!==o),U=(u.members||[]).filter(c=>c.id!==o),P=(u.activeEnemies||[]).filter(c=>c.type!=="player"||c.id!==o);oe({sessionRoster:y,members:U,activeEnemies:P}),a(F).isOpen=!1}},!0)}function Ve(o){const u=(ht.get(s.campaign.id)||s.campaign).activeEnemies||[],y={...o,instanceId:xa(),damage:0,currentHealth:o.health,afflictions:[],acted:!1,initiative:!1};oe({activeEnemies:[...u,y]})}function qe(o){const u=(ht.get(s.campaign.id)||s.campaign).activeEnemies||[];let y=[];o.enemies.forEach(U=>{const P=z().find(c=>c.id===U.enemyId);if(P)for(let c=0;c<U.count;c++)y.push({...P,instanceId:xa(),damage:0,currentHealth:P.health,afflictions:[],acted:!1,initiative:!1})}),oe({activeEnemies:[...u,...y]})}function _t(){oe({combat:{active:!0,round:1}}),ma(s.campaign.id,{active:!0,round:1})}function Ze(){const o=a(ve).filter(v=>v.damage<(v.currentHealth??v.health)&&v.endOfRound&&v.endOfRound.length>0).map(v=>({name:v.name,effects:v.endOfRound}));if(o.length>0){R(pe,o,!0),R(ee,!0);return}yt()}function yt(){const o=ht.get(s.campaign.id)||s.campaign,v=(o.combat?.round||1)+1,u=(o.activeEnemies||[]).map(y=>({...y,acted:!1}));oe({combat:{...o.combat,round:v},activeEnemies:u}),ma(s.campaign.id,{active:!0,round:v}),R(ee,!1)}function xt(o){oe({combat:{active:!1,round:1}}),ma(s.campaign.id,{active:!1,round:1})}function q(o){const v=ht.get(s.campaign.id)||s.campaign;oe({activeEnemies:(v.activeEnemies||[]).filter(u=>u.instanceId!==o)})}function ce(o,v){const u=ht.get(s.campaign.id)||s.campaign;oe({activeEnemies:(u.activeEnemies||[]).map(y=>y.instanceId===o?{...y,...v}:y)})}function ke(){const o=ht.get(s.campaign.id)||s.campaign,v=o.combat?.round||1;v>1&&oe({combat:{...o.combat,round:v-1}})}let Oe=Be(Zt(Date.now()));Ea(()=>{const o=setInterval(()=>{R(Oe,Date.now(),!0)},1e4);return()=>clearInterval(o)});let Ge=Z(()=>(()=>{const o=a(Ae).filter(v=>a(He).includes(v.id));return bs(a(Me),o,a(ve))})());function Xe(o){return o.lastUpdate?a(Oe)-o.lastUpdate<6e4:!1}function B(o,v){const u=ht.get(s.campaign.id)||s.campaign,y=u.members||[],U=y.findIndex($=>$.id===o);let P=y;U!==-1&&(P=[...y],P[U]={...P[U],...v});const c=u.activeEnemies||[],m=c.findIndex($=>$.id===o&&$.type==="player");let g=c;m!==-1&&(g=[...c],g[m]={...g[m],...v}),oe({members:P,activeEnemies:g})}var ge=Fs(),T=Se(ge),re=t(T),be=t(re),xe=t(be),fe=t(xe),Ye=t(fe);Da(Ye,{size:14,class:"text-indigo-500"});var Pe=r(Ye),Qe=r(Pe);{var vt=o=>{var v=xs(),u=t(v,!0);e(v),p(()=>i(u,a(Ae).length)),d(o,v)};M(Qe,o=>{a(Ae).length>0&&o(vt)})}e(fe);var j=r(fe,2);j.__click=()=>R(E,!a(E));var S=t(j,!0);e(j),e(xe);var Y=r(xe,2);{var Fe=o=>{var v=_s(),u=t(v),y=r(t(u),2),U=t(y);e(y),e(u);var P=r(u,2);Ue(P,17,()=>a(ae),c=>c.id,(c,m)=>{var g=ms(),$=t(g),L=t($),I=t(L,!0);e(L);var D=r(L,2),J=t(D,!0);e(D),e($);var se=r($,2),w=t(se);w.__click=()=>Re(a(m).id);var A=t(w);Sa(A,{size:14}),e(w);var G=r(w,2);G.__click=()=>$e(a(m).id);var k=t(G);da(k,{size:14}),e(G),e(se),e(g),p(C=>{i(I,a(m).name),i(J,C)},[()=>x()("session.players.new_request")]),d(c,g)}),Gt(2),e(v),p(c=>i(U,`${c??""} (${a(ae).length??""})`),[()=>x()("session.players.waiting_approval")]),d(o,v)};M(Y,o=>{a(ae).length>0&&o(Fe)})}var et=r(Y,2),Je=t(et),Ke=t(Je);Ue(Ke,17,()=>a(Ae),o=>o.id,(o,v)=>{const u=Z(()=>Xe(a(v))),y=Z(()=>a(He).includes(a(v).id));var U=ps(),P=t(U),c=r(P,2),m=t(c),g=t(m,!0);e(m);var $=r(m,2),L=t($);{var I=H=>{var V=fs(),ie=t(V,!0);e(V),p(te=>i(ie,te),[()=>x()("common.labels.session")]),d(H,V)};M(L,H=>{a(y)&&H(I)})}var D=r(L);e($),e(c);var J=r(c,2),se=t(J);se.__click=()=>ye(a(v).id);var w=t(se);{var A=H=>{ur(H,{size:14})},G=H=>{Xt(H,{size:14})};M(w,H=>{a(y)?H(A):H(G,!1)})}e(se);var k=r(se,2);k.__click=()=>We(a(v).id);var C=t(k);da(C,{size:14}),e(k),e(J),e(U),p((H,V,ie)=>{De(U,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(u)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(u)||a(y)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),De(P,1,`w-2 h-2 rounded-full ${a(u)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),De(m,1,`font-bold text-sm ${a(u)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),i(g,a(v).name),i(D,` ${H??""} ${a(v).level??""} • ${a(v).ancestry??""}`),De(se,1,`p-1.5 rounded-lg transition-all ${a(y)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),je(se,"title",V),je(k,"title",ie)},[()=>x()("common.labels.level"),()=>a(y)?x()("session.players.remove_from_session"):x()("session.players.add_to_session"),()=>x()("session.players.kick_from_campaign")]),d(o,U)});var Ot=r(Ke,2);{var $t=o=>{var v=gs(),u=t(v,!0);e(v),p(y=>i(u,y),[()=>x()("session.players.none")]),d(o,v)};M(Ot,o=>{a(Ae).length===0&&o($t)})}e(Je),e(et);var Ct=r(et,2),Rt=t(Ct);{var Et=o=>{var v=hs(),u=Se(v);u.__click=()=>oe({isPublished:!0});var y=t(u);zr(y,{size:14});var U=r(y);e(u);var P=r(u,2),c=t(P,!0);e(P),p((m,g)=>{i(U,` ${m??""}`),i(c,g)},[()=>x()("session.publish.publish_session"),()=>x()("session.publish.make_visible")]),d(o,v)},jt=o=>{var v=ks(),u=Se(v),y=t(u),U=t(y),P=t(U);Aa(P,{size:10,class:"animate-pulse"});var c=r(P);e(U),e(y);var m=r(y,2);m.__click=()=>R(le,!a(le));var g=t(m);Tr(g,{size:14}),e(m),e(u);var $=r(u,2);{var L=V=>{var ie=ys(),te=t(ie);e(ie),p((Ie,ze)=>{je(te,"src",Ie),je(te,"alt",ze)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(me))}`,()=>x()("session.publish.qr_alt")]),d(V,ie)};M($,V=>{a(le)&&V(L)})}var I=r($,2),D=t(I),J=t(D);J.__click=X;var se=t(J,!0);e(J);var w=r(J,2);w.__click=X;var A=t(w);{var G=V=>{var ie=ws(),te=t(ie);Sa(te,{size:10,class:"inline mr-1"});var Ie=r(te);e(ie),p(ze=>i(Ie,` ${ze??""}`),[()=>x()("common.buttons.copied")]),d(V,ie)};M(A,V=>{a(W)&&V(G)})}var k=r(A,2);Sr(k,{size:14}),e(w),e(D),e(I);var C=r(I,2);C.__click=()=>oe({isPublished:!1});var H=t(C,!0);e(C),p((V,ie,te,Ie)=>{i(c,` ${V??""}`),je(m,"title",ie),i(se,a(me)),je(w,"aria-label",te),i(H,Ie)},[()=>x()("session.publish.public_session"),()=>x()("session.publish.qr_code"),()=>x()("session.publish.copy_link"),()=>x()("session.publish.remove_public")]),d(o,v)};M(Rt,o=>{s.campaign?.isPublished?o(jt,!1):o(Et)})}e(Ct),e(be);var Nt=r(be,2),ct=t(Nt),kt=t(ct);kt.__click=()=>R(ne,"enemies");var st=t(kt);fa(st,{size:14});var mt=r(st);e(kt);var Ne=r(kt,2);Ne.__click=()=>R(ne,"encounters");var it=t(Ne);Va(it,{size:14});var Tt=r(it);e(Ne),e(ct);var wt=r(ct,2),ft=t(wt);{var Mt=o=>{var v=Cs(),u=Se(v);Ue(u,1,z,P=>P.id,(P,c)=>{var m=zs(),g=t(m),$=t(g);Nr($,{size:12,class:"text-slate-600 cursor-grab"});var L=r($,2),I=t(L),D=t(I,!0);e(I);var J=r(I,2),se=t(J);e(J),e(L),e(g);var w=r(g,2);w.__click=()=>Ve(a(c));var A=t(w);Xt(A,{size:16}),e(w),e(m),p(G=>{i(D,a(c).name),i(se,`${G??""} ${a(c).difficulty??""}`)},[()=>x()("session.enemies.difficulty")]),d(P,m)});var y=r(u,2);{var U=P=>{var c=$s(),m=t(c,!0);e(c),p(g=>i(m,g),[()=>x()("session.enemies.none")]),d(P,c)};M(y,P=>{z().length===0&&P(U)})}d(o,v)},Dt=o=>{var v=Ms(),u=Se(v);Ue(u,1,Q,P=>P.id,(P,c)=>{var m=Es(),g=t(m),$=t(g),L=t($,!0);e($);var I=r($,2),D=t(I);e(I),e(g);var J=r(g,2);J.__click=()=>qe(a(c));var se=t(J);Wa(se,{size:14}),e(J),e(m),p((w,A)=>{i(L,a(c).name),i(D,`${w??""} ${A??""}`)},[()=>a(c).enemies?.reduce((w,A)=>w+A.count,0)||0,()=>x()("session.enemies.title")]),d(P,m)});var y=r(u,2);{var U=P=>{var c=js(),m=t(c,!0);e(c),p(g=>i(m,g),[()=>x()("session.enemies.no_encounters")]),d(P,c)};M(y,P=>{Q().length===0&&P(U)})}d(o,v)};M(ft,o=>{a(ne)==="enemies"?o(Mt):o(Dt,!1)})}e(wt),e(Nt),e(re);var Ft=r(re,2),Lt=t(Ft),aa=t(Lt),Qt=t(aa);{var Vt=o=>{var v=Os();v.__click=_t;var u=t(v);Ja(u,{size:20});var y=r(u);e(v),p(U=>i(y,` ${U??""}`),[()=>x()("session.combat.start")]),d(o,v)},ra=o=>{var v=Is(),u=t(v);u.__click=ke;var y=t(u);La(y,{size:20}),e(u);var U=r(u,2),P=t(U),c=t(P,!0);e(P);var m=r(P),g=t(m,!0);e(m),e(U);var $=r(U,2);$.__click=Ze;var L=t($);br(L,{size:16});var I=r(L);e($);var D=r($,4);D.__click=()=>xt();var J=t(D,!0);e(D),e(v),p((se,w,A,G,k)=>{je(u,"title",se),i(c,w),i(g,a(rt).round),je($,"title",A),i(I,` ${G??""}`),i(J,k)},[()=>x()("session.combat.previous"),()=>x()("session.combat.round"),()=>x()("session.combat.next"),()=>x()("session.combat.next"),()=>x()("session.combat.end")]),d(o,v)};M(Qt,o=>{a(rt).active?o(ra,!1):o(Vt)})}e(aa),e(Lt);var na=r(Lt,2),Jt=t(na);Ue(Jt,25,()=>a(Ge),o=>o.type==="player"?o.id:o.instanceId,(o,v)=>{var u=Ss(),y=t(u);ds(y,{get entity(){return a(v)},updateEnemy:ce,removeFromCombat:q,updatePlayer:B}),e(u),or(u,()=>vs,()=>({duration:300})),d(o,u)});var va=r(Jt,2);{var ca=o=>{var v=Rs(),u=t(v,!0);e(v),p(y=>i(u,y),[()=>x()("session.combat.empty")]),d(o,v)};M(va,o=>{a(Ge).length===0&&o(ca)})}e(na),e(Ft),Gt(2),e(T);var _=r(T,2);{var h=o=>{var v=Ds();v.__click=G=>{G.target===G.currentTarget&&R(ee,!1)};var u=t(v),y=t(u),U=t(y),P=t(U);xr(P,{size:24}),e(U);var c=r(U,2),m=t(c),g=t(m,!0);e(m);var $=r(m,2),L=t($,!0);e($),e(c),e(y);var I=r(y,2);Ue(I,21,()=>a(pe),ut,(G,k)=>{var C=Ts(),H=t(C),V=t(H);fa(V,{size:14,class:"text-slate-500"});var ie=r(V);e(H);var te=r(H,2);Ue(te,21,()=>a(k).effects,ut,(Ie,ze)=>{var nt=Ns(),Le=t(nt),tt=t(Le);e(Le);var at=r(Le,2),Ce=t(at,!0);e(at),e(nt),p(()=>{i(tt,`${a(ze).name??""}:`),i(Ce,a(ze).desc)}),d(Ie,nt)}),e(te),e(C),p(()=>i(ie,` ${a(k).name??""}`)),d(G,C)}),e(I);var D=r(I,2),J=t(D);J.__click=()=>R(ee,!1);var se=t(J,!0);e(J);var w=r(J,2);w.__click=yt;var A=t(w,!0);e(w),e(D),e(u),e(v),p((G,k,C,H)=>{i(g,G),i(L,k),i(se,C),i(A,H)},[()=>x()("session.end_of_round.title"),()=>x()("session.end_of_round.summary"),()=>x()("common.buttons.cancel"),()=>x()("session.end_of_round.advance")]),d(o,v)};M(_,o=>{a(ee)&&o(h)})}var K=r(_,2);{var ue=o=>{var v=Hs();v.__click=w=>{w.target===w.currentTarget&&R(E,!1)};var u=t(v),y=t(u),U=t(y),P=t(U),c=t(P,!0);e(P);var m=r(P,2),g=t(m,!0);e(m),e(U);var $=r(U,2);$.__click=()=>R(E,!1);var L=t($);la(L,{size:16}),e($),e(y);var I=r(y,2),D=t(I);Ue(D,17,()=>a(he),ut,(w,A)=>{var G=As();G.__click=()=>ye(a(A).id);var k=t(G),C=t(k,!0);e(k);var H=r(k,2),V=t(H),ie=t(V,!0);e(V);var te=r(V,2),Ie=t(te);e(te),e(H);var ze=r(H,2),nt=t(ze);Xt(nt,{size:16}),e(ze),e(G),p((Le,tt)=>{i(C,Le),i(ie,a(A).name),i(Ie,`${tt??""} ${a(A).level??""} • ${a(A).ancestry??""}`)},[()=>a(A).name.charAt(0),()=>x()("common.labels.level")]),d(w,G)});var J=r(D,2);{var se=w=>{var A=Ps(),G=t(A),k=t(G);fa(k,{size:24}),e(G);var C=r(G,2),H=t(C,!0);e(C);var V=r(C,2),ie=t(V,!0);e(V),e(A),p((te,Ie)=>{i(H,te),i(ie,Ie)},[()=>x()("session.manage_session.no_available"),()=>x()("session.manage_session.all_in_session")]),d(w,A)};M(J,w=>{a(he).length===0&&w(se)})}e(I),e(u),e(v),p((w,A)=>{i(c,w),i(g,A)},[()=>x()("session.manage_session.title"),()=>x()("session.manage_session.description")]),d(o,v)};M(K,o=>{a(E)&&o(ue)})}var Te=r(K,2);Fa(Te,{get isOpen(){return O()},onClose:()=>ia.set(!1)});var pt=r(Te,2);Na(pt,{get isOpen(){return a(F).isOpen},get title(){return a(F).title},get message(){return a(F).message},get onConfirm(){return a(F).onConfirm},onCancel:()=>a(F).isOpen=!1}),p((o,v,u,y)=>{i(Pe,` ${o??""} `),i(S,v),De(kt,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(ne)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(mt,` ${u??""}`),De(Ne,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(ne)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(Tt,` ${y??""}`)},[()=>x()("session.players.title"),()=>a(E)?x()("session.players.close"):x()("session.players.add"),()=>x()("session.enemies.title"),()=>x()("session.enemies.encounters")]),d(N,ge),Kt(),f()}ea(["click"]);var Us=b('<div class="space-y-4"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-size" type="number" step="0.5" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="grid grid-cols-1"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div></div>'),qs=b('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Bs=b('<div class="space-y-6"><div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),Ws=b('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none" placeholder="Nome"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2" placeholder="Descrição..."></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Vs=b('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),Gs=b('<div><div class="flex justify-between items-center mb-3"><h4> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div>'),Qs=b('<div class="space-y-6"></div>'),Js=b('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),Zs=b('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),Xs=b('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Ys=b('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Ks=b('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),ei=b('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),ti=b('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),ai=b('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),ri=b('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),si=b('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),ii=b('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),ni=b('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),oi=b('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),li=b('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-6xl h-[90vh] border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><h3 id="modal-title" class="font-bold text-white text-lg"> </h3> <button class="lg:hidden text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50"><button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3"><button class="px-6 py-2 rounded bg-slate-800 hover:bg-slate-700 text-white font-bold transition-colors"> </button> <button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function di(N,s){Yt(s,!0);const n=()=>dt(Ht,"$t",x),[x,z]=ta();let Q=Pt(s,"isOpen",3,!1),O=Pt(s,"initialData",3,"{}"),l=Be(Zt(ee())),f=Be("stats"),E=Be(!1),W=Be(""),le=Be(void 0);function de(ve){const _e=ve.target.files;if(_e&&_e.length>0){const Me=_e[0],we=new FileReader;we.onload=()=>{R(W,we.result,!0),R(E,!0)},we.readAsDataURL(Me)}ve.target&&(ve.target.value="")}async function ne(ve){try{const _e=await _r(ve);a(l).imageUrl=_e,R(E,!1)}catch(_e){console.error(_e),alert(_e.message||"Erro ao salvar imagem")}}function ee(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}za(()=>{if(Q()&&O())try{const ve=JSON.parse(O());Object.keys(ve).length===0?R(l,ee(),!0):R(l,{...ee(),...ve},!0)}catch{R(l,ee(),!0)}});function pe(ve){a(l)[ve]=[...a(l)[ve],{name:"",desc:""}]}function F(ve,_e){a(l)[ve]=a(l)[ve].filter((Me,we)=>we!==_e)}function me(ve){}var X=bt(),He=Se(X);{var rt=ve=>{var _e=li(),Me=Se(_e);Me.__click=me;var we=t(Me),Ae=t(we),ae=t(Ae),he=t(ae),oe=t(he,!0);e(he);var ye=r(he,2);ye.__click=function(...c){s.onClose?.apply(this,c)};var Re=t(ye);la(Re,{size:20}),e(ye),e(ae);var $e=r(ae,2),We=t($e);We.__click=()=>R(f,"stats");var Ve=t(We,!0);e(We);var qe=r(We,2);qe.__click=()=>R(f,"attributes");var _t=t(qe,!0);e(qe);var Ze=r(qe,2);Ze.__click=()=>R(f,"abilities");var yt=t(Ze,!0);e(Ze),e($e);var xt=r($e,2),q=t(xt);{var ce=c=>{var m=Us(),g=t(m),$=t(g);$.__click=()=>a(le)?.click();var L=t($),I=t(L);qa(I,()=>a(l).imageUrl,ot=>{ka(ot,{get hash(){return a(l).imageUrl},get alt(){return a(l).name},size:"custom",fallbackText:"?"})}),e(L);var D=r(L,2),J=t(D);fr(J,{size:20,class:"text-white"}),e(D),e($);var se=r($,2),w=t(se),A=t(w,!0);e(w);var G=r(w,2);St(G),e(se),e(g);var k=r(g,2),C=t(k),H=t(C),V=t(H,!0);e(H);var ie=r(H);St(ie),e(C);var te=r(C,2),Ie=t(te),ze=t(Ie,!0);e(Ie);var nt=r(Ie);St(nt),e(te),e(k);var Le=r(k,2),tt=t(Le),at=t(tt,!0);e(tt);var Ce=r(tt,2);Ca(Ce),e(Le);var Ee=r(Le,2),gt=t(Ee),lt=t(gt),It=t(lt,!0);e(lt);var zt=r(lt);St(zt),e(gt),e(Ee),e(m),p((ot,sa,ua,ba,Za,Xa)=>{i(A,ot),i(V,sa),i(ze,ua),i(at,ba),je(Ce,"placeholder",Za),i(It,Xa)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.speed")]),At(G,()=>a(l).name,ot=>a(l).name=ot),At(ie,()=>a(l).difficulty,ot=>a(l).difficulty=ot),At(nt,()=>a(l).size,ot=>a(l).size=ot),At(Ce,()=>a(l).description,ot=>a(l).description=ot),At(zt,()=>a(l).speed,ot=>a(l).speed=ot),d(c,m)},ke=c=>{var m=bt(),g=Se(m);{var $=I=>{var D=Bs(),J=t(D),se=t(J),w=t(se,!0);e(se);var A=r(se,2);Ue(A,20,()=>["str","agi","int","wil"],ut,(Ce,Ee)=>{var gt=qs(),lt=t(gt),It=t(lt,!0);e(lt);var zt=r(lt,2);St(zt);var ot=r(zt,2),sa=t(ot);e(ot),e(gt),p(()=>{je(lt,"for",`attr-${Ee??""}`),i(It,Ee),je(zt,"id",`attr-${Ee??""}`),De(ot,1,`text-xs font-bold ${a(l).stats[Ee]-10>=0?"text-green-500":"text-red-500"}`),i(sa,`${a(l).stats[Ee]-10>=0?"+":""}${a(l).stats[Ee]-10}`)}),At(zt,()=>a(l).stats[Ee],ua=>a(l).stats[Ee]=ua),d(Ce,gt)}),e(A),e(J);var G=r(J,2),k=t(G),C=t(k),H=t(C,!0);e(C);var V=r(C);St(V),e(k);var ie=r(k,2),te=t(ie),Ie=t(te,!0);e(te);var ze=r(te);St(ze),e(ie);var nt=r(ie,2),Le=t(nt),tt=t(Le,!0);e(Le);var at=r(Le);St(at),e(nt),e(G),e(D),p((Ce,Ee,gt,lt,It,zt,ot)=>{i(w,Ce),i(H,Ee),je(V,"placeholder",gt),i(Ie,lt),je(ze,"placeholder",It),i(tt,zt),je(at,"placeholder",ot)},[()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder"),()=>n()("session.enemy_modal.languages"),()=>n()("session.enemy_modal.languages_placeholder"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder")]),At(V,()=>a(l).senses,Ce=>a(l).senses=Ce),At(ze,()=>a(l).languages,Ce=>a(l).languages=Ce),At(at,()=>a(l).immune,Ce=>a(l).immune=Ce),d(I,D)},L=I=>{var D=bt(),J=Se(D);{var se=w=>{var A=Qs();Ue(A,20,()=>[{key:"traits",title:"Traços (Traits)",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",title:"Ações",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",title:"Reações",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",title:"Fim da Rodada",color:"text-yellow-400",border:"border-yellow-500/30"}],ut,(G,k)=>{var C=Gs(),H=t(C),V=t(H),ie=t(V,!0);e(V);var te=r(V,2);te.__click=()=>pe(k.key);var Ie=t(te);Xt(Ie,{size:12});var ze=r(Ie);e(te),e(H);var nt=r(H,2),Le=t(nt);Ue(Le,17,()=>a(l)[k.key],ut,(Ce,Ee,gt)=>{var lt=Ws(),It=t(lt),zt=t(It);St(zt);var ot=r(zt,2);Ca(ot),e(It);var sa=r(It,2);sa.__click=()=>F(k.key,gt);var ua=t(sa);da(ua,{size:16}),e(sa),e(lt),At(zt,()=>a(Ee).name,ba=>a(Ee).name=ba),At(ot,()=>a(Ee).desc,ba=>a(Ee).desc=ba),d(Ce,lt)});var tt=r(Le,2);{var at=Ce=>{var Ee=Vs(),gt=t(Ee,!0);e(Ee),p(lt=>i(gt,lt),[()=>n()("session.enemy_modal.empty")]),d(Ce,Ee)};M(tt,Ce=>{a(l)[k.key].length===0&&Ce(at)})}e(nt),e(C),p(Ce=>{De(C,1,`p-4 bg-slate-900 rounded border ${k.border??""}`),De(V,1,`font-bold text-sm uppercase ${k.color??""}`),i(ie,k.title),i(ze,` ${Ce??""}`)},[()=>n()("session.enemy_modal.add")]),d(G,C)}),e(A),d(w,A)};M(J,w=>{a(f)==="abilities"&&w(se)},!0)}d(I,D)};M(g,I=>{a(f)==="attributes"?I($):I(L,!1)},!0)}d(c,m)};M(q,c=>{a(f)==="stats"?c(ce):c(ke,!1)})}e(xt);var Oe=r(xt,2),Ge=t(Oe);Ge.__click=function(...c){s.onClose?.apply(this,c)};var Xe=t(Ge,!0);e(Ge);var B=r(Ge,2);B.__click=()=>s.onSave(a(l));var ge=t(B);Qa(ge,{size:18});var T=r(ge);e(B),e(Oe),e(Ae);var re=r(Ae,2),be=t(re),xe=t(be),fe=t(xe);Ha(fe,{size:14});var Ye=r(fe);e(xe),e(be);var Pe=r(be,2),Qe=t(Pe),vt=t(Qe),j=t(vt);e(vt);var S=r(vt,2),Y=t(S);{var Fe=c=>{var m=Js(),g=t(m);ka(g,{get hash(){return a(l).imageUrl},get alt(){return a(l).name},size:"custom"}),e(m),d(c,m)};M(Y,c=>{a(l).imageUrl&&c(Fe)})}var et=r(Y,2),Je=t(et),Ke=t(Je,!0);e(Je),Gt(2),e(et),e(S);var Ot=r(S,2),$t=t(Ot),Ct=t($t),Rt=t(Ct,!0);e(Ct);var Et=r(Ct,2),jt=t(Et,!0);e(Et),e($t);var Nt=r($t,2),ct=t(Nt),kt=t(ct,!0);e(ct);var st=r(ct,2),mt=t(st,!0);e(st),e(Nt);var Ne=r(Nt,2),it=t(Ne),Tt=t(it,!0);e(it);var wt=r(it,2),ft=t(wt,!0);e(wt),e(Ne);var Mt=r(Ne,2),Dt=t(Mt),Ft=t(Dt,!0);e(Dt);var Lt=r(Dt,2),aa=t(Lt,!0);e(Lt),e(Mt),e(Ot);var Qt=r(Ot,2);Ue(Qt,20,()=>["str","agi","int","wil"],ut,(c,m)=>{var g=Zs(),$=t(g),L=t($,!0);e($);var I=r($,2),D=t(I),J=r(D),se=t(J);e(J),e(I),e(g),p(()=>{i(L,m),i(D,`${a(l).stats[m]??""} `),De(J,1,`text-xs ${a(l).stats[m]-10>=0?"text-green-500":"text-red-500"}`),i(se,`(${a(l).stats[m]-10>=0?"+":""}${a(l).stats[m]-10})`)}),d(c,g)}),e(Qt);var Vt=r(Qt,2),ra=t(Vt);{var na=c=>{var m=Xs(),g=t(m),$=t(g);e(g);var L=r(g,2),I=t(L,!0);e(L),e(m),p(D=>{i($,`${D??""}:`),i(I,a(l).senses)},[()=>n()("session.enemy_modal.senses")]),d(c,m)};M(ra,c=>{a(l).senses&&c(na)})}var Jt=r(ra,2);{var va=c=>{var m=Ys(),g=t(m),$=t(g);e(g);var L=r(g,2),I=t(L,!0);e(L),e(m),p(D=>{i($,`${D??""}:`),i(I,a(l).languages)},[()=>n()("session.enemy_modal.languages")]),d(c,m)};M(Jt,c=>{a(l).languages&&c(va)})}var ca=r(Jt,2);{var _=c=>{var m=Ks(),g=t(m),$=t(g);e(g);var L=r(g,2),I=t(L,!0);e(L),e(m),p(D=>{i($,`${D??""}:`),i(I,a(l).immune)},[()=>n()("session.enemy_modal.immunities")]),d(c,m)};M(ca,c=>{a(l).immune&&c(_)})}e(Vt);var h=r(Vt,2),K=t(h);{var ue=c=>{var m=ti(),g=t(m),$=t(g,!0);e(g);var L=r(g,2);Ue(L,17,()=>a(l).traits,ut,(I,D,J,se)=>{var w=ei(),A=t(w),G=t(A);e(A);var k=r(A,2),C=t(k,!0);e(k),e(w),p(()=>{i(G,`${a(D).name??""}:`),i(C,a(D).desc)}),d(I,w)}),e(m),p(I=>i($,I),[()=>n()("session.enemy_modal.traits")]),d(c,m)};M(K,c=>{a(l).traits.length>0&&c(ue)})}var Te=r(K,2);{var pt=c=>{var m=ri(),g=t(m),$=t(g,!0);e(g);var L=r(g,2);Ue(L,17,()=>a(l).actions,ut,(I,D,J,se)=>{var w=ai(),A=t(w),G=t(A);e(A);var k=r(A,2),C=t(k,!0);e(k),e(w),p(()=>{i(G,`${a(D).name??""}:`),i(C,a(D).desc)}),d(I,w)}),e(m),p(I=>i($,I),[()=>n()("session.enemy_modal.actions")]),d(c,m)};M(Te,c=>{a(l).actions.length>0&&c(pt)})}var o=r(Te,2);{var v=c=>{var m=ii(),g=t(m),$=t(g,!0);e(g);var L=r(g,2);Ue(L,17,()=>a(l).reactions,ut,(I,D,J,se)=>{var w=si(),A=t(w),G=t(A);e(A);var k=r(A,2),C=t(k,!0);e(k),e(w),p(()=>{i(G,`${a(D).name??""}:`),i(C,a(D).desc)}),d(I,w)}),e(m),p(I=>i($,I),[()=>n()("session.enemy_modal.reactions")]),d(c,m)};M(o,c=>{a(l).reactions.length>0&&c(v)})}var u=r(o,2);{var y=c=>{var m=oi(),g=t(m),$=t(g,!0);e(g);var L=r(g,2);Ue(L,17,()=>a(l).endOfRound,ut,(I,D,J,se)=>{var w=ni(),A=t(w),G=t(A);e(A);var k=r(A,2),C=t(k,!0);e(k),e(w),p(()=>{i(G,`${a(D).name??""}:`),i(C,a(D).desc)}),d(I,w)}),e(m),p(I=>i($,I),[()=>n()("session.enemy_modal.end_of_round")]),d(c,m)};M(u,c=>{a(l).endOfRound.length>0&&c(y)})}e(h),e(Qe),e(Pe),e(re),e(we),e(Me);var U=r(Me,2);U.__change=de,Er(U,c=>R(le,c),()=>a(le));var P=r(U,2);mr(P,{get isOpen(){return a(E)},get imageUrl(){return a(W)},onClose:()=>R(E,!1),onCrop:ne}),p((c,m,g,$,L,I,D,J,se,w,A,G,k,C)=>{je(Me,"aria-label",c),i(oe,m),De(We,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(f)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Ve,g),De(qe,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(f)==="attributes"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(_t,$),De(Ze,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(f)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(yt,L),i(Xe,I),i(T,` ${D??""}`),i(Ye,` ${J??""}`),i(j,`${se??""} ${a(l).difficulty??""}`),i(Ke,w),i(Rt,A),i(jt,a(l).defense),i(kt,G),i(mt,a(l).health),i(Tt,k),i(ft,a(l).size),i(Ft,C),i(aa,a(l).speed)},[()=>n()("session.enemy_modal.close"),()=>n()("session.enemy_modal.title"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_attributes"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("common.buttons.cancel"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview"),()=>n()("session.enemy_modal.difficulty"),()=>a(l).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed")]),d(ve,_e)};M(He,ve=>{Q()&&ve(rt)})}d(N,X),Kt(),z()}ea(["click","change"]);var vi=b('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),ci=b('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),ui=b('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),bi=b('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function xi(N,s){Yt(s,!0);const n=()=>dt(Ht,"$t",z),x=()=>dt($a,"$liveEnemies",z),[z,Q]=ta();let O=Pt(s,"isOpen",3,!1),l=Pt(s,"initialData",3,"{}"),f=Be(Zt({name:"",enemies:[]}));za(()=>{if(O()&&l())try{const F=JSON.parse(l());R(f,{name:F.name||"",enemies:F.enemies||[]},!0)}catch{R(f,{name:"",enemies:[]},!0)}});function E(F){a(f).enemies.find(X=>X.enemyId===F)?a(f).enemies=a(f).enemies.map(X=>X.enemyId===F?{...X,count:X.count+1}:X):a(f).enemies=[...a(f).enemies,{enemyId:F,count:1}]}function W(F){a(f).enemies=a(f).enemies.filter((me,X)=>X!==F)}function le(F,me){const X=Math.max(1,parseInt(me)||1);a(f).enemies[F].count=X}function de(F){}var ne=bt(),ee=Se(ne);{var pe=F=>{var me=bi();me.__click=de;var X=t(me),He=t(X),rt=t(He),ve=t(rt,!0);e(rt);var _e=r(rt,2);_e.__click=function(...T){s.onClose?.apply(this,T)};var Me=t(_e);la(Me,{size:20}),e(_e),e(He);var we=r(He,2),Ae=t(we),ae=t(Ae),he=t(ae,!0);e(ae);var oe=r(ae,2);St(oe),e(Ae),e(we);var ye=r(we,2),Re=t(ye),$e=t(Re),We=t($e,!0);e($e);var Ve=r($e,2),qe=t(Ve);Ue(qe,17,()=>a(f).enemies,ut,(T,re,be)=>{const xe=Z(()=>x().find(Je=>Je.id===a(re).enemyId));var fe=vi(),Ye=t(fe),Pe=t(Ye),Qe=t(Pe,!0);e(Pe);var vt=r(Pe,2),j=t(vt);e(vt),e(Ye);var S=r(Ye,2),Y=t(S);St(Y),Y.__input=Je=>le(be,Je.target.value);var Fe=r(Y,2);Fe.__click=()=>W(be);var et=t(Fe);da(et,{size:16}),e(Fe),e(S),e(fe),p(Je=>{i(Qe,Je),i(j,`Dif ${(a(xe)?a(xe).difficulty:"?")??""}`),ya(Y,a(re).count)},[()=>a(xe)?a(xe).name:n()("session.encounter_modal.unknown")]),d(T,fe)});var _t=r(qe,2);{var Ze=T=>{var re=ci(),be=t(re,!0);e(re),p(xe=>i(be,xe),[()=>n()("session.encounter_modal.none_added")]),d(T,re)};M(_t,T=>{a(f).enemies.length===0&&T(Ze)})}e(Ve),e(Re);var yt=r(Re,2),xt=t(yt),q=t(xt,!0);e(xt);var ce=r(xt,2);Ue(ce,5,x,T=>T.id,(T,re)=>{var be=ui(),xe=t(be),fe=t(xe),Ye=t(fe,!0);e(fe);var Pe=r(fe,2),Qe=t(Pe);e(Pe),e(xe);var vt=r(xe,2);vt.__click=()=>E(a(re).id);var j=t(vt);Xt(j,{size:16}),e(vt),e(be),p(()=>{i(Ye,a(re).name),i(Qe,`Dif ${a(re).difficulty??""}`)}),d(T,be)}),e(ce),e(yt),e(ye);var ke=r(ye,2),Oe=t(ke);Oe.__click=function(...T){s.onClose?.apply(this,T)};var Ge=t(Oe,!0);e(Oe);var Xe=r(Oe,2);Xe.__click=()=>s.onSave(a(f));var B=t(Xe);Qa(B,{size:18});var ge=r(B);e(Xe),e(ke),e(X),e(me),p((T,re,be,xe,fe,Ye,Pe,Qe)=>{je(me,"aria-label",T),i(ve,re),i(he,be),je(oe,"placeholder",xe),i(We,fe),i(q,Ye),i(Ge,Pe),i(ge,` ${Qe??""}`)},[()=>n()("session.encounter_modal.close"),()=>n()("session.encounter_modal.title"),()=>n()("session.encounter_modal.name"),()=>n()("session.encounter_modal.name_placeholder"),()=>n()("session.encounter_modal.enemies_in_encounter"),()=>n()("session.encounter_modal.add_enemies"),()=>n()("common.buttons.cancel"),()=>n()("session.encounter_modal.save_encounter")]),At(oe,()=>a(f).name,T=>a(f).name=T),d(F,me)};M(ee,F=>{O()&&F(pe)})}d(N,ne),Kt(),Q()}ea(["click","input"]);var mi=b('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),_i=b('<div class="text-[10px] text-slate-600 italic"> </div>'),fi=b('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="font-bold text-white text-base mb-2 group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),pi=b('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),gi=b('<div class="mb-4 flex-1"><p> </p> <!></div>'),hi=b('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),yi=b('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),wi=b('<div class="text-center text-slate-500 italic col-span-3"> </div>'),ki=b('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function zi(N,s){Yt(s,!0);const n=()=>dt($a,"$liveEnemies",Q),x=()=>dt(Ta,"$liveEncounters",Q),z=()=>dt(Ht,"$t",Q),[Q,O]=ta();let l=Be(!1),f=Be(null),E=Be("{}"),W=Be(!1),le=Be(null),de=Be("{}"),ne=Be(Zt({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function ee(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function pe(j=null){R(f,j?j.id:null,!0),R(E,JSON.stringify(j||ee()),!0),R(l,!0)}let F=Zt(new Set);function me(j){F.has(j)?F.delete(j):F.add(j)}function X(j){const S=a(f)||xa(),Y=ht.get(s.campId);Oa.set(S,{...j,id:S,campaignId:s.campId,system:Y?.system||"sofww"}),R(l,!1)}function He(j){const S=n().find(Y=>Y.id===j);R(ne,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${S?.name||"este inimigo"}"?`,onConfirm:()=>{Oa.delete(j),a(ne).isOpen=!1}},!0)}function rt(j=null){R(le,j?j.id:null,!0),R(de,JSON.stringify(j||{name:"",enemies:[]}),!0),R(W,!0)}function ve(j){const S=a(le)||xa();ga.set(S,{...j,id:S}),R(W,!1)}function _e(j){const S=x().find(Y=>Y.id===j);R(ne,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${S?.name||"este encontro"}"?`,onConfirm:()=>{ga.delete(j),a(ne).isOpen=!1}},!0)}function Me(j){const S=ht.get(s.campId);if(!S)return;const Y=S.activeEnemies||[];let Fe=[];j.enemies.forEach(et=>{const Je=n().find(Ke=>Ke.id===et.enemyId);if(Je)for(let Ke=0;Ke<et.count;Ke++)Fe.push({...Je,instanceId:xa(),damage:0,currentHealth:Je.health,afflictions:[],acted:!1,initiative:!1})}),ht.set(s.campId,{...S,activeEnemies:[...Y,...Fe]})}function we(j,S){j.dataTransfer.setData("text/plain",S.id),j.dataTransfer.effectAllowed="copy"}function Ae(j){return j.preventDefault(),!1}function ae(j,S){j.preventDefault();const Y=j.dataTransfer.getData("text/plain");if(!Y)return;const Fe=S.enemies||[],et=Fe.find(Ke=>Ke.enemyId===Y);let Je;et?Je=Fe.map(Ke=>Ke.enemyId===Y?{...Ke,count:Ke.count+1}:Ke):Je=[...Fe,{enemyId:Y,count:1}],ga.set(S.id,{...S,enemies:Je})}let he=Z(()=>ht.get(s.campId)?.system||"sofww"),oe=Z(()=>n().filter(j=>(j.system||"sofww")===a(he)));var ye=ki(),Re=t(ye),$e=t(Re),We=t($e),Ve=t(We);Va(Ve,{size:16});var qe=r(Ve);e(We),e($e);var _t=r($e,2),Ze=t(_t);Ze.__click=()=>rt();var yt=t(Ze);Xt(yt,{size:28,class:"group-hover:scale-110 transition-transform"});var xt=r(yt,2),q=t(xt,!0);e(xt),e(Ze);var ce=r(Ze,2);Ue(ce,1,x,j=>j.id,(j,S)=>{var Y=fi(),Fe=t(Y),et=t(Fe),Je=t(et,!0);e(et);var Ke=r(et,2),Ot=t(Ke);Ue(Ot,17,()=>a(S).enemies||[],ut,(Ne,it)=>{const Tt=Z(()=>n().find(Lt=>Lt.id===a(it).enemyId));var wt=mi(),ft=t(wt),Mt=t(ft);e(ft);var Dt=r(ft,2),Ft=t(Dt,!0);e(Dt),e(wt),p(()=>{i(Mt,`${a(it).count??""}x`),i(Ft,a(Tt)?a(Tt).name:"...")}),d(Ne,wt)});var $t=r(Ot,2);{var Ct=Ne=>{var it=_i(),Tt=t(it,!0);e(it),p(wt=>i(Tt,wt),[()=>z()("session.bestiary.empty_encounter")]),d(Ne,it)};M($t,Ne=>{a(S).enemies?.length||Ne(Ct)})}e(Ke),e(Fe);var Rt=r(Fe,2),Et=t(Rt);Et.__click=()=>Me(a(S));var jt=t(Et);Wa(jt,{size:12,fill:"currentColor"});var Nt=r(jt);e(Et);var ct=r(Et,2);ct.__click=()=>rt(a(S));var kt=t(ct);kr(kt,{size:14}),e(ct);var st=r(ct,2);st.__click=()=>_e(a(S).id);var mt=t(st);da(mt,{size:14}),e(st),e(Rt),e(Y),p(Ne=>{je(Y,"aria-label",`Encontro ${a(S).name??""}`),i(Je,a(S).name),i(Nt,` ${Ne??""}`)},[()=>z()("session.bestiary.start")]),pa("dragover",Y,Ae),pa("drop",Y,Ne=>ae(Ne,a(S))),d(j,Y)}),e(_t),e(Re);var ke=r(Re,2),Oe=t(ke),Ge=t(Oe);fa(Ge,{size:16});var Xe=r(Ge);e(Oe),e(ke);var B=r(ke,2),ge=t(B);ge.__click=()=>pe();var T=t(ge);Xt(T,{size:32,class:"group-hover:scale-110 transition-transform"});var re=r(T,2),be=t(re,!0);e(re),e(ge);var xe=r(ge,2);Ue(xe,17,()=>a(oe),j=>j.id,(j,S)=>{var Y=yi(),Fe=t(Y),et=t(Fe),Je=t(et,!0);e(et);var Ke=r(et,2),Ot=t(Ke);e(Ke),e(Fe);var $t=r(Fe,2);{var Ct=st=>{var mt=gi(),Ne=t(mt),it=t(Ne,!0);e(Ne);var Tt=r(Ne,2);{var wt=ft=>{var Mt=pi();Mt.__click=()=>me(a(S).id);var Dt=t(Mt,!0);e(Mt),p(Ft=>i(Dt,Ft),[()=>F.has(a(S).id)?z()("session.bestiary.see_less"):z()("session.bestiary.see_more")]),d(ft,Mt)};M(Tt,ft=>{a(S).description.length>120&&ft(wt)})}e(mt),p(ft=>{De(Ne,1,`text-xs text-slate-400 leading-relaxed ${ft??""}`),i(it,a(S).description)},[()=>F.has(a(S).id)?"":"line-clamp-3"]),d(st,mt)},Rt=st=>{var mt=hi(),Ne=t(mt,!0);e(mt),p(it=>i(Ne,it),[()=>z()("session.bestiary.no_description")]),d(st,mt)};M($t,st=>{a(S).description?st(Ct):st(Rt,!1)})}var Et=r($t,2),jt=t(Et);jt.__click=()=>pe(a(S));var Nt=t(jt,!0);e(jt);var ct=r(jt,2);ct.__click=()=>He(a(S).id);var kt=t(ct);da(kt,{size:14}),e(ct),e(Et),e(Y),p((st,mt)=>{i(Je,a(S).name),i(Ot,`${st??""} ${a(S).difficulty??""}`),i(Nt,mt)},[()=>z()("session.bestiary.level"),()=>z()("common.buttons.edit")]),pa("dragstart",Y,st=>we(st,a(S))),d(j,Y)});var fe=r(xe,2);{var Ye=j=>{var S=wi(),Y=t(S,!0);e(S),p(Fe=>i(Y,Fe),[()=>z()("session.bestiary.no_enemies")]),d(j,S)};M(fe,j=>{a(oe).length===0&&j(Ye)})}e(B);var Pe=r(B,2);di(Pe,{get isOpen(){return a(l)},get initialData(){return a(E)},onClose:()=>R(l,!1),onSave:X});var Qe=r(Pe,2);xi(Qe,{get isOpen(){return a(W)},get initialData(){return a(de)},onClose:()=>R(W,!1),onSave:ve});var vt=r(Qe,2);Na(vt,{get isOpen(){return a(ne).isOpen},get title(){return a(ne).title},get message(){return a(ne).message},get onConfirm(){return a(ne).onConfirm},onCancel:()=>a(ne).isOpen=!1}),e(ye),p((j,S,Y,Fe)=>{i(qe,` ${j??""}`),i(q,S),i(Xe,` ${Y??""}`),i(be,Fe)},[()=>z()("session.bestiary.encounters_title"),()=>z()("session.bestiary.new_encounter"),()=>z()("session.bestiary.title"),()=>z()("session.bestiary.new_enemy")]),d(N,ye),Kt(),O()}ea(["click"]);var $i=b('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),Ci=b('<div class="flex items-center gap-1 text-emerald-400"><!> <span class="text-xs font-bold hidden sm:block"> </span></div> <!>',1),Ei=b('<div class="flex items-center gap-1 text-slate-500"><!> <span class="text-xs hidden sm:block"> </span></div>'),ji=b('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),Mi=b('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group"><!> <!></button> <div class="flex flex-col"><h1 class="text-base sm:text-lg font-black text-white leading-tight truncate max-w-[140px] sm:max-w-none"> </h1> <span class="text-xs text-indigo-400 font-mono font-black uppercase tracking-wider"> </span></div></div> <div class="hidden md:flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block"> </span></button> <button><!> <span class="hidden min-[400px]:block"> </span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 sm:p-2.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all"><!></button> <button class="p-2 sm:p-2.5 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative"><!> <!></button></div></div></div></header>');function Oi(N,s){Yt(s,!0);const n=()=>dt(Ht,"$t",O),x=()=>dt(ar,"$syncState",O),z=()=>dt(ia,"$isHistoryOpen",O),Q=()=>dt(rr,"$hasUnreadRolls",O),[O,l]=ta();let f=Pt(s,"campaignName",3,""),E=Pt(s,"gmName",3,"Mestre"),W=Pt(s,"activeSubTab",3,"session"),le=Pt(s,"onTabChange",3,()=>{}),de=Pt(s,"onOpenSettings",3,()=>{});var ne=Mi(),ee=t(ne),pe=t(ee),F=t(pe),me=t(F);me.__click=()=>jr(Pa("/"));var X=t(me);La(X,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var He=r(X,2);pr(He,{size:18,class:"hidden sm:block opacity-50"}),e(me);var rt=r(me,2),ve=t(rt),_e=t(ve,!0);e(ve);var Me=r(ve,2),we=t(Me,!0);e(Me),e(rt),e(F);var Ae=r(F,2),ae=t(Ae);ae.__click=()=>le()("session");var he=t(ae);{let B=Z(()=>W()==="session"?"opacity-100":"opacity-50");Ua(he,{size:14,get class(){return a(B)}})}var oe=r(he,2),ye=t(oe,!0);e(oe),e(ae);var Re=r(ae,2);Re.__click=()=>le()("bestiary");var $e=t(Re);{let B=Z(()=>W()==="bestiary"?"opacity-100":"opacity-50");Ga($e,{size:14,get class(){return a(B)}})}var We=r($e,2),Ve=t(We,!0);e(We),e(Re),e(Ae);var qe=r(Ae,2),_t=t(qe),Ze=t(_t);{var yt=B=>{var ge=Ci(),T=Se(ge),re=t(T);Aa(re,{size:16});var be=r(re,2),xe=t(be,!0);e(be),e(T);var fe=r(T,2);{var Ye=Pe=>{var Qe=$i(),vt=t(Qe);Da(vt,{size:14});var j=r(vt,2),S=t(j,!0);e(j),e(Qe),p(Y=>{je(Qe,"title",Y),i(S,x().peers.length)},[()=>n()("common.status.peers",{values:{count:x().peers.length}})]),d(Pe,Qe)};M(fe,Pe=>{x().peers.length>0&&Pe(Ye)})}p((Pe,Qe)=>{je(T,"title",Pe),i(xe,Qe)},[()=>n()("common.status.connected"),()=>n()("common.status.connected")]),d(B,ge)},xt=B=>{var ge=Ei(),T=t(ge);Mr(T,{size:16});var re=r(T,2),be=t(re,!0);e(re),e(ge),p((xe,fe)=>{je(ge,"title",xe),i(be,fe)},[()=>n()("common.status.offline"),()=>n()("common.status.offline")]),d(B,ge)};M(Ze,B=>{x().isConnected?B(yt):B(xt,!1)})}e(_t);var q=r(_t,2);q.__click=function(...B){de()?.apply(this,B)};var ce=t(q);$r(ce,{size:20}),e(q);var ke=r(q,2);ke.__click=()=>ia.update(B=>!B);var Oe=t(ke);gr(Oe,{size:20});var Ge=r(Oe,2);{var Xe=B=>{var ge=ji();d(B,ge)};M(Ge,B=>{Q()&&B(Xe)})}e(ke),e(qe),e(pe),e(ee),e(ne),p((B,ge,T,re,be,xe,fe,Ye)=>{je(me,"aria-label",B),je(me,"title",ge),i(_e,f()),i(we,E()),De(ae,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${W()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),je(ae,"aria-pressed",W()==="session"),i(ye,T),De(Re,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${W()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),je(Re,"aria-pressed",W()==="bestiary"),i(Ve,re),je(q,"aria-label",be),je(q,"title",xe),je(ke,"aria-label",fe),je(ke,"title",Ye),je(ke,"aria-pressed",z())},[()=>n()("character.header.back_dashboard"),()=>n()("character.header.back_dashboard"),()=>n()("common.labels.session"),()=>n()("common.labels.bestiary"),()=>n()("common.buttons.settings"),()=>n()("common.buttons.settings"),()=>n()("character.header.history"),()=>n()("character.header.history")]),d(N,ne),Kt(),l()}ea(["click"]);var Ii=b('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),Si=b('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),Ri=b('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),Ni=b('<div class="fixed bottom-24 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0 z-[60] flex flex-col items-center gap-2"><div class="bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center gap-2 shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 duration-200"><button class="bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-indigo-500/20"><span class="text-[10px] opacity-70">d20</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">2d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">3d6</span> <!></button> <div class="w-px h-8 bg-white/10 mx-1"></div> <button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button></div></div>  <div class="fixed inset-0 bg-black/40 z-[55]"></div>',1),Ti=b('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!> <!> <div class="hidden md:block fixed bottom-8 left-8 z-[60]"><button class="w-16 h-16 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-[0_0_20px_rgba(79,70,229,0.4)] flex items-center justify-center transition-all active:scale-90 border-2 border-white/10 group" title="Rolagens Rápidas"><!></button></div> <nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-6 pt-2 pointer-events-none"><div class="max-w-md mx-auto relative h-16 pointer-events-auto"><div class="absolute inset-0 bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"></div></div> <div class="relative h-full flex items-center justify-around px-2"><button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Sessão</span></button> <div class="relative w-16 h-16 -mt-10 flex items-center justify-center"><div class="absolute inset-0 bg-indigo-600/20 rounded-full blur-xl animate-pulse"></div> <button class="relative w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(79,70,229,0.5)] border-4 border-slate-900 transition-all active:scale-90 hover:bg-indigo-500 z-10" aria-label="Rolar Dados"><!></button></div> <button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Bestiário</span></button></div></div></nav> <!></div>');function an(N,s){Yt(s,!0);const n=()=>dt(Ka,"$page",O),x=()=>dt(nr,"$liveCampaigns",O),z=()=>dt(Ht,"$t",O),Q=()=>dt(ia,"$isHistoryOpen",O),[O,l]=ta();let f=Be("session"),E=Be(!1),W=Z(()=>n().params.id),le=Z(()=>x().find(q=>q.id===a(W))),de=Z(()=>!!a(le));function ne(q){if(!a(W)||!a(le))return;const ce={...a(le),...q};ht.set(a(W),ce),wa(a(W),{name:ce.name,gmName:ce.gmName}),R(E,!1)}let ee=Be(!1),pe=Be(Zt({isOpen:!1,sides:20,count:1,modifier:0}));function F(q,ce=1){R(pe,{isOpen:!0,sides:q,count:ce,modifier:0},!0)}function me(q){if(!a(le))return;const ce=us(a(pe).sides,a(pe).count,q);let ke="";a(pe).count>1&&(ke+=`Dados: [${ce.results.join(", ")}] `),ce.bonusRolls?.length>0&&(ke+=`Bonus Rolls: [${ce.bonusRolls.join(", ")}] -> ${Math.abs(ce.modifierTotal)}`);const Oe=a(le).gmName||ha(Ht)("common.labels.master");sr.addToHistory({source:"GM",charName:Oe,name:`${a(pe).count}d${a(pe).sides} ${q?q>0?`+${q}`:q:""}`,description:ke.trim()||null,total:ce.total,formula:ce.formula,crit:ce.crit}),ia.set(!0),a(pe).isOpen=!1}var X=Ti(),He=t(X);{var rt=q=>{var ce=Ii(),ke=Se(ce);Oi(ke,{get campaignName(){return a(le).name},get gmName(){return a(le).gmName},get activeSubTab(){return a(f)},onTabChange:T=>R(f,T,!0),onOpenSettings:()=>R(E,!0)});var Oe=r(ke,2);{let T=Z(()=>JSON.stringify(a(le)));Cr(Oe,{get isOpen(){return a(E)},get initialData(){return a(T)},onClose:()=>R(E,!1),onSave:ne})}var Ge=r(Oe,2),Xe=t(Ge);{var B=T=>{Ls(T,{get campaign(){return a(le)}})},ge=T=>{var re=bt(),be=Se(re);{var xe=fe=>{zi(fe,{get campId(){return a(W)}})};M(be,fe=>{a(f)==="bestiary"&&fe(xe)},!0)}d(T,re)};M(Xe,T=>{a(f)==="session"?T(B):T(ge,!1)})}e(Ge),d(q,ce)},ve=q=>{var ce=bt(),ke=Se(ce);{var Oe=Xe=>{var B=Si(),ge=r(t(B),2),T=t(ge,!0);e(ge);var re=r(ge,2),be=t(re,!0);e(re);var xe=r(re,2);xe.__click=()=>window.history.back();var fe=r(t(xe));e(xe),e(B),p((Ye,Pe,Qe)=>{i(T,Ye),i(be,Pe),i(fe,` ${Qe??""}`)},[()=>z()("campaign.not_found.title"),()=>z()("campaign.not_found.message"),()=>z()("common.buttons.back")]),d(Xe,B)},Ge=Xe=>{var B=Ri();d(Xe,B)};M(ke,Xe=>{a(de)&&!a(le)?Xe(Oe):Xe(Ge,!1)},!0)}d(q,ce)};M(He,q=>{a(de)&&a(le)?q(rt):q(ve,!1)})}var _e=r(He,2);Fa(_e,{get isOpen(){return Q()},onClose:()=>ia.set(!1)});var Me=r(_e,2);{var we=q=>{var ce=Ni(),ke=Se(ce),Oe=t(ke),Ge=t(Oe);Ge.__click=()=>{F(20),R(ee,!1)};var Xe=r(t(Ge),2);oa(Xe,{size:16}),e(Ge);var B=r(Ge,2);B.__click=()=>{F(6),R(ee,!1)};var ge=r(t(B),2);oa(ge,{size:16}),e(B);var T=r(B,2);T.__click=()=>{F(6,2),R(ee,!1)};var re=r(t(T),2);oa(re,{size:16}),e(T);var be=r(T,2);be.__click=()=>{F(6,3),R(ee,!1)};var xe=r(t(be),2);oa(xe,{size:16}),e(be);var fe=r(be,4);fe.__click=()=>R(ee,!1);var Ye=t(fe);la(Ye,{size:20}),e(fe),e(Oe),e(ke);var Pe=r(ke,2);Pe.__click=()=>R(ee,!1),d(q,ce)};M(Me,q=>{a(ee)&&q(we)})}var Ae=r(Me,2),ae=t(Ae);ae.__click=()=>R(ee,!a(ee));var he=t(ae);oa(he,{size:32,class:"group-hover:rotate-12 transition-transform"}),e(ae),e(Ae);var oe=r(Ae,2),ye=t(oe),Re=r(t(ye),2),$e=t(Re);$e.__click=()=>{R(f,"session"),R(ee,!1)};var We=t($e);{let q=Z(()=>a(f)==="session"?"animate-in zoom-in-75 duration-300":"");Ua(We,{size:20,get class(){return a(q)}})}Gt(2),e($e);var Ve=r($e,2),qe=r(t(Ve),2);qe.__click=()=>R(ee,!a(ee));var _t=t(qe);{let q=Z(()=>a(ee)?"rotate-90":"rotate-0");oa(_t,{size:28,get class(){return`text-white ${a(q)??""} transition-transform duration-300`}})}e(qe),e(Ve);var Ze=r(Ve,2);Ze.__click=()=>{R(f,"bestiary"),R(ee,!1)};var yt=t(Ze);{let q=Z(()=>a(f)==="bestiary"?"animate-in zoom-in-75 duration-300":"");Ga(yt,{size:20,get class(){return a(q)}})}Gt(2),e(Ze),e(Re),e(ye),e(oe);var xt=r(oe,2);{let q=Z(()=>`${z()("session.quick.roll_title")} (${a(pe).count}d${a(pe).sides})`),ce=Z(()=>a(pe).sides===20?z()("session.quick.boons_banes"):z()("session.quick.fixed_modifier"));hr(xt,{get isOpen(){return a(pe).isOpen},get title(){return a(q)},get label(){return a(ce)},onClose:()=>a(pe).isOpen=!1,onRoll:me,initialModifier:0})}e(X),p(()=>{De($e,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(f)==="session"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),De(Ze,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(f)==="bestiary"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`)}),d(N,X),Kt(),l()}ea(["click"]);export{an as component};
