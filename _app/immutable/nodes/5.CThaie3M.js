const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BlDAHNTi.js","../chunks/vbI-l42I.js","../chunks/BlobBfBu.js","../chunks/BX-sjYO1.js","../chunks/-C23ZK4E.js","../chunks/BBccnPWr.js","../chunks/iJn5IoH5.js","../chunks/CI59BmNm.js","../chunks/BO950AV2.js","../chunks/OaA2MUvX.js","../chunks/DGloBz3m.js","../chunks/PPVm8Dsz.js"])))=>i.map(i=>d[i]);
import{_ as Ie}from"../chunks/PPVm8Dsz.js";import{c as de,a as l,f as p,t as Ee}from"../chunks/vbI-l42I.js";import{o as Me}from"../chunks/D_FouEMM.js";import{B as q,p as ze,c as o,s as n,t as N,b as Ae,d as c,g as a,C as x,D as I,r as i,n as E}from"../chunks/BlobBfBu.js";import{d as Pe,s as h}from"../chunks/OaA2MUvX.js";import{e as Oe,s as oe,i as Be,r as De,b as Ve}from"../chunks/BO950AV2.js";import{l as Ge,s as Le,i as f}from"../chunks/BBccnPWr.js";import{a as B,s as Re}from"../chunks/iJn5IoH5.js";import{p as Te,C as He,W as Je}from"../chunks/D4r5fGFG.js";import{C as Se,l as Ue}from"../chunks/BuBssglp.js";import{I as We,U as qe,j as Fe,c as Ke,i as Qe}from"../chunks/BlDAHNTi.js";import{g as ie}from"../chunks/BsQs4fei.js";import{v as Xe}from"../chunks/BYmFNSF7.js";import"../chunks/BX-sjYO1.js";import{s as Ye}from"../chunks/-C23ZK4E.js";function ne(D,M){const V=Ge(M,["children","$$slots","$$events","$$legacy"]);const w=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["path",{d:"M12 9v4"}],["path",{d:"M12 17h.01"}]];We(D,Le({name:"triangle-alert"},()=>V,{get iconNode(){return w},children:(g,F)=>{var b=de(),G=q(b);Ye(G,M,"default",{}),l(g,b)},$$slots:{default:!0}}))}var Ze=p('<span class="block text-xs mt-1 uppercase tracking-widest text-slate-500 font-black"> </span>'),ea=p('<div class="mt-4 px-3 py-1 bg-amber-500/10 border border-amber-500/20 rounded-full text-[10px] text-amber-500 font-bold uppercase tracking-wider animate-pulse flex items-center gap-2"><!> Aguardando o Mestre ficar online...</div>'),aa=p('<div class="mb-6 bg-red-500/10 border border-red-500/20 rounded-xl p-3 flex items-center gap-3"><!> <p class="text-red-400 text-sm font-bold"> </p></div>'),ta=p('<p class="text-red-400 text-xs mt-1">Senha incorreta.</p>'),ra=p('<div class="mb-6 bg-slate-950/50 p-4 rounded-xl border border-slate-800"><label for="campaign-pwd-input" class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2 flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-indigo-500 animate-pulse"></div> Senha Necessária</label> <input id="campaign-pwd-input" type="password" placeholder="Digite a senha da campanha..."/> <!></div>'),sa=p('<button><div class="w-8 h-8 rounded-full bg-slate-800 flex items-center justify-center text-xs font-bold"> </div> <div class="flex-1 text-left"><div class="font-bold text-sm"> </div> <div class="text-[10px] opacity-60"> </div></div> <!></button>'),oa=p("<div>Nenhum personagem encontrado.</div> <div>Crie um personagem primeiro!</div>",1),ia=p('<div class="flex flex-col items-center gap-2"><!> <div class="text-amber-500 font-bold">Todos os seus personagens já estão em campanhas.</div> <div class="text-xs text-slate-500">Crie um novo personagem ou saia de uma campanha existente.</div></div>'),na=p('<div class="text-center py-8 text-slate-600 italic text-sm space-y-2"><!></div>'),da=p('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> Validando...',1),la=p('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> Carregando...',1),ca=p('<div class="min-h-screen bg-slate-950 flex items-center justify-center p-4"><div class="max-w-md w-full bg-slate-900 border border-slate-800 rounded-2xl p-8 shadow-2xl"><div class="flex flex-col items-center text-center mb-8"><div class="w-16 h-16 bg-indigo-600/20 rounded-full flex items-center justify-center text-indigo-400 mb-4 border border-indigo-500/30"><!></div> <h1 class="text-2xl font-bold text-white mb-2">Convite para Campanha</h1> <p class="text-slate-400">Você foi convidado para participar de <span class="text-indigo-400 font-bold"> </span> <!></p> <!></div> <!> <!> <div class="space-y-4 mb-8"><label for="char-selector" class="block text-xs font-bold text-slate-500 uppercase tracking-widest mb-2">Escolha seu Personagem</label> <div id="char-selector" class="space-y-2 max-h-60 overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div> <div class="flex gap-3"><button class="flex-1 py-3 rounded-xl bg-slate-800 hover:bg-slate-700 text-white font-bold transition-all">Recusar</button> <button class="flex-1 py-3 rounded-xl bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold transition-all shadow-lg shadow-indigo-900/20 flex items-center justify-center gap-2"><!></button></div></div></div> <!>',1);function ja(D,M){ze(M,!0);const V=()=>B(Te,"$page",b),w=()=>B(Ke,"$character",b),g=()=>B(Ue,"$liveCharacters",b),F=()=>B(Qe,"$isGmOnline",b),[b,G]=Re(),$=V().params.id;let y=I(()=>w().campaignName||"Buscando campanha..."),L=I(()=>w().gmName||"..."),z=I(()=>w().passwordHash),K=I(()=>g().filter(t=>!t.campaignId)),m=x(null),A=x(!1),C=x(""),k=x(!1),P=x(!1),_=x("");Me(()=>{$&&Fe($,!1)});async function le(){if(c(_,""),!a(m)||!$)return;if(g().find(e=>e.id===a(m))?.campaignId){c(_,"Este personagem já está em uma campanha!");return}if(a(z)){if(!a(C)){c(k,!0);return}c(P,!0);const e=await Xe(a(C),a(z));if(c(P,!1),!e){c(k,!0);return}}c(k,!1),c(A,!0)}function ce(){if(!a(m)||!$)return;const t=g().find(e=>e.id===a(m));if(t){if(t.campaignId){c(_,"Este personagem já está em uma campanha!"),c(A,!1);return}Ie(async()=>{const{charactersMap:e}=await import("../chunks/BlDAHNTi.js").then(r=>r.L);return{charactersMap:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]),import.meta.url).then(({charactersMap:e})=>{e.set(a(m),{...t,campaignId:$,campaignName:a(y),gmName:a(L),campaignApproval:"pending"}),ie(`/characters/${a(m)}`)})}}var Q=ca(),R=q(Q),X=o(R),T=o(X),H=o(T),ve=o(H);qe(ve,{size:32}),i(H);var J=n(H,4),S=n(o(J)),pe=o(S,!0);i(S);var me=n(S,2);{var fe=t=>{var e=Ze(),r=o(e);i(e),N(()=>h(r,`Mestre: ${a(L)??""}`)),l(t,e)};f(me,t=>{a(L)!=="..."&&t(fe)})}i(J);var ue=n(J,2);{var ge=t=>{var e=ea(),r=o(e);Je(r,{size:12}),E(),i(e),l(t,e)};f(ue,t=>{F()||t(ge)})}i(T);var Y=n(T,2);{var be=t=>{var e=aa(),r=o(e);ne(r,{size:20,class:"text-red-500 mb-0.5"});var v=n(r,2),u=o(v,!0);i(v),i(e),N(()=>h(u,a(_))),l(t,e)};f(Y,t=>{a(_)&&t(be)})}var Z=n(Y,2);{var _e=t=>{var e=ra(),r=n(o(e),2);De(r);var v=n(r,2);{var u=s=>{var d=ta();l(s,d)};f(v,s=>{a(k)&&s(u)})}i(e),N(()=>oe(r,1,`w-full bg-slate-900 border ${a(k)?"border-red-500":"border-slate-700"} rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors`)),Ve(r,()=>a(C),s=>c(C,s)),l(t,e)};f(Z,t=>{a(z)&&t(_e)})}var U=n(Z,2),ee=n(o(U),2),ae=o(ee);Oe(ae,17,()=>a(K),Be,(t,e)=>{var r=sa();r.__click=()=>{c(m,a(e).id,!0),c(_,"")};var v=o(r),u=o(v,!0);i(v);var s=n(v,2),d=o(s),W=o(d,!0);i(d);var se=n(d,2),ke=o(se);i(se),i(s);var je=n(s,2);{var Ne=j=>{He(j,{size:16,class:"text-indigo-400"})};f(je,j=>{a(m)===a(e).id&&j(Ne)})}i(r),N(j=>{oe(r,1,`w-full flex items-center gap-3 p-3 rounded-xl border transition-all ${a(m)===a(e).id?"bg-indigo-600/20 border-indigo-500 text-white":"bg-slate-950 border-slate-800 text-slate-400 hover:border-slate-700"}`),h(u,j),h(W,a(e).name),h(ke,`Lvl ${a(e).level??""} • ${a(e).ancestry??""}`)},[()=>a(e).name.charAt(0)]),l(t,r)});var xe=n(ae,2);{var he=t=>{var e=na(),r=o(e);{var v=s=>{var d=oa();E(2),l(s,d)},u=s=>{var d=ia(),W=o(d);ne(W,{size:24,class:"text-amber-500"}),E(4),i(d),l(s,d)};f(r,s=>{g().length===0?s(v):s(u,!1)})}i(e),l(t,e)};f(xe,t=>{a(K).length===0&&t(he)})}i(ee),i(U);var te=n(U,2),re=o(te);re.__click=()=>ie("/");var O=n(re,2);O.__click=le;var we=o(O);{var $e=t=>{var e=da();E(),l(t,e)},ye=t=>{var e=de(),r=q(e);{var v=s=>{var d=la();E(),l(s,d)},u=s=>{var d=Ee("Aceitar Convite");l(s,d)};f(r,s=>{a(y)==="Buscando campanha..."?s(v):s(u,!1)},!0)}l(t,e)};f(we,t=>{a(P)?t($e):t(ye,!1)})}i(O),i(te),i(X),i(R);var Ce=n(R,2);{let t=I(()=>`Deseja entrar na campanha "${a(y)}" com o personagem "${g().find(e=>e.id===a(m))?.name}"?`);Se(Ce,{get isOpen(){return a(A)},title:"Confirmar Participação",get message(){return a(t)},onConfirm:ce,onCancel:()=>c(A,!1)})}N(()=>{h(pe,a(y)),O.disabled=!a(m)||a(P)||!!a(z)&&!a(C)||a(y)==="Buscando campanha..."}),l(D,Q),Ae(),G()}Pe(["click"]);export{ja as component};
