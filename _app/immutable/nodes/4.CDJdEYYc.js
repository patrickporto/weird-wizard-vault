import"../chunks/DsnmJJEf.js";import{v as pt,w as Re,k as l,x as ta,z as aa,j as u,B as t,y as a,A as r,T as Q,I as e,t as f,L as $a,F as I,R as Qe,n as Zt,a2 as Yt,at as Ea}from"../chunks/Dw_raXzk.js";import{d as ra,s as i,o as ja,g as ya,e as ga}from"../chunks/Dy4L3Tb7.js";import{l as Wt,s as Vt,i as E,p as Ft}from"../chunks/C7jdvfZ7.js";import{e as Ve,s as He,i as mt,$ as Ut,r as Nt,a as Oe,f as wa,g as Xa}from"../chunks/DHvfXG5j.js";import{s as sa,a as ut}from"../chunks/CLDCoJG6.js";import{p as Ka}from"../chunks/DYstLEKx.js";import{A as Ya,d as Oa,h as pa,a as er,c as Ma,e as wt,k as ka,l as tr,m as oa,n as ma,u as xa,b as Ht,f as Ia,g as ha,o as ar,p as rr,q as sr}from"../chunks/DoCbXyb_.js";import{C as Na,a as Ca,b as Ta,l as ir,c as nr}from"../chunks/CjEbL4_G.js";import{b as or}from"../chunks/CdKeR9oO.js";import{U as Aa,C as Sa,W as Da,r as Pa}from"../chunks/Dw-BcmbT.js";import{a as lr,A as za,B as dr,T as vr,E as Ha,M as cr,G as _a,H as Fa,C as La,R as ur,b as br,I as xr,s as mr,c as pr,L as _r,S as Ua,d as fr,D as da,e as gr}from"../chunks/fALCtdEP.js";import{k as qa}from"../chunks/MwG3W-Qj.js";import{M as hr,X as va,P as ea,a as Ra,c as yr,T as ca,b as wr}from"../chunks/DsV61ll_.js";import{C as Ba,G as kr,P as Wa,S as zr,a as $r}from"../chunks/CphbQaxe.js";import"../chunks/Dcsmm6So.js";import{I as Gt,s as Qt}from"../chunks/DjRg1Dji.js";import{b as Cr}from"../chunks/Bb9Zu10p.js";import{g as Er}from"../chunks/D5jXSscZ.js";import{W as jr}from"../chunks/BirloD4D.js";function Or(S,s){const n=Wt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"m6 9 6 6 6-6"}]];Gt(S,Vt({name:"chevron-down"},()=>n,{get iconNode(){return x},children:(z,W)=>{var j=pt(),d=Re(j);Qt(d,s,"default",{}),l(z,j)},$$slots:{default:!0}}))}function Mr(S,s){const n=Wt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"m18 15-6-6-6 6"}]];Gt(S,Vt({name:"chevron-up"},()=>n,{get iconNode(){return x},children:(z,W)=>{var j=pt(),d=Re(j);Qt(d,s,"default",{}),l(z,j)},$$slots:{default:!0}}))}function Ir(S,s){const n=Wt(s,["children","$$slots","$$events","$$legacy"]);const x=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];Gt(S,Vt({name:"copy"},()=>n,{get iconNode(){return x},children:(z,W)=>{var j=pt(),d=Re(j);Qt(d,s,"default",{}),l(z,j)},$$slots:{default:!0}}))}function Sr(S,s){const n=Wt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];Gt(S,Vt({name:"flame"},()=>n,{get iconNode(){return x},children:(z,W)=>{var j=pt(),d=Re(j);Qt(d,s,"default",{}),l(z,j)},$$slots:{default:!0}}))}function Rr(S,s){const n=Wt(s,["children","$$slots","$$events","$$legacy"]);const x=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];Gt(S,Vt({name:"grip-vertical"},()=>n,{get iconNode(){return x},children:(z,W)=>{var j=pt(),d=Re(j);Qt(d,s,"default",{}),l(z,j)},$$slots:{default:!0}}))}function Va(S,s){const n=Wt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];Gt(S,Vt({name:"layers"},()=>n,{get iconNode(){return x},children:(z,W)=>{var j=pt(),d=Re(j);Qt(d,s,"default",{}),l(z,j)},$$slots:{default:!0}}))}function Ga(S,s){const n=Wt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];Gt(S,Vt({name:"library"},()=>n,{get iconNode(){return x},children:(z,W)=>{var j=pt(),d=Re(j);Qt(d,s,"default",{}),l(z,j)},$$slots:{default:!0}}))}function Nr(S,s){const n=Wt(s,["children","$$slots","$$events","$$legacy"]);const x=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];Gt(S,Vt({name:"qr-code"},()=>n,{get iconNode(){return x},children:(z,W)=>{var j=pt(),d=Re(j);Qt(d,s,"default",{}),l(z,j)},$$slots:{default:!0}}))}function Qa(S,s){const n=Wt(s,["children","$$slots","$$events","$$legacy"]);const x=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];Gt(S,Vt({name:"save"},()=>n,{get iconNode(){return x},children:(z,W)=>{var j=pt(),d=Re(j);Qt(d,s,"default",{}),l(z,j)},$$slots:{default:!0}}))}function Ja(S,s){const n=Wt(s,["children","$$slots","$$events","$$legacy"]);const x=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];Gt(S,Vt({name:"swords"},()=>n,{get iconNode(){return x},children:(z,W)=>{var j=pt(),d=Re(j);Qt(d,s,"default",{}),l(z,j)},$$slots:{default:!0}}))}function Tr(S){let s=!1;return document.body&&(document.body.appendChild(S),s=!0),{destroy(){s&&S.parentNode&&S.parentNode.removeChild(S)}}}var Ar=u("<button> <!></button>"),Dr=u('<p class="text-xs text-slate-600 italic"> </p>'),Pr=u('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),Hr=u('<div class="space-y-1"></div>'),Fr=u('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),Lr=u("<div><!></div>");function Ur(S,s){ta(s,!0);const n=()=>ut(Ut,"$t",x),[x,z]=sa();var W=pt(),j=Re(W);{var d=_=>{var $=Lr(),q=t($);{let oe=Q(()=>n()("session.affliction_modal.title"));hr(q,{get isOpen(){return s.isOpen},get onClose(){return s.onClose},get title(){return a(oe)},maxWidth:"max-w-md",children:(le,ie)=>{var K=Fr(),ge=Re(K);Ve(ge,21,()=>Object.keys(Ya),mt,(ae,ye)=>{const ne=Q(()=>s.afflictions.includes(a(ye)));var we=Ar();we.__click=()=>s.onToggle(a(ye));var Ne=t(we),je=r(Ne);{var Je=Ze=>{Ba(Ze,{size:14,class:"text-red-400"})};E(je,Ze=>{a(ne)&&Ze(Je)})}e(we),f(Ze=>{He(we,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(ne)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),i(Ne,`${Ze??""} `)},[()=>n()(`character.afflictions.${a(ye)}`)]),l(ae,we)}),e(ge);var P=r(ge,2),pe=t(P),J=t(pe),Ue=t(J,!0);e(J);var lt=r(J,2);{var de=ae=>{var ye=Dr(),ne=t(ye,!0);e(ye),f(we=>i(ne,we),[()=>n()("session.affliction_modal.none_selected")]),l(ae,ye)},_e=ae=>{var ye=Hr();Ve(ye,21,()=>s.afflictions,mt,(ne,we)=>{var Ne=Pr(),je=t(Ne),Je=t(je);e(je);var Ze=r(je,2),Ge=t(Ze,!0);e(Ze),e(Ne),f((gt,tt)=>{i(Je,`${gt??""}:`),i(Ge,tt)},[()=>n()(`character.afflictions.${a(we)}`),()=>n()(`sofww.afflictions.${a(we).toLowerCase().replace(" ","_")}.effect`)]),l(ne,Ne)}),e(ye),l(ae,ye)};E(lt,ae=>{s.afflictions.length===0?ae(de):ae(_e,!1)})}e(pe);var Me=r(pe,2),$e=t(Me);$e.__click=function(...ae){s.onClose?.apply(this,ae)};var Fe=t($e,!0);e($e),e(Me),e(P),f((ae,ye)=>{i(Ue,ae),i(Fe,ye)},[()=>n()("session.affliction_modal.effects"),()=>n()("session.affliction_modal.done")]),l(le,K)},$$slots:{default:!0}})}e($),lr($,oe=>Tr?.(oe)),l(_,$)};E(j,_=>{s.isOpen&&_(d)})}l(S,W),aa(),z()}ra(["click"]);var qr=u('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),Br=u('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),Wr=u('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),Vr=u("<button><!></button>"),Gr=u('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),Qr=u('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),Jr=u('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),Zr=u('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),Xr=u('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),Kr=u('<div class="flex flex-col items-center justify-between bg-cyan-950/20 border border-cyan-500/30 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-cyan-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div>'),Yr=u('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),es=u('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),ts=u('<div class="grid grid-cols-2 gap-4 mb-4"><div class="p-3 rounded-xl bg-purple-950/20 border border-purple-500/30 flex justify-between items-center group/ins"><div><span class="text-[9px] text-purple-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div> <div class="p-3 rounded-xl bg-red-950/20 border border-red-500/30 flex justify-between items-center group/cor"><div><span class="text-[9px] text-red-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div></div>'),as=u("<!> ",1),rs=u('<div class="flex flex-col items-center justify-between bg-cyan-950/20 border border-cyan-500/30 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-cyan-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div>'),ss=u('<div><div class="text-emerald-500 text-[10px] font-black uppercase mb-2 flex items-center gap-2"> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="flex flex-wrap gap-2"></div> <!></div>'),is=u('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),ns=u('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),os=u('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <!> <div class="grid grid-cols-3 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"><!> <!></div></div>'),ls=u('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div> <!></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function ds(S,s){ta(s,!0);const n=()=>ut(Ut,"$t",x),[x,z]=sa();let W=Ft(s,"updateEnemy",3,(p,h)=>{}),j=Ft(s,"updatePlayer",3,(p,h)=>{}),d=Ft(s,"removeFromCombat",3,p=>{}),_=Q(()=>s.entity.type==="player"),$=Q(()=>s.entity.system==="sofdl"),q=Q(()=>s.entity.damage||0),oe=Q(()=>s.entity.normalHealth||s.entity.health||10),le=Q(()=>s.entity.currentHealth??a(oe)),ie=Q(()=>a(q)>=a(le)),K=Q(()=>a(q)>=a(le)/2&&!a(ie)),ge=Q(()=>a(le)>0?Math.min(100,Math.max(0,a(q)/a(le)*100)):100),P=Qe(!1),pe=Qe(!1);$a(()=>{const p=s.entity.afflictions||[],h=p.includes("Incapacitated");if(a(ie)&&!h){const ce={afflictions:[...p,"Incapacitated"]};s.entity.type==="player"?J(ce):W()(s.entity.instanceId,ce)}else if(!a(ie)&&h){const ce={afflictions:p.filter(Ae=>Ae!=="Incapacitated")};s.entity.type==="player"?J(ce):W()(s.entity.instanceId,ce)}});function J(p){if(s.entity.type!=="player")return;const h=Oa.get(s.entity.id);h&&Oa.set(s.entity.id,{...h,...p}),j()(s.entity.id,p),pa({id:s.entity.id,...p})}function Ue(p){const h=parseInt(p.target.value);if(isNaN(h))return;const ce={damage:Math.max(0,h)};s.entity.type==="player"?J(ce):W()(s.entity.instanceId,ce)}function lt(p){const h=parseInt(p.target.value);if(isNaN(h))return;const X=Math.max(0,h);let ce=a(q);X<a(q)&&(ce=X);const Ae={currentHealth:X,damage:ce};s.entity.type==="player"?J(Ae):W()(s.entity.instanceId,Ae)}function de(){const p=!s.entity.acted;s.entity.type==="player"?J({acted:p}):W()(s.entity.instanceId,{acted:p})}function _e(){s.entity.type==="player"&&J({initiative:!s.entity.initiative})}function Me(p){const h=s.entity.afflictions||[],ce={afflictions:h.includes(p)?h.filter(Ae=>Ae!==p):[...h,p]};s.entity.type==="player"?J(ce):W()(s.entity.instanceId,ce)}var $e=ls(),Fe=t($e);{var ae=p=>{var h=qr(),X=t(h,!0);e(h),f(ce=>i(X,ce),[()=>n()("session.combat_card.initiative")]),l(p,h)};E(Fe,p=>{a(_)&&s.entity.initiative&&p(ae)})}var ye=r(Fe,2);{var ne=p=>{var h=Br();l(p,h)};E(ye,p=>{a(ie)&&p(ne)})}var we=r(ye,2),Ne=t(we),je=t(Ne),Je=t(je),Ze=t(Je);qa(Ze,()=>s.entity.imageUrl,p=>{{let h=Q(()=>s.entity.name.charAt(0));za(p,{get hash(){return s.entity.imageUrl},get alt(){return s.entity.name},size:"custom",get fallbackText(){return a(h)}})}}),e(Je);var Ge=r(Je,2);Ge.__click=de;var gt=t(Ge);{var tt=p=>{Ra(p,{size:14,class:""})},kt=p=>{var h=pt(),X=Re(h);{var ce=yt=>{Ba(yt,{size:14})},Ae=yt=>{Ja(yt,{size:14})};E(X,yt=>{s.entity.acted?yt(ce):yt(Ae,!1)},!0)}l(p,h)};E(gt,p=>{a(ie)?p(tt):p(kt,!1)})}e(Ge),e(je);var _t=r(je,2),L=t(_t),ve=t(L),Ce=t(ve),Ie=t(Ce),Xe=t(Ie,!0);e(Ie);var at=r(Ie,2);{var U=p=>{var h=Wr(),X=t(h);e(h),f(()=>i(X,`Dif ${s.entity.difficulty??""}`)),l(p,h)};E(at,p=>{a(_)||p(U)})}e(Ce),e(ve);var he=r(ve,2),R=t(he);R.__click=()=>I(P,!a(P));var re=t(R);{var be=p=>{Mr(p,{size:14})},xe=p=>{Or(p,{size:14})};E(re,p=>{a(P)?p(be):p(xe,!1)})}e(R);var fe=r(R,2);{var rt=p=>{var h=Vr();h.__click=_e;var X=t(h);Sr(X,{size:14}),e(h),f(ce=>{He(h,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${s.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),Oe(h,"title",ce)},[()=>n()("session.combat_card.initiative")]),l(p,h)},Le=p=>{var h=Gr();h.__click=()=>d()(s.entity.instanceId);var X=t(h);va(X,{size:14}),e(h),l(p,h)};E(fe,p=>{a(_)?p(rt):p(Le,!1)})}e(he),e(L);var Ke=r(L,2),bt=t(Ke),C=r(bt,2);{var M=p=>{var h=Qr();f(()=>{He(h,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10
                            ${a(ie)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(ge)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(K)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),Xa(h,`width: ${a(ge)??""}%`)}),l(p,h)};E(C,p=>{a(ge)>0&&p(M)})}var Z=r(C,2);{var qe=p=>{var h=Jr();l(p,h)};E(Z,p=>{a(q)===0&&p(qe)})}var nt=r(Z,2);{var Ye=p=>{var h=Zr(),X=t(h),ce=t(X,!0);e(X),e(h),f(Ae=>i(ce,Ae),[()=>n()("session.combat_card.incapacitated")]),l(p,h)},st=p=>{var h=pt(),X=Re(h);{var ce=Ae=>{var yt=Xr(),o=t(yt),v=t(o,!0);e(o),e(yt),f(b=>i(v,b),[()=>n()("session.combat_card.injured")]),l(Ae,yt)};E(X,Ae=>{a(K)&&Ae(ce)},!0)}l(p,h)};E(nt,p=>{a(ie)?p(Ye):p(st,!1)})}e(Ke);var St=r(Ke,2),Ct=t(St),Et=t(Ct),Tt=t(Et),jt=t(Tt,!0);e(Tt);var Ot=r(Tt,2),At=t(Ot,!0);e(Ot),e(Et);var xt=r(Et,2),$t=t(xt),dt=t($t,!0);e($t);var ft=r($t,2);Nt(ft),ft.__input=Ue,Zt(2),e(xt);var Te=r(xt,2),vt=t(Te),Dt=t(vt,!0);e(vt);var zt=r(vt,2),ht=t(zt);Nt(ht),ht.__input=lt;var Mt=r(ht,2),Pt=t(Mt);e(Mt),e(zt),e(Te);var qt=r(Te,2);{var Bt=p=>{var h=Kr(),X=t(h),ce=t(X,!0);e(X);var Ae=r(X,2),yt=t(Ae,!0);e(Ae),e(h),f(o=>{i(ce,o),i(yt,s.entity.perception||10)},[()=>n()("sofdl.attributes.perception")]),l(p,h)};E(qt,p=>{a($)&&p(Bt)})}e(Ct);var ia=r(Ct,2),Xt=t(ia);Ve(Xt,17,()=>s.entity.afflictions||[],mt,(p,h)=>{var X=Yr();X.__click=()=>Me(a(h));var ce=t(X),Ae=r(ce);va(Ae,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(X),f(()=>i(ce,`${a(h)??""} `)),l(p,X)});var Jt=r(Xt,2);Jt.__click=()=>I(pe,!0);var na=t(Jt);ea(na,{size:10});var la=r(na);e(Jt),e(ia),e(St),e(_t),e(Ne),e(we);var Kt=r(we,2);{var ua=p=>{var h=os(),X=t(h),ce=t(X),Ae=t(ce),yt=t(Ae,!0);e(Ae),Zt(2),e(ce);var o=r(ce,2);Ve(o,21,()=>a($)?["strength","agility","intellect","will"]:["str","agi","int","wil"],mt,(Y,ee)=>{const Ee=Q(()=>a($)?s.entity.attributes?.[a(ee)]??10:s.entity.stats?.[a(ee)]??s.entity.attributes?.[a(ee)]??10),Be=Q(()=>a(Ee)-10);var Pe=es(),ot=t(Pe),ct=t(ot,!0);e(ot);var te=r(ot,2),ke=t(te,!0);e(te);var Se=r(te,2),We=t(Se);e(Se),e(Pe),f(it=>{i(ct,it),i(ke,a(Ee)),He(Se,1,`text-[9px] font-bold ${a(Be)>=0?"text-emerald-500":"text-red-500"}`),i(We,`${a(Be)>=0?"+":""}${a(Be)??""}`)},[()=>a($)?a(ee).slice(0,3):a(ee)]),l(Y,Pe)}),e(o),e(X);var v=r(X,2);{var b=Y=>{var ee=ts(),Ee=t(ee),Be=t(Ee),Pe=t(Be),ot=t(Pe,!0);e(Pe);var ct=r(Pe,2),te=t(ct,!0);e(ct),e(Be);var ke=r(Be,2);dr(ke,{size:20,class:"text-purple-500/30 group-hover/ins:text-purple-500 transition-colors"}),e(Ee);var Se=r(Ee,2),We=t(Se),it=t(We),et=t(it,!0);e(it);var ze=r(it,2),It=t(ze,!0);e(ze),e(We);var Rt=r(We,2);Ra(Rt,{size:20,class:"text-red-500/30 group-hover/cor:text-red-500 transition-colors"}),e(Se),e(ee),f((Lt,fa)=>{i(ot,Lt),i(te,s.entity.insanity||0),i(et,fa),i(It,s.entity.corruption||0)},[()=>n()("sofdl.attributes.insanity"),()=>n()("sofdl.attributes.corruption")]),l(Y,ee)};E(v,Y=>{a($)&&Y(b)})}var y=r(v,2),F=t(y),A=t(F),c=t(A,!0);e(A);var m=r(A,2),g=t(m,!0);e(m),e(F);var k=r(F,2),H=t(k),O=t(H,!0);e(H);var N=r(H,2),V=t(N,!0);e(N),e(k);var se=r(k,2),w=t(se),T=t(w,!0);e(w);var B=r(w,2),D=t(B,!0);e(B),e(se),e(y);var G=r(y,2),ue=t(G);{var me=Y=>{var ee=ss(),Ee=t(ee),Be=t(Ee);Zt(),e(Ee);var Pe=r(Ee,2);Ve(Pe,21,()=>s.entity.senses,mt,(te,ke)=>{const Se=Q(()=>{const[et,ze]=a(ke).split(":");return{key:et,val:ze}}),We=Q(()=>n()(`character.senses.list.${a(Se).key}`)+(a(Se).val?` ${a(Se).val}`:"")),it=Q(()=>n()(`character.senses.descriptions.${a(Se).key}`));vr(te,{get text(){return a(it)},class:"text-xs bg-emerald-950/30 text-emerald-200 px-3 py-1.5 rounded border border-emerald-900/50 font-bold flex items-center gap-2 cursor-help whitespace-nowrap",children:(et,ze)=>{var It=as(),Rt=Re(It);Ha(Rt,{size:12,class:"text-emerald-500 flex-shrink-0"});var Lt=r(Rt);f(()=>i(Lt,` ${a(We)??""}`)),l(et,It)},$$slots:{default:!0}})}),e(Pe);var ot=r(Pe,2);{var ct=te=>{var ke=rs(),Se=t(ke),We=t(Se,!0);e(Se);var it=r(Se,2),et=t(it,!0);e(it),e(ke),f(ze=>{i(We,ze),i(et,s.entity.perception||10)},[()=>n()("sofdl.attributes.perception")]),l(te,ke)};E(ot,te=>{a($)&&te(ct)})}e(ee),f(te=>i(Be,`${te??""} `),[()=>n()("character.senses.title")]),l(Y,ee)};E(ue,Y=>{s.entity.senses&&s.entity.senses.length>0&&Y(me)})}var De=r(ue,2);Ve(De,16,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],mt,(Y,ee)=>{var Ee=pt(),Be=Re(Ee);{var Pe=ot=>{var ct=ns(),te=t(ct),ke=t(te);Zt(),e(te);var Se=r(te,2);Ve(Se,21,()=>s.entity[ee.key],mt,(We,it)=>{var et=is(),ze=t(et),It=t(ze,!0);e(ze);var Rt=r(ze,2),Lt=t(Rt,!0);e(Rt),e(et),f(()=>{i(It,a(it).name),i(Lt,a(it).description||a(it).effect)}),l(We,et)}),e(Se),e(ct),f(()=>{He(te,1,`${ee.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),i(ke,`${ee.label??""} `)}),l(ot,ct)};E(Be,ot=>{s.entity[ee.key]&&s.entity[ee.key].length>0&&ot(Pe)})}l(Y,Ee)}),e(G),e(h),f((Y,ee,Ee,Be)=>{i(yt,Y),i(c,ee),i(g,s.entity.size||1),i(O,Ee),i(V,s.entity.speed||10),i(T,Be),i(D,s.entity.defense||10)},[()=>n()("session.combat_card.attributes"),()=>n()("session.combat_card.size"),()=>n()("session.combat_card.speed"),()=>n()("session.combat_card.defense")]),l(p,h)};E(Kt,p=>{a(P)&&p(ua)})}var ba=r(Kt,2);{let p=Q(()=>s.entity.afflictions||[]);Ur(ba,{get isOpen(){return a(pe)},onClose:()=>I(pe,!1),get afflictions(){return a(p)},onToggle:Me})}e($e),f((p,h,X,ce,Ae)=>{He($e,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(_)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),He(Je,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(ie)?"border-red-600 grayscale brightness-50":a(_)?"border-indigo-500/50":"border-red-900/50"}`),He(Ge,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${s.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(_)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),Oe(Ge,"title",p),He(Ie,1,`text-base font-bold truncate leading-snug ${a(_)?"text-white":"text-red-100 font-serif tracking-wide"}`),i(Xe,s.entity.name),He(bt,1,`absolute inset-0 w-full ${a(q)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),i(jt,h),i(At,s.entity.defense||10),i(dt,X),wa(ft,a(q)),He(Te,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(ie)?"bg-red-950/50 border-red-500":a(K)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),He(vt,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(ie)?"text-red-400":a(K)?"text-orange-400":"text-emerald-400"}`),i(Dt,ce),wa(ht,a(le)),i(Pt,`/${a(oe)??""}`),i(la,` ${Ae??""}`)},[()=>s.entity.acted?n()("session.combat_card.acted"):n()("session.combat_card.act"),()=>n()("session.combat_card.defense"),()=>n()("session.combat_card.damage"),()=>n()("session.combat_card.health"),()=>n()("session.combat_card.add_affliction")]),l(S,$e),aa(),z()}ra(["click","input"]);function vs(S,{from:s,to:n},x={}){var{delay:z=0,duration:W=_e=>Math.sqrt(_e)*120,easing:j=yr}=x,d=getComputedStyle(S),_=d.transform==="none"?"":d.transform,[$,q]=d.transformOrigin.split(" ").map(parseFloat);$/=S.clientWidth,q/=S.clientHeight;var oe=cs(S),le=S.clientWidth/n.width/oe,ie=S.clientHeight/n.height/oe,K=s.left+s.width*$,ge=s.top+s.height*q,P=n.left+n.width*$,pe=n.top+n.height*q,J=(K-P)*le,Ue=(ge-pe)*ie,lt=s.width/n.width,de=s.height/n.height;return{delay:z,duration:typeof W=="function"?W(Math.sqrt(J*J+Ue*Ue)):W,easing:j,css:(_e,Me)=>{var $e=Me*J,Fe=Me*Ue,ae=_e+Me*lt,ye=_e+Me*de;return`transform: ${_} translate(${$e}px, ${Fe}px) scale(${ae}, ${ye});`}}}function cs(S){if("currentCSSZoom"in S)return S.currentCSSZoom;for(var s=S,n=1;s!==null;)n*=+getComputedStyle(s).zoom,s=s.parentElement;return n}function us(S,s=1,n=0){const x=[];let z=0;for(let _=0;_<s;_++){const $=Math.floor(Math.random()*S)+1;x.push($),z+=$}let W=`${s}d${S}`,j=[],d=0;if(n!==0)if(S===20){const _=Math.abs(n);for(let q=0;q<_;q++)j.push(Math.floor(Math.random()*6)+1);const $=Math.max(...j);n>0?(d=$,z+=$,W+=` + ${$} [Boon]`):(d=-$,z-=$,W+=` - ${$} [Bane]`)}else d=n,z+=n,W+=n>0?` + ${n}`:` - ${Math.abs(n)}`;return{total:z,results:x,bonusRolls:j,formula:W,crit:S===20&&x.includes(20),modifierTotal:d}}function bs(S,s,n){const x=n.map(_=>({..._,type:"enemy"}));if(S==="standard"){const _=s.filter(le=>le.initiative).map(le=>({...le,type:"player",isFast:!0})),$=s.filter(le=>!le.initiative).map(le=>({...le,type:"player",isFast:!1})),q=x.filter(le=>le.initiative).map(le=>({...le,isFast:!0})),oe=x.filter(le=>!le.initiative).map(le=>({...le,isFast:!1}));return[..._,...q,...$,...oe]}if(S==="individual")return[...s.map($=>({...$,type:"player",totalInit:($.initiativeRoll||0)+($.attributes?.agility||10)-10})),...x.map($=>({...$,type:"enemy",totalInit:($.initiativeRoll||0)+($.attributes?.agility||10)-10}))].sort(($,q)=>q.totalInit-$.totalInit);const z=s.filter(_=>_&&_.initiative).map(_=>({..._,type:"player"})),W=s.filter(_=>_&&!_.initiative).map(_=>({..._,type:"player"})),j=[...z,...x,...W],d=new Set;return j.filter(_=>{if(!_)return!1;const $=_.type==="player"?_.id:_.instanceId;return d.has($)?!1:(d.add($),!0)})}var xs=u('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),ms=u('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),ps=u('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),_s=u('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),fs=u('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),gs=u('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),hs=u('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),ys=u('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),ws=u('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),ks=u('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),zs=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all"><div class="truncate flex-1 flex items-center gap-2"><!> <div><div class="text-sm font-bold text-white truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800"><!></button></div>'),$s=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Cs=u("<!> <!>",1),Es=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800"><!></button></div>'),js=u('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Os=u("<!> <!>",1),Ms=u('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),Is=u('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),Ss=u("<div><!></div>"),Rs=u('<div class="text-center text-slate-500 italic py-10"> </div>'),Ns=u('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),Ts=u('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),As=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),Ds=u('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),Ps=u('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),Hs=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Fs=u('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col h-[400px]"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"></div></div> <!> <!> <!> <!>',1);function Ls(S,s){ta(s,!0);const n=()=>ut(ir,"$liveCharacters",d),x=()=>ut(Ut,"$t",d),z=()=>ut(Ca,"$liveEnemies",d),W=()=>ut(Ta,"$liveEncounters",d),j=()=>ut(oa,"$isHistoryOpen",d),[d,_]=sa();let $=Qe(!1),q=Qe(!1),oe=Qe(!1);const le={active:!1,round:1};let ie=Qe("enemies"),K=Qe(!1),ge=Qe(Yt([])),P=Qe(Yt({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));ja(()=>{if(s.campaign?.id){er(s.campaign.id,!0);const o=ya(Ut)("common.labels.master");Ma.update(b=>({...b,campaignId:s.campaign.id,name:s.campaign.gmName||o}));const v=setInterval(()=>{const b=wt.get(s.campaign.id)||s.campaign,y=ya(Ut)("common.labels.master");ka(s.campaign.id,{name:b.name,gmName:b.gmName||y})},3e4);return()=>{clearInterval(v),tr(),Ma.update(b=>({...b,campaignId:null}))}}});const pe=Q(()=>typeof window<"u"?`${window.location.origin}${Pa("/campaigns/[id]/invite",{id:s.campaign?.id})}`:"");function J(){a(pe)&&(navigator.clipboard.writeText(a(pe)),I(q,!0),setTimeout(()=>{I(q,!1)},2e3))}let Ue=Q(()=>s.campaign?.sessionRoster||[]),lt=Q(()=>s.campaign?.combat||le),de=Q(()=>s.campaign?.activeEnemies||[]),_e=Q(()=>s.campaign?.members||[]),Me=Q(()=>s.campaign?.initiativeStyle||"dle"),$e=Q(()=>Array.from(new Set([...a(Ue),...a(_e).map(v=>v.id)])).map(v=>{const b=n().find(F=>F.id===v),y=a(_e).find(F=>F.id===v);return b&&y?{...b,...y,lastUpdate:y.lastUpdate}:b||y}).filter(Boolean)),Fe=Q(()=>a($e).filter(o=>!o.campaignApproval||o.campaignApproval==="approved")),ae=Q(()=>a($e).filter(o=>o.campaignApproval==="pending")),ye=Q(()=>n().filter(o=>!a(Ue).includes(o.id)&&!a(_e).some(v=>v.id===o.id)));function ne(o){if(!s.campaign?.id)return;const b={...wt.get(s.campaign.id)||s.campaign,...o};wt.set(s.campaign.id,b),o.combat&&ma(s.campaign.id,o.combat),(o.name||o.gmName)&&ka(s.campaign.id,{name:b.name,gmName:b.gmName})}function we(o){if(a(Ue).includes(o)){const v=a(Ue).filter(b=>b!==o);ne({sessionRoster:v})}else{const v=[...a(Ue),o];ne({sessionRoster:v})}}function Ne(o){U(o,{campaignApproval:"approved"}),pa({id:o,campaignApproval:"approved"})}function je(o){pa({id:o,campaignApproval:"rejected",campaignId:null});const b=((wt.get(s.campaign.id)||s.campaign).members||[]).filter(y=>y.id!==o);ne({members:b})}function Je(o){const v=a($e).find(b=>b.id===o);I(P,{isOpen:!0,title:x()("session.players.remove_title"),message:x()("session.players.remove_message",{values:{name:v?.name||"este personagem"}}),onConfirm:()=>{const b=wt.get(s.campaign.id)||s.campaign;pa({id:o,campaignId:null});const y=(b.sessionRoster||[]).filter(c=>c!==o),F=(b.members||[]).filter(c=>c.id!==o),A=(b.activeEnemies||[]).filter(c=>c.type!=="player"||c.id!==o);ne({sessionRoster:y,members:F,activeEnemies:A}),a(P).isOpen=!1}},!0)}function Ze(o){const b=(wt.get(s.campaign.id)||s.campaign).activeEnemies||[],y={...o,instanceId:xa(),damage:0,currentHealth:o.health,afflictions:[],acted:!1,initiative:!1};ne({activeEnemies:[...b,y]})}function Ge(o){const b=(wt.get(s.campaign.id)||s.campaign).activeEnemies||[];let y=[];o.enemies.forEach(F=>{const A=z().find(c=>c.id===F.enemyId);if(A)for(let c=0;c<F.count;c++)y.push({...A,instanceId:xa(),damage:0,currentHealth:A.health,afflictions:[],acted:!1,initiative:!1})}),ne({activeEnemies:[...b,...y]})}function gt(){ne({combat:{active:!0,round:1}}),ma(s.campaign.id,{active:!0,round:1})}function tt(){const o=a(de).filter(v=>v.damage<(v.currentHealth??v.health)&&v.endOfRound&&v.endOfRound.length>0).map(v=>({name:v.name,effects:v.endOfRound}));if(o.length>0){I(ge,o,!0),I(K,!0);return}kt()}function kt(){const o=wt.get(s.campaign.id)||s.campaign,v=(o.combat?.round||1)+1,b=(o.activeEnemies||[]).map(y=>({...y,acted:!1}));ne({combat:{...o.combat,round:v},activeEnemies:b}),ma(s.campaign.id,{active:!0,round:v}),I(K,!1)}function _t(o){ne({combat:{active:!1,round:1}}),ma(s.campaign.id,{active:!1,round:1})}function L(o){const v=wt.get(s.campaign.id)||s.campaign;ne({activeEnemies:(v.activeEnemies||[]).filter(b=>b.instanceId!==o)})}function ve(o,v){const b=wt.get(s.campaign.id)||s.campaign;ne({activeEnemies:(b.activeEnemies||[]).map(y=>y.instanceId===o?{...y,...v}:y)})}function Ce(){const o=wt.get(s.campaign.id)||s.campaign,v=o.combat?.round||1;v>1&&ne({combat:{...o.combat,round:v-1}})}let Ie=Qe(Yt(Date.now()));ja(()=>{const o=setInterval(()=>{I(Ie,Date.now(),!0)},1e4);return()=>clearInterval(o)});let Xe=Q(()=>(()=>{const o=a(Fe).filter(v=>a(Ue).includes(v.id));return bs(a(Me),o,a(de))})());function at(o){return o.lastUpdate?a(Ie)-o.lastUpdate<6e4:!1}function U(o,v){const b=wt.get(s.campaign.id)||s.campaign,y=b.members||[],F=y.findIndex(k=>k.id===o);let A=y;F!==-1&&(A=[...y],A[F]={...A[F],...v});const c=b.activeEnemies||[],m=c.findIndex(k=>k.id===o&&k.type==="player");let g=c;m!==-1&&(g=[...c],g[m]={...g[m],...v}),ne({members:A,activeEnemies:g})}var he=Fs(),R=Re(he),re=t(R),be=t(re),xe=t(be),fe=t(xe),rt=t(fe);Aa(rt,{size:14,class:"text-indigo-500"});var Le=r(rt),Ke=r(Le);{var bt=o=>{var v=xs(),b=t(v,!0);e(v),f(()=>i(b,a(Fe).length)),l(o,v)};E(Ke,o=>{a(Fe).length>0&&o(bt)})}e(fe);var C=r(fe,2);C.__click=()=>I($,!a($));var M=t(C,!0);e(C),e(xe);var Z=r(xe,2);{var qe=o=>{var v=ps(),b=t(v),y=r(t(b),2),F=t(y);e(y),e(b);var A=r(b,2);Ve(A,17,()=>a(ae),c=>c.id,(c,m)=>{var g=ms(),k=t(g),H=t(k),O=t(H,!0);e(H);var N=r(H,2),V=t(N,!0);e(N),e(k);var se=r(k,2),w=t(se);w.__click=()=>Ne(a(m).id);var T=t(w);Sa(T,{size:14}),e(w);var B=r(w,2);B.__click=()=>je(a(m).id);var D=t(B);ca(D,{size:14}),e(B),e(se),e(g),f(G=>{i(O,a(m).name),i(V,G)},[()=>x()("session.players.new_request")]),l(c,g)}),Zt(2),e(v),f(c=>i(F,`${c??""} (${a(ae).length??""})`),[()=>x()("session.players.waiting_approval")]),l(o,v)};E(Z,o=>{a(ae).length>0&&o(qe)})}var nt=r(Z,2),Ye=t(nt),st=t(Ye);Ve(st,17,()=>a(Fe),o=>o.id,(o,v)=>{const b=Q(()=>at(a(v))),y=Q(()=>a(Ue).includes(a(v).id));var F=fs(),A=t(F),c=r(A,2),m=t(c),g=t(m,!0);e(m);var k=r(m,2),H=t(k);{var O=ue=>{var me=_s(),De=t(me,!0);e(me),f(Y=>i(De,Y),[()=>x()("common.labels.session")]),l(ue,me)};E(H,ue=>{a(y)&&ue(O)})}var N=r(H);e(k),e(c);var V=r(c,2),se=t(V);se.__click=()=>we(a(v).id);var w=t(se);{var T=ue=>{cr(ue,{size:14})},B=ue=>{ea(ue,{size:14})};E(w,ue=>{a(y)?ue(T):ue(B,!1)})}e(se);var D=r(se,2);D.__click=()=>Je(a(v).id);var G=t(D);ca(G,{size:14}),e(D),e(V),e(F),f((ue,me,De)=>{He(F,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(b)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(b)||a(y)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),He(A,1,`w-2 h-2 rounded-full ${a(b)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),He(m,1,`font-bold text-sm ${a(b)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),i(g,a(v).name),i(N,` ${ue??""} ${a(v).level??""} • ${a(v).ancestry??""}`),He(se,1,`p-1.5 rounded-lg transition-all ${a(y)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),Oe(se,"title",me),Oe(D,"title",De)},[()=>x()("common.labels.level"),()=>a(y)?x()("session.players.remove_from_session"):x()("session.players.add_to_session"),()=>x()("session.players.kick_from_campaign")]),l(o,F)});var St=r(st,2);{var Ct=o=>{var v=gs(),b=t(v,!0);e(v),f(y=>i(b,y),[()=>x()("session.players.none")]),l(o,v)};E(St,o=>{a(Fe).length===0&&o(Ct)})}e(Ye),e(nt);var Et=r(nt,2),Tt=t(Et);{var jt=o=>{var v=hs(),b=Re(v);b.__click=()=>ne({isPublished:!0});var y=t(b);kr(y,{size:14});var F=r(y);e(b);var A=r(b,2),c=t(A,!0);e(A),f((m,g)=>{i(F,` ${m??""}`),i(c,g)},[()=>x()("session.publish.publish_session"),()=>x()("session.publish.make_visible")]),l(o,v)},Ot=o=>{var v=ks(),b=Re(v),y=t(b),F=t(y),A=t(F);Da(A,{size:10,class:"animate-pulse"});var c=r(A);e(F),e(y);var m=r(y,2);m.__click=()=>I(oe,!a(oe));var g=t(m);Nr(g,{size:14}),e(m),e(b);var k=r(b,2);{var H=me=>{var De=ys(),Y=t(De);e(De),f((ee,Ee)=>{Oe(Y,"src",ee),Oe(Y,"alt",Ee)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(pe))}`,()=>x()("session.publish.qr_alt")]),l(me,De)};E(k,me=>{a(oe)&&me(H)})}var O=r(k,2),N=t(O),V=t(N);V.__click=J;var se=t(V,!0);e(V);var w=r(V,2);w.__click=J;var T=t(w);{var B=me=>{var De=ws(),Y=t(De);Sa(Y,{size:10,class:"inline mr-1"});var ee=r(Y);e(De),f(Ee=>i(ee,` ${Ee??""}`),[()=>x()("common.buttons.copied")]),l(me,De)};E(T,me=>{a(q)&&me(B)})}var D=r(T,2);Ir(D,{size:14}),e(w),e(N),e(O);var G=r(O,2);G.__click=()=>ne({isPublished:!1});var ue=t(G,!0);e(G),f((me,De,Y,ee)=>{i(c,` ${me??""}`),Oe(m,"title",De),i(se,a(pe)),Oe(w,"aria-label",Y),i(ue,ee)},[()=>x()("session.publish.public_session"),()=>x()("session.publish.qr_code"),()=>x()("session.publish.copy_link"),()=>x()("session.publish.remove_public")]),l(o,v)};E(Tt,o=>{s.campaign?.isPublished?o(Ot,!1):o(jt)})}e(Et),e(be);var At=r(be,2),xt=t(At),$t=t(xt);$t.__click=()=>I(ie,"enemies");var dt=t($t);_a(dt,{size:14});var ft=r(dt);e($t);var Te=r($t,2);Te.__click=()=>I(ie,"encounters");var vt=t(Te);Va(vt,{size:14});var Dt=r(vt);e(Te),e(xt);var zt=r(xt,2),ht=t(zt);{var Mt=o=>{var v=Cs(),b=Re(v);Ve(b,1,z,A=>A.id,(A,c)=>{var m=zs(),g=t(m),k=t(g);Rr(k,{size:12,class:"text-slate-600 cursor-grab"});var H=r(k,2),O=t(H),N=t(O,!0);e(O);var V=r(O,2),se=t(V);e(V),e(H),e(g);var w=r(g,2);w.__click=()=>Ze(a(c));var T=t(w);ea(T,{size:16}),e(w),e(m),f(B=>{i(N,a(c).name),i(se,`${B??""} ${a(c).difficulty??""}`)},[()=>x()("session.enemies.difficulty")]),l(A,m)});var y=r(b,2);{var F=A=>{var c=$s(),m=t(c,!0);e(c),f(g=>i(m,g),[()=>x()("session.enemies.none")]),l(A,c)};E(y,A=>{z().length===0&&A(F)})}l(o,v)},Pt=o=>{var v=Os(),b=Re(v);Ve(b,1,W,A=>A.id,(A,c)=>{var m=Es(),g=t(m),k=t(g),H=t(k,!0);e(k);var O=r(k,2),N=t(O);e(O),e(g);var V=r(g,2);V.__click=()=>Ge(a(c));var se=t(V);Wa(se,{size:14}),e(V),e(m),f((w,T)=>{i(H,a(c).name),i(N,`${w??""} ${T??""}`)},[()=>a(c).enemies?.reduce((w,T)=>w+T.count,0)||0,()=>x()("session.enemies.title")]),l(A,m)});var y=r(b,2);{var F=A=>{var c=js(),m=t(c,!0);e(c),f(g=>i(m,g),[()=>x()("session.enemies.no_encounters")]),l(A,c)};E(y,A=>{W().length===0&&A(F)})}l(o,v)};E(ht,o=>{a(ie)==="enemies"?o(Mt):o(Pt,!1)})}e(zt),e(At),e(re);var qt=r(re,2),Bt=t(qt),ia=t(Bt),Xt=t(ia);{var Jt=o=>{var v=Ms();v.__click=gt;var b=t(v);Ja(b,{size:20});var y=r(b);e(v),f(F=>i(y,` ${F??""}`),[()=>x()("session.combat.start")]),l(o,v)},na=o=>{var v=Is(),b=t(v);b.__click=Ce;var y=t(b);La(y,{size:20}),e(b);var F=r(b,2),A=t(F),c=t(A,!0);e(A);var m=r(A),g=t(m,!0);e(m),e(F);var k=r(F,2);k.__click=tt;var H=t(k);ur(H,{size:16});var O=r(H);e(k);var N=r(k,4);N.__click=()=>_t();var V=t(N,!0);e(N),e(v),f((se,w,T,B,D)=>{Oe(b,"title",se),i(c,w),i(g,a(lt).round),Oe(k,"title",T),i(O,` ${B??""}`),i(V,D)},[()=>x()("session.combat.previous"),()=>x()("session.combat.round"),()=>x()("session.combat.next"),()=>x()("session.combat.next"),()=>x()("session.combat.end")]),l(o,v)};E(Xt,o=>{a(lt).active?o(na,!1):o(Jt)})}e(ia),e(Bt);var la=r(Bt,2),Kt=t(la);Ve(Kt,25,()=>a(Xe),o=>o.type==="player"?o.id:o.instanceId,(o,v)=>{var b=Ss(),y=t(b);ds(y,{get entity(){return a(v)},updateEnemy:ve,removeFromCombat:L,updatePlayer:U}),e(b),or(b,()=>vs,()=>({duration:300})),l(o,b)});var ua=r(Kt,2);{var ba=o=>{var v=Rs(),b=t(v,!0);e(v),f(y=>i(b,y),[()=>x()("session.combat.empty")]),l(o,v)};E(ua,o=>{a(Xe).length===0&&o(ba)})}e(la),e(qt),Zt(2),e(R);var p=r(R,2);{var h=o=>{var v=As();v.__click=B=>{B.target===B.currentTarget&&I(K,!1)};var b=t(v),y=t(b),F=t(y),A=t(F);br(A,{size:24}),e(F);var c=r(F,2),m=t(c),g=t(m,!0);e(m);var k=r(m,2),H=t(k,!0);e(k),e(c),e(y);var O=r(y,2);Ve(O,21,()=>a(ge),mt,(B,D)=>{var G=Ts(),ue=t(G),me=t(ue);_a(me,{size:14,class:"text-slate-500"});var De=r(me);e(ue);var Y=r(ue,2);Ve(Y,21,()=>a(D).effects,mt,(ee,Ee)=>{var Be=Ns(),Pe=t(Be),ot=t(Pe);e(Pe);var ct=r(Pe,2),te=t(ct,!0);e(ct),e(Be),f(()=>{i(ot,`${a(Ee).name??""}:`),i(te,a(Ee).desc)}),l(ee,Be)}),e(Y),e(G),f(()=>i(De,` ${a(D).name??""}`)),l(B,G)}),e(O);var N=r(O,2),V=t(N);V.__click=()=>I(K,!1);var se=t(V,!0);e(V);var w=r(V,2);w.__click=kt;var T=t(w,!0);e(w),e(N),e(b),e(v),f((B,D,G,ue)=>{i(g,B),i(H,D),i(se,G),i(T,ue)},[()=>x()("session.end_of_round.title"),()=>x()("session.end_of_round.summary"),()=>x()("common.buttons.cancel"),()=>x()("session.end_of_round.advance")]),l(o,v)};E(p,o=>{a(K)&&o(h)})}var X=r(p,2);{var ce=o=>{var v=Hs();v.__click=w=>{w.target===w.currentTarget&&I($,!1)};var b=t(v),y=t(b),F=t(y),A=t(F),c=t(A,!0);e(A);var m=r(A,2),g=t(m,!0);e(m),e(F);var k=r(F,2);k.__click=()=>I($,!1);var H=t(k);va(H,{size:16}),e(k),e(y);var O=r(y,2),N=t(O);Ve(N,17,()=>a(ye),mt,(w,T)=>{var B=Ds();B.__click=()=>we(a(T).id);var D=t(B),G=t(D,!0);e(D);var ue=r(D,2),me=t(ue),De=t(me,!0);e(me);var Y=r(me,2),ee=t(Y);e(Y),e(ue);var Ee=r(ue,2),Be=t(Ee);ea(Be,{size:16}),e(Ee),e(B),f((Pe,ot)=>{i(G,Pe),i(De,a(T).name),i(ee,`${ot??""} ${a(T).level??""} • ${a(T).ancestry??""}`)},[()=>a(T).name.charAt(0),()=>x()("common.labels.level")]),l(w,B)});var V=r(N,2);{var se=w=>{var T=Ps(),B=t(T),D=t(B);_a(D,{size:24}),e(B);var G=r(B,2),ue=t(G,!0);e(G);var me=r(G,2),De=t(me,!0);e(me),e(T),f((Y,ee)=>{i(ue,Y),i(De,ee)},[()=>x()("session.manage_session.no_available"),()=>x()("session.manage_session.all_in_session")]),l(w,T)};E(V,w=>{a(ye).length===0&&w(se)})}e(O),e(b),e(v),f((w,T)=>{i(c,w),i(g,T)},[()=>x()("session.manage_session.title"),()=>x()("session.manage_session.description")]),l(o,v)};E(X,o=>{a($)&&o(ce)})}var Ae=r(X,2);Fa(Ae,{get isOpen(){return j()},onClose:()=>oa.set(!1)});var yt=r(Ae,2);Na(yt,{get isOpen(){return a(P).isOpen},get title(){return a(P).title},get message(){return a(P).message},get onConfirm(){return a(P).onConfirm},onCancel:()=>a(P).isOpen=!1}),f((o,v,b,y)=>{i(Le,` ${o??""} `),i(M,v),He($t,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(ie)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(ft,` ${b??""}`),He(Te,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(ie)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(Dt,` ${y??""}`)},[()=>x()("session.players.title"),()=>a($)?x()("session.players.close"):x()("session.players.add"),()=>x()("session.enemies.title"),()=>x()("session.enemies.encounters")]),l(S,he),aa(),_()}ra(["click"]);var Us=u('<div class="space-y-4"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-size" type="number" step="0.5" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="grid grid-cols-1"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div></div>'),qs=u('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Bs=u('<div class="space-y-6"><div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),Ws=u('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none" placeholder="Nome"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2" placeholder="Descrição..."></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Vs=u('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),Gs=u('<div><div class="flex justify-between items-center mb-3"><h4> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div>'),Qs=u('<div class="space-y-6"></div>'),Js=u('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),Zs=u('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),Xs=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Ks=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Ys=u('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),ei=u('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),ti=u('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),ai=u('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),ri=u('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),si=u('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),ii=u('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),ni=u('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),oi=u('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),li=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-6xl h-[90vh] border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><h3 id="modal-title" class="font-bold text-white text-lg"> </h3> <button class="lg:hidden text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50"><button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3"><button class="px-6 py-2 rounded bg-slate-800 hover:bg-slate-700 text-white font-bold transition-colors"> </button> <button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function di(S,s){ta(s,!0);const n=()=>ut(Ut,"$t",x),[x,z]=sa();let W=Ft(s,"isOpen",3,!1),j=Ft(s,"initialData",3,"{}"),d=Qe(Yt(K())),_=Qe("stats"),$=Qe(!1),q=Qe(""),oe=Qe(void 0);function le(de){const _e=de.target.files;if(_e&&_e.length>0){const Me=_e[0],$e=new FileReader;$e.onload=()=>{I(q,$e.result,!0),I($,!0)},$e.readAsDataURL(Me)}de.target&&(de.target.value="")}async function ie(de){try{const _e=await mr(de);a(d).imageUrl=_e,I($,!1)}catch(_e){console.error(_e),alert(_e.message||"Erro ao salvar imagem")}}function K(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}$a(()=>{if(W()&&j())try{const de=JSON.parse(j());Object.keys(de).length===0?I(d,K(),!0):I(d,{...K(),...de},!0)}catch{I(d,K(),!0)}});function ge(de){a(d)[de]=[...a(d)[de],{name:"",desc:""}]}function P(de,_e){a(d)[de]=a(d)[de].filter((Me,$e)=>$e!==_e)}function pe(de){}var J=pt(),Ue=Re(J);{var lt=de=>{var _e=li(),Me=Re(_e);Me.__click=pe;var $e=t(Me),Fe=t($e),ae=t(Fe),ye=t(ae),ne=t(ye,!0);e(ye);var we=r(ye,2);we.__click=function(...c){s.onClose?.apply(this,c)};var Ne=t(we);va(Ne,{size:20}),e(we),e(ae);var je=r(ae,2),Je=t(je);Je.__click=()=>I(_,"stats");var Ze=t(Je,!0);e(Je);var Ge=r(Je,2);Ge.__click=()=>I(_,"attributes");var gt=t(Ge,!0);e(Ge);var tt=r(Ge,2);tt.__click=()=>I(_,"abilities");var kt=t(tt,!0);e(tt),e(je);var _t=r(je,2),L=t(_t);{var ve=c=>{var m=Us(),g=t(m),k=t(g);k.__click=()=>a(oe)?.click();var H=t(k),O=t(H);qa(O,()=>a(d).imageUrl,ze=>{za(ze,{get hash(){return a(d).imageUrl},get alt(){return a(d).name},size:"custom",fallbackText:"?"})}),e(H);var N=r(H,2),V=t(N);pr(V,{size:20,class:"text-white"}),e(N),e(k);var se=r(k,2),w=t(se),T=t(w,!0);e(w);var B=r(w,2);Nt(B),e(se),e(g);var D=r(g,2),G=t(D),ue=t(G),me=t(ue,!0);e(ue);var De=r(ue);Nt(De),e(G);var Y=r(G,2),ee=t(Y),Ee=t(ee,!0);e(ee);var Be=r(ee);Nt(Be),e(Y),e(D);var Pe=r(D,2),ot=t(Pe),ct=t(ot,!0);e(ot);var te=r(ot,2);Ea(te),e(Pe);var ke=r(Pe,2),Se=t(ke),We=t(Se),it=t(We,!0);e(We);var et=r(We);Nt(et),e(Se),e(ke),e(m),f((ze,It,Rt,Lt,fa,Za)=>{i(T,ze),i(me,It),i(Ee,Rt),i(ct,Lt),Oe(te,"placeholder",fa),i(it,Za)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.speed")]),Ht(B,()=>a(d).name,ze=>a(d).name=ze),Ht(De,()=>a(d).difficulty,ze=>a(d).difficulty=ze),Ht(Be,()=>a(d).size,ze=>a(d).size=ze),Ht(te,()=>a(d).description,ze=>a(d).description=ze),Ht(et,()=>a(d).speed,ze=>a(d).speed=ze),l(c,m)},Ce=c=>{var m=pt(),g=Re(m);{var k=O=>{var N=Bs(),V=t(N),se=t(V),w=t(se,!0);e(se);var T=r(se,2);Ve(T,20,()=>["str","agi","int","wil"],mt,(te,ke)=>{var Se=qs(),We=t(Se),it=t(We,!0);e(We);var et=r(We,2);Nt(et);var ze=r(et,2),It=t(ze);e(ze),e(Se),f(()=>{Oe(We,"for",`attr-${ke??""}`),i(it,ke),Oe(et,"id",`attr-${ke??""}`),He(ze,1,`text-xs font-bold ${a(d).stats[ke]-10>=0?"text-green-500":"text-red-500"}`),i(It,`${a(d).stats[ke]-10>=0?"+":""}${a(d).stats[ke]-10}`)}),Ht(et,()=>a(d).stats[ke],Rt=>a(d).stats[ke]=Rt),l(te,Se)}),e(T),e(V);var B=r(V,2),D=t(B),G=t(D),ue=t(G,!0);e(G);var me=r(G);Nt(me),e(D);var De=r(D,2),Y=t(De),ee=t(Y,!0);e(Y);var Ee=r(Y);Nt(Ee),e(De);var Be=r(De,2),Pe=t(Be),ot=t(Pe,!0);e(Pe);var ct=r(Pe);Nt(ct),e(Be),e(B),e(N),f((te,ke,Se,We,it,et,ze)=>{i(w,te),i(ue,ke),Oe(me,"placeholder",Se),i(ee,We),Oe(Ee,"placeholder",it),i(ot,et),Oe(ct,"placeholder",ze)},[()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder"),()=>n()("session.enemy_modal.languages"),()=>n()("session.enemy_modal.languages_placeholder"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder")]),Ht(me,()=>a(d).senses,te=>a(d).senses=te),Ht(Ee,()=>a(d).languages,te=>a(d).languages=te),Ht(ct,()=>a(d).immune,te=>a(d).immune=te),l(O,N)},H=O=>{var N=pt(),V=Re(N);{var se=w=>{var T=Qs();Ve(T,20,()=>[{key:"traits",title:"Traços (Traits)",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",title:"Ações",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",title:"Reações",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",title:"Fim da Rodada",color:"text-yellow-400",border:"border-yellow-500/30"}],mt,(B,D)=>{var G=Gs(),ue=t(G),me=t(ue),De=t(me,!0);e(me);var Y=r(me,2);Y.__click=()=>ge(D.key);var ee=t(Y);ea(ee,{size:12});var Ee=r(ee);e(Y),e(ue);var Be=r(ue,2),Pe=t(Be);Ve(Pe,17,()=>a(d)[D.key],mt,(te,ke,Se)=>{var We=Ws(),it=t(We),et=t(it);Nt(et);var ze=r(et,2);Ea(ze),e(it);var It=r(it,2);It.__click=()=>P(D.key,Se);var Rt=t(It);ca(Rt,{size:16}),e(It),e(We),Ht(et,()=>a(ke).name,Lt=>a(ke).name=Lt),Ht(ze,()=>a(ke).desc,Lt=>a(ke).desc=Lt),l(te,We)});var ot=r(Pe,2);{var ct=te=>{var ke=Vs(),Se=t(ke,!0);e(ke),f(We=>i(Se,We),[()=>n()("session.enemy_modal.empty")]),l(te,ke)};E(ot,te=>{a(d)[D.key].length===0&&te(ct)})}e(Be),e(G),f(te=>{He(G,1,`p-4 bg-slate-900 rounded border ${D.border??""}`),He(me,1,`font-bold text-sm uppercase ${D.color??""}`),i(De,D.title),i(Ee,` ${te??""}`)},[()=>n()("session.enemy_modal.add")]),l(B,G)}),e(T),l(w,T)};E(V,w=>{a(_)==="abilities"&&w(se)},!0)}l(O,N)};E(g,O=>{a(_)==="attributes"?O(k):O(H,!1)},!0)}l(c,m)};E(L,c=>{a(_)==="stats"?c(ve):c(Ce,!1)})}e(_t);var Ie=r(_t,2),Xe=t(Ie);Xe.__click=function(...c){s.onClose?.apply(this,c)};var at=t(Xe,!0);e(Xe);var U=r(Xe,2);U.__click=()=>s.onSave(a(d));var he=t(U);Qa(he,{size:18});var R=r(he);e(U),e(Ie),e(Fe);var re=r(Fe,2),be=t(re),xe=t(be),fe=t(xe);Ha(fe,{size:14});var rt=r(fe);e(xe),e(be);var Le=r(be,2),Ke=t(Le),bt=t(Ke),C=t(bt);e(bt);var M=r(bt,2),Z=t(M);{var qe=c=>{var m=Js(),g=t(m);za(g,{get hash(){return a(d).imageUrl},get alt(){return a(d).name},size:"custom"}),e(m),l(c,m)};E(Z,c=>{a(d).imageUrl&&c(qe)})}var nt=r(Z,2),Ye=t(nt),st=t(Ye,!0);e(Ye),Zt(2),e(nt),e(M);var St=r(M,2),Ct=t(St),Et=t(Ct),Tt=t(Et,!0);e(Et);var jt=r(Et,2),Ot=t(jt,!0);e(jt),e(Ct);var At=r(Ct,2),xt=t(At),$t=t(xt,!0);e(xt);var dt=r(xt,2),ft=t(dt,!0);e(dt),e(At);var Te=r(At,2),vt=t(Te),Dt=t(vt,!0);e(vt);var zt=r(vt,2),ht=t(zt,!0);e(zt),e(Te);var Mt=r(Te,2),Pt=t(Mt),qt=t(Pt,!0);e(Pt);var Bt=r(Pt,2),ia=t(Bt,!0);e(Bt),e(Mt),e(St);var Xt=r(St,2);Ve(Xt,20,()=>["str","agi","int","wil"],mt,(c,m)=>{var g=Zs(),k=t(g),H=t(k,!0);e(k);var O=r(k,2),N=t(O),V=r(N),se=t(V);e(V),e(O),e(g),f(()=>{i(H,m),i(N,`${a(d).stats[m]??""} `),He(V,1,`text-xs ${a(d).stats[m]-10>=0?"text-green-500":"text-red-500"}`),i(se,`(${a(d).stats[m]-10>=0?"+":""}${a(d).stats[m]-10})`)}),l(c,g)}),e(Xt);var Jt=r(Xt,2),na=t(Jt);{var la=c=>{var m=Xs(),g=t(m),k=t(g);e(g);var H=r(g,2),O=t(H,!0);e(H),e(m),f(N=>{i(k,`${N??""}:`),i(O,a(d).senses)},[()=>n()("session.enemy_modal.senses")]),l(c,m)};E(na,c=>{a(d).senses&&c(la)})}var Kt=r(na,2);{var ua=c=>{var m=Ks(),g=t(m),k=t(g);e(g);var H=r(g,2),O=t(H,!0);e(H),e(m),f(N=>{i(k,`${N??""}:`),i(O,a(d).languages)},[()=>n()("session.enemy_modal.languages")]),l(c,m)};E(Kt,c=>{a(d).languages&&c(ua)})}var ba=r(Kt,2);{var p=c=>{var m=Ys(),g=t(m),k=t(g);e(g);var H=r(g,2),O=t(H,!0);e(H),e(m),f(N=>{i(k,`${N??""}:`),i(O,a(d).immune)},[()=>n()("session.enemy_modal.immunities")]),l(c,m)};E(ba,c=>{a(d).immune&&c(p)})}e(Jt);var h=r(Jt,2),X=t(h);{var ce=c=>{var m=ti(),g=t(m),k=t(g,!0);e(g);var H=r(g,2);Ve(H,17,()=>a(d).traits,mt,(O,N,V,se)=>{var w=ei(),T=t(w),B=t(T);e(T);var D=r(T,2),G=t(D,!0);e(D),e(w),f(()=>{i(B,`${a(N).name??""}:`),i(G,a(N).desc)}),l(O,w)}),e(m),f(O=>i(k,O),[()=>n()("session.enemy_modal.traits")]),l(c,m)};E(X,c=>{a(d).traits.length>0&&c(ce)})}var Ae=r(X,2);{var yt=c=>{var m=ri(),g=t(m),k=t(g,!0);e(g);var H=r(g,2);Ve(H,17,()=>a(d).actions,mt,(O,N,V,se)=>{var w=ai(),T=t(w),B=t(T);e(T);var D=r(T,2),G=t(D,!0);e(D),e(w),f(()=>{i(B,`${a(N).name??""}:`),i(G,a(N).desc)}),l(O,w)}),e(m),f(O=>i(k,O),[()=>n()("session.enemy_modal.actions")]),l(c,m)};E(Ae,c=>{a(d).actions.length>0&&c(yt)})}var o=r(Ae,2);{var v=c=>{var m=ii(),g=t(m),k=t(g,!0);e(g);var H=r(g,2);Ve(H,17,()=>a(d).reactions,mt,(O,N,V,se)=>{var w=si(),T=t(w),B=t(T);e(T);var D=r(T,2),G=t(D,!0);e(D),e(w),f(()=>{i(B,`${a(N).name??""}:`),i(G,a(N).desc)}),l(O,w)}),e(m),f(O=>i(k,O),[()=>n()("session.enemy_modal.reactions")]),l(c,m)};E(o,c=>{a(d).reactions.length>0&&c(v)})}var b=r(o,2);{var y=c=>{var m=oi(),g=t(m),k=t(g,!0);e(g);var H=r(g,2);Ve(H,17,()=>a(d).endOfRound,mt,(O,N,V,se)=>{var w=ni(),T=t(w),B=t(T);e(T);var D=r(T,2),G=t(D,!0);e(D),e(w),f(()=>{i(B,`${a(N).name??""}:`),i(G,a(N).desc)}),l(O,w)}),e(m),f(O=>i(k,O),[()=>n()("session.enemy_modal.end_of_round")]),l(c,m)};E(b,c=>{a(d).endOfRound.length>0&&c(y)})}e(h),e(Ke),e(Le),e(re),e($e),e(Me);var F=r(Me,2);F.__change=le,Cr(F,c=>I(oe,c),()=>a(oe));var A=r(F,2);xr(A,{get isOpen(){return a($)},get imageUrl(){return a(q)},onClose:()=>I($,!1),onCrop:ie}),f((c,m,g,k,H,O,N,V,se,w,T,B,D,G)=>{Oe(Me,"aria-label",c),i(ne,m),He(Je,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(_)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Ze,g),He(Ge,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(_)==="attributes"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(gt,k),He(tt,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(_)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(kt,H),i(at,O),i(R,` ${N??""}`),i(rt,` ${V??""}`),i(C,`${se??""} ${a(d).difficulty??""}`),i(st,w),i(Tt,T),i(Ot,a(d).defense),i($t,B),i(ft,a(d).health),i(Dt,D),i(ht,a(d).size),i(qt,G),i(ia,a(d).speed)},[()=>n()("session.enemy_modal.close"),()=>n()("session.enemy_modal.title"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_attributes"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("common.buttons.cancel"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview"),()=>n()("session.enemy_modal.difficulty"),()=>a(d).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed")]),l(de,_e)};E(Ue,de=>{W()&&de(lt)})}l(S,J),aa(),z()}ra(["click","change"]);var vi=u('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),ci=u('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),ui=u('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),bi=u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function xi(S,s){ta(s,!0);const n=()=>ut(Ut,"$t",z),x=()=>ut(Ca,"$liveEnemies",z),[z,W]=sa();let j=Ft(s,"isOpen",3,!1),d=Ft(s,"initialData",3,"{}"),_=Qe(Yt({name:"",enemies:[]}));$a(()=>{if(j()&&d())try{const P=JSON.parse(d());I(_,{name:P.name||"",enemies:P.enemies||[]},!0)}catch{I(_,{name:"",enemies:[]},!0)}});function $(P){a(_).enemies.find(J=>J.enemyId===P)?a(_).enemies=a(_).enemies.map(J=>J.enemyId===P?{...J,count:J.count+1}:J):a(_).enemies=[...a(_).enemies,{enemyId:P,count:1}]}function q(P){a(_).enemies=a(_).enemies.filter((pe,J)=>J!==P)}function oe(P,pe){const J=Math.max(1,parseInt(pe)||1);a(_).enemies[P].count=J}function le(P){}var ie=pt(),K=Re(ie);{var ge=P=>{var pe=bi();pe.__click=le;var J=t(pe),Ue=t(J),lt=t(Ue),de=t(lt,!0);e(lt);var _e=r(lt,2);_e.__click=function(...R){s.onClose?.apply(this,R)};var Me=t(_e);va(Me,{size:20}),e(_e),e(Ue);var $e=r(Ue,2),Fe=t($e),ae=t(Fe),ye=t(ae,!0);e(ae);var ne=r(ae,2);Nt(ne),e(Fe),e($e);var we=r($e,2),Ne=t(we),je=t(Ne),Je=t(je,!0);e(je);var Ze=r(je,2),Ge=t(Ze);Ve(Ge,17,()=>a(_).enemies,mt,(R,re,be)=>{const xe=Q(()=>x().find(Ye=>Ye.id===a(re).enemyId));var fe=vi(),rt=t(fe),Le=t(rt),Ke=t(Le,!0);e(Le);var bt=r(Le,2),C=t(bt);e(bt),e(rt);var M=r(rt,2),Z=t(M);Nt(Z),Z.__input=Ye=>oe(be,Ye.target.value);var qe=r(Z,2);qe.__click=()=>q(be);var nt=t(qe);ca(nt,{size:16}),e(qe),e(M),e(fe),f(Ye=>{i(Ke,Ye),i(C,`Dif ${(a(xe)?a(xe).difficulty:"?")??""}`),wa(Z,a(re).count)},[()=>a(xe)?a(xe).name:n()("session.encounter_modal.unknown")]),l(R,fe)});var gt=r(Ge,2);{var tt=R=>{var re=ci(),be=t(re,!0);e(re),f(xe=>i(be,xe),[()=>n()("session.encounter_modal.none_added")]),l(R,re)};E(gt,R=>{a(_).enemies.length===0&&R(tt)})}e(Ze),e(Ne);var kt=r(Ne,2),_t=t(kt),L=t(_t,!0);e(_t);var ve=r(_t,2);Ve(ve,5,x,R=>R.id,(R,re)=>{var be=ui(),xe=t(be),fe=t(xe),rt=t(fe,!0);e(fe);var Le=r(fe,2),Ke=t(Le);e(Le),e(xe);var bt=r(xe,2);bt.__click=()=>$(a(re).id);var C=t(bt);ea(C,{size:16}),e(bt),e(be),f(()=>{i(rt,a(re).name),i(Ke,`Dif ${a(re).difficulty??""}`)}),l(R,be)}),e(ve),e(kt),e(we);var Ce=r(we,2),Ie=t(Ce);Ie.__click=function(...R){s.onClose?.apply(this,R)};var Xe=t(Ie,!0);e(Ie);var at=r(Ie,2);at.__click=()=>s.onSave(a(_));var U=t(at);Qa(U,{size:18});var he=r(U);e(at),e(Ce),e(J),e(pe),f((R,re,be,xe,fe,rt,Le,Ke)=>{Oe(pe,"aria-label",R),i(de,re),i(ye,be),Oe(ne,"placeholder",xe),i(Je,fe),i(L,rt),i(Xe,Le),i(he,` ${Ke??""}`)},[()=>n()("session.encounter_modal.close"),()=>n()("session.encounter_modal.title"),()=>n()("session.encounter_modal.name"),()=>n()("session.encounter_modal.name_placeholder"),()=>n()("session.encounter_modal.enemies_in_encounter"),()=>n()("session.encounter_modal.add_enemies"),()=>n()("common.buttons.cancel"),()=>n()("session.encounter_modal.save_encounter")]),Ht(ne,()=>a(_).name,R=>a(_).name=R),l(P,pe)};E(K,P=>{j()&&P(ge)})}l(S,ie),aa(),W()}ra(["click","input"]);var mi=u('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),pi=u('<div class="text-[10px] text-slate-600 italic"> </div>'),_i=u('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="font-bold text-white text-base mb-2 group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),fi=u('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),gi=u('<div class="mb-4 flex-1"><p> </p> <!></div>'),hi=u('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),yi=u('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),wi=u('<div class="text-center text-slate-500 italic col-span-3"> </div>'),ki=u('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function zi(S,s){ta(s,!0);const n=()=>ut(Ca,"$liveEnemies",W),x=()=>ut(Ta,"$liveEncounters",W),z=()=>ut(Ut,"$t",W),[W,j]=sa();let d=Qe(!1),_=Qe(null),$=Qe("{}"),q=Qe(!1),oe=Qe(null),le=Qe("{}"),ie=Qe(Yt({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function K(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function ge(C=null){I(_,C?C.id:null,!0),I($,JSON.stringify(C||K()),!0),I(d,!0)}let P=Yt(new Set);function pe(C){P.has(C)?P.delete(C):P.add(C)}function J(C){const M=a(_)||xa(),Z=wt.get(s.campId);Ia.set(M,{...C,id:M,campaignId:s.campId,system:Z?.system||"sofww"}),I(d,!1)}function Ue(C){const M=n().find(Z=>Z.id===C);I(ie,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${M?.name||"este inimigo"}"?`,onConfirm:()=>{Ia.delete(C),a(ie).isOpen=!1}},!0)}function lt(C=null){I(oe,C?C.id:null,!0),I(le,JSON.stringify(C||{name:"",enemies:[]}),!0),I(q,!0)}function de(C){const M=a(oe)||xa();ha.set(M,{...C,id:M}),I(q,!1)}function _e(C){const M=x().find(Z=>Z.id===C);I(ie,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${M?.name||"este encontro"}"?`,onConfirm:()=>{ha.delete(C),a(ie).isOpen=!1}},!0)}function Me(C){const M=wt.get(s.campId);if(!M)return;const Z=M.activeEnemies||[];let qe=[];C.enemies.forEach(nt=>{const Ye=n().find(st=>st.id===nt.enemyId);if(Ye)for(let st=0;st<nt.count;st++)qe.push({...Ye,instanceId:xa(),damage:0,currentHealth:Ye.health,afflictions:[],acted:!1,initiative:!1})}),wt.set(s.campId,{...M,activeEnemies:[...Z,...qe]})}function $e(C,M){C.dataTransfer.setData("text/plain",M.id),C.dataTransfer.effectAllowed="copy"}function Fe(C){return C.preventDefault(),!1}function ae(C,M){C.preventDefault();const Z=C.dataTransfer.getData("text/plain");if(!Z)return;const qe=M.enemies||[],nt=qe.find(st=>st.enemyId===Z);let Ye;nt?Ye=qe.map(st=>st.enemyId===Z?{...st,count:st.count+1}:st):Ye=[...qe,{enemyId:Z,count:1}],ha.set(M.id,{...M,enemies:Ye})}let ye=Q(()=>wt.get(s.campId)?.system||"sofww"),ne=Q(()=>n().filter(C=>(C.system||"sofww")===a(ye)));var we=ki(),Ne=t(we),je=t(Ne),Je=t(je),Ze=t(Je);Va(Ze,{size:16});var Ge=r(Ze);e(Je),e(je);var gt=r(je,2),tt=t(gt);tt.__click=()=>lt();var kt=t(tt);ea(kt,{size:28,class:"group-hover:scale-110 transition-transform"});var _t=r(kt,2),L=t(_t,!0);e(_t),e(tt);var ve=r(tt,2);Ve(ve,1,x,C=>C.id,(C,M)=>{var Z=_i(),qe=t(Z),nt=t(qe),Ye=t(nt,!0);e(nt);var st=r(nt,2),St=t(st);Ve(St,17,()=>a(M).enemies||[],mt,(Te,vt)=>{const Dt=Q(()=>n().find(Bt=>Bt.id===a(vt).enemyId));var zt=mi(),ht=t(zt),Mt=t(ht);e(ht);var Pt=r(ht,2),qt=t(Pt,!0);e(Pt),e(zt),f(()=>{i(Mt,`${a(vt).count??""}x`),i(qt,a(Dt)?a(Dt).name:"...")}),l(Te,zt)});var Ct=r(St,2);{var Et=Te=>{var vt=pi(),Dt=t(vt,!0);e(vt),f(zt=>i(Dt,zt),[()=>z()("session.bestiary.empty_encounter")]),l(Te,vt)};E(Ct,Te=>{a(M).enemies?.length||Te(Et)})}e(st),e(qe);var Tt=r(qe,2),jt=t(Tt);jt.__click=()=>Me(a(M));var Ot=t(jt);Wa(Ot,{size:12,fill:"currentColor"});var At=r(Ot);e(jt);var xt=r(jt,2);xt.__click=()=>lt(a(M));var $t=t(xt);wr($t,{size:14}),e(xt);var dt=r(xt,2);dt.__click=()=>_e(a(M).id);var ft=t(dt);ca(ft,{size:14}),e(dt),e(Tt),e(Z),f(Te=>{Oe(Z,"aria-label",`Encontro ${a(M).name??""}`),i(Ye,a(M).name),i(At,` ${Te??""}`)},[()=>z()("session.bestiary.start")]),ga("dragover",Z,Fe),ga("drop",Z,Te=>ae(Te,a(M))),l(C,Z)}),e(gt),e(Ne);var Ce=r(Ne,2),Ie=t(Ce),Xe=t(Ie);_a(Xe,{size:16});var at=r(Xe);e(Ie),e(Ce);var U=r(Ce,2),he=t(U);he.__click=()=>ge();var R=t(he);ea(R,{size:32,class:"group-hover:scale-110 transition-transform"});var re=r(R,2),be=t(re,!0);e(re),e(he);var xe=r(he,2);Ve(xe,17,()=>a(ne),C=>C.id,(C,M)=>{var Z=yi(),qe=t(Z),nt=t(qe),Ye=t(nt,!0);e(nt);var st=r(nt,2),St=t(st);e(st),e(qe);var Ct=r(qe,2);{var Et=dt=>{var ft=gi(),Te=t(ft),vt=t(Te,!0);e(Te);var Dt=r(Te,2);{var zt=ht=>{var Mt=fi();Mt.__click=()=>pe(a(M).id);var Pt=t(Mt,!0);e(Mt),f(qt=>i(Pt,qt),[()=>P.has(a(M).id)?z()("session.bestiary.see_less"):z()("session.bestiary.see_more")]),l(ht,Mt)};E(Dt,ht=>{a(M).description.length>120&&ht(zt)})}e(ft),f(ht=>{He(Te,1,`text-xs text-slate-400 leading-relaxed ${ht??""}`),i(vt,a(M).description)},[()=>P.has(a(M).id)?"":"line-clamp-3"]),l(dt,ft)},Tt=dt=>{var ft=hi(),Te=t(ft,!0);e(ft),f(vt=>i(Te,vt),[()=>z()("session.bestiary.no_description")]),l(dt,ft)};E(Ct,dt=>{a(M).description?dt(Et):dt(Tt,!1)})}var jt=r(Ct,2),Ot=t(jt);Ot.__click=()=>ge(a(M));var At=t(Ot,!0);e(Ot);var xt=r(Ot,2);xt.__click=()=>Ue(a(M).id);var $t=t(xt);ca($t,{size:14}),e(xt),e(jt),e(Z),f((dt,ft)=>{i(Ye,a(M).name),i(St,`${dt??""} ${a(M).difficulty??""}`),i(At,ft)},[()=>z()("session.bestiary.level"),()=>z()("common.buttons.edit")]),ga("dragstart",Z,dt=>$e(dt,a(M))),l(C,Z)});var fe=r(xe,2);{var rt=C=>{var M=wi(),Z=t(M,!0);e(M),f(qe=>i(Z,qe),[()=>z()("session.bestiary.no_enemies")]),l(C,M)};E(fe,C=>{a(ne).length===0&&C(rt)})}e(U);var Le=r(U,2);di(Le,{get isOpen(){return a(d)},get initialData(){return a($)},onClose:()=>I(d,!1),onSave:J});var Ke=r(Le,2);xi(Ke,{get isOpen(){return a(q)},get initialData(){return a(le)},onClose:()=>I(q,!1),onSave:de});var bt=r(Ke,2);Na(bt,{get isOpen(){return a(ie).isOpen},get title(){return a(ie).title},get message(){return a(ie).message},get onConfirm(){return a(ie).onConfirm},onCancel:()=>a(ie).isOpen=!1}),e(we),f((C,M,Z,qe)=>{i(Ge,` ${C??""}`),i(L,M),i(at,` ${Z??""}`),i(be,qe)},[()=>z()("session.bestiary.encounters_title"),()=>z()("session.bestiary.new_encounter"),()=>z()("session.bestiary.title"),()=>z()("session.bestiary.new_enemy")]),l(S,we),aa(),j()}ra(["click"]);var $i=u('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),Ci=u('<div class="flex items-center gap-1 text-emerald-400"><!> <span class="text-xs font-bold hidden sm:block"> </span></div> <!>',1),Ei=u('<div class="flex items-center gap-1 text-slate-500"><!> <span class="text-xs hidden sm:block"> </span></div>'),ji=u('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),Oi=u('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group"><!> <!></button> <div class="flex flex-col"><h1 class="text-base sm:text-lg font-black text-white leading-tight truncate max-w-[140px] sm:max-w-none"> </h1> <span class="text-xs text-indigo-400 font-mono font-black uppercase tracking-wider"> </span></div></div> <div class="hidden md:flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block"> </span></button> <button><!> <span class="hidden min-[400px]:block"> </span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 sm:p-2.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all"><!></button> <button class="p-2 sm:p-2.5 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative"><!> <!></button></div></div></div></header>');function Mi(S,s){ta(s,!0);const n=()=>ut(Ut,"$t",j),x=()=>ut(ar,"$syncState",j),z=()=>ut(oa,"$isHistoryOpen",j),W=()=>ut(rr,"$hasUnreadRolls",j),[j,d]=sa();let _=Ft(s,"campaignName",3,""),$=Ft(s,"gmName",3,"Mestre"),q=Ft(s,"activeSubTab",3,"session"),oe=Ft(s,"onTabChange",3,()=>{}),le=Ft(s,"onOpenSettings",3,()=>{});var ie=Oi(),K=t(ie),ge=t(K),P=t(ge),pe=t(P);pe.__click=()=>Er(Pa("/"));var J=t(pe);La(J,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var Ue=r(J,2);_r(Ue,{size:18,class:"hidden sm:block opacity-50"}),e(pe);var lt=r(pe,2),de=t(lt),_e=t(de,!0);e(de);var Me=r(de,2),$e=t(Me,!0);e(Me),e(lt),e(P);var Fe=r(P,2),ae=t(Fe);ae.__click=()=>oe()("session");var ye=t(ae);{let U=Q(()=>q()==="session"?"opacity-100":"opacity-50");Ua(ye,{size:14,get class(){return a(U)}})}var ne=r(ye,2),we=t(ne,!0);e(ne),e(ae);var Ne=r(ae,2);Ne.__click=()=>oe()("bestiary");var je=t(Ne);{let U=Q(()=>q()==="bestiary"?"opacity-100":"opacity-50");Ga(je,{size:14,get class(){return a(U)}})}var Je=r(je,2),Ze=t(Je,!0);e(Je),e(Ne),e(Fe);var Ge=r(Fe,2),gt=t(Ge),tt=t(gt);{var kt=U=>{var he=Ci(),R=Re(he),re=t(R);Da(re,{size:16});var be=r(re,2),xe=t(be,!0);e(be),e(R);var fe=r(R,2);{var rt=Le=>{var Ke=$i(),bt=t(Ke);Aa(bt,{size:14});var C=r(bt,2),M=t(C,!0);e(C),e(Ke),f(Z=>{Oe(Ke,"title",Z),i(M,x().peers.length)},[()=>n()("common.status.peers",{count:x().peers.length})]),l(Le,Ke)};E(fe,Le=>{x().peers.length>0&&Le(rt)})}f((Le,Ke)=>{Oe(R,"title",Le),i(xe,Ke)},[()=>n()("common.status.connected"),()=>n()("common.status.connected")]),l(U,he)},_t=U=>{var he=Ei(),R=t(he);jr(R,{size:16});var re=r(R,2),be=t(re,!0);e(re),e(he),f((xe,fe)=>{Oe(he,"title",xe),i(be,fe)},[()=>n()("common.status.offline"),()=>n()("common.status.offline")]),l(U,he)};E(tt,U=>{x().isConnected?U(kt):U(_t,!1)})}e(gt);var L=r(gt,2);L.__click=function(...U){le()?.apply(this,U)};var ve=t(L);zr(ve,{size:20}),e(L);var Ce=r(L,2);Ce.__click=()=>oa.update(U=>!U);var Ie=t(Ce);fr(Ie,{size:20});var Xe=r(Ie,2);{var at=U=>{var he=ji();l(U,he)};E(Xe,U=>{W()&&U(at)})}e(Ce),e(Ge),e(ge),e(K),e(ie),f((U,he,R,re,be,xe,fe,rt)=>{Oe(pe,"aria-label",U),Oe(pe,"title",he),i(_e,_()),i($e,$()),He(ae,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${q()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),Oe(ae,"aria-pressed",q()==="session"),i(we,R),He(Ne,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${q()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),Oe(Ne,"aria-pressed",q()==="bestiary"),i(Ze,re),Oe(L,"aria-label",be),Oe(L,"title",xe),Oe(Ce,"aria-label",fe),Oe(Ce,"title",rt),Oe(Ce,"aria-pressed",z())},[()=>n()("character.header.back_dashboard"),()=>n()("character.header.back_dashboard"),()=>n()("common.labels.session"),()=>n()("common.labels.bestiary"),()=>n()("common.buttons.settings"),()=>n()("common.buttons.settings"),()=>n()("character.header.history"),()=>n()("character.header.history")]),l(S,ie),aa(),d()}ra(["click"]);var Ii=u('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),Si=u('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),Ri=u('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),Ni=u('<div class="fixed bottom-24 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0 z-[60] flex flex-col items-center gap-2"><div class="bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center gap-2 shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 duration-200"><button class="bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-indigo-500/20"><span class="text-[10px] opacity-70">d20</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">2d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">3d6</span> <!></button> <div class="w-px h-8 bg-white/10 mx-1"></div> <button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button></div></div>  <div class="fixed inset-0 bg-black/40 z-[55]"></div>',1),Ti=u('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!> <!> <div class="hidden md:block fixed bottom-8 left-8 z-[60]"><button class="w-16 h-16 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-[0_0_20px_rgba(79,70,229,0.4)] flex items-center justify-center transition-all active:scale-90 border-2 border-white/10 group" title="Rolagens Rápidas"><!></button></div> <nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-6 pt-2 pointer-events-none"><div class="max-w-md mx-auto relative h-16 pointer-events-auto"><div class="absolute inset-0 bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"></div></div> <div class="relative h-full flex items-center justify-around px-2"><button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Sessão</span></button> <div class="relative w-16 h-16 -mt-10 flex items-center justify-center"><div class="absolute inset-0 bg-indigo-600/20 rounded-full blur-xl animate-pulse"></div> <button class="relative w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(79,70,229,0.5)] border-4 border-slate-900 transition-all active:scale-90 hover:bg-indigo-500 z-10" aria-label="Rolar Dados"><!></button></div> <button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Bestiário</span></button></div></div></nav> <!></div>');function an(S,s){ta(s,!0);const n=()=>ut(Ka,"$page",j),x=()=>ut(nr,"$liveCampaigns",j),z=()=>ut(Ut,"$t",j),W=()=>ut(oa,"$isHistoryOpen",j),[j,d]=sa();let _=Qe("session"),$=Qe(!1),q=Q(()=>n().params.id),oe=Q(()=>x().find(L=>L.id===a(q))),le=Q(()=>!!a(oe));function ie(L){if(!a(q)||!a(oe))return;const ve={...a(oe),...L};wt.set(a(q),ve),ka(a(q),{name:ve.name,gmName:ve.gmName}),I($,!1)}let K=Qe(!1),ge=Qe(Yt({isOpen:!1,sides:20,count:1,modifier:0}));function P(L,ve=1){I(ge,{isOpen:!0,sides:L,count:ve,modifier:0},!0)}function pe(L){if(!a(oe))return;const ve=us(a(ge).sides,a(ge).count,L);let Ce="";a(ge).count>1&&(Ce+=`Dados: [${ve.results.join(", ")}] `),ve.bonusRolls?.length>0&&(Ce+=`Bonus Rolls: [${ve.bonusRolls.join(", ")}] -> ${Math.abs(ve.modifierTotal)}`);const Ie=a(oe).gmName||ya(Ut)("common.labels.master");sr.addToHistory({source:"GM",charName:Ie,name:`${a(ge).count}d${a(ge).sides} ${L?L>0?`+${L}`:L:""}`,description:Ce.trim()||null,total:ve.total,formula:ve.formula,crit:ve.crit}),oa.set(!0),a(ge).isOpen=!1}var J=Ti(),Ue=t(J);{var lt=L=>{var ve=Ii(),Ce=Re(ve);Mi(Ce,{get campaignName(){return a(oe).name},get gmName(){return a(oe).gmName},get activeSubTab(){return a(_)},onTabChange:R=>I(_,R,!0),onOpenSettings:()=>I($,!0)});var Ie=r(Ce,2);{let R=Q(()=>JSON.stringify(a(oe)));$r(Ie,{get isOpen(){return a($)},get initialData(){return a(R)},onClose:()=>I($,!1),onSave:ie})}var Xe=r(Ie,2),at=t(Xe);{var U=R=>{Ls(R,{get campaign(){return a(oe)}})},he=R=>{var re=pt(),be=Re(re);{var xe=fe=>{zi(fe,{get campId(){return a(q)}})};E(be,fe=>{a(_)==="bestiary"&&fe(xe)},!0)}l(R,re)};E(at,R=>{a(_)==="session"?R(U):R(he,!1)})}e(Xe),l(L,ve)},de=L=>{var ve=pt(),Ce=Re(ve);{var Ie=at=>{var U=Si(),he=r(t(U),2),R=t(he,!0);e(he);var re=r(he,2),be=t(re,!0);e(re);var xe=r(re,2);xe.__click=()=>window.history.back();var fe=r(t(xe));e(xe),e(U),f((rt,Le,Ke)=>{i(R,rt),i(be,Le),i(fe,` ${Ke??""}`)},[()=>z()("campaign.not_found.title"),()=>z()("campaign.not_found.message"),()=>z()("common.buttons.back")]),l(at,U)},Xe=at=>{var U=Ri();l(at,U)};E(Ce,at=>{a(le)&&!a(oe)?at(Ie):at(Xe,!1)},!0)}l(L,ve)};E(Ue,L=>{a(le)&&a(oe)?L(lt):L(de,!1)})}var _e=r(Ue,2);Fa(_e,{get isOpen(){return W()},onClose:()=>oa.set(!1)});var Me=r(_e,2);{var $e=L=>{var ve=Ni(),Ce=Re(ve),Ie=t(Ce),Xe=t(Ie);Xe.__click=()=>{P(20),I(K,!1)};var at=r(t(Xe),2);da(at,{size:16}),e(Xe);var U=r(Xe,2);U.__click=()=>{P(6),I(K,!1)};var he=r(t(U),2);da(he,{size:16}),e(U);var R=r(U,2);R.__click=()=>{P(6,2),I(K,!1)};var re=r(t(R),2);da(re,{size:16}),e(R);var be=r(R,2);be.__click=()=>{P(6,3),I(K,!1)};var xe=r(t(be),2);da(xe,{size:16}),e(be);var fe=r(be,4);fe.__click=()=>I(K,!1);var rt=t(fe);va(rt,{size:20}),e(fe),e(Ie),e(Ce);var Le=r(Ce,2);Le.__click=()=>I(K,!1),l(L,ve)};E(Me,L=>{a(K)&&L($e)})}var Fe=r(Me,2),ae=t(Fe);ae.__click=()=>I(K,!a(K));var ye=t(ae);da(ye,{size:32,class:"group-hover:rotate-12 transition-transform"}),e(ae),e(Fe);var ne=r(Fe,2),we=t(ne),Ne=r(t(we),2),je=t(Ne);je.__click=()=>{I(_,"session"),I(K,!1)};var Je=t(je);{let L=Q(()=>a(_)==="session"?"animate-in zoom-in-75 duration-300":"");Ua(Je,{size:20,get class(){return a(L)}})}Zt(2),e(je);var Ze=r(je,2),Ge=r(t(Ze),2);Ge.__click=()=>I(K,!a(K));var gt=t(Ge);{let L=Q(()=>a(K)?"rotate-90":"rotate-0");da(gt,{size:28,get class(){return`text-white ${a(L)??""} transition-transform duration-300`}})}e(Ge),e(Ze);var tt=r(Ze,2);tt.__click=()=>{I(_,"bestiary"),I(K,!1)};var kt=t(tt);{let L=Q(()=>a(_)==="bestiary"?"animate-in zoom-in-75 duration-300":"");Ga(kt,{size:20,get class(){return a(L)}})}Zt(2),e(tt),e(Ne),e(we),e(ne);var _t=r(ne,2);{let L=Q(()=>`${z()("session.quick.roll_title")} (${a(ge).count}d${a(ge).sides})`),ve=Q(()=>a(ge).sides===20?z()("session.quick.boons_banes"):z()("session.quick.fixed_modifier"));gr(_t,{get isOpen(){return a(ge).isOpen},get title(){return a(L)},get label(){return a(ve)},onClose:()=>a(ge).isOpen=!1,onRoll:pe,initialModifier:0})}e(J),f(()=>{He(je,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(_)==="session"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),He(tt,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(_)==="bestiary"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`)}),l(S,J),aa(),d()}ra(["click"]);export{an as component};
