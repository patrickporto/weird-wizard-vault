import"../chunks/DsnmJJEf.js";import"../chunks/1d2PQuzn.js";import{v as ue,w as z,k as p,x as vt,j as y,z as ut,F as u,R as H,y as i,A as s,B as t,I as e,t as O,a2 as Ga,L as $t,n as et,aq as os,U as rs,b7 as Kt,T as Dt}from"../chunks/D6Pz1OcM.js";import{d as pt,o as Aa,s as g,w as la,g as ye,e as Qe}from"../chunks/CCHuTdEV.js";import{l as tt,s as at,i as B,p as St}from"../chunks/DSn_IzLH.js";import{h as yt}from"../chunks/-CdcaW8x.js";import{a as ze,$ as Lt,e as At,s as Be,i as ns,r as Ve,f as Xt,g as Zt}from"../chunks/D_y7S3KX.js";import{s as Ht,a as xe}from"../chunks/DRdbpf1Q.js";import{I as st,s as ot}from"../chunks/B3F2ylC7.js";import{X as is,M as Ua,a as ls,T as Ia,P as Qt,q as Nt,b as ds}from"../chunks/CfkvuZVU.js";import{t as kt,a as cs,f as Pt}from"../chunks/BouNVTfo.js";import{D as Ge,G as Ut,S as vs,l as Oa,a as ra,b as us,c as ps,C as gs,g as ea}from"../chunks/C0Q8mMo1.js";import{b as Ye,h as qe,d as ce,e as ve,f as jt,g as Mt,k as na,u as za,p as fs}from"../chunks/D9LWGkM2.js";import{b as ms,g as Bt}from"../chunks/BwJOTeE9.js";import{U as Ta,r as Gt,W as hs}from"../chunks/BQ-QHdNf.js";import{C as bs,G as ta,a as xs,P as Da}from"../chunks/Dxz7SzsP.js";import{U as da,L as _s}from"../chunks/Dh_xQme8.js";import{h as ws}from"../chunks/BYmFNSF7.js";function ys(v,o){const d=tt(o,["children","$$slots","$$events","$$legacy"]);const l=[["circle",{cx:"12",cy:"12",r:"10"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16"}]];st(v,at({name:"circle-alert"},()=>d,{get iconNode(){return l},children:(n,r)=>{var a=ue(),f=z(a);ot(f,o,"default",{}),p(n,a)},$$slots:{default:!0}}))}function ks(v,o){const d=tt(o,["children","$$slots","$$events","$$legacy"]);const l=[["path",{d:"m2 2 20 20"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07"}]];st(v,at({name:"cloud-off"},()=>d,{get iconNode(){return l},children:(n,r)=>{var a=ue(),f=z(a);ot(f,o,"default",{}),p(n,a)},$$slots:{default:!0}}))}function $s(v,o){const d=tt(o,["children","$$slots","$$events","$$legacy"]);const l=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z"}]];st(v,at({name:"cloud"},()=>d,{get iconNode(){return l},children:(n,r)=>{var a=ue(),f=z(a);ot(f,o,"default",{}),p(n,a)},$$slots:{default:!0}}))}function Na(v,o){const d=tt(o,["children","$$slots","$$events","$$legacy"]);const l=[["path",{d:"M12 15V3"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}],["path",{d:"m7 10 5 5 5-5"}]];st(v,at({name:"download"},()=>d,{get iconNode(){return l},children:(n,r)=>{var a=ue(),f=z(a);ot(f,o,"default",{}),p(n,a)},$$slots:{default:!0}}))}function Ss(v,o){const d=tt(o,["children","$$slots","$$events","$$legacy"]);const l=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56"}]];st(v,at({name:"loader-circle"},()=>d,{get iconNode(){return l},children:(n,r)=>{var a=ue(),f=z(a);ot(f,o,"default",{}),p(n,a)},$$slots:{default:!0}}))}function Cs(v,o){const d=tt(o,["children","$$slots","$$events","$$legacy"]);const l=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]];st(v,at({name:"refresh-cw"},()=>d,{get iconNode(){return l},children:(n,r)=>{var a=ue(),f=z(a);ot(f,o,"default",{}),p(n,a)},$$slots:{default:!0}}))}function aa(v,o){const d=tt(o,["children","$$slots","$$events","$$legacy"]);const l=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3"}]];st(v,at({name:"scroll"},()=>d,{get iconNode(){return l},children:(n,r)=>{var a=ue(),f=z(a);ot(f,o,"default",{}),p(n,a)},$$slots:{default:!0}}))}var Es=y('<button class="fixed bottom-28 md:bottom-6 right-6 z-[60] bg-indigo-600 hover:bg-indigo-500 text-white h-14 px-4 rounded-full shadow-2xl shadow-indigo-900/50 flex items-center justify-center font-bold animate-pulse hover:animate-none transition-all active:scale-95 group"><!> <span class="text-sm uppercase tracking-wider max-w-0 overflow-hidden ml-0 group-hover:max-w-xs group-hover:ml-2 transition-all duration-300 md:max-w-xs md:ml-2 md:inline"> </span></button>'),Is=y("<div><!></div>"),zs=y("<div><!></div>"),Ts=y('<li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">1</span> <!></li> <li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">2</span> <div><!></div></li>',1),Ds=y('<li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">1</span> <div><!></div></li> <li class="flex items-start gap-3"><span class="flex-shrink-0 w-6 h-6 rounded-full bg-slate-800 flex items-center justify-center font-bold text-xs border border-slate-700 text-indigo-400">2</span> <div><!></div></li>',1),Ns=y('<div class="fixed inset-0 z-50 bg-black/80 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 animate-in fade-in"><div class="bg-slate-900 border border-slate-700 rounded-2xl p-6 max-w-sm w-full relative shadow-2xl mb-4 sm:mb-0 animate-in slide-in-from-bottom-10 sm:slide-in-from-bottom-0 sm:zoom-in-95"><button class="absolute top-4 right-4 text-slate-400 hover:text-white p-1"><!></button> <h3 class="text-xl font-bold text-white mb-4 flex items-center gap-2"><!> </h3> <ol class="space-y-4 text-slate-300 text-sm"><!></ol> <div class="mt-6 text-center"><button class="text-indigo-400 text-sm font-bold hover:text-indigo-300"> </button></div></div></div>'),Ps=y("<!> <!>",1);function js(v,o){vt(o,!0);const d=()=>xe(Lt,"$t",l),[l,n]=Ht();let r=H(null),a=H(!1),f=H(!1),b=H(!1),x=H(!1);Aa(()=>{if(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone){u(a,!1);return}const _=window.navigator.userAgent;u(b,/iPad|iPhone|iPod/.test(_)&&!window.MSStream,!0),u(x,/CriOS/i.test(_),!0),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(_)&&u(a,!0),window.addEventListener("beforeinstallprompt",D=>{D.preventDefault(),u(r,D,!0),u(a,!0)}),window.addEventListener("appinstalled",()=>{u(r,null),u(a,!1),u(f,!1)})});async function L(){if(i(r)){i(r).prompt();const{outcome:C}=await i(r).userChoice;C==="accepted"&&(u(r,null),u(a,!1))}else u(f,!0)}const S="inline w-3.5 h-3.5",q=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${S}"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" x2="12" y1="2" y2="15"/></svg>`,F=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${S}"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M8 12h8"/><path d="M12 8v8"/></svg>`,R=`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${S}"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></svg>`;function Q(C,_){const T=d()(C),D=`<span class="inline-flex items-center justify-center bg-slate-800 p-1 rounded mx-1 align-middle">${_}</span>`;return T.replace("{icon}",D)}var ee=Ps(),E=z(ee);{var J=C=>{var _=Es();_.__click=L;var T=t(_);Na(T,{size:24});var D=s(T,2),ae=t(D,!0);e(D),e(_),O((w,k)=>{ze(_,"aria-label",w),g(ae,k)},[()=>d()("home.install.button"),()=>d()("home.install.button")]),p(C,_)};B(E,C=>{i(a)&&C(J)})}var G=s(E,2);{var m=C=>{var _=Ns(),T=t(_),D=t(T);D.__click=()=>u(f,!1);var ae=t(D);is(ae,{size:20}),e(D);var w=s(D,2),k=t(w);Na(k,{size:24,class:"text-indigo-500"});var N=s(k);e(w);var W=s(w,2),K=t(W);{var A=j=>{var M=Ts(),V=z(M),pe=s(t(V),2);{var _e=le=>{var me=Is(),de=t(me);yt(de,()=>Q("home.install.ios_chrome_step1",q)),e(me),p(le,me)},ne=le=>{var me=zs(),de=t(me);yt(de,()=>Q("home.install.ios_step1",q)),e(me),p(le,me)};B(pe,le=>{i(x)?le(_e):le(ne,!1)})}e(V);var te=s(V,2),ie=s(t(te),2),Te=t(ie);yt(Te,()=>Q("home.install.ios_step2",F)),e(ie),e(te),p(j,M)},P=j=>{var M=Ds(),V=z(M),pe=s(t(V),2),_e=t(pe);yt(_e,()=>Q("home.install.android_step1",R)),e(pe),e(V);var ne=s(V,2),te=s(t(ne),2),ie=t(te);yt(ie,()=>d()("home.install.android_step2")),e(te),e(ne),p(j,M)};B(K,j=>{i(b)?j(A):j(P,!1)})}e(W);var Z=s(W,2),fe=t(Z);fe.__click=()=>u(f,!1);var U=t(fe,!0);e(fe),e(Z),e(T),e(_),O((j,M)=>{g(N,` ${j??""}`),g(U,M)},[()=>d()("home.install.title"),()=>d()("home.install.close")]),p(C,_)};B(G,C=>{i(f)&&C(m)})}p(v,ee),ut(),n()}pt(["click"]);var Ms=y('<span class="text-[9px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded uppercase tracking-wider">Em Breve</span>'),Bs=y('<div class="w-2 h-2 rounded-full bg-indigo-500 shadow-[0_0_8px_rgba(99,102,241,0.5)]"></div>'),Gs=y('<button><div class="flex-1"><div class="font-bold text-sm flex items-center gap-2"> <!></div> <div class="text-[10px] opacity-60 mt-0.5"> </div></div> <!></button>'),As=y('<div class="space-y-4"><div><label class="text-xs text-slate-500 uppercase font-black block mb-2 tracking-widest flex items-center gap-1"><!> Sistema de Jogo</label> <div class="grid grid-cols-1 gap-2"></div></div> <div><label for="char-name" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest">Nome do Personagem</label> <input id="char-name" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors" placeholder="Ex: Alaric, o Errante"/></div> <div><label for="char-player" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest flex items-center gap-1"><!> Nome do Jogador</label> <input id="char-player" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors" placeholder="Seu nome ou apelido"/></div> <div class="grid grid-cols-2 gap-4"><div><label for="char-ancestry" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest">Ancestralidade</label> <input id="char-ancestry" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors" placeholder="Ex: Humano"/></div> <div><label for="char-level" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest">NÃ­vel</label> <input id="char-level" type="number" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div></div> <div><label for="char-path" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest">Trilha Inicial (Novice)</label> <input id="char-path" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors" placeholder="Ex: Guerreiro, Mago"/></div> <div class="grid grid-cols-2 gap-4"><div><label for="char-defense" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest">Defesa</label> <input id="char-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div> <div><label for="char-health" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest">Vida MÃ¡xima</label> <input id="char-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors"/></div></div></div> <div class="flex gap-3 mt-8"><button class="flex-1 bg-slate-700 hover:bg-slate-600 transition-all py-3 rounded-xl text-white font-bold active:scale-95">Cancelar</button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 transition-all py-3 rounded-xl text-white font-bold shadow-lg shadow-indigo-900/20 active:scale-95">Criar Personagem</button></div>',1);function Us(v,o){vt(o,!0);let d=St(o,"isOpen",3,!1),l=St(o,"initialData",3,"{}"),n=Ga({name:"",playerName:"",ancestry:"",novicePath:"",level:1,defense:10,health:24,system:Ge});$t(()=>{if(d()&&l())try{const a=JSON.parse(l());n.name=a.name||"",n.playerName=a.playerName||"",n.ancestry=a.ancestry||"",n.novicePath=a.paths&&a.paths.novice?a.paths.novice:"",n.level=a.level||1,n.defense=a.defense||10,n.health=a.health||a.normalHealth||24,n.system=a.system||Ge}catch{n.name="",n.playerName="",n.ancestry="",n.novicePath="",n.level=1,n.defense=10,n.health=24,n.system=Ge}});function r(){o.onSave({...n})}Ua(v,{get isOpen(){return d()},get onClose(){return o.onClose},title:"Novo Personagem",maxWidth:"max-w-md",children:(a,f)=>{var b=As(),x=z(b),L=t(x),S=t(L),q=t(S);Ut(q,{size:12}),et(),e(S);var F=s(S,2);At(F,21,()=>vs,ns,(U,j)=>{var M=Gs();M.__click=()=>!i(j).disabled&&(n.system=i(j).id);var V=t(M),pe=t(V),_e=t(pe),ne=s(_e);{var te=de=>{var gt=Ms();p(de,gt)};B(ne,de=>{i(j).comingSoon&&de(te)})}e(pe);var ie=s(pe,2),Te=t(ie,!0);e(ie),e(V);var le=s(V,2);{var me=de=>{var gt=Bs();p(de,gt)};B(le,de=>{n.system===i(j).id&&de(me)})}e(M),O(()=>{Be(M,1,`relative flex items-center p-3 rounded-lg border text-left transition-all ${n.system===i(j).id?"bg-indigo-600/20 border-indigo-500 text-white":"bg-slate-900 border-slate-700 text-slate-400 hover:border-slate-600"} ${i(j).disabled?"opacity-60 cursor-not-allowed":""}`),M.disabled=i(j).disabled,g(_e,`${i(j).name??""} `),g(Te,i(j).description)}),p(U,M)}),e(F),e(L);var R=s(L,2),Q=s(t(R),2);Ve(Q),e(R);var ee=s(R,2),E=t(ee),J=t(E);da(J,{size:12}),et(),e(E);var G=s(E,2);Ve(G),e(ee);var m=s(ee,2),C=t(m),_=s(t(C),2);Ve(_),e(C);var T=s(C,2),D=s(t(T),2);Ve(D),e(T),e(m);var ae=s(m,2),w=s(t(ae),2);Ve(w),e(ae);var k=s(ae,2),N=t(k),W=s(t(N),2);Ve(W),e(N);var K=s(N,2),A=s(t(K),2);Ve(A),e(K),e(k),e(x);var P=s(x,2),Z=t(P);Z.__click=function(...U){o.onClose?.apply(this,U)};var fe=s(Z,2);fe.__click=r,e(P),Ye(Q,()=>n.name,U=>n.name=U),Ye(G,()=>n.playerName,U=>n.playerName=U),Ye(_,()=>n.ancestry,U=>n.ancestry=U),Ye(D,()=>n.level,U=>n.level=U),Ye(w,()=>n.novicePath,U=>n.novicePath=U),Ye(W,()=>n.defense,U=>n.defense=U),Ye(A,()=>n.health,U=>n.health=U),p(a,b)},$$slots:{default:!0}}),ut()}pt(["click"]);var Os=y('<div class="space-y-5"><div><label for="settings-player-name" class="text-xs text-slate-500 uppercase font-black block mb-1 tracking-widest flex items-center gap-1"><!> Nome do Jogador</label> <input id="settings-player-name" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-white outline-none focus:border-indigo-500 transition-colors" placeholder="Seu nome ou apelido"/> <p class="text-[10px] text-slate-500 mt-1">O nome do jogador associado a este personagem.</p></div></div> <div class="flex flex-col-reverse sm:flex-row gap-3 mt-6"><button class="flex-1 bg-slate-700 hover:bg-slate-600 transition-all py-4 sm:py-3 rounded-xl text-white font-bold active:scale-95">Cancelar</button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 transition-all py-4 sm:py-3 rounded-xl text-white font-bold shadow-lg shadow-indigo-900/20 active:scale-95">Salvar</button></div>',1);function Fs(v,o){vt(o,!0);let d=St(o,"isOpen",3,!1),l=St(o,"characterData",3,null),n=H("");$t(()=>{d()&&l()&&u(n,l().playerName||"",!0)});function r(){o.onSave({playerName:i(n)})}Ua(v,{get isOpen(){return d()},get onClose(){return o.onClose},title:"âš™ï¸ ConfiguraÃ§Ãµes do Personagem",maxWidth:"max-w-md",children:(a,f)=>{var b=Os(),x=z(b),L=t(x),S=t(L),q=t(S);da(q,{size:12}),et(),e(S);var F=s(S,2);Ve(F),et(2),e(L),e(x);var R=s(x,2),Q=t(R);Q.__click=function(...E){o.onClose?.apply(this,E)};var ee=s(Q,2);ee.__click=r,e(R),Ye(F,()=>i(n),E=>u(n,E)),p(a,b)},$$slots:{default:!0}}),ut()}pt(["click"]);const Je=la("idle"),ca=la(null),Ls="701898444454-7ml9onnv529k99rkvgh1slhdj4a1arrm.apps.googleusercontent.com",Pa="https://www.googleapis.com/auth/drive.appdata https://www.googleapis.com/auth/userinfo.profile",re=la({signedIn:!1,accessToken:null,tokenExpiry:null,userProfile:null,isInited:!1});let Ot,ja=!1;const ct="wwv_google_session";function Hs(){localStorage.removeItem(ct),re.update(v=>({...v,signedIn:!1,accessToken:null,tokenExpiry:null,userProfile:null})),console.log("Session cleared due to expired or invalid token")}async function Ft(){Hs(),console.warn("OAuth token expired or invalid. Please sign in again.")}async function Fa(v){try{const o=await fetch("https://www.googleapis.com/oauth2/v1/userinfo?alt=json",{headers:{Authorization:`Bearer ${v}`}});if(o.status===401){await Ft();return}if(o.ok){const d=await o.json();re.update(l=>({...l,userProfile:{name:d.name,picture:d.picture}})),La()}}catch(o){console.error("Failed to fetch user profile:",o)}}function Rs(){try{const v=localStorage.getItem(ct);if(v){const o=JSON.parse(v);if(o.accessToken)return o.tokenExpiry&&Date.now()>o.tokenExpiry?(console.log("Stored token is expired, clearing session"),localStorage.removeItem(ct),!1):(re.set({signedIn:!0,accessToken:o.accessToken,tokenExpiry:o.tokenExpiry||null,userProfile:o.userProfile||null,isInited:!0}),console.log("Restored session from localStorage"),Fa(o.accessToken),!0)}}catch(v){console.error("Failed to load stored session:",v)}return!1}function La(){const v=ye(re);v.signedIn&&v.accessToken?localStorage.setItem(ct,JSON.stringify({accessToken:v.accessToken,tokenExpiry:v.tokenExpiry,userProfile:v.userProfile})):localStorage.removeItem(ct)}async function Vs(){const v=Ls;if(Rs()){try{await Ba(),Ot=google.accounts.oauth2.initTokenClient({client_id:v,scope:Pa,callback:Ma}),ja=!0}catch(d){console.warn("Could not initialize GIS after restoring session:",d)}return}try{await Ba(),Ot=google.accounts.oauth2.initTokenClient({client_id:v,scope:Pa,callback:Ma}),ja=!0,re.update(d=>({...d,isInited:!0})),console.log("Google Auth Initialized")}catch(d){console.error("Failed to initialize Google Auth:",d),re.update(l=>({...l,isInited:!0})),alert("Falha ao inicializar Google Auth. Verifique sua conexÃ£o/Console.")}}function Ma(v){if(v.error!==void 0){console.error("Google Auth Error:",v);return}console.log("Google Auth Success",v);const o=v.expires_in||3600,d=Date.now()+o*1e3;re.update(l=>({...l,signedIn:!0,accessToken:v.access_token,tokenExpiry:d})),La(),Fa(v.access_token)}function Ba(){return new Promise((v,o)=>{if(typeof google<"u"&&google.accounts){v();return}const d=document.createElement("script");d.src="https://accounts.google.com/gsi/client",d.async=!0,d.defer=!0,d.onload=()=>{const l=setInterval(()=>{typeof google<"u"&&google.accounts&&(clearInterval(l),v())},50);setTimeout(()=>{clearInterval(l),(typeof google>"u"||!google.accounts)&&o(new Error("Google object not available after script load"))},3e3)},d.onerror=()=>{o(new Error("Failed to load Google Identity Services script"))},document.head.appendChild(d)})}function Ha(){Ot?Ot.requestAccessToken():(console.error("Google Auth not initialized"),alert("Google Auth ainda nÃ£o inicializou. Tente novamente em alguns segundos."))}function Ys(){const v=ye(re).accessToken;localStorage.removeItem(ct),re.update(o=>({...o,signedIn:!1,accessToken:null,tokenExpiry:null,userProfile:null})),v&&typeof google<"u"&&google.accounts&&google.accounts.oauth2.revoke(v,()=>{console.log("Access token revoked")})}async function Ra(){const v=ye(re),o=v.accessToken;if(!o)throw new Error("Not signed in");if(v.tokenExpiry&&Date.now()>v.tokenExpiry)throw await Ft(),new Error("Token expired, please sign in again");const l=`https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent("name = 'weird-wizard-backup.json' and 'appDataFolder' in parents and trashed = false")}&spaces=appDataFolder&fields=files(id, name, modifiedTime, size)`,n=await fetch(l,{headers:{Authorization:`Bearer ${o}`}});if(n.status===401)throw await Ft(),new Error("Token expired, please sign in again");if(!n.ok)throw new Error("Failed to list backups: "+n.statusText);return(await n.json()).files||[]}async function qs(v){const o=ye(re).accessToken;if(!o)throw new Error("Not signed in");const d=JSON.stringify(v),l="weird-wizard-backup.json",n=await Ra(),r=n.length>0?n[0].id:null;if(r){const a=`https://www.googleapis.com/upload/drive/v3/files/${r}?uploadType=media`,f=await fetch(a,{method:"PATCH",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:d});if(!f.ok){const b=await f.text();throw console.error("Upload error details:",b),new Error("Upload failed: "+f.statusText)}return await f.json()}else{const a={name:l,mimeType:"application/json",parents:["appDataFolder"]},f=new FormData;f.append("metadata",new Blob([JSON.stringify(a)],{type:"application/json"})),f.append("file",new Blob([d],{type:"application/json"}));const x=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:{Authorization:`Bearer ${o}`},body:f});if(!x.ok){const L=await x.text();throw console.error("Upload error details:",L),new Error("Upload failed: "+x.statusText)}return await x.json()}}async function Js(v){const o=ye(re).accessToken;if(!o)throw new Error("Not signed in");const d=`https://www.googleapis.com/drive/v3/files/${v}?alt=media`,l=await fetch(d,{headers:{Authorization:`Bearer ${o}`}});if(l.status===401)throw await Ft(),new Error("Token expired, please sign in again");if(!l.ok)throw new Error("Download failed: "+l.statusText);return await l.json()}let sa;async function ia(){if(ye(re).accessToken)try{console.log("Syncing from cloud..."),Je.set("syncing");const o=await Ra();if(o.length===0){console.log("No backups found in cloud."),Je.set("success");return}const d=o[0].id,l=await Js(d),n=new Set;if(qe.forEach((r,a)=>{n.add(String(a)),console.log("[DEBUG] Local deleted ID entry:",{key:a,type:typeof a,val:r})}),console.log("[DEBUG] Total locally deleted IDs:",n.size),l.deletedIds&&Array.isArray(l.deletedIds)){console.log("[DEBUG] Cloud data deletedIds count:",l.deletedIds.length);for(const r of l.deletedIds){const a=String(r.id);qe.has(a)||(qe.set(a,r),console.log("[DEBUG] New deletion synced from cloud:",a)),n.add(a),r.type==="character"&&ce.has(a)&&(ce.delete(a),console.log("[DEBUG] Removed char locally based on cloud deletion:",a)),r.type==="campaign"&&ve.has(a)&&(ve.delete(a),console.log("[DEBUG] Removed camp locally based on cloud deletion:",a)),r.type==="enemy"&&jt.has(a)&&(jt.delete(a),console.log("[DEBUG] Removed enemy locally based on cloud deletion:",a)),r.type==="encounter"&&Mt.has(a)&&(Mt.delete(a),console.log("[DEBUG] Removed encounter locally based on cloud deletion:",a))}}if(l.characters&&Array.isArray(l.characters)){console.log("[DEBUG] Syncing",l.characters.length,"characters from cloud");for(const r of l.characters){const a=String(r.id);if(n.has(a)||qe.has(a)){console.log("[DEBUG] Skipping character because it is marked as deleted:",{id:a,name:r.name}),ce.has(a)&&(console.log("[DEBUG] Character found locally but marked deleted. Removing now:",a),ce.delete(a));for(const b of ce.keys()){const x=ce.get(b);x&&x.id===a&&(console.log("[DEBUG] Mismatched key entry found for deleted char. Removing:",b),ce.delete(b))}continue}ce.get(a)||(console.log("[DEBUG] ADDING character from cloud (missing locally):",{id:a,name:r.name}),ce.set(a,r))}}if(l.campaigns&&Array.isArray(l.campaigns)){console.log("[DEBUG] Syncing",l.campaigns.length,"campaigns from cloud");for(const r of l.campaigns){const a=String(r.id);if(n.has(a)||qe.has(a)){console.log("[DEBUG] Skipping campaign because it is marked as deleted:",{id:a,name:r.name}),ve.has(a)&&(console.log("[DEBUG] Campaign found locally but marked deleted. Removing now:",a),ve.delete(a));for(const b of ve.keys()){const x=ve.get(b);x&&x.id===a&&(console.log("[DEBUG] Mismatched key entry found for deleted camp. Removing:",b),ve.delete(b))}continue}ve.get(a)||(console.log("[DEBUG] ADDING campaign from cloud (missing locally):",{id:a,name:r.name}),ve.set(a,r))}}if(l.enemies&&Array.isArray(l.enemies))for(const r of l.enemies){const a=String(r.id);!n.has(a)&&!jt.has(a)&&jt.set(a,r)}if(l.encounters&&Array.isArray(l.encounters))for(const r of l.encounters){const a=String(r.id);!n.has(a)&&!Mt.has(a)&&Mt.set(a,r)}if(l.images&&typeof l.images=="object"){console.log("[DEBUG] Syncing",Object.keys(l.images).length,"images from cloud");for(const[r,a]of Object.entries(l.images))na.has(r)||(na.set(r,a),console.log("[DEBUG] New image synced from cloud:",r))}console.log("[DEBUG] Sync from cloud complete."),Je.set("success"),ca.set(Date.now())}catch(o){console.error("Failed to sync from cloud:",o),Je.set("error")}}async function oa(){ye(re).accessToken&&(sa&&clearTimeout(sa),sa=setTimeout(async()=>{try{console.log("Syncing to cloud..."),Je.set("syncing");const o=[],d=new Set;qe.forEach((x,L)=>{o.push({id:L,...x}),d.add(String(L))});const l=ye(Oa).filter(x=>!d.has(String(x.id))),n=ye(ra).filter(x=>!d.has(String(x.id))),r=ye(us).filter(x=>!d.has(String(x.id))),a=ye(ps).filter(x=>!d.has(String(x.id))),f={};na.forEach((x,L)=>{f[L]=x});const b={characters:l,campaigns:n,enemies:r,encounters:a,images:f,deletedIds:o,timestamp:Date.now(),version:1,appName:"WeirdWizardVault"};console.log("[DEBUG] Uploading to cloud:",{charactersCount:b.characters.length,campaignsCount:b.campaigns.length,enemiesCount:r.length,imagesCount:Object.keys(f).length,deletedIdsCount:o.length}),await qs(b),console.log("Sync to cloud complete."),Je.set("success"),ca.set(Date.now())}catch(o){console.error("Failed to sync to cloud:",o),Je.set("error")}},2e3))}var Ws=y('<img alt="Avatar" class="w-10 h-10 rounded-full border-2 border-indigo-500/50 shadow-lg object-cover"/>'),Ks=y('<div class="w-10 h-10 rounded-full bg-indigo-600 flex items-center justify-center text-white border-2 border-indigo-400/30 shadow-lg"><span class="font-bold text-lg"><!></span></div>'),Xs=y('<div class="absolute right-0 top-full mt-2 w-48 bg-slate-800 rounded-xl shadow-xl border border-slate-700 p-2 z-50 animate-in fade-in slide-in-from-top-2"><div class="px-3 py-2 border-b border-slate-700 mb-2"><p class="text-xs text-slate-400"> </p> <p class="text-sm font-bold text-white truncate"> </p></div> <button class="w-full flex items-center gap-2 px-3 py-2 text-slate-300 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors text-sm"><!> </button></div>  <div class="fixed inset-0 z-40"></div>',1),Zs=y('<div class="relative"><button><!> <div class="absolute bottom-1 right-1 w-3 h-3 bg-emerald-500 rounded-full border-2 border-slate-900"></div></button> <!></div>'),Qs=y('<div class="w-4 h-4 rounded-full border-2 border-slate-300 border-t-slate-600 animate-spin"></div>'),eo=os('<svg class="w-4 h-4" viewBox="0 0 24 24"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"></path></svg>'),to=y("<button><!> <span> </span></button>");function ao(v,o){vt(o,!0);const d=()=>xe(re,"$googleSession",n),l=()=>xe(Lt,"$t",n),[n,r]=Ht();let a=St(o,"className",3,""),f=H(!1);var b=ue(),x=z(b);{var L=q=>{var F=Zs(),R=t(F);R.__click=()=>u(f,!i(f));var Q=t(R);{var ee=m=>{var C=Ws();O(()=>ze(C,"src",d().userProfile.picture)),p(m,C)},E=m=>{var C=Ks(),_=t(C),T=t(_);{var D=w=>{var k=rs();O(N=>g(k,N),[()=>d().userProfile.name[0].toUpperCase()]),p(w,k)},ae=w=>{da(w,{size:20})};B(T,w=>{d().userProfile?.name?w(D):w(ae,!1)})}e(_),e(C),p(m,C)};B(Q,m=>{d().userProfile?.picture?m(ee):m(E,!1)})}et(2),e(R);var J=s(R,2);{var G=m=>{var C=Xs(),_=z(C),T=t(_),D=t(T),ae=t(D,!0);e(D);var w=s(D,2),k=t(w,!0);e(w),e(T);var N=s(T,2);N.__click=()=>{Ys(),u(f,!1)};var W=t(N);_s(W,{size:14});var K=s(W);e(N),e(_);var A=s(_,2);A.__click=()=>u(f,!1),O((P,Z,fe)=>{g(ae,P),g(k,Z),g(K,` ${fe??""}`)},[()=>l()("common.auth.signed_in_as"),()=>d().userProfile?.name??l()("common.auth.user"),()=>l()("common.auth.logout")]),p(m,C)};B(J,m=>{i(f)&&m(G)})}e(F),O(m=>{Be(R,1,`flex items-center gap-2 p-1 rounded-full hover:bg-slate-800 transition-colors border border-transparent hover:border-slate-700 ${a()??""}`),ze(R,"title",m)},[()=>d().userProfile?.name||l()("common.auth.user")]),p(q,F)},S=q=>{var F=to();F.__click=function(...G){Ha?.apply(this,G)};var R=t(F);{var Q=G=>{var m=Qs();p(G,m)},ee=G=>{var m=eo();p(G,m)};B(R,G=>{d().isInited?G(ee,!1):G(Q)})}var E=s(R,2),J=t(E,!0);e(E),e(F),O(G=>{F.disabled=!d().isInited,Be(F,1,`flex items-center gap-2 px-4 py-2 bg-white text-slate-900 hover:bg-slate-100 rounded-full font-bold text-xs transition-all shadow-lg hover:shadow-xl hover:scale-105 disabled:opacity-50 disabled:cursor-wait disabled:scale-100 disabled:shadow-none ${a()??""}`),g(J,G)},[()=>l()("common.auth.login")]),p(q,F)};B(x,q=>{d().signedIn?q(L):q(S,!1)})}p(v,b),ut(),r()}pt(["click"]);var so=y('<span class="w-2 h-2 rounded-full bg-slate-600"></span> <span> </span>',1),oo=y('<span class="w-2 h-2 rounded-full bg-indigo-500 animate-pulse"></span> <span> </span>',1),ro=y('<span class="w-2 h-2 rounded-full bg-emerald-500"></span> <span> </span>',1),no=y('<span class="w-2 h-2 rounded-full bg-red-500"></span> <span> </span>',1),io=y('<span class="w-2 h-2 rounded-full bg-slate-500"></span> <span> </span>',1),lo=y('<div class="mt-1.5 pt-1.5 border-t border-slate-800 text-[9px] text-slate-400 opacity-80 font-medium flex justify-between items-center gap-4"><span> </span> <span> </span></div>'),co=y('<div class="mt-1 text-[9px] text-slate-400 opacity-60 italic"> </div>'),vo=y('<div class="absolute top-full right-0 mt-3 whitespace-nowrap bg-slate-900/95 backdrop-blur-md text-white text-[10px] font-bold py-2 px-3 rounded-lg shadow-2xl border border-slate-700/50 z-[100] pointer-events-none min-w-[120px]"><div class="flex items-center gap-2"><!></div> <!></div>'),uo=y('<div class="relative flex items-center"><button class="flex items-center justify-center p-2 rounded-xl hover:bg-slate-800/50 transition-all active:scale-95 group focus:outline-none"><!></button> <!></div>');function po(v,o){vt(o,!0);const d=()=>xe(re,"$googleSession",a),l=()=>xe(Lt,"$t",a),n=()=>xe(Je,"$syncStatus",a),r=()=>xe(ca,"$lastSyncTime",a),[a,f]=Ht();let b=H(!1);function x(E){return new Date(E).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}var L=uo(),S=t(L);S.__click=()=>d().signedIn?ia():Ha();var q=t(S);{var F=E=>{ks(E,{size:20,class:"text-slate-600 group-hover:text-slate-400"})},R=E=>{var J=ue(),G=z(J);{var m=_=>{Cs(_,{size:20,class:"animate-spin text-indigo-400"})},C=_=>{var T=ue(),D=z(T);{var ae=k=>{bs(k,{size:20,class:"text-emerald-400 group-hover:text-emerald-300"})},w=k=>{var N=ue(),W=z(N);{var K=P=>{ys(P,{size:20,class:"text-red-400"})},A=P=>{$s(P,{size:20,class:"text-slate-400 group-hover:text-slate-300"})};B(W,P=>{n()==="error"?P(K):P(A,!1)},!0)}p(k,N)};B(D,k=>{n()==="success"?k(ae):k(w,!1)},!0)}p(_,T)};B(G,_=>{n()==="syncing"?_(m):_(C,!1)},!0)}p(E,J)};B(q,E=>{d().signedIn?E(R,!1):E(F)})}e(S);var Q=s(S,2);{var ee=E=>{var J=vo(),G=t(J),m=t(G);{var C=w=>{var k=so(),N=s(z(k),2),W=t(N,!0);e(N),O(K=>g(W,K),[()=>l()("common.status.offline")]),p(w,k)},_=w=>{var k=ue(),N=z(k);{var W=A=>{var P=oo(),Z=s(z(P),2),fe=t(Z,!0);e(Z),O(U=>g(fe,U),[()=>l()("common.status.syncing")]),p(A,P)},K=A=>{var P=ue(),Z=z(P);{var fe=j=>{var M=ro(),V=s(z(M),2),pe=t(V,!0);e(V),O(_e=>g(pe,_e),[()=>l()("common.status.saved")]),p(j,M)},U=j=>{var M=ue(),V=z(M);{var pe=ne=>{var te=no(),ie=s(z(te),2),Te=t(ie,!0);e(ie),O(le=>g(Te,le),[()=>l()("common.status.error")]),p(ne,te)},_e=ne=>{var te=io(),ie=s(z(te),2),Te=t(ie,!0);e(ie),O(le=>g(Te,le),[()=>l()("common.status.synced")]),p(ne,te)};B(V,ne=>{n()==="error"?ne(pe):ne(_e,!1)},!0)}p(j,M)};B(Z,j=>{n()==="success"?j(fe):j(U,!1)},!0)}p(A,P)};B(N,A=>{n()==="syncing"?A(W):A(K,!1)},!0)}p(w,k)};B(m,w=>{d().signedIn?w(_,!1):w(C)})}e(G);var T=s(G,2);{var D=w=>{var k=lo(),N=t(k),W=t(N,!0);e(N);var K=s(N,2),A=t(K,!0);e(K),e(k),O((P,Z)=>{g(W,P),g(A,Z)},[()=>l()("common.status.last_sync"),()=>x(r())]),p(w,k)},ae=w=>{var k=ue(),N=z(k);{var W=K=>{var A=co(),P=t(A,!0);e(A),O(Z=>g(P,Z),[()=>l()("common.auth.login")]),p(K,A)};B(N,K=>{d().signedIn||K(W)},!0)}p(w,k)};B(T,w=>{d().signedIn&&r()?w(D):w(ae,!1)})}e(J),kt(3,J,()=>cs,()=>({duration:150})),p(E,J)};B(Q,E=>{i(b)&&E(ee)})}e(L),O(E=>ze(S,"aria-label",E),[()=>l()("common.status.label")]),Qe("mouseenter",S,()=>u(b,!0)),Qe("mouseleave",S,()=>u(b,!1)),Qe("focus",S,()=>u(b,!0)),Qe("blur",S,()=>u(b,!1)),p(v,L),ut(),f()}pt(["click"]);var go=y('<div class="absolute top-full right-0 mt-2 bg-slate-900 border border-slate-700 rounded-xl shadow-xl p-1.5 min-w-[120px] z-50 flex flex-col gap-1 animate-in fade-in zoom-in-95 duration-200"><button>ðŸ‡§ðŸ‡· PT-BR</button> <button>ðŸ‡ºðŸ‡¸ EN-US</button></div> <button class="fixed inset-0 z-40 cursor-default" aria-label="Close menu"></button>',1),fo=y('<span class="text-[10px] text-slate-400 font-medium"> </span>'),mo=y('<div class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hover:border-indigo-500/40 transition-all relative group flex flex-col shadow-lg hover:shadow-indigo-500/10 border-t-white/5"><div class="flex justify-between items-start mb-4"><div class="flex-1"><h3 class="font-black text-xl text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate pr-16"> </h3> <div class="flex items-center gap-2 mt-1 flex-wrap"><span class="text-[10px] bg-indigo-500/10 text-indigo-400 font-black px-2 py-0.5 rounded uppercase tracking-wider"> </span> <span class="text-[10px] text-slate-500 font-bold uppercase tracking-widest"> </span> <!></div> <div class="mt-2 flex items-center gap-2"><div class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800 text-[9px] text-slate-400 border border-slate-700 font-bold uppercase tracking-wider"><!> </div></div></div> <div class="flex items-center gap-1"><button class="text-slate-700 hover:text-indigo-400 p-2 rounded-xl hover:bg-indigo-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button> <button class="text-slate-700 hover:text-red-400 p-2 rounded-xl hover:bg-red-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button></div></div> <div class="space-y-3 mb-6"><div class="flex items-center justify-between text-xs text-slate-400"><span class="flex items-center gap-1.5 opacity-60"><!> </span> <span class="font-bold text-slate-300 truncate max-w-[150px]"> </span></div></div> <button class="w-full bg-slate-800 hover:bg-indigo-600 text-white py-3 rounded-2xl font-bold transition-all active:scale-[0.98] border border-slate-700 hover:border-indigo-400/30 flex items-center justify-center gap-2"> <!></button></div>'),ho=y('<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 col-start-1 row-start-1 w-full"><!> <button class="h-full min-h-[160px] border-2 border-dashed border-slate-800 rounded-3xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-500 transition-all hover:bg-indigo-500/5 gap-2 group shadow-sm bg-slate-900/20"><div class="w-12 h-12 rounded-full bg-slate-800 flex items-center justify-center group-hover:bg-indigo-500/10 group-hover:scale-110 transition-all"><!></div> <span class="font-bold"> </span></button></div>'),bo=y('<span class="text-[9px] bg-emerald-500/10 text-emerald-400 px-2 py-0.5 rounded-full border border-emerald-500/20 font-black uppercase tracking-widest flex items-center gap-1"><!> </span>'),xo=y('<div class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hover:border-indigo-500/40 transition-all group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10 border-t-white/5"><div class="mb-4"><div class="flex justify-between items-start mb-1"><h3 class="font-black text-2xl text-white group-hover:text-indigo-400 transition-colors uppercase tracking-tight"> </h3> <div class="flex items-center gap-1"><!> <button class="text-slate-700 hover:text-indigo-400 p-2 rounded-xl hover:bg-indigo-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button> <button class="text-slate-700 hover:text-red-400 p-2 rounded-xl hover:bg-red-400/5 transition-all opacity-40 group-hover:opacity-100"><!></button></div></div> <p class="text-indigo-400 text-[10px] font-black uppercase tracking-[0.2em] mb-3"> </p> <div class="mb-3"><div class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800 text-[9px] text-slate-400 border border-slate-700 font-bold uppercase tracking-wider"><!> </div></div> <p class="text-sm text-slate-400 line-clamp-2 leading-relaxed h-10"> </p></div> <button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-2xl font-bold flex items-center justify-center gap-2 border border-indigo-400/20 shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98]"><!> </button></div>'),_o=y('<div class="bg-slate-900 border border-slate-800 rounded-3xl p-6 hover:border-emerald-500/40 transition-all group relative flex flex-col justify-between shadow-xl border-t-white/5"><div><h3 class="font-black text-2xl text-white group-hover:text-emerald-400 mb-2 uppercase tracking-tight"> </h3> <div class="flex items-center gap-2 mb-4"><div class="px-2 py-0.5 bg-slate-800 rounded text-[9px] text-slate-400 font-black uppercase tracking-widest"> </div> <div class="flex items-center gap-1 px-2 py-0.5 bg-emerald-500/10 rounded text-[9px] text-emerald-400 font-black uppercase tracking-wider"><div class="w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"></div> </div></div> <div class="mb-4"><div class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded bg-slate-800/50 text-[9px] text-slate-400 border border-slate-700/50 font-bold uppercase tracking-wider"><!> </div></div> <p class="text-sm text-slate-400 line-clamp-3 leading-relaxed mb-6 h-15"> </p></div> <button class="w-full bg-emerald-600 hover:bg-emerald-500 text-white py-3 rounded-2xl font-black uppercase text-xs tracking-[0.1em] flex items-center justify-center gap-2 border border-emerald-400/20 transition-all active:scale-[0.98] group"> <!></button></div>'),wo=y('<div class="col-span-full py-12 flex flex-col items-center text-center opacity-40"><div class="w-16 h-16 bg-slate-800/50 rounded-full flex items-center justify-center text-slate-600 mb-3 border border-slate-700 border-dashed"><!></div> <h3 class="text-lg font-black uppercase tracking-widest text-slate-500"> </h3> <p class="text-slate-600 max-w-sm mt-2 text-sm"> </p></div>'),yo=y('<div class="space-y-8 col-start-1 row-start-1 w-full"><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><!> <button class="h-full min-h-[160px] border-2 border-dashed border-slate-800 rounded-3xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-500 transition-all hover:bg-indigo-500/5 gap-2 group shadow-sm bg-slate-900/20"><div class="w-12 h-12 rounded-full bg-slate-800 flex items-center justify-center group-hover:bg-indigo-500/10 group-hover:scale-110 transition-all"><!></div> <span class="font-bold"> </span></button></div> <div><div class="flex items-center gap-3 mb-4"><div class="h-px flex-1 bg-slate-800"></div> <h3 class="text-xs font-black uppercase tracking-widest text-emerald-400 flex items-center gap-2"><!> </h3> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><!> <!></div></div></div>'),ko=y('<div class="fixed top-0 left-0 w-full flex justify-center items-center pointer-events-none z-[100] transition-all duration-300"><div class="bg-indigo-600 rounded-full p-2.5 shadow-xl border border-indigo-500/50 text-white"><!></div></div> <div class="animate-in fade-in px-4 md:px-8 max-w-7xl mx-auto pb-32 md:pb-20"><header class="mb-8 flex justify-between items-center border-b border-slate-800/50 pt-4 md:pt-8 pb-4 sticky top-0 bg-slate-950/80 backdrop-blur-md z-40 -mx-4 px-4 md:-mx-8 md:px-8 transition-all"><div class="flex items-center gap-3"><img alt="Schwalb Vault Logo" class="h-10 md:h-14 w-auto rounded-xl"/> <h1 class="text-xl md:text-3xl font-bold text-white flex items-center gap-2 text-gradient m-0 leading-none"><span class="hidden md:inline">Schwalb Vault</span> <span class="md:hidden">Schwalb Vault</span></h1></div> <div class="hidden md:flex absolute left-1/2 -translate-x-1/2 bg-slate-900/50 p-1.5 rounded-2xl border border-slate-800 glass shadow-xl backdrop-blur-md"><div class="relative flex"><div class="absolute inset-y-0 w-1/2 bg-indigo-600 rounded-xl transition-transform duration-300 ease-out shadow-lg shadow-indigo-500/20"></div> <button><!> </button> <button><!> </button></div></div> <div class="flex items-center justify-end min-w-[40px] gap-3"><!> <div class="relative"><button class="flex items-center gap-2 text-slate-400 hover:text-white transition-colors p-2 rounded-lg hover:bg-slate-800"><!> <span class="text-xs font-bold uppercase hidden md:inline"> </span></button> <!></div> <!></div></header> <div class="md:hidden fixed bottom-6 left-4 right-4 bg-slate-900/90 backdrop-blur-xl border border-slate-700/50 shadow-2xl rounded-2xl p-1.5 z-50"><div class="relative flex justify-between"><div class="absolute inset-y-0 w-1/2 bg-indigo-600/20 rounded-xl transition-transform duration-300 ease-out"></div> <button><!> <span class="transition-all duration-300"> </span></button> <button><!> <span class="transition-all duration-300"> </span></button></div></div> <div class="min-h-[500px] grid items-start relative"><!></div> <!> <!> <!> <!></div>',1);function $o(v,o){vt(o,!0);const d=()=>xe(re,"$googleSession",b),l=()=>xe(Oa,"$liveCharacters",b),n=()=>xe(ra,"$liveCampaigns",b),r=()=>xe(Lt,"$t",b),a=()=>xe(Zt,"$locale",b),f=()=>xe(fs,"$publicCampaigns",b),[b,x]=Ht();let L=H(0),S=H(0),q=H(!1),F=H(!1);const R=80;function Q(c){window.scrollY===0&&(u(L,c.touches[0].clientY,!0),u(q,!0))}function ee(c){if(!i(q))return;const I=c.touches[0].clientY-i(L);I>0&&window.scrollY<=0?u(S,Math.min(I*.4,120),!0):(u(q,!1),u(S,0))}async function E(){if(i(q))if(u(q,!1),i(S)>R){u(F,!0),u(S,60);try{navigator&&navigator.vibrate&&navigator.vibrate(50),await ia()}finally{setTimeout(()=>{u(F,!1),u(S,0)},1e3)}}else u(S,0)}Aa(()=>{Vs();const c=localStorage.getItem("user_locale");return c&&Zt.set(c),document.addEventListener("touchmove",ee,{passive:!1}),()=>{document.removeEventListener("touchmove",ee)}});let J=H(!1);function G(c){Zt.set(c),localStorage.setItem("user_locale",c),u(J,!1)}let m=H("characters"),C=H("characters");$t(()=>{i(m)!==i(C)&&u(C,i(m),!0)}),$t(()=>{d().signedIn&&ia()}),$t(()=>{d().signedIn&&(l(),n(),oa())});let _=H(!1),T=H(null);function D(c){u(T,c,!0),u(_,!0)}function ae(c){if(!i(T))return;const $=i(T).id,h={...ce.get($),...c};ce.set($,h),u(_,!1)}let w=H(!1),k=H("{}");const N={name:"",playerName:"",ancestry:"Humano",novicePath:"",level:0,defense:8,health:5,system:Ge};function W(){u(k,JSON.stringify(N),!0),u(w,!0)}async function K(c){const $=za(),I={id:$,name:c.name,playerName:c.playerName||"",ancestry:c.ancestry,level:c.level,defense:c.defense,system:c.system||Ge,paths:{novice:c.novicePath||"-",expert:"-",master:"-"},attributes:[{name:"ForÃ§a",value:10,key:"str"},{name:"Agilidade",value:10,key:"agi"},{name:"Intelecto",value:10,key:"int"},{name:"Vontade",value:10,key:"wil"}],speed:5,health:c.health,currentHealth:c.health,spells:[],talents:[],equipment:[],afflictions:[],effects:[],currency:{gp:0,sp:0,cp:0},languages:["Comum"]};ce.set($,I),u(w,!1),Bt(Gt("/characters/[id]",{id:$}))}let A=H(!1),P=H(null),Z=H("{}");const fe={name:"",description:"",gmName:"",system:Ge};function U(c=null){u(P,c?c.id:null,!0),u(Z,JSON.stringify(c||fe),!0),u(A,!0)}async function j(c){const $=i(P)||za(),I=i(P)?ve.get($):{},h={...I,id:$,name:c.name,description:c.description,gmName:c.gmName,players:I.players||[],backupEnabled:c.backupEnabled||!1,backupHash:c.backupHash||"",system:c.system||Ge};c.removePassword?delete h.passwordHash:c.password&&(h.passwordHash=await ws(c.password)),ve.set($,h),u(A,!1)}let M=H(!1),V=H(Ga({title:"",message:"",onConfirm:()=>{}}));function pe(c){u(V,{title:r()("dashboard.campaigns.delete_title"),message:r()("dashboard.campaigns.delete_message"),onConfirm:()=>{console.log("[DEBUG] Deleting campaign with ID:",c);let $=0;for(const I of ve.keys()){const h=ve.get(I);(I===c||h&&h.id===c)&&(console.log("[DEBUG] Found match for deletion - Key:",I,"Camp ID:",h?.id),ve.delete(I),$++)}console.log("[DEBUG] Total entries deleted from map:",$),qe.set(c,{type:"campaign",deletedAt:Date.now()}),console.log("[DEBUG] Deletion tracked in deletedIdsMap"),oa(),u(M,!1)}},!0),u(M,!0)}function _e(c){u(V,{title:r()("dashboard.characters.delete_title"),message:r()("dashboard.characters.delete_message"),onConfirm:()=>{ye(ra).forEach(h=>{let X=!1;h.members&&h.members.some(se=>se.id===c)&&(h.members=h.members.filter(se=>se.id!==c),X=!0),h.sessionRoster&&h.sessionRoster.includes(c)&&(h.sessionRoster=h.sessionRoster.filter(se=>se!==c),X=!0),h.activeEnemies&&h.activeEnemies.some(se=>se.id===c)&&(h.activeEnemies=h.activeEnemies.filter(se=>se.id!==c),X=!0),X&&ve.set(h.id,h)}),console.log("[DEBUG] Deleting character with ID:",c);let I=0;for(const h of ce.keys()){const X=ce.get(h);(h===c||X&&X.id===c)&&(console.log("[DEBUG] Found match for deletion - Key:",h,"Char ID:",X?.id),ce.delete(h),I++)}console.log("[DEBUG] Total entries deleted from map:",I),qe.set(c,{type:"character",deletedAt:Date.now()}),console.log("[DEBUG] Deletion tracked in deletedIdsMap"),oa(),u(M,!1)}},!0),u(M,!0)}var ne=ko();Qe("touchstart",Kt,Q),Qe("touchmove",Kt,ee),Qe("touchend",Kt,E);var te=z(ne),ie=t(te),Te=t(ie);{let c=Dt(()=>i(F)?"animate-spin":""),$=Dt(()=>i(S)*2);Ss(Te,{get class(){return i(c)},size:20,get style(){return`transform: rotate(${i($)??""}deg)`}})}e(ie),e(te);var le=s(te,2),me=t(le),de=t(me),gt=t(de);et(2),e(de);var Rt=s(de,2),va=t(Rt),ua=t(va),ft=s(ua,2);ft.__click=()=>u(m,"characters");var pa=t(ft);Ta(pa,{size:18});var Va=s(pa);e(ft);var Ct=s(ft,2);Ct.__click=()=>u(m,"campaigns");var ga=t(Ct);aa(ga,{size:18});var Ya=s(ga);e(Ct),e(va),e(Rt);var fa=s(Rt,2),ma=t(fa);po(ma,{});var Vt=s(ma,2),mt=t(Vt);mt.__click=()=>u(J,!i(J));var ha=t(mt);ta(ha,{size:20});var ba=s(ha,2),qa=t(ba,!0);e(ba),e(mt);var Ja=s(mt,2);{var Wa=c=>{var $=go(),I=z($),h=t(I);h.__click=()=>G("pt");var X=s(h,2);X.__click=()=>G("en"),e(I);var se=s(I,2);se.__click=()=>u(J,!1),O(()=>{Be(h,1,`flex items-center gap-2 px-3 py-2 text-sm font-bold rounded-lg ${a()==="pt"?"bg-indigo-600 text-white":"text-slate-400 hover:text-white hover:bg-slate-800"}`),Be(X,1,`flex items-center gap-2 px-3 py-2 text-sm font-bold rounded-lg ${a()==="en"?"bg-indigo-600 text-white":"text-slate-400 hover:text-white hover:bg-slate-800"}`)}),p(c,$)};B(Ja,c=>{i(J)&&c(Wa)})}e(Vt);var Ka=s(Vt,2);ao(Ka,{}),e(fa),e(me);var Yt=s(me,2),xa=t(Yt),_a=t(xa),ht=s(_a,2);ht.__click=()=>u(m,"characters");var wa=t(ht);{let c=Dt(()=>i(m)==="characters"?2.5:2);Ta(wa,{size:20,get strokeWidth(){return i(c)},class:"transition-all duration-300"})}var ya=s(wa,2),Xa=t(ya,!0);e(ya),e(ht);var Et=s(ht,2);Et.__click=()=>u(m,"campaigns");var ka=t(Et);{let c=Dt(()=>i(m)==="campaigns"?2.5:2);aa(ka,{size:20,get strokeWidth(){return i(c)},class:"transition-all duration-300"})}var $a=s(ka,2),Za=t($a,!0);e($a),e(Et),e(xa),e(Yt);var qt=s(Yt,2),Qa=t(qt);{var es=c=>{var $=ho(),I=t($);At(I,1,l,We=>We.id,(We,he)=>{var Ke=mo(),rt=t(Ke),nt=t(rt),bt=t(nt),Tt=t(bt,!0);e(bt);var it=s(bt,2),xt=t(it),Jt=t(xt,!0);e(xt);var oe=s(xt,2),Y=t(oe);e(oe);var be=s(oe,2);{var ke=Ie=>{var je=fo(),Me=t(je);e(je),O(()=>g(Me,`â€¢ ${i(he).playerName??""}`)),p(Ie,je)};B(be,Ie=>{i(he).playerName&&Ie(ke)})}e(it);var ge=s(it,2),Se=t(ge),$e=t(Se);Ut($e,{size:10});var Ce=s($e);e(Se),e(ge),e(nt);var De=s(nt,2),we=t(De);we.__click=()=>D(i(he));var Ne=t(we);ls(Ne,{size:16}),e(we);var Ee=s(we,2);Ee.__click=()=>_e(i(he).id);var Pe=t(Ee);Ia(Pe,{size:16}),e(Ee),e(De),e(rt);var Ae=s(rt,2),Ue=t(Ae),Oe=t(Ue),Fe=t(Oe);aa(Fe,{size:12});var Le=s(Fe);e(Oe);var He=s(Oe,2),_t=t(He,!0);e(He),e(Ue),e(Ae);var Re=s(Ae,2);Re.__click=()=>Bt(Gt("/characters/[id]",{id:i(he).id}));var lt=t(Re),Xe=s(lt);Da(Xe,{size:14,fill:"currentColor"}),e(Re),e(Ke),O((Ie,je,Me,Ze,dt,wt)=>{g(Tt,i(he).name),g(Jt,i(he).ancestry||"Humano"),g(Y,`${Ie??""} ${i(he).level??""}`),g(Ce,` ${je??""}`),ze(we,"title",Me),ze(Ee,"title",Ze),g(Le,` ${dt??""}`),g(_t,i(he).paths?.novice||"-"),g(lt,`${wt??""} `)},[()=>r()("common.labels.level"),()=>ea(i(he).system).name,()=>r()("common.buttons.settings"),()=>r()("common.buttons.delete"),()=>r()("dashboard.characters.paths"),()=>r()("dashboard.characters.open_sheet")]),p(We,Ke)});var h=s(I,2);h.__click=()=>W();var X=t(h),se=t(X);Qt(se,{size:32}),e(X);var It=s(X,2),zt=t(It,!0);e(It),e(h),e($),O(We=>g(zt,We),[()=>r()("dashboard.characters.new_character")]),kt(1,$,()=>Pt,()=>({x:-100,duration:300,easing:Nt})),kt(2,$,()=>Pt,()=>({x:-100,duration:300,easing:Nt})),p(c,$)},ts=c=>{var $=yo(),I=t($),h=t(I);At(h,1,n,oe=>oe.id,(oe,Y)=>{var be=xo(),ke=t(be),ge=t(ke),Se=t(ge),$e=t(Se,!0);e(Se);var Ce=s(Se,2),De=t(Ce);{var we=Me=>{var Ze=bo(),dt=t(Ze);ta(dt,{size:10});var wt=s(dt);e(Ze),O(Wt=>g(wt,` ${Wt??""}`),[()=>r()("dashboard.campaigns.published")]),p(Me,Ze)};B(De,Me=>{i(Y).isPublished&&Me(we)})}var Ne=s(De,2);Ne.__click=()=>U(i(Y));var Ee=t(Ne);ds(Ee,{size:16}),e(Ne);var Pe=s(Ne,2);Pe.__click=()=>pe(i(Y).id);var Ae=t(Pe);Ia(Ae,{size:16}),e(Pe),e(Ce),e(ge);var Ue=s(ge,2),Oe=t(Ue,!0);e(Ue);var Fe=s(Ue,2),Le=t(Fe),He=t(Le);Ut(He,{size:10});var _t=s(He);e(Le),e(Fe);var Re=s(Fe,2),lt=t(Re,!0);e(Re),e(ke);var Xe=s(ke,2);Xe.__click=()=>Bt(Gt("/campaigns/[id]",{id:i(Y).id}));var Ie=t(Xe);Da(Ie,{size:18,fill:"currentColor"});var je=s(Ie);e(Xe),e(be),O((Me,Ze,dt,wt,Wt,ss)=>{g($e,i(Y).name),ze(Ne,"title",Me),ze(Pe,"title",Ze),g(Oe,dt),g(_t,` ${wt??""}`),g(lt,Wt),g(je,` ${ss??""}`)},[()=>r()("common.buttons.edit"),()=>r()("common.buttons.delete"),()=>i(Y).gmName||r()("common.labels.master"),()=>ea(i(Y).system||Ge).name,()=>i(Y).description||r()("dashboard.campaigns.no_description"),()=>r()("dashboard.campaigns.start_session")]),p(oe,be)});var X=s(h,2);X.__click=()=>U();var se=t(X),It=t(se);Qt(It,{size:32}),e(se);var zt=s(se,2),We=t(zt,!0);e(zt),e(X),e(I);var he=s(I,2),Ke=t(he),rt=s(t(Ke),2),nt=t(rt);ta(nt,{size:14});var bt=s(nt);e(rt),et(2),e(Ke);var Tt=s(Ke,2),it=t(Tt);At(it,1,f,oe=>oe.id,(oe,Y)=>{var be=_o(),ke=t(be),ge=t(ke),Se=t(ge,!0);e(ge);var $e=s(ge,2),Ce=t($e),De=t(Ce,!0);e(Ce);var we=s(Ce,2),Ne=s(t(we));e(we),e($e);var Ee=s($e,2),Pe=t(Ee),Ae=t(Pe);Ut(Ae,{size:10});var Ue=s(Ae);e(Pe),e(Ee);var Oe=s(Ee,2),Fe=t(Oe,!0);e(Oe),e(ke);var Le=s(ke,2);Le.__click=()=>Bt(Gt("/campaigns/[id]/invite",{id:i(Y).id}));var He=t(Le),_t=s(He);Qt(_t,{size:18,class:"group-hover:rotate-90 transition-transform"}),e(Le),e(be),O((Re,lt,Xe,Ie,je)=>{g(Se,i(Y).name),g(De,Re),g(Ne,` ${lt??""}`),g(Ue,` ${Xe??""}`),g(Fe,Ie),g(He,`${je??""} `)},[()=>i(Y).gmName||r()("common.labels.master"),()=>r()("dashboard.campaigns.online"),()=>ea(i(Y).system||Ge).name,()=>i(Y).description||r()("dashboard.campaigns.public_description"),()=>r()("dashboard.campaigns.join_adventure")]),p(oe,be)});var xt=s(it,2);{var Jt=oe=>{var Y=wo(),be=t(Y),ke=t(be);hs(ke,{size:32}),e(be);var ge=s(be,2),Se=t(ge,!0);e(ge);var $e=s(ge,2),Ce=t($e,!0);e($e),e(Y),O((De,we)=>{g(Se,De),g(Ce,we)},[()=>r()("dashboard.campaigns.no_online_campaigns"),()=>r()("dashboard.campaigns.no_online_description")]),p(oe,Y)};B(xt,oe=>{f().length===0&&oe(Jt)})}e(Tt),e(he),e($),O((oe,Y)=>{g(We,oe),g(bt,` ${Y??""}`)},[()=>r()("dashboard.campaigns.new_campaign"),()=>r()("dashboard.campaigns.public_campaigns")]),kt(1,$,()=>Pt,()=>({x:100,duration:300,easing:Nt})),kt(2,$,()=>Pt,()=>({x:100,duration:300,easing:Nt})),p(c,$)};B(Qa,c=>{i(m)==="characters"?c(es):c(ts,!1)})}e(qt);var Sa=s(qt,2);Us(Sa,{get isOpen(){return i(w)},get initialData(){return i(k)},onClose:()=>u(w,!1),onSave:K});var Ca=s(Sa,2);xs(Ca,{get isOpen(){return i(A)},get initialData(){return i(Z)},onClose:()=>u(A,!1),onSave:j});var Ea=s(Ca,2);gs(Ea,{get isOpen(){return i(M)},get title(){return i(V).title},get message(){return i(V).message},get onConfirm(){return i(V).onConfirm},onCancel:()=>u(M,!1)});var as=s(Ea,2);Fs(as,{get isOpen(){return i(_)},get characterData(){return i(T)},onClose:()=>u(_,!1),onSave:ae}),e(le),O((c,$,I,h,X)=>{Xt(te,`transform: translateY(${(i(F)?60:i(S))??""}px); opacity: ${i(S)>0?1:0}`),ze(gt,"src",`${ms??""}/logo-black.webp`),Xt(ua,`transform: translateX(${i(m)==="campaigns"?"100%":"0%"})`),Be(ft,1,`relative z-10 px-6 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 flex items-center gap-2 ${i(m)==="characters"?"text-white":"text-slate-400 hover:text-white"}`),g(Va,` ${c??""}`),Be(Ct,1,`relative z-10 px-6 py-2.5 rounded-xl text-sm font-bold transition-all duration-300 flex items-center gap-2 ${i(m)==="campaigns"?"text-white":"text-slate-400 hover:text-white"}`),g(Ya,` ${$??""}`),ze(mt,"title",I),g(qa,a()==="pt"?"PT":"EN"),Xt(_a,`transform: translateX(${i(m)==="campaigns"?"100%":"0%"})`),Be(ht,1,`relative flex-1 py-3 rounded-xl text-xs font-bold transition-all duration-300 flex flex-col items-center justify-center gap-1 z-10 ${i(m)==="characters"?"text-indigo-400":"text-slate-500"}`),g(Xa,h),Be(Et,1,`relative flex-1 py-3 rounded-xl text-xs font-bold transition-all duration-300 flex flex-col items-center justify-center gap-1 z-10 ${i(m)==="campaigns"?"text-indigo-400":"text-slate-500"}`),g(Za,X)},[()=>r()("dashboard.tabs.characters"),()=>r()("dashboard.tabs.campaigns"),()=>r()("common.labels.language")||"Language",()=>r()("dashboard.tabs.characters"),()=>r()("dashboard.tabs.campaigns")]),p(v,ne),ut(),x()}pt(["click"]);var So=y("<!> <!>",1);function Ro(v){var o=So(),d=z(o);js(d,{});var l=s(d,2);$o(l,{}),p(v,o)}export{Ro as component};
