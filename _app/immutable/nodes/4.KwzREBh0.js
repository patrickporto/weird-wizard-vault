const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/D-px-r2z.js","../chunks/EigO5Itq.js","../chunks/CE5Oy5gg.js","../chunks/PPVm8Dsz.js","../chunks/B3FtJd8P.js","../chunks/2Gu058ss.js"])))=>i.map(i=>d[i]);
import{_ as Ss}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import{u as It,v as qe,k as d,w as oa,z as la,j as c,x as t,B as a,y as s,E as J,F as e,t as _,V as La,A as C,D as _t,n as Ea,G as Va,a9 as ma,aw as ha,bd as Is}from"../chunks/EigO5Itq.js";import{d as ba,s as i,o as rs,g as Ta,e as ja}from"../chunks/CE5Oy5gg.js";import{e as Xe,s as Ze,i as Ot,$ as aa,r as Mt,a as de,h as Za,b as Na,j as Ds}from"../chunks/B3FtJd8P.js";import{l as xa,s as fa,i as p,p as sa}from"../chunks/EUrPnace.js";import{f as Aa,j as Rs,c as is,h as Xa,l as Ns,k as Ma,m as As,n as Ra,u as Ia,b as bt,o as cs,p as Ts,q as $s,t as Qa,e as Us,d as Ps}from"../chunks/D-px-r2z.js";import{a as da,s as Ut}from"../chunks/x7t77AVd.js";import{p as Ls}from"../chunks/Besq1sGQ.js";import{c as ns,a as ea,e as os,b as Ya}from"../chunks/2Gu058ss.js";import{l as Fs,b as ts,c as us,a as Hs}from"../chunks/BPReyIlN.js";import{a as qs,t as $a,f as Ua}from"../chunks/DRbEtCnn.js";import{U as bs,C as ls,W as _s,r as ms}from"../chunks/jSS4on-d.js";import{A as Bs,a as Ws,B as Gs,T as Js,M as xs,G as Ca,H as fs,R as Vs,I as ps,C as gs,S as hs,L as Qs,b as Ys,D as Zs,c as Xs}from"../chunks/B2Yaxb9C.js";import{k as as}from"../chunks/CSpwhPtH.js";import{A as Da,C as Ks,s as ys}from"../chunks/CEcYnnFh.js";import{M as er,X as ya,P as ra,E as Fa,d as tr,c as ua,C as Ha,e as ar,f as ws,b as za,A as sr}from"../chunks/CP3tlatW.js";import{C as ks}from"../chunks/CEAxk489.js";import{b as rr,S as zs,a as ir,c as nr}from"../chunks/eOqvUlZi.js";import{S as Pa}from"../chunks/B41T8Fmh.js";import"../chunks/BmPwc1c7.js";import{I as pa,s as ga}from"../chunks/D-_OqhXn.js";import{C as or,G as _a,P as Ka,S as lr,L as dr,a as vr,b as cr}from"../chunks/bb6I9rAY.js";import{C as Cs,D as Oa,a as ur}from"../chunks/pDEUQP3R.js";import{b as js}from"../chunks/BuOUQAlr.js";import{g as br}from"../chunks/BKk7sOUi.js";import{W as _r}from"../chunks/B4GIR-C0.js";function mr(Y,r){const n=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["path",{d:"m18 15-6-6-6 6"}]];pa(Y,fa({name:"chevron-up"},()=>n,{get iconNode(){return K},children:(R,m)=>{var N=It(),A=qe(N);ga(A,r,"default",{}),d(R,N)},$$slots:{default:!0}}))}function xr(Y,r){const n=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];pa(Y,fa({name:"copy"},()=>n,{get iconNode(){return K},children:(R,m)=>{var N=It(),A=qe(N);ga(A,r,"default",{}),d(R,N)},$$slots:{default:!0}}))}function fr(Y,r){const n=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];pa(Y,fa({name:"flame"},()=>n,{get iconNode(){return K},children:(R,m)=>{var N=It(),A=qe(N);ga(A,r,"default",{}),d(R,N)},$$slots:{default:!0}}))}function pr(Y,r){const n=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];pa(Y,fa({name:"grip-vertical"},()=>n,{get iconNode(){return K},children:(R,m)=>{var N=It(),A=qe(N);ga(A,r,"default",{}),d(R,N)},$$slots:{default:!0}}))}function es(Y,r){const n=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];pa(Y,fa({name:"layers"},()=>n,{get iconNode(){return K},children:(R,m)=>{var N=It(),A=qe(N);ga(A,r,"default",{}),d(R,N)},$$slots:{default:!0}}))}function Ms(Y,r){const n=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];pa(Y,fa({name:"library"},()=>n,{get iconNode(){return K},children:(R,m)=>{var N=It(),A=qe(N);ga(A,r,"default",{}),d(R,N)},$$slots:{default:!0}}))}function gr(Y,r){const n=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];pa(Y,fa({name:"qr-code"},()=>n,{get iconNode(){return K},children:(R,m)=>{var N=It(),A=qe(N);ga(A,r,"default",{}),d(R,N)},$$slots:{default:!0}}))}function ss(Y,r){const n=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];pa(Y,fa({name:"save"},()=>n,{get iconNode(){return K},children:(R,m)=>{var N=It(),A=qe(N);ga(A,r,"default",{}),d(R,N)},$$slots:{default:!0}}))}function hr(Y,r){const n=xa(r,["children","$$slots","$$events","$$legacy"]);const K=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];pa(Y,fa({name:"send"},()=>n,{get iconNode(){return K},children:(R,m)=>{var N=It(),A=qe(N);ga(A,r,"default",{}),d(R,N)},$$slots:{default:!0}}))}function yr(Y){let r=!1;return document.body&&(document.body.appendChild(Y),r=!0),{destroy(){r&&Y.parentNode&&Y.parentNode.removeChild(Y)}}}var wr=c("<button> <!></button>"),kr=c('<p class="text-xs text-slate-600 italic"> </p>'),zr=c('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),Cr=c('<div class="space-y-1"></div>'),jr=c('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),Mr=c("<div><!></div>");function Or(Y,r){oa(r,!0);const n=()=>Ut(aa,"$t",K),[K,R]=da();var m=It(),N=qe(m);{var A=o=>{var S=Mr(),$=t(S);{let se=J(()=>n()("session.affliction_modal.title"));er($,{get isOpen(){return r.isOpen},get onClose(){return r.onClose},get title(){return a(se)},maxWidth:"max-w-md",children:(Ne,pe)=>{var I=jr(),D=qe(I);Xe(D,21,()=>Object.keys(Bs),Ot,(ye,Me)=>{const Je=J(()=>r.afflictions.includes(a(Me)));var he=wr();he.__click=()=>r.onToggle(a(Me));var P=t(he),oe=s(P);{var ue=Ee=>{ks(Ee,{size:14,class:"text-red-400"})};p(oe,Ee=>{a(Je)&&Ee(ue)})}e(he),_(Ee=>{Ze(he,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(Je)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),i(P,`${Ee??""} `)},[()=>n()(`character.afflictions.${a(Me)}`)]),d(ye,he)}),e(D);var M=s(D,2),V=t(M),U=t(V),De=t(U,!0);e(U);var ze=s(U,2);{var kt=ye=>{var Me=kr(),Je=t(Me,!0);e(Me),_(he=>i(Je,he),[()=>n()("session.affliction_modal.none_selected")]),d(ye,Me)},re=ye=>{var Me=Cr();Xe(Me,21,()=>r.afflictions,Ot,(Je,he)=>{var P=zr(),oe=t(P),ue=t(oe);e(oe);var Ee=s(oe,2),we=t(Ee,!0);e(Ee),e(P),_((mt,lt)=>{i(ue,`${mt??""}:`),i(we,lt)},[()=>n()(`character.afflictions.${a(he)}`),()=>n()(`sofww.afflictions.${a(he).toLowerCase().replace(" ","_")}.effect`)]),d(Je,P)}),e(Me),d(ye,Me)};p(ze,ye=>{r.afflictions.length===0?ye(kt):ye(re,!1)})}e(V);var Ce=s(V,2),me=t(Ce);me.__click=function(...ye){r.onClose?.apply(this,ye)};var je=t(me,!0);e(me),e(Ce),e(M),_((ye,Me)=>{i(De,ye),i(je,Me)},[()=>n()("session.affliction_modal.effects"),()=>n()("session.affliction_modal.done")]),d(Ne,I)},$$slots:{default:!0}})}e(S),Ws(S,se=>yr?.(se)),d(o,S)};p(N,o=>{r.isOpen&&o(A)})}d(Y,m),la(),R()}ba(["click"]);var Er=c('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),Sr=c('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),Ir=c('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),Dr=c("<button><!></button>"),Rr=c('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),Nr=c('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),Ar=c('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),Tr=c('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),$r=c('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),Ur=c('<div class="flex flex-col items-center justify-between bg-cyan-950/20 border border-cyan-500/30 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-cyan-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div>'),Pr=c('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),Lr=c('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),Fr=c('<div class="grid grid-cols-2 gap-4 mb-4"><div class="p-3 rounded-xl bg-purple-950/20 border border-purple-500/30 flex justify-between items-center group/ins"><div><span class="text-[9px] text-purple-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div> <div class="p-3 rounded-xl bg-red-950/20 border border-red-500/30 flex justify-between items-center group/cor"><div><span class="text-[9px] text-red-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div></div>'),Hr=c("<!> ",1),qr=c('<div><div class="text-emerald-500 text-[10px] font-black uppercase mb-2 flex items-center gap-2"> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="flex flex-wrap gap-2"></div></div>'),Br=c('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),Wr=c('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),Gr=c('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <!> <div class="grid grid-cols-2 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"><!> <!></div></div>'),Jr=c('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div> <!></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function Vr(Y,r){oa(r,!0);const n=()=>Ut(aa,"$t",K),[K,R]=da();let m=sa(r,"updateEnemy",3,(x,b)=>{}),N=sa(r,"updatePlayer",3,(x,b)=>{}),A=sa(r,"removeFromCombat",3,x=>{}),o=J(()=>r.entity.type==="player"),S=J(()=>r.entity.system==="sofdl"),$=J(()=>r.entity.damage||0),se=J(()=>r.entity.normalHealth||r.entity.health||10),Ne=J(()=>r.entity.currentHealth??a(se)),pe=J(()=>a($)>=a(Ne)),I=J(()=>a($)>=a(Ne)/2&&!a(pe)),D=J(()=>a(Ne)>0?Math.min(100,Math.max(0,a($)/a(Ne)*100)):100),M=_t(!1),V=_t(!1);La(()=>{const x=r.entity.afflictions||[],b=x.includes("Incapacitated");if(a(pe)&&!b){const k={afflictions:[...x,"Incapacitated"]};r.entity.type==="player"?U(k):m()(r.entity.instanceId,k)}else if(!a(pe)&&b){const k={afflictions:x.filter(ke=>ke!=="Incapacitated")};r.entity.type==="player"?U(k):m()(r.entity.instanceId,k)}});function U(x){if(r.entity.type!=="player")return;const b=ns.get(r.entity.id);if(b){const j={...b,...x};ns.set(r.entity.id,j);const k=r.campaignId||r.entity.campaignId;k&&rr(k,j)}N()(r.entity.id,x),Aa({id:r.entity.id,...x})}function De(x){const b=parseInt(x.target.value);if(isNaN(b))return;const k={damage:Math.max(0,b)};r.entity.type==="player"?U(k):m()(r.entity.instanceId,k)}function ze(x){const b=parseInt(x.target.value);if(isNaN(b))return;const j=Math.max(0,b);let k=a($);j<a($)&&(k=j);const ke={currentHealth:j,damage:k};r.entity.type==="player"?U(ke):m()(r.entity.instanceId,ke)}function kt(){const x=!r.entity.acted;r.entity.type==="player"?U({acted:x}):m()(r.entity.instanceId,{acted:x})}function re(){r.entity.type==="player"&&U({initiative:!r.entity.initiative})}function Ce(x){const b=r.entity.afflictions||[],k={afflictions:b.includes(x)?b.filter(ke=>ke!==x):[...b,x]};r.entity.type==="player"?U(k):m()(r.entity.instanceId,k)}var me=Jr(),je=t(me);{var ye=x=>{var b=Er(),j=t(b,!0);e(b),_(k=>i(j,k),[()=>n()("session.combat_card.initiative")]),d(x,b)};p(je,x=>{a(o)&&r.entity.initiative&&x(ye)})}var Me=s(je,2);{var Je=x=>{var b=Sr();d(x,b)};p(Me,x=>{a(pe)&&x(Je)})}var he=s(Me,2),P=t(he),oe=t(P),ue=t(oe),Ee=t(ue);as(Ee,()=>r.entity.imageUrl,x=>{{let b=J(()=>r.entity.name.charAt(0));Da(x,{get hash(){return r.entity.imageUrl},get alt(){return r.entity.name},size:"custom",get fallbackText(){return a(b)}})}}),e(ue);var we=s(ue,2);we.__click=kt;var mt=t(we);{var lt=x=>{Pa(x,{size:14,class:""})},dt=x=>{var b=It(),j=qe(b);{var k=Ge=>{ks(Ge,{size:14})},ke=Ge=>{zs(Ge,{size:14})};p(j,Ge=>{r.entity.acted?Ge(k):Ge(ke,!1)},!0)}d(x,b)};p(mt,x=>{a(pe)?x(lt):x(dt,!1)})}e(we),e(oe);var xt=s(oe,2),it=t(xt),St=t(it),ht=t(St),ft=t(ht),Pt=t(ft,!0);e(ft);var yt=s(ft,2);{var Ve=x=>{var b=Ir(),j=t(b);e(b),_(()=>i(j,`Dif ${r.entity.difficulty??""}`)),d(x,b)};p(yt,x=>{a(o)||x(Ve)})}e(ht),e(St);var nt=s(St,2),Se=t(nt);Se.__click=()=>C(M,!a(M));var Pe=t(Se);{var Ke=x=>{mr(x,{size:14})},Le=x=>{or(x,{size:14})};p(Pe,x=>{a(M)?x(Ke):x(Le,!1)})}e(Se);var et=s(Se,2);{var F=x=>{var b=Dr();b.__click=re;var j=t(b);fr(j,{size:14}),e(b),_(k=>{Ze(b,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${r.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),de(b,"title",k)},[()=>n()("session.combat_card.initiative")]),d(x,b)},le=x=>{var b=Rr();b.__click=()=>A()(r.entity.instanceId);var j=t(b);ya(j,{size:14}),e(b),d(x,b)};p(et,x=>{a(o)?x(F):x(le,!1)})}e(nt),e(it);var Ie=s(it,2),Z=t(Ie),Oe=s(Z,2);{var Re=x=>{var b=Nr();_(()=>{Ze(b,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10
                            ${a(pe)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(D)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(I)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),Na(b,`width: ${a(D)??""}%`)}),d(x,b)};p(Oe,x=>{a(D)>0&&x(Re)})}var Qe=s(Oe,2);{var y=x=>{var b=Ar();d(x,b)};p(Qe,x=>{a($)===0&&x(y)})}var z=s(Qe,2);{var O=x=>{var b=Tr(),j=t(b),k=t(j,!0);e(j),e(b),_(ke=>i(k,ke),[()=>n()("session.combat_card.incapacitated")]),d(x,b)},Q=x=>{var b=It(),j=qe(b);{var k=ke=>{var Ge=$r(),rt=t(Ge),at=t(rt,!0);e(rt),e(Ge),_(Ct=>i(at,Ct),[()=>n()("session.combat_card.injured")]),d(ke,Ge)};p(j,ke=>{a(I)&&ke(k)},!0)}d(x,b)};p(z,x=>{a(pe)?x(O):x(Q,!1)})}e(Ie);var ge=s(Ie,2),be=t(ge),Ae=t(be),tt=t(Ae),st=t(tt,!0);e(tt);var zt=s(tt,2),Be=t(zt,!0);e(zt),e(Ae);var T=s(Ae,2),L=t(T),E=t(L,!0);e(L);var ve=s(L,2);Mt(ve),ve.__input=De,Ea(2),e(T);var q=s(T,2),W=t(q),G=t(W,!0);e(W);var Te=s(W,2),ce=t(Te);Mt(ce),ce.__input=ze;var _e=s(ce,2),X=t(_e);e(_e),e(Te),e(q);var $e=s(q,2);{var xe=x=>{var b=Ur(),j=t(b),k=t(j,!0);e(j);var ke=s(j,2),Ge=t(ke,!0);e(ke),e(b),_(rt=>{i(k,rt),i(Ge,r.entity.perception||10)},[()=>n()("sofdl.attributes.perception")]),d(x,b)};p($e,x=>{a(S)&&x(xe)})}e(be);var We=s(be,2),vt=t(We);Xe(vt,17,()=>r.entity.afflictions||[],Ot,(x,b)=>{var j=Pr();j.__click=()=>Ce(a(b));var k=t(j),ke=s(k);ya(ke,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(j),_(()=>i(k,`${a(b)??""} `)),d(x,j)});var ct=s(vt,2);ct.__click=()=>C(V,!0);var ut=t(ct);ra(ut,{size:10});var Lt=s(ut);e(ct),e(We),e(ge),e(xt),e(P),e(he);var Dt=s(he,2);{var Vt=x=>{var b=Gr(),j=t(b),k=t(j),ke=t(k),Ge=t(ke,!0);e(ke),Ea(2),e(k);var rt=s(k,2);Xe(rt,21,()=>a(S)?["strength","agility","intellect","will"]:["str","agi","int","wil"],Ot,(l,v)=>{const u=J(()=>a(S)?r.entity.attributes?.[a(v)]??10:r.entity.stats?.[a(v)]??r.entity.attributes?.[a(v)]??10),g=J(()=>a(u)-10);var B=Lr(),f=t(B),w=t(f,!0);e(f);var h=s(f,2),ie=t(h,!0);e(h);var H=s(h,2),te=t(H);e(H),e(B),_(ee=>{i(w,ee),i(ie,a(u)),Ze(H,1,`text-[9px] font-bold ${a(g)>=0?"text-emerald-500":"text-red-500"}`),i(te,`${a(g)>=0?"+":""}${a(g)??""}`)},[()=>a(S)?a(v).slice(0,3):a(v)]),d(l,B)}),e(rt),e(j);var at=s(j,2);{var Ct=l=>{var v=Fr(),u=t(v),g=t(u),B=t(g),f=t(B,!0);e(B);var w=s(B,2),h=t(w,!0);e(w),e(g);var ie=s(g,2);Gs(ie,{size:20,class:"text-purple-500/30 group-hover/ins:text-purple-500 transition-colors"}),e(u);var H=s(u,2),te=t(H),ee=t(te),fe=t(ee,!0);e(ee);var ne=s(ee,2),Fe=t(ne,!0);e(ne),e(te);var ae=s(te,2);Pa(ae,{size:20,class:"text-red-500/30 group-hover/cor:text-red-500 transition-colors"}),e(H),e(v),_((He,Ue)=>{i(f,He),i(h,r.entity.insanity||0),i(fe,Ue),i(Fe,r.entity.corruption||0)},[()=>n()("sofdl.attributes.insanity"),()=>n()("sofdl.attributes.corruption")]),d(l,v)};p(at,l=>{a(S)&&l(Ct)})}var jt=s(at,2),Ft=t(jt),Rt=t(Ft),Bt=t(Rt,!0);e(Rt);var Jt=s(Rt,2),Xt=t(Jt,!0);e(Jt),e(Ft);var ta=s(Ft,2),Gt=t(ta),Wt=t(Gt,!0);e(Gt);var Qt=s(Gt,2),ca=t(Qt,!0);e(Qt),e(ta),e(jt);var Zt=s(jt,2),pt=t(Zt);{var $t=l=>{var v=qr(),u=t(v),g=t(u);Ea(),e(u);var B=s(u,2);Xe(B,21,()=>r.entity.senses,Ot,(f,w)=>{const h=J(()=>{const[te,ee]=a(w).split(":");return{key:te,val:ee}}),ie=J(()=>n()(`character.senses.list.${a(h).key}`)+(a(h).val?` ${a(h).val}`:"")),H=J(()=>n()(`character.senses.descriptions.${a(h).key}`));Js(f,{get text(){return a(H)},class:"text-xs bg-emerald-950/30 text-emerald-200 px-3 py-1.5 rounded border border-emerald-900/50 font-bold flex items-center gap-2 cursor-help whitespace-nowrap",children:(te,ee)=>{var fe=Hr(),ne=qe(fe);Fa(ne,{size:12,class:"text-emerald-500 flex-shrink-0"});var Fe=s(ne);_(()=>i(Fe,` ${a(ie)??""}`)),d(te,fe)},$$slots:{default:!0}})}),e(B),e(v),_(f=>i(g,`${f??""} `),[()=>n()("character.senses.title")]),d(l,v)};p(pt,l=>{r.entity.senses&&r.entity.senses.length>0&&l($t)})}var ia=s(pt,2);Xe(ia,16,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],Ot,(l,v)=>{var u=It(),g=qe(u);{var B=f=>{var w=Wr(),h=t(w),ie=t(h);Ea(),e(h);var H=s(h,2);Xe(H,21,()=>r.entity[v.key],Ot,(te,ee)=>{var fe=Br(),ne=t(fe),Fe=t(ne,!0);e(ne);var ae=s(ne,2),He=t(ae,!0);e(ae),e(fe),_(()=>{i(Fe,a(ee).name),i(He,a(ee).description||a(ee).effect)}),d(te,fe)}),e(H),e(w),_(()=>{Ze(h,1,`${v.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),i(ie,`${v.label??""} `)}),d(f,w)};p(g,f=>{r.entity[v.key]&&r.entity[v.key].length>0&&f(B)})}d(l,u)}),e(Zt),e(b),_((l,v,u)=>{i(Ge,l),i(Bt,v),i(Xt,r.entity.size||1),i(Wt,u),i(ca,r.entity.speed||10)},[()=>n()("session.combat_card.attributes"),()=>n()("session.combat_card.size"),()=>n()("session.combat_card.speed")]),d(x,b)};p(Dt,x=>{a(M)&&x(Vt)})}var Tt=s(Dt,2);{let x=J(()=>r.entity.afflictions||[]);Or(Tt,{get isOpen(){return a(V)},onClose:()=>C(V,!1),get afflictions(){return a(x)},onToggle:Ce})}e(me),_((x,b,j,k,ke)=>{Ze(me,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(o)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),Ze(ue,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(pe)?"border-red-600 grayscale brightness-50":a(o)?"border-indigo-500/50":"border-red-900/50"}`),Ze(we,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${r.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(o)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),de(we,"title",x),Ze(ft,1,`text-base font-bold truncate leading-snug ${a(o)?"text-white":"text-red-100 font-serif tracking-wide"}`),i(Pt,r.entity.name),Ze(Z,1,`absolute inset-0 w-full ${a($)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),i(st,b),i(Be,r.entity.defense||10),i(E,j),Za(ve,a($)),Ze(q,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(pe)?"bg-red-950/50 border-red-500":a(I)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),Ze(W,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(pe)?"text-red-400":a(I)?"text-orange-400":"text-emerald-400"}`),i(G,k),Za(ce,a(Ne)),i(X,`/${a(se)??""}`),i(Lt,` ${ke??""}`)},[()=>r.entity.acted?n()("session.combat_card.acted"):n()("session.combat_card.act"),()=>n()("session.combat_card.defense"),()=>n()("session.combat_card.damage"),()=>n()("session.combat_card.health"),()=>n()("session.combat_card.add_affliction")]),d(Y,me),la(),R()}ba(["click","input"]);function Qr(Y,{from:r,to:n},K={}){var{delay:R=0,duration:m=re=>Math.sqrt(re)*120,easing:N=tr}=K,A=getComputedStyle(Y),o=A.transform==="none"?"":A.transform,[S,$]=A.transformOrigin.split(" ").map(parseFloat);S/=Y.clientWidth,$/=Y.clientHeight;var se=Yr(Y),Ne=Y.clientWidth/n.width/se,pe=Y.clientHeight/n.height/se,I=r.left+r.width*S,D=r.top+r.height*$,M=n.left+n.width*S,V=n.top+n.height*$,U=(I-M)*Ne,De=(D-V)*pe,ze=r.width/n.width,kt=r.height/n.height;return{delay:R,duration:typeof m=="function"?m(Math.sqrt(U*U+De*De)):m,easing:N,css:(re,Ce)=>{var me=Ce*U,je=Ce*De,ye=re+Ce*ze,Me=re+Ce*kt;return`transform: ${o} translate(${me}px, ${je}px) scale(${ye}, ${Me});`}}}function Yr(Y){if("currentCSSZoom"in Y)return Y.currentCSSZoom;for(var r=Y,n=1;r!==null;)n*=+getComputedStyle(r).zoom,r=r.parentElement;return n}function Zr(Y,r=1,n=0){const K=[];let R=0;for(let o=0;o<r;o++){const S=Math.floor(Math.random()*Y)+1;K.push(S),R+=S}let m=`${r}d${Y}`,N=[],A=0;if(n!==0)if(Y===20){const o=Math.abs(n);for(let $=0;$<o;$++)N.push(Math.floor(Math.random()*6)+1);const S=Math.max(...N);n>0?(A=S,R+=S,m+=` + ${S} [Boon]`):(A=-S,R-=S,m+=` - ${S} [Bane]`)}else A=n,R+=n,m+=n>0?` + ${n}`:` - ${Math.abs(n)}`;return{total:R,results:K,bonusRolls:N,formula:m,crit:Y===20&&K.includes(20),modifierTotal:A,dice:[{sides:Y,count:r,results:K}]}}function Xr(Y){const r=Y.replace(/\s+/g,""),n=/([+-]?)(?:(\d+)?d(\d+)|(\d+))/g;let K=0,R="";const m=[],N=[];let A,o=!0;for(;(A=n.exec(r))!==null;){if(A[0]===""){n.lastIndex++;continue}const $=(A[1]||"+")==="-"?-1:1,se=A[2],Ne=A[3],pe=A[4];if(Ne){const I=se?parseInt(se):1,D=parseInt(Ne),M=[];let V=0;for(let kt=0;kt<I;kt++){const re=Math.floor(Math.random()*D)+1;M.push(re),V+=re}m.push(...M),N.push({sides:D,count:I,results:M});const U=V*$;K+=U;const De=o&&$===1?"":$===1?" + ":" - ";I===1&&D===3&&M[0];const ze=`${De}${I}d${D}[${M.join(",")}]`;R+=ze}else if(pe){const I=parseInt(pe);K+=I*$;const M=`${o&&$===1?"":$===1?" + ":" - "}${I}`;R+=M}o=!1}return{total:K,results:m,bonusRolls:[],formula:R.trim(),crit:!1,modifierTotal:0,dice:N}}var Kr=c('<div class="h-full border-r border-slate-900/30 last:border-0"></div>'),ei=c('<div class="flex flex-col items-center"><span> </span> <span class="text-[8px] font-mono text-slate-600"><!></span></div>'),ti=c('<div class="space-y-4 w-full"><div class="relative h-3 w-full bg-slate-800 rounded-full overflow-hidden border border-slate-700/50 shadow-inner"><div class="absolute inset-0 flex"></div> <div><div class="absolute inset-0 bg-white/10 animate-pulse"></div></div></div> <div class="flex justify-between w-full px-1"></div></div>');function Os(Y,r){oa(r,!0);const n=()=>Ut(aa,"$t",K),[K,R]=da();let m=J(()=>()=>{for(let I=0;I<r.segments.length;I++)if(r.value<=r.segments[I].max)return I;return r.segments.length-1}),N=J(()=>()=>{const I=a(m)(),D=I===0?0:r.segments[I-1].max,M=r.segments[I].max;if(I===r.segments.length-1&&r.value>M)return 1;const V=M-D;return V===0?1:Math.min(1,Math.max(0,(r.value-D)/V))}),A=J(()=>()=>{const I=a(m)(),D=100/r.segments.length;return I*D+a(N)()*D}),o=J(()=>r.segments[a(m)()].color);var S=ti(),$=t(S),se=t($);Xe(se,21,()=>r.segments,Ot,(I,D)=>{var M=Kr();_(()=>Na(M,`width: ${100/r.segments.length}%`)),d(I,M)}),e(se);var Ne=s(se,2);e($);var pe=s($,2);Xe(pe,21,()=>r.segments,Ot,(I,D,M)=>{var V=ei(),U=t(V),De=t(U,!0);e(U);var ze=s(U,2),kt=t(ze);{var re=me=>{var je=Va();_(()=>i(je,`${r.segments[M-1].max+1}+`)),d(me,je)},Ce=me=>{var je=It(),ye=qe(je);{var Me=he=>{var P=Va();_(()=>i(P,a(D).max)),d(he,P)},Je=he=>{var P=Va();_(()=>i(P,a(D).max)),d(he,P)};p(ye,he=>{M===0?he(Me):he(Je,!1)},!0)}d(me,je)};p(kt,me=>{M===r.segments.length-1?me(re):me(Ce,!1)})}e(ze),e(V),_((me,je)=>{Na(V,`width: ${100/r.segments.length}%`),Ze(U,1,`text-[9px] font-black uppercase tracking-tighter transition-colors ${me??""}`,"svelte-1ix6916"),i(De,je)},[()=>M===a(m)()?a(o).replace("bg-","text-"):"text-slate-500",()=>n()("campaign.difficulty."+a(D).key)]),d(I,V)}),e(pe),e(S),_(I=>{Ze(Ne,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out rounded-full ${a(o)??""}`,"svelte-1ix6916"),Na(Ne,`width: ${I??""}%`)},[()=>a(A)()]),d(Y,S),la(),R()}var ai=c('<div><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-2"><!> <span class="text-xs font-black uppercase tracking-widest"> </span></div> <div class="text-xs font-bold uppercase opacity-70"> </div></div> <div class="flex items-center justify-between mb-6"><div><div class="text-3xl font-black leading-none"> </div> <div class="text-[10px] font-bold uppercase opacity-50 mt-1"> </div></div> <div class="text-right"><div class="text-sm font-black uppercase"> </div> <div class="text-[10px] font-bold opacity-40 mt-1 flex items-center justify-end gap-1"><span class="uppercase tracking-tighter"> </span> <span> </span></div></div></div> <!></div>');function ds(Y,r){oa(r,!0);const n=()=>Ut(aa,"$t",K),[K,R]=da(),m={starting:{easy:3,avgMin:4,avgMax:15,challMin:16,challMax:30,hard:31,maxCreature:25},novice:{easy:10,avgMin:11,avgMax:30,challMin:31,challMax:50,hard:51,maxCreature:100},expert:{easy:30,avgMin:31,avgMax:50,challMin:51,challMax:125,hard:126,maxCreature:250},master:{easy:50,avgMin:51,avgMax:125,challMin:126,challMax:200,hard:201,maxCreature:null}};let N=J(()=>m[r.tier]||m.starting),A=J(()=>()=>r.totalDifficulty<=a(N).easy?"easy":r.totalDifficulty<=a(N).avgMax?"average":r.totalDifficulty<=a(N).challMax?"challenging":"hard"),o=J(()=>[{key:"easy",max:a(N).easy,color:"bg-green-500"},{key:"average",max:a(N).avgMax,color:"bg-yellow-500"},{key:"challenging",max:a(N).challMax,color:"bg-orange-500"},{key:"hard",max:a(N).challMax*1.5,color:"bg-red-500"}]),S=J(()=>()=>{switch(a(A)()){case"easy":return"text-green-400 bg-green-500/10 border-green-500/30";case"average":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/30";case"challenging":return"text-orange-400 bg-orange-500/10 border-orange-500/30";case"hard":return"text-red-400 bg-red-500/10 border-red-500/30";default:return"text-slate-400 bg-slate-500/10 border-slate-500/30"}});var $=ai(),se=t($),Ne=t(se),pe=t(Ne);Pa(pe,{size:18});var I=s(pe,2),D=t(I,!0);e(I),e(Ne);var M=s(Ne,2),V=t(M,!0);e(M),e(se);var U=s(se,2),De=t(U),ze=t(De),kt=t(ze,!0);e(ze);var re=s(ze,2),Ce=t(re,!0);e(re),e(De);var me=s(De,2),je=t(me),ye=t(je,!0);e(je);var Me=s(je,2),Je=t(Me),he=t(Je);e(Je);var P=s(Je,2),oe=t(P,!0);e(P),e(Me),e(me),e(U);var ue=s(U,2);Os(ue,{get value(){return r.totalDifficulty},get segments(){return a(o)}}),e($),_((Ee,we,mt,lt,dt,xt,it)=>{Ze($,1,`rounded-xl border p-4 ${Ee??""} shadow-lg`),i(D,we),i(V,mt),i(kt,r.totalDifficulty),i(Ce,lt),i(ye,dt),i(he,`${xt??""}:`),i(oe,it)},[()=>a(S)(),()=>n()("campaign.difficulty.title"),()=>n()("campaign.settings.tiers."+r.tier),()=>n()("campaign.difficulty.total"),()=>n()("campaign.difficulty."+a(A)()),()=>n()("campaign.difficulty.max_creature"),()=>a(N).maxCreature??n()("campaign.difficulty.none")]),d(Y,$),la(),R()}var si=c('<div><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-2"><!> <span class="text-xs font-black uppercase tracking-widest"> </span></div> <div class="flex items-center gap-2 text-xs font-bold uppercase opacity-70"><span> </span> <span class="text-[10px] bg-black/20 px-2 py-0.5 rounded"> </span></div></div> <div class="flex items-center justify-between mb-6"><div><div class="text-3xl font-black leading-none"> </div> <div class="text-[10px] font-bold uppercase opacity-50 mt-1"> </div></div> <div class="text-right"><div class="text-sm font-black uppercase"> </div> <div class="text-[10px] font-medium opacity-50 mt-1 uppercase tracking-tighter"> </div></div></div> <!></div>');function vs(Y,r){oa(r,!0);const n=()=>Ut(aa,"$t",K),[K,R]=da(),m={starting:{easy:.5,average:1,hard:1.5},novice:{easy:1,average:2,hard:3},expert:{easy:2,average:4,hard:6},master:{easy:4,average:8,hard:12}};let N=J(()=>m[r.tier]||m.novice),A=J(()=>({easy:a(N).easy*r.playerCount,average:a(N).average*r.playerCount,hard:a(N).hard*r.playerCount})),o=J(()=>()=>r.totalDifficulty<=a(A).easy?"easy":r.totalDifficulty<=a(A).average?"average":"hard"),S=J(()=>[{key:"easy",max:a(A).easy,color:"bg-green-500"},{key:"average",max:a(A).average,color:"bg-yellow-500"},{key:"hard",max:a(A).hard*1.5,color:"bg-red-500"}]),$=J(()=>()=>{switch(a(o)()){case"easy":return"text-green-400 bg-green-500/10 border-green-500/30";case"average":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/30";case"hard":return"text-red-400 bg-red-500/10 border-red-500/30";default:return"text-slate-400 bg-slate-500/10 border-slate-500/30"}});var se=si(),Ne=t(se),pe=t(Ne),I=t(pe);Pa(I,{size:18});var D=s(I,2),M=t(D,!0);e(D),e(pe);var V=s(pe,2),U=t(V),De=t(U,!0);e(U);var ze=s(U,2),kt=t(ze,!0);e(ze),e(V),e(Ne);var re=s(Ne,2),Ce=t(re),me=t(Ce),je=t(me,!0);e(me);var ye=s(me,2),Me=t(ye,!0);e(ye),e(Ce);var Je=s(Ce,2),he=t(Je),P=t(he,!0);e(he);var oe=s(he,2),ue=t(oe);e(oe),e(Je),e(re);var Ee=s(re,2);Os(Ee,{get value(){return r.totalDifficulty},get segments(){return a(S)}}),e(se),_((we,mt,lt,dt,xt,it,St)=>{Ze(se,1,`rounded-xl border p-4 ${we??""} shadow-lg`),i(M,mt),i(De,lt),i(kt,dt),i(je,r.totalDifficulty),i(Me,xt),i(P,it),i(ue,`${a(N).average??""}/${St??""}`)},[()=>a($)(),()=>n()("campaign.difficulty.title"),()=>n()("campaign.settings.tiers."+r.tier),()=>n()("campaign.difficulty.players",{values:{count:r.playerCount}}),()=>n()("campaign.difficulty.total"),()=>n()("campaign.difficulty."+a(o)()),()=>n()("common.labels.master")]),d(Y,se),la(),R()}var ri=c('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),ii=c('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),ni=c('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),oi=c('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),li=c('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),di=c('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),vi=c('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),ci=c('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),ui=c('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),bi=c('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),_i=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1 flex items-center gap-2"><!> <div class="min-w-0 flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),mi=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),xi=c("<!> <!>",1),fi=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),pi=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),gi=c("<!> <!>",1),hi=c('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),yi=c('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),wi=c('<div class="lg:hidden"><!></div>'),ki=c("<div><!></div>"),zi=c('<div class="text-center text-slate-500 italic py-10"> </div>'),Ci=c('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),ji=c('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),Mi=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),Oi=c('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),Ei=c('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),Si=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Ii=c('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1 flex flex-col"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),Di=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Ri=c("<!> <!>",1),Ni=c('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),Ai=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Ti=c("<!> <!>",1),$i=c('<div class="fixed inset-0 z-50 flex justify-end bg-black/60"><div class="w-full max-w-[300px] h-full bg-slate-900 border-l border-slate-800 p-4 shadow-2xl animate-in slide-in-from-right duration-300"><div class="flex justify-between items-center mb-4"><h3 class="font-bold text-white uppercase tracking-widest text-sm flex items-center gap-2"><!> </h3> <button class="bg-slate-800 p-2 rounded-lg text-slate-400 hover:text-white"><!></button></div> <div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="h-[calc(100%-100px)] overflow-y-auto custom-scrollbar space-y-2"><!></div></div></div>'),Ui=c('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="hidden lg:flex flex-col h-[400px] bg-slate-900 border border-slate-800 rounded-xl p-4"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4" role="region" aria-label="Combat Zone"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <!> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"><!></div></div> <!> <!> <!> <button class="lg:hidden fixed bottom-24 right-4 bg-slate-800 text-white p-3 rounded-full shadow-lg border border-slate-700 z-40 active:scale-90 transition-transform" aria-label="Add Enemy"><!></button> <!> <!>',1);function Pi(Y,r){oa(r,!0);const n=()=>Ut(Fs,"$liveCharacters",A),K=()=>Ut(ts,"$liveEnemies",A),R=()=>Ut(us,"$liveEncounters",A),m=()=>Ut(aa,"$t",A),N=()=>Ut(Ma,"$isHistoryOpen",A),[A,o]=da();let S=_t(!1),$=_t(!1),se=_t(!1),Ne=_t(!1);const pe={active:!1,round:1};let I=_t("enemies"),D=_t(!1),M=_t(ma([])),V=_t(ma({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));rs(()=>{if(r.campaign?.id){Rs(r.campaign.id,!0);const l=Ta(aa)("common.labels.master");is.update(u=>({...u,campaignId:r.campaign.id,name:r.campaign.gmName||l}));const v=setInterval(()=>{const u=ea.get(r.campaign.id)||r.campaign,g=Ta(aa)("common.labels.master");Xa(r.campaign.id,{name:u.name,gmName:u.gmName||g})},3e4);return()=>{clearInterval(v),Ns(),is.update(u=>({...u,campaignId:null}))}}});const U=J(()=>typeof window<"u"?`${window.location.origin}${ms("/campaigns/[id]/invite",{id:r.campaign?.id})}`:"");function De(){a(U)&&(navigator.clipboard.writeText(a(U)),C(se,!0),setTimeout(()=>{C(se,!1)},2e3))}let ze=J(()=>r.campaign?.sessionRoster||[]),kt=J(()=>r.campaign?.combat||pe),re=J(()=>r.campaign?.activeEnemies||[]),Ce=J(()=>r.campaign?.members||[]),me=J(()=>r.campaign?.initiativeStyle||"dle"),je=J(()=>r.campaign?.tier||ur(r.campaign?.system)),ye=J(()=>a(re).reduce((l,v)=>l+(v.difficulty||0),0)),Me=J(()=>a(ze).length||1),Je=J(()=>Array.from(new Set([...a(ze),...a(Ce).map(v=>v.id)])).map(v=>{const u=n().find(B=>B.id===v),g=a(Ce).find(B=>B.id===v);return u&&g?{...u,...g,lastUpdate:g.lastUpdate}:u||g}).filter(Boolean)),he=J(()=>a(Je).filter(l=>!l.campaignApproval||l.campaignApproval==="approved")),P=J(()=>a(Je).filter(l=>l.campaignApproval==="pending")),oe=J(()=>n().filter(l=>!a(ze).includes(l.id)&&!a(Ce).some(v=>v.id===l.id)&&(l.system||Oa)===(r.campaign?.system||Oa))),ue=J(()=>K().filter(l=>{const v=(l.system||Oa)===(r.campaign?.system||Oa),u=l.campaignId===r.campaign?.id||l.global;return v&&u})),Ee=J(()=>R().filter(l=>(l.system||Oa)===(r.campaign?.system||Oa)&&!0));function we(l){if(!r.campaign?.id)return;const u={...ea.get(r.campaign.id)||r.campaign,...l,lastUpdate:Date.now()};ea.set(r.campaign.id,u),l.combat&&Ra(r.campaign.id,l.combat),(l.name||l.gmName)&&Xa(r.campaign.id,{name:u.name,gmName:u.gmName}),nr(r.campaign.id,u)}function mt(l){if(a(ze).includes(l)){const v=a(ze).filter(u=>u!==l);we({sessionRoster:v})}else{const v=[...a(ze),l];we({sessionRoster:v})}}function lt(l){et(l,{campaignApproval:"approved"}),Aa({id:l,campaignApproval:"approved"})}function dt(l){Aa({id:l,campaignApproval:"rejected",campaignId:null});const u=((ea.get(r.campaign.id)||r.campaign).members||[]).filter(g=>g.id!==l);we({members:u})}function xt(l){const v=a(Je).find(u=>u.id===l);C(V,{isOpen:!0,title:m()("session.players.remove_title"),message:m()("session.players.remove_message",{values:{name:v?.name||"este personagem"}}),onConfirm:()=>{const u=ea.get(r.campaign.id)||r.campaign;Aa({id:l,campaignId:null});const g=(u.sessionRoster||[]).filter(w=>w!==l),B=(u.members||[]).filter(w=>w.id!==l),f=(u.activeEnemies||[]).filter(w=>w.type!=="player"||w.id!==l);we({sessionRoster:g,members:B,activeEnemies:f}),a(V).isOpen=!1}},!0)}function it(l){const u=(ea.get(r.campaign.id)||r.campaign).activeEnemies||[],g={...l,instanceId:Ia(),damage:0,currentHealth:l.health,afflictions:[],acted:!1,initiative:!1};we({activeEnemies:[...u,g]})}function St(l){const u=(ea.get(r.campaign.id)||r.campaign).activeEnemies||[];let g=[];l.enemies.forEach(B=>{const f=K().find(w=>w.id===B.enemyId);if(f)for(let w=0;w<B.count;w++)g.push({...f,instanceId:Ia(),damage:0,currentHealth:f.health,afflictions:[],acted:!1,initiative:!1})}),we({activeEnemies:[...u,...g]})}function ht(){we({combat:{active:!0,round:1}}),Ra(r.campaign.id,{active:!0,round:1})}function ft(){const l=a(re).filter(v=>v.damage<(v.currentHealth??v.health)&&v.endOfRound&&v.endOfRound.length>0).map(v=>({name:v.name,effects:v.endOfRound}));if(l.length>0){C(M,l,!0),C(D,!0);return}Pt()}function Pt(){const l=ea.get(r.campaign.id)||r.campaign,v=(l.combat?.round||1)+1,u=(l.activeEnemies||[]).map(g=>({...g,acted:!1}));we({combat:{...l.combat,round:v},activeEnemies:u}),Ra(r.campaign.id,{active:!0,round:v}),C(D,!1)}function yt(l){we({combat:{active:!1,round:1}}),Ra(r.campaign.id,{active:!1,round:1})}function Ve(l){const v=ea.get(r.campaign.id)||r.campaign;we({activeEnemies:(v.activeEnemies||[]).filter(u=>u.instanceId!==l)})}function nt(l,v){const u=ea.get(r.campaign.id)||r.campaign;we({activeEnemies:(u.activeEnemies||[]).map(g=>g.instanceId===l?{...g,...v}:g)})}function Se(){const l=ea.get(r.campaign.id)||r.campaign,v=l.combat?.round||1;v>1&&we({combat:{...l.combat,round:v-1}})}let Pe=_t(ma(Date.now()));rs(()=>{const l=setInterval(()=>{C(Pe,Date.now(),!0)},1e4);return()=>clearInterval(l)});let Ke=J(()=>(()=>{const l=a(he).filter(v=>a(ze).includes(v.id));return ir(a(me),l,a(re))})());function Le(l){return l.lastUpdate?a(Pe)-l.lastUpdate<6e4:!1}function et(l,v){const u=ea.get(r.campaign.id)||r.campaign,g=u.members||[],B=g.findIndex(H=>H.id===l);let f=g;B!==-1&&(f=[...g],f[B]={...f[B],...v});const w=u.activeEnemies||[],h=w.findIndex(H=>H.id===l&&H.type==="player");let ie=w;h!==-1&&(ie=[...w],ie[h]={...ie[h],...v}),we({members:f,activeEnemies:ie})}function F(l,v,u){l.dataTransfer&&(l.dataTransfer.setData("application/json",JSON.stringify({item:v,type:u})),l.dataTransfer.effectAllowed="copy")}function le(l){return l.preventDefault(),!1}function Ie(l){l.preventDefault();const v=l.dataTransfer?.getData("application/json");if(v)try{const{item:u,type:g}=JSON.parse(v);g==="enemy"?it(u):g==="encounter"&&St(u)}catch(u){console.error("Drop error",u)}}var Z=Ui(),Oe=qe(Z),Re=t(Oe),Qe=t(Re),y=t(Qe),z=t(y),O=t(z);bs(O,{size:14,class:"text-indigo-500"});var Q=s(O),ge=s(Q);{var be=l=>{var v=ri(),u=t(v,!0);e(v),_(()=>i(u,a(he).length)),d(l,v)};p(ge,l=>{a(he).length>0&&l(be)})}e(z);var Ae=s(z,2);Ae.__click=()=>C(S,!a(S));var tt=t(Ae,!0);e(Ae),e(y);var st=s(y,2);{var zt=l=>{var v=ni(),u=t(v),g=s(t(u),2),B=t(g);e(g),e(u);var f=s(u,2);Xe(f,17,()=>a(P),w=>w.id,(w,h)=>{var ie=ii(),H=t(ie),te=t(H),ee=t(te,!0);e(te);var fe=s(te,2),ne=t(fe,!0);e(fe),e(H);var Fe=s(H,2),ae=t(Fe);ae.__click=()=>lt(a(h).id);var He=t(ae);ls(He,{size:14}),e(ae);var Ue=s(ae,2);Ue.__click=()=>dt(a(h).id);var wt=t(Ue);ua(wt,{size:14}),e(Ue),e(Fe),e(ie),_(gt=>{i(ee,a(h).name),i(ne,gt)},[()=>m()("session.players.new_request")]),d(w,ie)}),Ea(2),e(v),_(w=>i(B,`${w??""} (${a(P).length??""})`),[()=>m()("session.players.waiting_approval")]),d(l,v)};p(st,l=>{a(P).length>0&&l(zt)})}var Be=s(st,2),T=t(Be),L=t(T);Xe(L,17,()=>a(he),l=>l.id,(l,v)=>{const u=J(()=>Le(a(v))),g=J(()=>a(ze).includes(a(v).id));var B=li(),f=t(B),w=s(f,2),h=t(w),ie=t(h,!0);e(h);var H=s(h,2),te=t(H);{var ee=Ye=>{var ot=oi(),Et=t(ot,!0);e(ot),_(qt=>i(Et,qt),[()=>m()("common.labels.session")]),d(Ye,ot)};p(te,Ye=>{a(g)&&Ye(ee)})}var fe=s(te);e(H),e(w);var ne=s(w,2),Fe=t(ne);Fe.__click=()=>mt(a(v).id);var ae=t(Fe);{var He=Ye=>{xs(Ye,{size:14})},Ue=Ye=>{ra(Ye,{size:14})};p(ae,Ye=>{a(g)?Ye(He):Ye(Ue,!1)})}e(Fe);var wt=s(Fe,2);wt.__click=()=>xt(a(v).id);var gt=t(wt);ua(gt,{size:14}),e(wt),e(ne),e(B),_((Ye,ot,Et)=>{Ze(B,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(u)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(u)||a(g)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),Ze(f,1,`w-2 h-2 rounded-full ${a(u)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),Ze(h,1,`font-bold text-sm ${a(u)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),i(ie,a(v).name),i(fe,` ${Ye??""} ${a(v).level??""} • ${a(v).ancestry??""}`),Ze(Fe,1,`p-1.5 rounded-lg transition-all ${a(g)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),de(Fe,"title",ot),de(wt,"title",Et)},[()=>m()("common.labels.level"),()=>a(g)?m()("session.players.remove_from_session"):m()("session.players.add_to_session"),()=>m()("session.players.kick_from_campaign")]),d(l,B)});var E=s(L,2);{var ve=l=>{var v=di(),u=t(v,!0);e(v),_(g=>i(u,g),[()=>m()("session.players.none")]),d(l,v)};p(E,l=>{a(he).length===0&&l(ve)})}e(T),e(Be);var q=s(Be,2),W=t(q);{var G=l=>{var v=vi(),u=qe(v);u.__click=()=>{we({isPublished:!0}),As({id:r.campaign.id,name:r.campaign.name,gmName:r.campaign.gmName,description:r.campaign.description,system:r.campaign.system})};var g=t(u);_a(g,{size:14});var B=s(g);e(u);var f=s(u,2),w=t(f,!0);e(f),_((h,ie)=>{i(B,` ${h??""}`),i(w,ie)},[()=>m()("session.publish.publish_session"),()=>m()("session.publish.make_visible")]),d(l,v)},Te=l=>{var v=bi(),u=qe(v),g=t(u),B=t(g),f=t(B);_s(f,{size:10,class:"animate-pulse"});var w=s(f);e(B),e(g);var h=s(g,2);h.__click=()=>C(Ne,!a(Ne));var ie=t(h);gr(ie,{size:14}),e(h),e(u);var H=s(u,2);{var te=ot=>{var Et=ci(),qt=t(Et);e(Et),_((Nt,At)=>{de(qt,"src",Nt),de(qt,"alt",At)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(U))}`,()=>m()("session.publish.qr_alt")]),d(ot,Et)};p(H,ot=>{a(Ne)&&ot(te)})}var ee=s(H,2),fe=t(ee),ne=t(fe);ne.__click=De;var Fe=t(ne,!0);e(ne);var ae=s(ne,2);ae.__click=De;var He=t(ae);{var Ue=ot=>{var Et=ui(),qt=t(Et);ls(qt,{size:10,class:"inline mr-1"});var Nt=s(qt);e(Et),_(At=>i(Nt,` ${At??""}`),[()=>m()("common.buttons.copied")]),d(ot,Et)};p(He,ot=>{a(se)&&ot(Ue)})}var wt=s(He,2);xr(wt,{size:14}),e(ae),e(fe),e(ee);var gt=s(ee,2);gt.__click=()=>we({isPublished:!1});var Ye=t(gt,!0);e(gt),_((ot,Et,qt,Nt)=>{i(w,` ${ot??""}`),de(h,"title",Et),i(Fe,a(U)),de(ae,"aria-label",qt),i(Ye,Nt)},[()=>m()("session.publish.public_session"),()=>m()("session.publish.qr_code"),()=>m()("session.publish.copy_link"),()=>m()("session.publish.remove_public")]),d(l,v)};p(W,l=>{r.campaign?.isPublished?l(Te,!1):l(G)})}e(q),e(Qe);var ce=s(Qe,2),_e=t(ce),X=t(_e);X.__click=()=>C(I,"enemies");var $e=t(X);Ca($e,{size:14});var xe=s($e);e(X);var We=s(X,2);We.__click=()=>C(I,"encounters");var vt=t(We);es(vt,{size:14});var ct=s(vt);e(We),e(_e);var ut=s(_e,2),Lt=t(ut);{var Dt=l=>{var v=xi(),u=qe(v);Xe(u,17,()=>a(ue),f=>f.id,(f,w)=>{var h=_i(),ie=t(h),H=t(ie);pr(H,{size:12,class:"text-slate-600 cursor-grab"});var te=s(H,2),ee=t(te),fe=t(ee),ne=s(fe);{var Fe=gt=>{_a(gt,{size:10,class:"text-indigo-400"})};p(ne,gt=>{a(w).global&&gt(Fe)})}e(ee);var ae=s(ee,2),He=t(ae);e(ae),e(te),e(ie);var Ue=s(ie,2);Ue.__click=()=>it(a(w));var wt=t(Ue);ra(wt,{size:16}),e(Ue),e(h),_(gt=>{i(fe,`${a(w).name??""} `),i(He,`${gt??""} ${a(w).difficulty??""}`)},[()=>m()("session.enemies.difficulty")]),ja("dragstart",h,gt=>F(gt,a(w),"enemy")),d(f,h)});var g=s(u,2);{var B=f=>{var w=mi(),h=t(w,!0);e(w),_(ie=>i(h,ie),[()=>m()("session.enemies.none")]),d(f,w)};p(g,f=>{a(ue).length===0&&f(B)})}d(l,v)},Vt=l=>{var v=gi(),u=qe(v);Xe(u,17,()=>a(Ee),f=>f.id,(f,w)=>{var h=fi(),ie=t(h),H=t(ie),te=t(H),ee=s(te);{var fe=Ue=>{_a(Ue,{size:10,class:"text-indigo-400"})};p(ee,Ue=>{a(w).global&&Ue(fe)})}e(H);var ne=s(H,2),Fe=t(ne);e(ne),e(ie);var ae=s(ie,2);ae.__click=()=>St(a(w));var He=t(ae);Ka(He,{size:14}),e(ae),e(h),_((Ue,wt)=>{i(te,`${a(w).name??""} `),i(Fe,`${Ue??""} ${wt??""}`)},[()=>a(w).enemies?.reduce((Ue,wt)=>Ue+wt.count,0)||0,()=>m()("session.enemies.title")]),ja("dragstart",h,Ue=>F(Ue,a(w),"encounter")),d(f,h)});var g=s(u,2);{var B=f=>{var w=pi(),h=t(w,!0);e(w),_(ie=>i(h,ie),[()=>m()("session.enemies.no_encounters")]),d(f,w)};p(g,f=>{a(Ee).length===0&&f(B)})}d(l,v)};p(Lt,l=>{a(I)==="enemies"?l(Dt):l(Vt,!1)})}e(ut),e(ce),e(Re);var Tt=s(Re,2),x=t(Tt),b=t(x),j=t(b);{var k=l=>{var v=hi();v.__click=ht;var u=t(v);zs(u,{size:20});var g=s(u);e(v),_(B=>i(g,` ${B??""}`),[()=>m()("session.combat.start")]),d(l,v)},ke=l=>{var v=yi(),u=t(v);u.__click=Se;var g=t(u);Ha(g,{size:20}),e(u);var B=s(u,2),f=t(B),w=t(f,!0);e(f);var h=s(f),ie=t(h,!0);e(h),e(B);var H=s(B,2);H.__click=ft;var te=t(H);Vs(te,{size:16});var ee=s(te);e(H);var fe=s(H,4);fe.__click=()=>yt();var ne=t(fe,!0);e(fe),e(v),_((Fe,ae,He,Ue,wt)=>{de(u,"title",Fe),i(w,ae),i(ie,a(kt).round),de(H,"title",He),i(ee,` ${Ue??""}`),i(ne,wt)},[()=>m()("session.combat.previous"),()=>m()("session.combat.round"),()=>m()("session.combat.next"),()=>m()("session.combat.next"),()=>m()("session.combat.end")]),d(l,v)};p(j,l=>{a(kt).active?l(ke,!1):l(k)})}e(b),e(x);var Ge=s(x,2);{var rt=l=>{var v=wi(),u=t(v);{var g=f=>{ds(f,{get tier(){return a(je)},get totalDifficulty(){return a(ye)}})},B=f=>{vs(f,{get tier(){return a(je)},get totalDifficulty(){return a(ye)},get playerCount(){return a(Me)}})};p(u,f=>{r.campaign?.system==="sofdl"?f(g):f(B,!1)})}e(v),d(l,v)};p(Ge,l=>{a(re).length>0&&l(rt)})}var at=s(Ge,2),Ct=t(at);Xe(Ct,25,()=>a(Ke),l=>l.type==="player"?l.id:l.instanceId,(l,v)=>{var u=ki(),g=t(u);Vr(g,{get entity(){return a(v)},get campaignId(){return r.campaign.id},updateEnemy:nt,removeFromCombat:Ve,updatePlayer:et}),e(u),qs(u,()=>Qr,()=>({duration:300})),d(l,u)});var jt=s(Ct,2);{var Ft=l=>{var v=zi(),u=t(v,!0);e(v),_(g=>i(u,g),[()=>m()("session.combat.empty")]),d(l,v)};p(jt,l=>{a(Ke).length===0&&l(Ft)})}e(at),e(Tt);var Rt=s(Tt,2),Bt=t(Rt);{var Jt=l=>{var v=It(),u=qe(v);{var g=f=>{ds(f,{get tier(){return a(je)},get totalDifficulty(){return a(ye)}})},B=f=>{vs(f,{get tier(){return a(je)},get totalDifficulty(){return a(ye)},get playerCount(){return a(Me)}})};p(u,f=>{r.campaign?.system==="sofdl"?f(g):f(B,!1)})}d(l,v)};p(Bt,l=>{a(re).length>0&&l(Jt)})}e(Rt),e(Oe);var Xt=s(Oe,2);{var ta=l=>{var v=Mi();v.__click=Ue=>{Ue.target===Ue.currentTarget&&C(D,!1)};var u=t(v),g=t(u),B=t(g),f=t(B);Ks(f,{size:24}),e(B);var w=s(B,2),h=t(w),ie=t(h,!0);e(h);var H=s(h,2),te=t(H,!0);e(H),e(w),e(g);var ee=s(g,2);Xe(ee,21,()=>a(M),Ot,(Ue,wt)=>{var gt=ji(),Ye=t(gt),ot=t(Ye);Ca(ot,{size:14,class:"text-slate-500"});var Et=s(ot);e(Ye);var qt=s(Ye,2);Xe(qt,21,()=>a(wt).effects,Ot,(Nt,At)=>{var Ht=Ci(),Yt=t(Ht),Kt=t(Yt);e(Yt);var va=s(Yt,2),wa=t(va,!0);e(va),e(Ht),_(()=>{i(Kt,`${a(At).name??""}:`),i(wa,a(At).desc)}),d(Nt,Ht)}),e(qt),e(gt),_(()=>i(Et,` ${a(wt).name??""}`)),d(Ue,gt)}),e(ee);var fe=s(ee,2),ne=t(fe);ne.__click=()=>C(D,!1);var Fe=t(ne,!0);e(ne);var ae=s(ne,2);ae.__click=Pt;var He=t(ae,!0);e(ae),e(fe),e(u),e(v),_((Ue,wt,gt,Ye)=>{i(ie,Ue),i(te,wt),i(Fe,gt),i(He,Ye)},[()=>m()("session.end_of_round.title"),()=>m()("session.end_of_round.summary"),()=>m()("common.buttons.cancel"),()=>m()("session.end_of_round.advance")]),d(l,v)};p(Xt,l=>{a(D)&&l(ta)})}var Gt=s(Xt,2);{var Wt=l=>{var v=Si();v.__click=ae=>{ae.target===ae.currentTarget&&C(S,!1)};var u=t(v),g=t(u),B=t(g),f=t(B),w=t(f,!0);e(f);var h=s(f,2),ie=t(h,!0);e(h),e(B);var H=s(B,2);H.__click=()=>C(S,!1);var te=t(H);ya(te,{size:16}),e(H),e(g);var ee=s(g,2),fe=t(ee);Xe(fe,17,()=>a(oe),Ot,(ae,He)=>{var Ue=Oi();Ue.__click=()=>mt(a(He).id);var wt=t(Ue),gt=t(wt,!0);e(wt);var Ye=s(wt,2),ot=t(Ye),Et=t(ot,!0);e(ot);var qt=s(ot,2),Nt=t(qt);e(qt),e(Ye);var At=s(Ye,2),Ht=t(At);ra(Ht,{size:16}),e(At),e(Ue),_((Yt,Kt)=>{i(gt,Yt),i(Et,a(He).name),i(Nt,`${Kt??""} ${a(He).level??""} • ${a(He).ancestry??""}`)},[()=>a(He).name.charAt(0),()=>m()("common.labels.level")]),d(ae,Ue)});var ne=s(fe,2);{var Fe=ae=>{var He=Ei(),Ue=t(He),wt=t(Ue);Ca(wt,{size:24}),e(Ue);var gt=s(Ue,2),Ye=t(gt,!0);e(gt);var ot=s(gt,2),Et=t(ot,!0);e(ot),e(He),_((qt,Nt)=>{i(Ye,qt),i(Et,Nt)},[()=>m()("session.manage_session.no_available"),()=>m()("session.manage_session.all_in_session")]),d(ae,He)};p(ne,ae=>{a(oe).length===0&&ae(Fe)})}e(ee),e(u),e(v),_((ae,He)=>{i(w,ae),i(ie,He)},[()=>m()("session.manage_session.title"),()=>m()("session.manage_session.description")]),d(l,v)};p(Gt,l=>{a(S)&&l(Wt)})}var Qt=s(Gt,2);{var ca=l=>{var v=$i();v.__click=Ye=>{Ye.target===Ye.currentTarget&&C($,!1)};var u=t(v),g=t(u),B=t(g),f=t(B);Ca(f,{size:16});var w=s(f);e(B);var h=s(B,2);h.__click=()=>C($,!1);var ie=t(h);ya(ie,{size:18}),e(h),e(g);var H=s(g,2),te=t(H);te.__click=()=>C(I,"enemies");var ee=t(te);Ca(ee,{size:14});var fe=s(ee);e(te);var ne=s(te,2);ne.__click=()=>C(I,"encounters");var Fe=t(ne);es(Fe,{size:14});var ae=s(Fe);e(ne),e(H);var He=s(H,2),Ue=t(He);{var wt=Ye=>{var ot=Ri(),Et=qe(ot);Xe(Et,17,()=>a(ue),At=>At.id,(At,Ht)=>{var Yt=Ii(),Kt=t(Yt),va=t(Kt),wa=t(va),qa=s(wa);{var Ba=na=>{_a(na,{size:10,class:"text-indigo-400"})};p(qa,na=>{a(Ht).global&&na(Ba)})}e(va);var Sa=s(va,2),Wa=t(Sa);e(Sa),e(Kt);var ka=s(Kt,2);ka.__click=()=>{it(a(Ht)),C($,!1)};var Ga=t(ka);ra(Ga,{size:16}),e(ka),e(Yt),_(na=>{i(wa,`${a(Ht).name??""} `),i(Wa,`${na??""} ${a(Ht).difficulty??""}`)},[()=>m()("session.enemies.difficulty")]),d(At,Yt)});var qt=s(Et,2);{var Nt=At=>{var Ht=Di(),Yt=t(Ht,!0);e(Ht),_(Kt=>i(Yt,Kt),[()=>m()("session.enemies.none")]),d(At,Ht)};p(qt,At=>{a(ue).length===0&&At(Nt)})}d(Ye,ot)},gt=Ye=>{var ot=Ti(),Et=qe(ot);Xe(Et,17,()=>a(Ee),At=>At.id,(At,Ht)=>{var Yt=Ni(),Kt=t(Yt),va=t(Kt),wa=t(va),qa=s(wa);{var Ba=na=>{_a(na,{size:10,class:"text-indigo-400"})};p(qa,na=>{a(Ht).global&&na(Ba)})}e(va);var Sa=s(va,2),Wa=t(Sa);e(Sa),e(Kt);var ka=s(Kt,2);ka.__click=()=>{St(a(Ht)),C($,!1)};var Ga=t(ka);Ka(Ga,{size:16}),e(ka),e(Yt),_((na,Ja)=>{i(wa,`${a(Ht).name??""} `),i(Wa,`${na??""} ${Ja??""}`)},[()=>a(Ht).enemies?.reduce((na,Ja)=>na+Ja.count,0)||0,()=>m()("session.enemies.title")]),d(At,Yt)});var qt=s(Et,2);{var Nt=At=>{var Ht=Ai(),Yt=t(Ht,!0);e(Ht),_(Kt=>i(Yt,Kt),[()=>m()("session.enemies.no_encounters")]),d(At,Ht)};p(qt,At=>{a(Ee).length===0&&At(Nt)})}d(Ye,ot)};p(Ue,Ye=>{a(I)==="enemies"?Ye(wt):Ye(gt,!1)})}e(He),e(u),e(v),_((Ye,ot,Et)=>{i(w,` ${Ye??""}`),Ze(te,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(I)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(fe,` ${ot??""}`),Ze(ne,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(I)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(ae,` ${Et??""}`)},[()=>m()("session.enemies.title"),()=>m()("session.enemies.title"),()=>m()("session.enemies.encounters")]),d(l,v)};p(Qt,l=>{a($)&&l(ca)})}var Zt=s(Qt,2);Zt.__click=()=>C($,!0);var pt=t(Zt);Ca(pt,{size:24}),e(Zt);var $t=s(Zt,2);fs($t,{get isOpen(){return N()},onClose:()=>Ma.set(!1)});var ia=s($t,2);Cs(ia,{get isOpen(){return a(V).isOpen},get title(){return a(V).title},get message(){return a(V).message},get onConfirm(){return a(V).onConfirm},onCancel:()=>a(V).isOpen=!1}),_((l,v,u,g)=>{i(Q,` ${l??""} `),i(tt,v),Ze(X,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(I)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(xe,` ${u??""}`),Ze(We,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(I)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(ct,` ${g??""}`)},[()=>m()("session.players.title"),()=>a(S)?m()("session.players.close"):m()("session.players.add"),()=>m()("session.enemies.title"),()=>m()("session.enemies.encounters")]),ja("dragover",Tt,le),ja("drop",Tt,Ie),d(Y,Z),la(),o()}ba(["click"]);var Li=c('<span class="text-[10px] text-indigo-300 uppercase font-bold mb-2 block"> </span>'),Fi=c('<div><!> <div class="flex items-center justify-between bg-black/40 rounded-xl p-1.5 border border-white/5"><button type="button" class="w-10 h-10 flex items-center justify-center bg-slate-800 hover:bg-slate-700 text-slate-300 rounded-lg transition-all active:scale-90 disabled:opacity-50 disabled:cursor-not-allowed"><!></button> <div class="flex flex-col items-center min-w-[3rem]"><span class="text-2xl font-black text-white leading-none tracking-tighter"> </span></div> <button type="button" class="w-10 h-10 flex items-center justify-center bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-all active:scale-90 shadow-lg shadow-indigo-500/20 disabled:opacity-50 disabled:cursor-not-allowed"><!></button></div></div>');function Es(Y,r){oa(r,!0);const n=()=>Ut(aa,"$t",K),[K,R]=da();function m(){const U=r.steps.indexOf(r.value);if(U>0)r.onUpdate(r.steps[U-1]);else if(U===-1){const De=[...r.steps].reverse().find(ze=>ze<r.value);De!==void 0?r.onUpdate(De):r.onUpdate(r.steps[0])}}function N(){const U=r.steps.indexOf(r.value);if(U!==-1&&U<r.steps.length-1)r.onUpdate(r.steps[U+1]);else if(U===-1){const De=r.steps.find(ze=>ze>r.value);De!==void 0?r.onUpdate(De):r.onUpdate(r.steps[r.steps.length-1])}}var A=Fi(),o=t(A);{var S=U=>{var De=Li(),ze=t(De,!0);e(De),_(()=>i(ze,r.label)),d(U,De)};p(o,U=>{r.label&&U(S)})}var $=s(o,2),se=t($);se.__click=m;var Ne=t(se);xs(Ne,{size:18}),e(se);var pe=s(se,2),I=t(pe),D=t(I,!0);e(I),e(pe);var M=s(pe,2);M.__click=N;var V=t(M);ra(V,{size:18}),e(M),e($),e(A),_((U,De)=>{de(se,"aria-label",U),se.disabled=r.value<=r.steps[0],i(D,r.value),de(M,"aria-label",De),M.disabled=r.value>=r.steps[r.steps.length-1]},[()=>n()("common.buttons.decrease"),()=>n()("common.buttons.increase")]),d(Y,A),la(),R()}ba(["click"]);var Hi=c('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),qi=c('<div class="text-xs text-slate-500 italic mt-2 leading-relaxed opacity-75"> </div>'),Bi=c('<span class="text-slate-400"> </span>'),Wi=c('<span class="text-slate-400"> </span>'),Gi=c('<div class="text-sm mb-4"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span></div>'),Ji=c('<div class="mb-3 text-sm"><span class="font-bold text-indigo-400"> </span> <span class="text-slate-300 ml-1"> </span></div>'),Vi=c('<span class="text-slate-300"> </span>'),Qi=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span> <span class="text-white ml-1"> </span> <!></div>'),Yi=c('<div class="mt-4"><h4 class="text-red-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Zi=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),Xi=c('<div class="mt-4"><h4 class="text-orange-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Ki=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),en=c('<div class="mt-4"><h4 class="text-yellow-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),tn=c('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl"><div class="flex items-start gap-3 mb-4"><!> <div class="flex-1 min-w-0"><div class="flex items-baseline gap-2"><h2 class="text-xl font-bold text-white font-serif tracking-wide"> </h2> <span class="text-red-500 font-bold text-sm"> </span></div> <div class="text-sm text-slate-400 mt-1"> </div> <!></div></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <span class="text-slate-500 font-bold ml-3"> </span> <span class="text-white ml-1"> </span></div> <div class="text-sm mb-3"><span class="text-white"><span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> </span></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <!> <div class="border-t border-slate-700 my-4"></div> <!> <!> <!> <!></div>'),an=c('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc-text" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc-text" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-desc" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div class="flex items-center gap-2 mt-4"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),sn=c('<div class="bg-slate-900 p-3 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),rn=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div class="flex flex-col"><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-perception" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-perception" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-speed-notes" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed-notes" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-senses" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[80px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div></div></div>'),nn=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),on=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-2"><div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <select class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm"><option> </option><option> </option></select></div> <div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/> <input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/></div> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),ln=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),dn=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),vn=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="p-4 bg-slate-900 rounded border border-indigo-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-indigo-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-red-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-red-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-orange-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-orange-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-yellow-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-yellow-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div></div>'),cn=c('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),un=c('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" aria-label="Close" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-start justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function bn(Y,r){oa(r,!0);const n=()=>Ut(aa,"$t",K),[K,R]=da(),m=P=>{var oe=tn(),ue=t(oe),Ee=t(ue);{var we=b=>{var j=Hi(),k=t(j);Da(k,{get hash(){return a(o).imageUrl},get alt(){return a(o).name},size:"custom"}),e(j),d(b,j)};p(Ee,b=>{a(o).imageUrl&&b(we)})}var mt=s(Ee,2),lt=t(mt),dt=t(lt),xt=t(dt,!0);e(dt);var it=s(dt,2),St=t(it);e(it),e(lt);var ht=s(lt,2),ft=t(ht);e(ht);var Pt=s(ht,2);{var yt=b=>{var j=qi(),k=t(j,!0);e(j),_(()=>i(k,a(o).description)),d(b,j)};p(Pt,b=>{a(o).description&&b(yt)})}e(mt),e(ue);var Ve=s(ue,2),nt=t(Ve),Se=t(nt,!0);e(nt);var Pe=s(nt,2),Ke=t(Pe);e(Pe);var Le=s(Pe,2);{var et=b=>{var j=Bi(),k=t(j);e(j),_(()=>i(k,`; ${a(o).senses??""}`)),d(b,j)};p(Le,b=>{a(o).senses&&b(et)})}e(Ve);var F=s(Ve,2),le=t(F),Ie=t(le,!0);e(le);var Z=s(le,2),Oe=t(Z,!0);e(Z);var Re=s(Z,2),Qe=t(Re,!0);e(Re);var y=s(Re,2),z=t(y,!0);e(y),e(F);var O=s(F,2),Q=t(O),ge=t(Q),be=t(ge,!0);e(ge);var Ae=s(ge),tt=s(Ae),st=t(tt,!0);e(tt);var zt=s(tt),Be=s(zt),T=t(Be,!0);e(Be);var L=s(Be),E=s(L),ve=t(E,!0);e(E);var q=s(E);e(Q),e(O);var W=s(O,2),G=t(W),Te=t(G,!0);e(G);var ce=s(G,2),_e=t(ce,!0);e(ce);var X=s(ce,2);{var $e=b=>{var j=Wi(),k=t(j);e(j),_(()=>i(k,`; ${a(o).speedNotes??""}`)),d(b,j)};p(X,b=>{a(o).speedNotes&&b($e)})}e(W);var xe=s(W,2);{var We=b=>{var j=Gi(),k=t(j),ke=t(k,!0);e(k);var Ge=s(k,2),rt=t(Ge,!0);e(Ge),e(j),_(at=>{i(ke,at),i(rt,a(o).immunities)},[()=>n()("session.enemy_modal.immunities")]),d(b,j)};p(xe,b=>{a(o).immunities&&b(We)})}var vt=s(xe,4);{var ct=b=>{var j=It(),k=qe(j);Xe(k,17,()=>a(o).traits,Ot,(ke,Ge)=>{var rt=Ji(),at=t(rt),Ct=t(at,!0);e(at);var jt=s(at,2),Ft=t(jt,!0);e(jt),e(rt),_(()=>{i(Ct,a(Ge).name),i(Ft,a(Ge).desc)}),d(ke,rt)}),d(b,j)};p(vt,b=>{a(o).traits.length>0&&b(ct)})}var ut=s(vt,2);{var Lt=b=>{var j=Yi(),k=t(j),ke=t(k,!0);e(k);var Ge=s(k,2);Xe(Ge,17,()=>a(o).attackOptions,Ot,(rt,at)=>{var Ct=Qi(),jt=t(Ct),Ft=t(jt,!0);e(jt);var Rt=s(jt,2),Bt=t(Rt);e(Rt);var Jt=s(Rt,2),Xt=t(Jt);e(Jt);var ta=s(Jt,2);{var Gt=Wt=>{var Qt=Vi(),ca=t(Qt);e(Qt),_(()=>i(ca,`; ${a(at).desc??""}`)),d(Wt,Qt)};p(ta,Wt=>{a(at).desc&&Wt(Gt)})}e(Ct),_(Wt=>{i(Ft,a(at).name),i(Bt,`(${Wt??""})`),i(Xt,`${a(at).attackRoll??""} (${a(at).damage??""})`)},[()=>a(at).type==="melee"?n()("session.enemy_modal.melee").toLowerCase():n()("session.enemy_modal.ranged").toLowerCase()]),d(rt,Ct)}),e(j),_(rt=>i(ke,rt),[()=>n()("session.enemy_modal.attack_options")]),d(b,j)};p(ut,b=>{a(o).attackOptions.length>0&&b(Lt)})}var Dt=s(ut,2);{var Vt=b=>{var j=Xi(),k=t(j),ke=t(k,!0);e(k);var Ge=s(k,2);Xe(Ge,17,()=>a(o).specialAttacks,Ot,(rt,at)=>{var Ct=Zi(),jt=t(Ct),Ft=t(jt,!0);e(jt);var Rt=s(jt,2),Bt=t(Rt,!0);e(Rt),e(Ct),_(()=>{i(Ft,a(at).name),i(Bt,a(at).desc)}),d(rt,Ct)}),e(j),_(rt=>i(ke,rt),[()=>n()("session.enemy_modal.special_attacks")]),d(b,j)};p(Dt,b=>{a(o).specialAttacks.length>0&&b(Vt)})}var Tt=s(Dt,2);{var x=b=>{var j=en(),k=t(j),ke=t(k,!0);e(k);var Ge=s(k,2);Xe(Ge,17,()=>a(o).endOfRound,Ot,(rt,at)=>{var Ct=Ki(),jt=t(Ct),Ft=t(jt,!0);e(jt);var Rt=s(jt,2),Bt=t(Rt,!0);e(Rt),e(Ct),_(()=>{i(Ft,a(at).name),i(Bt,a(at).desc)}),d(rt,Ct)}),e(j),_(rt=>i(ke,rt),[()=>n()("session.enemy_modal.end_of_round")]),d(b,j)};p(Tt,b=>{a(o).endOfRound.length>0&&b(x)})}e(oe),_((b,j,k,ke,Ge,rt,at,Ct,jt,Ft,Rt,Bt,Jt,Xt,ta,Gt,Wt)=>{i(xt,b),i(St,`${j??""} ${a(o).difficulty??""}`),i(ft,`${k??""} ${ke??""} ${a(o).descriptors??""}`),i(Se,Ge),i(Ke,`${a(o).perception??""} (${rt??""})`),i(Ie,at),i(Oe,a(o).defense),i(Qe,Ct),i(z,a(o).health),i(be,jt),i(Ae,` ${a(o).attributes.strength??""} (${Ft??""}), `),i(st,Rt),i(zt,` ${a(o).attributes.agility??""} (${Bt??""}), `),i(T,Jt),i(L,` ${a(o).attributes.intellect??""} (${Xt??""}), `),i(ve,ta),i(q,` ${a(o).attributes.will??""} (${Gt??""})`),i(Te,Wt),i(_e,a(o).speed)},[()=>a(o).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemies.difficulty").toUpperCase(),()=>n()("session.enemy_modal.size"),()=>V(a(o).size),()=>n()("sofdl.attributes.perception"),()=>M(a(o).perception),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("sofdl.attributes.strength"),()=>M(a(o).attributes.strength),()=>n()("sofdl.attributes.agility"),()=>M(a(o).attributes.agility),()=>n()("sofdl.attributes.intellect"),()=>M(a(o).attributes.intellect),()=>n()("sofdl.attributes.will"),()=>M(a(o).attributes.will),()=>n()("session.enemy_modal.speed")]),d(P,oe)};let N=sa(r,"isOpen",3,!1),A=sa(r,"initialData",3,"{}"),o=_t(ma(D())),S=_t("general"),$=_t(!1),se=_t(""),Ne=_t(void 0);function pe(P){const oe=P.target.files;if(oe&&oe.length>0){const ue=oe[0],Ee=new FileReader;Ee.onload=()=>{C(se,Ee.result,!0),C($,!0)},Ee.readAsDataURL(ue)}P.target&&(P.target.value="")}async function I(P){try{const oe=await ys(P);a(o).imageUrl=oe,C($,!1)}catch(oe){console.error(oe),alert(oe.message||"Erro ao salvar imagem")}}function D(){return{name:"",difficulty:1,size:1,description:"",descriptors:"",perception:10,senses:"",defense:10,health:10,attributes:{strength:10,agility:10,intellect:10,will:10},speed:10,speedNotes:"",immunities:"",traits:[],attackOptions:[],specialAttacks:[],endOfRound:[],imageUrl:"",global:!1}}function M(P){const oe=P-10;return oe>=0?`+${oe}`:`${oe}`}function V(P){return P===.125?"1/8":P===.5?"1/2":P}La(()=>{if(N()&&A())try{const P=JSON.parse(A());Object.keys(P).length===0?C(o,D(),!0):C(o,{...D(),...P},!0)}catch{C(o,D(),!0)}});function U(){a(o).traits=[...a(o).traits,{name:"",desc:""}]}function De(P){a(o).traits=a(o).traits.filter((oe,ue)=>ue!==P)}function ze(){a(o).attackOptions=[...a(o).attackOptions,{name:"",type:"melee",attackRoll:"+0",damage:"1d6",desc:""}]}function kt(P){a(o).attackOptions=a(o).attackOptions.filter((oe,ue)=>ue!==P)}function re(){a(o).specialAttacks=[...a(o).specialAttacks,{name:"",desc:""}]}function Ce(P){a(o).specialAttacks=a(o).specialAttacks.filter((oe,ue)=>ue!==P)}function me(){a(o).endOfRound=[...a(o).endOfRound,{name:"",desc:""}]}function je(P){a(o).endOfRound=a(o).endOfRound.filter((oe,ue)=>ue!==P)}function ye(P){}var Me=It(),Je=qe(Me);{var he=P=>{var oe=un(),ue=qe(oe);ue.__click=ye;var Ee=t(ue),we=t(Ee),mt=t(we),lt=t(mt),dt=t(lt);dt.__click=function(...Be){r.onClose?.apply(this,Be)};var xt=t(dt);Ha(xt,{size:24}),e(dt);var it=s(dt,2),St=t(it,!0);e(it),e(lt);var ht=s(lt,2);ht.__click=function(...Be){r.onClose?.apply(this,Be)};var ft=t(ht);ya(ft,{size:20}),e(ht),e(mt);var Pt=s(mt,2),yt=t(Pt);yt.__click=()=>C(S,"general");var Ve=t(yt,!0);e(yt);var nt=s(yt,2);nt.__click=()=>C(S,"stats");var Se=t(nt,!0);e(nt);var Pe=s(nt,2);Pe.__click=()=>C(S,"abilities");var Ke=t(Pe,!0);e(Pe);var Le=s(Pe,2);Le.__click=()=>C(S,"preview");var et=t(Le,!0);e(Le),e(Pt);var F=s(Pt,2),le=t(F);{var Ie=Be=>{var T=an(),L=t(T),E=t(L);E.__click=()=>a(Ne)?.click();var ve=t(E),q=t(ve);as(q,()=>a(o).imageUrl,k=>{Da(k,{get hash(){return a(o).imageUrl},get alt(){return a(o).name},size:"custom",fallbackText:"?"})}),e(ve);var W=s(ve,2),G=t(W);gs(G,{size:20,class:"text-white"}),e(W),e(E);var Te=s(E,2),ce=t(Te),_e=t(ce,!0);e(ce);var X=s(ce,2);Mt(X),e(Te),e(L);var $e=s(L,2),xe=t($e),We=t(xe,!0);e(xe);var vt=s(xe,2);ha(vt),e($e);var ct=s($e,2),ut=t(ct),Lt=t(ut,!0);e(ut);var Dt=s(ut,2);Mt(Dt),e(ct);var Vt=s(ct,2),Tt=t(Vt);Mt(Tt);var x=s(Tt,2),b=t(x);_a(b,{size:14});var j=s(b);e(x),e(Vt),e(T),_((k,ke,Ge,rt,at,Ct)=>{i(_e,k),i(We,ke),de(vt,"placeholder",Ge),i(Lt,rt),de(Dt,"placeholder",at),i(j,` ${Ct??""}`)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.descriptors"),()=>n()("session.enemy_modal.descriptors_placeholder"),()=>n()("session.enemy_modal.global_enemy")]),bt(X,()=>a(o).name,k=>a(o).name=k),bt(vt,()=>a(o).description,k=>a(o).description=k),bt(Dt,()=>a(o).descriptors,k=>a(o).descriptors=k),cs(Tt,()=>a(o).global,k=>a(o).global=k),d(Be,T)},Z=Be=>{var T=It(),L=qe(T);{var E=q=>{var W=rn(),G=t(W),Te=t(G),ce=t(Te),_e=t(ce,!0);e(ce);var X=s(ce,2);{let f=J(()=>a(o).difficulty??0);Es(X,{get value(){return a(f)},onUpdate:w=>a(o).difficulty=w,steps:[0,1,5,10,25,50,100,250,500,750,1e3]})}e(Te);var $e=s(Te,2),xe=t($e),We=t(xe,!0);e(xe);var vt=s(xe,2);{let f=J(()=>a(o).size||1);hs(vt,{get value(){return a(f)},onUpdate:w=>a(o).size=w})}e($e),e(G);var ct=s(G,2),ut=t(ct),Lt=t(ut),Dt=t(Lt,!0);e(Lt);var Vt=s(Lt,2);Mt(Vt),e(ut);var Tt=s(ut,2),x=t(Tt),b=t(x,!0);e(x);var j=s(x,2);Mt(j),e(Tt),e(ct);var k=s(ct,2),ke=t(k),Ge=t(ke),rt=t(Ge,!0);e(Ge);var at=s(Ge,2);Mt(at),e(ke);var Ct=s(ke,2),jt=t(Ct),Ft=t(jt,!0);e(jt);var Rt=s(jt,2);Mt(Rt),e(Ct),e(k);var Bt=s(k,2),Jt=t(Bt),Xt=t(Jt,!0);e(Jt);var ta=s(Jt,2);Xe(ta,5,()=>[{key:"strength",label:n()("sofdl.attributes.strength")},{key:"agility",label:n()("sofdl.attributes.agility")},{key:"intellect",label:n()("sofdl.attributes.intellect")},{key:"will",label:n()("sofdl.attributes.will")}],Ot,(f,w)=>{var h=sn(),ie=t(h),H=t(ie,!0);e(ie);var te=s(ie,2);Mt(te);var ee=s(te,2),fe=t(ee,!0);e(ee),e(h),_((ne,Fe)=>{de(ie,"for",`attr-${a(w).key??""}`),de(ie,"title",a(w).label),i(H,ne),de(te,"id",`attr-${a(w).key??""}`),Ze(ee,1,`text-xs font-bold ${a(o).attributes[a(w).key]-10>=0?"text-green-500":"text-red-500"}`),i(fe,Fe)},[()=>a(w).label.substring(0,3),()=>M(a(o).attributes[a(w).key])]),bt(te,()=>a(o).attributes[a(w).key],ne=>a(o).attributes[a(w).key]=ne),d(f,h)}),e(ta),e(Bt);var Gt=s(Bt,2),Wt=t(Gt),Qt=t(Wt),ca=t(Qt,!0);e(Qt);var Zt=s(Qt,2);Mt(Zt),e(Wt);var pt=s(Wt,2),$t=t(pt),ia=t($t,!0);e($t);var l=s($t,2);Mt(l),e(pt);var v=s(pt,2),u=t(v),g=t(u,!0);e(u);var B=s(u,2);ha(B),e(v),e(Gt),e(W),_((f,w,h,ie,H,te,ee,fe,ne,Fe,ae,He,Ue)=>{i(_e,f),i(We,w),i(Dt,h),i(b,ie),i(rt,H),i(Ft,te),i(Xt,ee),i(ca,fe),de(Zt,"placeholder",ne),i(ia,Fe),de(l,"placeholder",ae),i(g,He),de(B,"placeholder",Ue)},[()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.defense"),()=>n()("sofdl.attributes.perception"),()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.speed_notes"),()=>n()("session.enemy_modal.speed_notes_placeholder"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder_sotdl"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder_sotdl")]),bt(Vt,()=>a(o).speed,f=>a(o).speed=f),bt(j,()=>a(o).health,f=>a(o).health=f),bt(at,()=>a(o).defense,f=>a(o).defense=f),bt(Rt,()=>a(o).perception,f=>a(o).perception=f),bt(Zt,()=>a(o).speedNotes,f=>a(o).speedNotes=f),bt(l,()=>a(o).senses,f=>a(o).senses=f),bt(B,()=>a(o).immunities,f=>a(o).immunities=f),d(q,W)},ve=q=>{var W=It(),G=qe(W);{var Te=_e=>{var X=vn(),$e=t(X),xe=t($e),We=t(xe),vt=t(We,!0);e(We),e(xe);var ct=s(xe,2),ut=t(ct);Xe(ut,17,()=>a(o).traits,Ot,(w,h,ie)=>{var H=nn(),te=t(H),ee=t(te);Mt(ee);var fe=s(ee,2);ha(fe),e(te);var ne=s(te,2);ne.__click=()=>De(ie);var Fe=t(ne);ua(Fe,{size:16}),e(ne),e(H),_((ae,He)=>{de(ee,"placeholder",ae),de(fe,"placeholder",He)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),bt(ee,()=>a(h).name,ae=>a(h).name=ae),bt(fe,()=>a(h).desc,ae=>a(h).desc=ae),d(w,H)});var Lt=s(ut,2);Lt.__click=U;var Dt=t(Lt),Vt=t(Dt);ra(Vt,{size:16}),e(Dt);var Tt=s(Dt);e(Lt),e(ct),e($e);var x=s($e,2),b=t(x),j=t(b),k=t(j,!0);e(j),e(b);var ke=s(b,2),Ge=t(ke);Xe(Ge,17,()=>a(o).attackOptions,Ot,(w,h,ie)=>{var H=on(),te=t(H),ee=t(te),fe=t(ee);Mt(fe);var ne=s(fe,2),Fe=t(ne),ae=t(Fe,!0);e(Fe),Fe.value=Fe.__value="melee";var He=s(Fe),Ue=t(He,!0);e(He),He.value=He.__value="ranged",e(ne),e(ee);var wt=s(ee,2),gt=t(wt);Mt(gt);var Ye=s(gt,2);Mt(Ye),e(wt);var ot=s(wt,2);ha(ot),e(te);var Et=s(te,2);Et.__click=()=>kt(ie);var qt=t(Et);ua(qt,{size:16}),e(Et),e(H),_((Nt,At,Ht,Yt,Kt,va)=>{de(fe,"placeholder",Nt),i(ae,At),i(Ue,Ht),de(gt,"placeholder",Yt),de(Ye,"placeholder",Kt),de(ot,"placeholder",va)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.melee"),()=>n()("session.enemy_modal.ranged"),()=>n()("session.enemy_modal.attack_placeholder"),()=>n()("session.enemy_modal.damage_placeholder"),()=>n()("session.enemy_modal.desc_effects_placeholder")]),bt(fe,()=>a(h).name,Nt=>a(h).name=Nt),Ds(ne,()=>a(h).type,Nt=>a(h).type=Nt),bt(gt,()=>a(h).attackRoll,Nt=>a(h).attackRoll=Nt),bt(Ye,()=>a(h).damage,Nt=>a(h).damage=Nt),bt(ot,()=>a(h).desc,Nt=>a(h).desc=Nt),d(w,H)});var rt=s(Ge,2);rt.__click=ze;var at=t(rt),Ct=t(at);ra(Ct,{size:16}),e(at);var jt=s(at);e(rt),e(ke),e(x);var Ft=s(x,2),Rt=t(Ft),Bt=t(Rt),Jt=t(Bt,!0);e(Bt),e(Rt);var Xt=s(Rt,2),ta=t(Xt);Xe(ta,17,()=>a(o).specialAttacks,Ot,(w,h,ie)=>{var H=ln(),te=t(H),ee=t(te);Mt(ee);var fe=s(ee,2);ha(fe),e(te);var ne=s(te,2);ne.__click=()=>Ce(ie);var Fe=t(ne);ua(Fe,{size:16}),e(ne),e(H),_((ae,He)=>{de(ee,"placeholder",ae),de(fe,"placeholder",He)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),bt(ee,()=>a(h).name,ae=>a(h).name=ae),bt(fe,()=>a(h).desc,ae=>a(h).desc=ae),d(w,H)});var Gt=s(ta,2);Gt.__click=re;var Wt=t(Gt),Qt=t(Wt);ra(Qt,{size:16}),e(Wt);var ca=s(Wt);e(Gt),e(Xt),e(Ft);var Zt=s(Ft,2),pt=t(Zt),$t=t(pt),ia=t($t,!0);e($t),e(pt);var l=s(pt,2),v=t(l);Xe(v,17,()=>a(o).endOfRound,Ot,(w,h,ie)=>{var H=dn(),te=t(H),ee=t(te);Mt(ee);var fe=s(ee,2);ha(fe),e(te);var ne=s(te,2);ne.__click=()=>je(ie);var Fe=t(ne);ua(Fe,{size:16}),e(ne),e(H),_((ae,He)=>{de(ee,"placeholder",ae),de(fe,"placeholder",He)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),bt(ee,()=>a(h).name,ae=>a(h).name=ae),bt(fe,()=>a(h).desc,ae=>a(h).desc=ae),d(w,H)});var u=s(v,2);u.__click=me;var g=t(u),B=t(g);ra(B,{size:16}),e(g);var f=s(g);e(u),e(l),e(Zt),e(X),_((w,h,ie,H,te,ee,fe,ne)=>{i(vt,w),i(Tt,` ${h??""}`),i(k,ie),i(jt,` ${H??""}`),i(Jt,te),i(ca,` ${ee??""}`),i(ia,fe),i(f,` ${ne??""}`)},[()=>n()("session.enemy_modal.traits"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.attack_options"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.special_attacks"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.end_of_round"),()=>n()("common.buttons.add")]),d(_e,X)},ce=_e=>{var X=It(),$e=qe(X);{var xe=We=>{var vt=cn(),ct=t(vt);m(ct),e(vt),d(We,vt)};p($e,We=>{a(S)==="preview"&&We(xe)},!0)}d(_e,X)};p(G,_e=>{a(S)==="abilities"?_e(Te):_e(ce,!1)},!0)}d(q,W)};p(L,q=>{a(S)==="stats"?q(E):q(ve,!1)},!0)}d(Be,T)};p(le,Be=>{a(S)==="general"?Be(Ie):Be(Z,!1)})}e(F);var Oe=s(F,2),Re=t(Oe);Re.__click=()=>r.onSave(a(o));var Qe=t(Re);ss(Qe,{size:18});var y=s(Qe);e(Re),e(Oe),e(we);var z=s(we,2),O=t(z),Q=t(O),ge=t(Q);Fa(ge,{size:14});var be=s(ge);e(Q),e(O);var Ae=s(O,2),tt=t(Ae);m(tt),e(Ae),e(z),e(Ee),e(ue);var st=s(ue,2);st.__change=pe,js(st,Be=>C(Ne,Be),()=>a(Ne));var zt=s(st,2);ps(zt,{get isOpen(){return a($)},get imageUrl(){return a(se)},onClose:()=>C($,!1),onCrop:I}),_((Be,T,L,E,ve,q,W)=>{i(St,Be),Ze(yt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Ve,T),Ze(nt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Se,L),Ze(Pe,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Ke,E),Ze(Le,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(et,ve),i(y,` ${q??""}`),i(be,` ${W??""}`)},[()=>n()("session.enemy_modal.title"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_stats"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("session.enemy_modal.preview"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview")]),$a(3,Ee,()=>Ua,()=>({y:20,duration:300})),$a(3,ue,()=>Ua,()=>({duration:200,opacity:1})),d(P,oe)};p(Je,P=>{N()&&P(he)})}d(Y,Me),la(),R()}ba(["click","change"]);var _n=c('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),mn=c('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),xn=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),fn=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),pn=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),gn=c('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),hn=c('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),yn=c('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),wn=c('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),kn=c('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),zn=c('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Cn=c('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),jn=c('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Mn=c('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div>'),On=c('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="flex items-center gap-2"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),En=c('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Sn=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div class="flex flex-col"><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div> <div class="flex flex-col"><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-damage" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-damage" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 text-center border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),In=c('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Dn=c('<div><div class="mb-3"><h4> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div>'),Rn=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"></div>'),Nn=c('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),An=c('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function Tn(Y,r){oa(r,!0);const n=()=>Ut(aa,"$t",K),[K,R]=da(),m=re=>{var Ce=Mn(),me=t(Ce),je=t(me);e(me);var ye=s(me,2),Me=t(ye);{var Je=T=>{var L=_n(),E=t(L);Da(E,{get hash(){return a(o).imageUrl},get alt(){return a(o).name},size:"custom"}),e(L),d(T,L)};p(Me,T=>{a(o).imageUrl&&T(Je)})}var he=s(Me,2),P=t(he),oe=t(P,!0);e(P),Ea(2),e(he),e(ye);var ue=s(ye,2),Ee=t(ue),we=t(Ee),mt=t(we,!0);e(we);var lt=s(we,2),dt=t(lt,!0);e(lt),e(Ee);var xt=s(Ee,2),it=t(xt),St=t(it,!0);e(it);var ht=s(it,2),ft=t(ht,!0);e(ht),e(xt);var Pt=s(xt,2),yt=t(Pt),Ve=t(yt,!0);e(yt);var nt=s(yt,2),Se=t(nt,!0);e(nt),e(Pt);var Pe=s(Pt,2),Ke=t(Pe),Le=t(Ke,!0);e(Ke);var et=s(Ke,2),F=t(et,!0);e(et),e(Pe),e(ue);var le=s(ue,2);Xe(le,20,()=>["str","agi","int","wil"],Ot,(T,L)=>{var E=mn(),ve=t(E),q=t(ve,!0);e(ve);var W=s(ve,2),G=t(W),Te=s(G),ce=t(Te);e(Te),e(W),e(E),_(()=>{i(q,L),i(G,`${a(o).stats[L]??""} `),Ze(Te,1,`text-xs ${a(o).stats[L]-10>=0?"text-green-500":"text-red-500"}`),i(ce,`(${a(o).stats[L]-10>=0?"+":""}${a(o).stats[L]-10})`)}),d(T,E)}),e(le);var Ie=s(le,2),Z=t(Ie);{var Oe=T=>{var L=xn(),E=t(L),ve=t(E);e(E);var q=s(E,2),W=t(q,!0);e(q),e(L),_(G=>{i(ve,`${G??""}:`),i(W,a(o).senses)},[()=>n()("session.enemy_modal.senses")]),d(T,L)};p(Z,T=>{a(o).senses&&T(Oe)})}var Re=s(Z,2);{var Qe=T=>{var L=fn(),E=t(L),ve=t(E);e(E);var q=s(E,2),W=t(q,!0);e(q),e(L),_(G=>{i(ve,`${G??""}:`),i(W,a(o).languages)},[()=>n()("session.enemy_modal.languages")]),d(T,L)};p(Re,T=>{a(o).languages&&T(Qe)})}var y=s(Re,2);{var z=T=>{var L=pn(),E=t(L),ve=t(E);e(E);var q=s(E,2),W=t(q,!0);e(q),e(L),_(G=>{i(ve,`${G??""}:`),i(W,a(o).immune)},[()=>n()("session.enemy_modal.immunities")]),d(T,L)};p(y,T=>{a(o).immune&&T(z)})}e(Ie);var O=s(Ie,2),Q=t(O);{var ge=T=>{var L=hn(),E=t(L),ve=t(E,!0);e(E);var q=s(E,2);Xe(q,17,()=>a(o).traits,Ot,(W,G,Te,ce)=>{var _e=gn(),X=t(_e),$e=t(X);e(X);var xe=s(X,2),We=t(xe,!0);e(xe),e(_e),_(()=>{i($e,`${a(G).name??""}:`),i(We,a(G).desc)}),d(W,_e)}),e(L),_(W=>i(ve,W),[()=>n()("session.enemy_modal.traits")]),d(T,L)};p(Q,T=>{a(o).traits.length>0&&T(ge)})}var be=s(Q,2);{var Ae=T=>{var L=wn(),E=t(L),ve=t(E,!0);e(E);var q=s(E,2);Xe(q,17,()=>a(o).actions,Ot,(W,G,Te,ce)=>{var _e=yn(),X=t(_e),$e=t(X);e(X);var xe=s(X,2),We=t(xe,!0);e(xe),e(_e),_(()=>{i($e,`${a(G).name??""}:`),i(We,a(G).desc)}),d(W,_e)}),e(L),_(W=>i(ve,W),[()=>n()("session.enemy_modal.actions")]),d(T,L)};p(be,T=>{a(o).actions.length>0&&T(Ae)})}var tt=s(be,2);{var st=T=>{var L=zn(),E=t(L),ve=t(E,!0);e(E);var q=s(E,2);Xe(q,17,()=>a(o).reactions,Ot,(W,G,Te,ce)=>{var _e=kn(),X=t(_e),$e=t(X);e(X);var xe=s(X,2),We=t(xe,!0);e(xe),e(_e),_(()=>{i($e,`${a(G).name??""}:`),i(We,a(G).desc)}),d(W,_e)}),e(L),_(W=>i(ve,W),[()=>n()("session.enemy_modal.reactions")]),d(T,L)};p(tt,T=>{a(o).reactions.length>0&&T(st)})}var zt=s(tt,2);{var Be=T=>{var L=jn(),E=t(L),ve=t(E,!0);e(E);var q=s(E,2);Xe(q,17,()=>a(o).endOfRound,Ot,(W,G,Te,ce)=>{var _e=Cn(),X=t(_e),$e=t(X);e(X);var xe=s(X,2),We=t(xe,!0);e(xe),e(_e),_(()=>{i($e,`${a(G).name??""}:`),i(We,a(G).desc)}),d(W,_e)}),e(L),_(W=>i(ve,W),[()=>n()("session.enemy_modal.end_of_round")]),d(T,L)};p(zt,T=>{a(o).endOfRound.length>0&&T(Be)})}e(O),e(Ce),_((T,L,E,ve,q,W)=>{i(je,`${T??""} ${a(o).difficulty??""}`),i(oe,L),i(mt,E),i(dt,a(o).defense),i(St,ve),i(ft,a(o).health),i(Ve,q),i(Se,a(o).size),i(Le,W),i(F,a(o).speed)},[()=>n()("session.enemy_modal.difficulty"),()=>a(o).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed")]),d(re,Ce)};let N=sa(r,"isOpen",3,!1),A=sa(r,"initialData",3,"{}"),o=_t(ma(D())),S=_t("general"),$=_t(!1),se=_t(""),Ne=_t(void 0);function pe(re){const Ce=re.target.files;if(Ce&&Ce.length>0){const me=Ce[0],je=new FileReader;je.onload=()=>{C(se,je.result,!0),C($,!0)},je.readAsDataURL(me)}re.target&&(re.target.value="")}async function I(re){try{const Ce=await ys(re);a(o).imageUrl=Ce,C($,!1)}catch(Ce){console.error(Ce),alert(Ce.message||"Erro ao salvar imagem")}}function D(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[],global:!1}}La(()=>{if(N()&&A())try{const re=JSON.parse(A());Object.keys(re).length===0?C(o,D(),!0):C(o,{...D(),...re},!0)}catch{C(o,D(),!0)}});function M(re){a(o)[re]=[...a(o)[re],{name:"",desc:""}]}function V(re,Ce){a(o)[re]=a(o)[re].filter((me,je)=>je!==Ce)}function U(re){}var De=It(),ze=qe(De);{var kt=re=>{var Ce=An(),me=qe(Ce);me.__click=U;var je=t(me),ye=t(je),Me=t(ye),Je=t(Me),he=t(Je);he.__click=function(...O){r.onClose?.apply(this,O)};var P=t(he);Ha(P,{size:24}),e(he);var oe=s(he,2),ue=t(oe,!0);e(oe),e(Je);var Ee=s(Je,2);Ee.__click=function(...O){r.onClose?.apply(this,O)};var we=t(Ee);ya(we,{size:20}),e(Ee),e(Me);var mt=s(Me,2),lt=t(mt);lt.__click=()=>C(S,"general");var dt=t(lt,!0);e(lt);var xt=s(lt,2);xt.__click=()=>C(S,"stats");var it=t(xt,!0);e(xt);var St=s(xt,2);St.__click=()=>C(S,"abilities");var ht=t(St,!0);e(St);var ft=s(St,2);ft.__click=()=>C(S,"preview");var Pt=t(ft,!0);e(ft),e(mt);var yt=s(mt,2),Ve=t(yt);{var nt=O=>{var Q=On(),ge=t(Q),be=t(ge);be.__click=()=>a(Ne)?.click();var Ae=t(be),tt=t(Ae);as(tt,()=>a(o).imageUrl,xe=>{Da(xe,{get hash(){return a(o).imageUrl},get alt(){return a(o).name},size:"custom",fallbackText:"?"})}),e(Ae);var st=s(Ae,2),zt=t(st);gs(zt,{size:20,class:"text-white"}),e(st),e(be);var Be=s(be,2),T=t(Be),L=t(T,!0);e(T);var E=s(T,2);Mt(E),e(Be),e(ge);var ve=s(ge,2),q=t(ve),W=t(q,!0);e(q);var G=s(q,2);ha(G),e(ve);var Te=s(ve,2),ce=t(Te);Mt(ce);var _e=s(ce,2),X=t(_e);_a(X,{size:14});var $e=s(X);e(_e),e(Te),e(Q),_((xe,We,vt,ct)=>{i(L,xe),i(W,We),de(G,"placeholder",vt),i($e,` ${ct??""}`)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.global_enemy")]),bt(E,()=>a(o).name,xe=>a(o).name=xe),bt(G,()=>a(o).description,xe=>a(o).description=xe),cs(ce,()=>a(o).global,xe=>a(o).global=xe),d(O,Q)},Se=O=>{var Q=It(),ge=qe(Q);{var be=tt=>{var st=Sn(),zt=t(st),Be=t(zt),T=t(Be),L=t(T,!0);e(T);var E=s(T,2);{let pt=J(()=>a(o).difficulty??1);Es(E,{get value(){return a(pt)},onUpdate:$t=>a(o).difficulty=$t,steps:[1,2,4,8,16,32,64,128]})}e(Be);var ve=s(Be,2),q=t(ve),W=t(q,!0);e(q);var G=s(q,2);{let pt=J(()=>a(o).size||1);hs(G,{get value(){return a(pt)},onUpdate:$t=>a(o).size=$t})}e(ve),e(zt);var Te=s(zt,2),ce=t(Te),_e=t(ce),X=t(_e,!0);e(_e);var $e=s(_e);Mt($e),e(ce);var xe=s(ce,2),We=t(xe),vt=t(We,!0);e(We);var ct=s(We);Mt(ct),e(xe),e(Te);var ut=s(Te,2),Lt=t(ut),Dt=t(Lt),Vt=t(Dt,!0);e(Dt);var Tt=s(Dt);Mt(Tt),e(Lt);var x=s(Lt,2),b=t(x),j=t(b,!0);e(b);var k=s(b);Mt(k),e(x),e(ut);var ke=s(ut,2),Ge=t(ke),rt=t(Ge,!0);e(Ge);var at=s(Ge,2);Xe(at,20,()=>["str","agi","int","wil"],Ot,(pt,$t)=>{var ia=En(),l=t(ia),v=t(l,!0);e(l);var u=s(l,2);Mt(u);var g=s(u,2),B=t(g);e(g),e(ia),_(f=>{de(l,"for",`attr-${$t??""}`),i(v,f),de(u,"id",`attr-${$t??""}`),Ze(g,1,`text-xs font-bold ${a(o).stats[$t]-10>=0?"text-green-500":"text-red-500"}`),i(B,`${a(o).stats[$t]-10>=0?"+":""}${a(o).stats[$t]-10}`)},[()=>n()("sofww.attributes."+$t).substring(0,3)]),bt(u,()=>a(o).stats[$t],f=>a(o).stats[$t]=f),d(pt,ia)}),e(at),e(ke);var Ct=s(ke,2),jt=t(Ct),Ft=t(jt),Rt=t(Ft,!0);e(Ft);var Bt=s(Ft);Mt(Bt),e(jt);var Jt=s(jt,2),Xt=t(Jt),ta=t(Xt,!0);e(Xt);var Gt=s(Xt);Mt(Gt),e(Jt);var Wt=s(Jt,2),Qt=t(Wt),ca=t(Qt,!0);e(Qt);var Zt=s(Qt);Mt(Zt),e(Wt),e(Ct),e(st),_((pt,$t,ia,l,v,u,g,B,f,w,h,ie,H)=>{i(L,pt),i(W,$t),i(X,ia),i(vt,l),i(Vt,v),i(j,u),i(rt,g),i(Rt,B),de(Bt,"placeholder",f),i(ta,w),de(Gt,"placeholder",h),i(ca,ie),de(Zt,"placeholder",H)},[()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.damage"),()=>n()("session.enemy_modal.speed"),()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder"),()=>n()("session.enemy_modal.languages"),()=>n()("session.enemy_modal.languages_placeholder"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder")]),bt($e,()=>a(o).defense,pt=>a(o).defense=pt),bt(ct,()=>a(o).health,pt=>a(o).health=pt),bt(Tt,()=>a(o).damage,pt=>a(o).damage=pt),bt(k,()=>a(o).speed,pt=>a(o).speed=pt),bt(Bt,()=>a(o).senses,pt=>a(o).senses=pt),bt(Gt,()=>a(o).languages,pt=>a(o).languages=pt),bt(Zt,()=>a(o).immune,pt=>a(o).immune=pt),d(tt,st)},Ae=tt=>{var st=It(),zt=qe(st);{var Be=L=>{var E=Rn();Xe(E,20,()=>[{key:"traits",label:"traits",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",label:"actions",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",label:"reactions",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",label:"end_of_round",color:"text-yellow-400",border:"border-yellow-500/30"}],Ot,(ve,q)=>{var W=Dn(),G=t(W),Te=t(G),ce=t(Te,!0);e(Te),e(G);var _e=s(G,2),X=t(_e);Xe(X,17,()=>a(o)[q.key],Ot,(ct,ut,Lt)=>{var Dt=In(),Vt=t(Dt),Tt=t(Vt);Mt(Tt);var x=s(Tt,2);ha(x),e(Vt);var b=s(Vt,2);b.__click=()=>V(q.key,Lt);var j=t(b);ua(j,{size:16}),e(b),e(Dt),_((k,ke)=>{de(Tt,"placeholder",k),de(x,"placeholder",ke)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),bt(Tt,()=>a(ut).name,k=>a(ut).name=k),bt(x,()=>a(ut).desc,k=>a(ut).desc=k),d(ct,Dt)});var $e=s(X,2);$e.__click=()=>M(q.key);var xe=t($e),We=t(xe);ra(We,{size:16}),e(xe);var vt=s(xe);e($e),e(_e),e(W),_((ct,ut)=>{Ze(W,1,`p-4 bg-slate-900 rounded border ${q.border??""}`),Ze(Te,1,`font-bold text-sm uppercase ${q.color??""}`),i(ce,ct),i(vt,` ${ut??""}`)},[()=>n()("session.enemy_modal."+q.label),()=>n()("common.buttons.add")]),d(ve,W)}),e(E),d(L,E)},T=L=>{var E=It(),ve=qe(E);{var q=W=>{var G=Nn(),Te=t(G);m(Te),e(G),d(W,G)};p(ve,W=>{a(S)==="preview"&&W(q)},!0)}d(L,E)};p(zt,L=>{a(S)==="abilities"?L(Be):L(T,!1)},!0)}d(tt,st)};p(ge,tt=>{a(S)==="stats"?tt(be):tt(Ae,!1)},!0)}d(O,Q)};p(Ve,O=>{a(S)==="general"?O(nt):O(Se,!1)})}e(yt);var Pe=s(yt,2),Ke=t(Pe);Ke.__click=()=>r.onSave(a(o));var Le=t(Ke);ss(Le,{size:18});var et=s(Le);e(Ke),e(Pe),e(ye);var F=s(ye,2),le=t(F),Ie=t(le),Z=t(Ie);Fa(Z,{size:14});var Oe=s(Z);e(Ie),e(le);var Re=s(le,2),Qe=t(Re);m(Qe),e(Re),e(F),e(je),e(me);var y=s(me,2);y.__change=pe,js(y,O=>C(Ne,O),()=>a(Ne));var z=s(y,2);ps(z,{get isOpen(){return a($)},get imageUrl(){return a(se)},onClose:()=>C($,!1),onCrop:I}),_((O,Q,ge,be,Ae,tt,st,zt)=>{de(me,"aria-label",O),i(ue,Q),Ze(lt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(dt,ge),Ze(xt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(it,be),Ze(St,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(ht,Ae),Ze(ft,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(S)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Pt,tt),i(et,` ${st??""}`),i(Oe,` ${zt??""}`)},[()=>n()("session.enemy_modal.close"),()=>n()("session.enemy_modal.title"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_stats"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("session.enemy_modal.preview"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview")]),$a(3,je,()=>Ua,()=>({y:20,duration:300})),$a(3,me,()=>Ua,()=>({duration:200,opacity:1})),d(re,Ce)};p(ze,re=>{N()&&re(kt)})}d(Y,De),la(),R()}ba(["click","change"]);var $n=c('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),Un=c('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),Pn=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),Ln=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function Fn(Y,r){oa(r,!0);const n=()=>Ut(aa,"$t",R),K=()=>Ut(ts,"$liveEnemies",R),[R,m]=da();let N=sa(r,"isOpen",3,!1),A=sa(r,"initialData",3,"{}"),o=_t(ma({name:"",enemies:[]}));La(()=>{if(N()&&A())try{const M=JSON.parse(A());C(o,{name:M.name||"",enemies:M.enemies||[]},!0)}catch{C(o,{name:"",enemies:[]},!0)}});function S(M){a(o).enemies.find(U=>U.enemyId===M)?a(o).enemies=a(o).enemies.map(U=>U.enemyId===M?{...U,count:U.count+1}:U):a(o).enemies=[...a(o).enemies,{enemyId:M,count:1}]}function $(M){a(o).enemies=a(o).enemies.filter((V,U)=>U!==M)}function se(M,V){const U=Math.max(1,parseInt(V)||1);a(o).enemies[M].count=U}function Ne(M){}var pe=It(),I=qe(pe);{var D=M=>{var V=Ln();V.__click=Ne;var U=t(V),De=t(U),ze=t(De),kt=t(ze,!0);e(ze);var re=s(ze,2);re.__click=function(...Se){r.onClose?.apply(this,Se)};var Ce=t(re);ya(Ce,{size:20}),e(re),e(De);var me=s(De,2),je=t(me),ye=t(je),Me=t(ye,!0);e(ye);var Je=s(ye,2);Mt(Je),e(je),e(me);var he=s(me,2),P=t(he),oe=t(P),ue=t(oe,!0);e(oe);var Ee=s(oe,2),we=t(Ee);Xe(we,17,()=>a(o).enemies,Ot,(Se,Pe,Ke)=>{const Le=J(()=>K().find(O=>O.id===a(Pe).enemyId));var et=$n(),F=t(et),le=t(F),Ie=t(le,!0);e(le);var Z=s(le,2),Oe=t(Z);e(Z),e(F);var Re=s(F,2),Qe=t(Re);Mt(Qe),Qe.__input=O=>se(Ke,O.target.value);var y=s(Qe,2);y.__click=()=>$(Ke);var z=t(y);ua(z,{size:16}),e(y),e(Re),e(et),_(O=>{i(Ie,O),i(Oe,`Dif ${(a(Le)?a(Le).difficulty:"?")??""}`),Za(Qe,a(Pe).count)},[()=>a(Le)?a(Le).name:n()("session.encounter_modal.unknown")]),d(Se,et)});var mt=s(we,2);{var lt=Se=>{var Pe=Un(),Ke=t(Pe,!0);e(Pe),_(Le=>i(Ke,Le),[()=>n()("session.encounter_modal.none_added")]),d(Se,Pe)};p(mt,Se=>{a(o).enemies.length===0&&Se(lt)})}e(Ee),e(P);var dt=s(P,2),xt=t(dt),it=t(xt,!0);e(xt);var St=s(xt,2);Xe(St,5,K,Se=>Se.id,(Se,Pe)=>{var Ke=Pn(),Le=t(Ke),et=t(Le),F=t(et,!0);e(et);var le=s(et,2),Ie=t(le);e(le),e(Le);var Z=s(Le,2);Z.__click=()=>S(a(Pe).id);var Oe=t(Z);ra(Oe,{size:16}),e(Z),e(Ke),_(()=>{i(F,a(Pe).name),i(Ie,`Dif ${a(Pe).difficulty??""}`)}),d(Se,Ke)}),e(St),e(dt),e(he);var ht=s(he,2),ft=t(ht);ft.__click=function(...Se){r.onClose?.apply(this,Se)};var Pt=t(ft,!0);e(ft);var yt=s(ft,2);yt.__click=()=>r.onSave(a(o));var Ve=t(yt);ss(Ve,{size:18});var nt=s(Ve);e(yt),e(ht),e(U),e(V),_((Se,Pe,Ke,Le,et,F,le,Ie)=>{de(V,"aria-label",Se),i(kt,Pe),i(Me,Ke),de(Je,"placeholder",Le),i(ue,et),i(it,F),i(Pt,le),i(nt,` ${Ie??""}`)},[()=>n()("session.encounter_modal.close"),()=>n()("session.encounter_modal.title"),()=>n()("session.encounter_modal.name"),()=>n()("session.encounter_modal.name_placeholder"),()=>n()("session.encounter_modal.enemies_in_encounter"),()=>n()("session.encounter_modal.add_enemies"),()=>n()("common.buttons.cancel"),()=>n()("session.encounter_modal.save_encounter")]),bt(Je,()=>a(o).name,Se=>a(o).name=Se),d(M,V)};p(I,M=>{N()&&M(D)})}d(Y,pe),la(),m()}ba(["click","input"]);var Hn=c('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),qn=c('<div class="text-[10px] text-slate-600 italic"> </div>'),Bn=c('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="flex items-center gap-2 mb-2"><div class="font-bold text-white text-base group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <!></div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),Wn=c('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),Gn=c('<div class="mb-4 flex-1"><p> </p> <!></div>'),Jn=c('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),Vn=c('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><div class="flex items-center gap-2"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <!></div> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),Qn=c('<div class="text-center text-slate-500 italic col-span-3"> </div>'),Yn=c('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function Zn(Y,r){oa(r,!0);const n=()=>Ut(ts,"$liveEnemies",m),K=()=>Ut(us,"$liveEncounters",m),R=()=>Ut(aa,"$t",m),[m,N]=da();let A=_t(!1),o=_t(null),S=_t("{}"),$=_t(!1),se=_t(null),Ne=_t("{}"),pe=_t(ma({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function I(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function D(y=null){C(o,y?y.id:null,!0),y?C(S,JSON.stringify(y),!0):a(Me)==="sofdl"?C(S,"{}"):C(S,JSON.stringify(I()),!0),C(A,!0)}let M=ma(new Set);function V(y){M.has(y)?M.delete(y):M.add(y)}function U(y){const z=a(o)||Ia(),O=ea.get(r.campId);os.set(z,{...y,id:z,campaignId:r.campId,system:O?.system||"sofww"}),C(A,!1)}function De(y){const z=n().find(O=>O.id===y);C(pe,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${z?.name||"este inimigo"}"?`,onConfirm:()=>{os.delete(y),a(pe).isOpen=!1}},!0)}function ze(y=null){C(se,y?y.id:null,!0),C(Ne,JSON.stringify(y||{name:"",enemies:[]}),!0),C($,!0)}function kt(y){const z=a(se)||Ia();Ya.set(z,{...y,id:z,system:a(Me)}),C($,!1)}function re(y){const z=K().find(O=>O.id===y);C(pe,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${z?.name||"este encontro"}"?`,onConfirm:()=>{Ya.delete(y),a(pe).isOpen=!1}},!0)}function Ce(y){const z=ea.get(r.campId);if(!z)return;const O=z.activeEnemies||[];let Q=[];y.enemies.forEach(ge=>{const be=n().find(Ae=>Ae.id===ge.enemyId);if(be)for(let Ae=0;Ae<ge.count;Ae++)Q.push({...be,instanceId:Ia(),damage:0,currentHealth:be.health,afflictions:[],acted:!1,initiative:!1})}),ea.set(r.campId,{...z,activeEnemies:[...O,...Q]})}function me(y,z){y.dataTransfer.setData("text/plain",z.id),y.dataTransfer.effectAllowed="copy"}function je(y){return y.preventDefault(),!1}function ye(y,z){y.preventDefault();const O=y.dataTransfer.getData("text/plain");if(!O)return;const Q=z.enemies||[],ge=Q.find(Ae=>Ae.enemyId===O);let be;ge?be=Q.map(Ae=>Ae.enemyId===O?{...Ae,count:Ae.count+1}:Ae):be=[...Q,{enemyId:O,count:1}],Ya.set(z.id,{...z,enemies:be})}let Me=J(()=>ea.get(r.campId)?.system||"sofww"),Je=J(()=>n().filter(y=>{const O=(y.system||"sofww")===a(Me),Q=y.global===!0,ge=y.campaignId===r.campId;return O&&(Q||ge)})),he=J(()=>K().filter(y=>{const O=(y.system||"sofww")===a(Me),Q=y.global===!0,ge=y.campaignId===r.campId;return O&&(Q||ge)}));var P=Yn(),oe=t(P),ue=t(oe),Ee=t(ue),we=t(Ee);es(we,{size:16});var mt=s(we);e(Ee),e(ue);var lt=s(ue,2),dt=t(lt);dt.__click=()=>ze();var xt=t(dt);ra(xt,{size:28,class:"group-hover:scale-110 transition-transform"});var it=s(xt,2),St=t(it,!0);e(it),e(dt);var ht=s(dt,2);Xe(ht,17,()=>a(he),y=>y.id,(y,z)=>{var O=Bn(),Q=t(O),ge=t(Q),be=t(ge),Ae=t(be,!0);e(be);var tt=s(be,2);{var st=X=>{_a(X,{size:12,class:"text-indigo-400"})};p(tt,X=>{a(z).global&&X(st)})}e(ge);var zt=s(ge,2),Be=t(zt);Xe(Be,17,()=>a(z).enemies||[],Ot,(X,$e)=>{const xe=J(()=>n().find(Dt=>Dt.id===a($e).enemyId));var We=Hn(),vt=t(We),ct=t(vt);e(vt);var ut=s(vt,2),Lt=t(ut,!0);e(ut),e(We),_(()=>{i(ct,`${a($e).count??""}x`),i(Lt,a(xe)?a(xe).name:"...")}),d(X,We)});var T=s(Be,2);{var L=X=>{var $e=qn(),xe=t($e,!0);e($e),_(We=>i(xe,We),[()=>R()("session.bestiary.empty_encounter")]),d(X,$e)};p(T,X=>{a(z).enemies?.length||X(L)})}e(zt),e(Q);var E=s(Q,2),ve=t(E);ve.__click=()=>Ce(a(z));var q=t(ve);Ka(q,{size:12,fill:"currentColor"});var W=s(q);e(ve);var G=s(ve,2);G.__click=()=>ze(a(z));var Te=t(G);ar(Te,{size:14}),e(G);var ce=s(G,2);ce.__click=()=>re(a(z).id);var _e=t(ce);ua(_e,{size:14}),e(ce),e(E),e(O),_(X=>{de(O,"aria-label",`Encontro ${a(z).name??""}`),i(Ae,a(z).name),i(W,` ${X??""}`)},[()=>R()("session.bestiary.start")]),ja("dragover",O,je),ja("drop",O,X=>ye(X,a(z))),d(y,O)}),e(lt),e(oe);var ft=s(oe,2),Pt=t(ft),yt=t(Pt);Ca(yt,{size:16});var Ve=s(yt);e(Pt),e(ft);var nt=s(ft,2),Se=t(nt);Se.__click=()=>D();var Pe=t(Se);ra(Pe,{size:32,class:"group-hover:scale-110 transition-transform"});var Ke=s(Pe,2),Le=t(Ke,!0);e(Ke),e(Se);var et=s(Se,2);Xe(et,17,()=>a(Je),y=>y.id,(y,z)=>{var O=Vn(),Q=t(O),ge=t(Q),be=t(ge),Ae=t(be,!0);e(be);var tt=s(be,2);{var st=ce=>{_a(ce,{size:14,class:"text-indigo-400"})};p(tt,ce=>{a(z).global&&ce(st)})}e(ge);var zt=s(ge,2),Be=t(zt);e(zt),e(Q);var T=s(Q,2);{var L=ce=>{var _e=Gn(),X=t(_e),$e=t(X,!0);e(X);var xe=s(X,2);{var We=vt=>{var ct=Wn();ct.__click=()=>V(a(z).id);var ut=t(ct,!0);e(ct),_(Lt=>i(ut,Lt),[()=>M.has(a(z).id)?R()("session.bestiary.see_less"):R()("session.bestiary.see_more")]),d(vt,ct)};p(xe,vt=>{a(z).description.length>120&&vt(We)})}e(_e),_(vt=>{Ze(X,1,`text-xs text-slate-400 leading-relaxed ${vt??""}`),i($e,a(z).description)},[()=>M.has(a(z).id)?"":"line-clamp-3"]),d(ce,_e)},E=ce=>{var _e=Jn(),X=t(_e,!0);e(_e),_($e=>i(X,$e),[()=>R()("session.bestiary.no_description")]),d(ce,_e)};p(T,ce=>{a(z).description?ce(L):ce(E,!1)})}var ve=s(T,2),q=t(ve);q.__click=()=>D(a(z));var W=t(q,!0);e(q);var G=s(q,2);G.__click=()=>De(a(z).id);var Te=t(G);ua(Te,{size:14}),e(G),e(ve),e(O),_((ce,_e)=>{i(Ae,a(z).name),i(Be,`${ce??""} ${a(z).difficulty??""}`),i(W,_e)},[()=>R()("session.bestiary.level"),()=>R()("common.buttons.edit")]),ja("dragstart",O,ce=>me(ce,a(z))),d(y,O)});var F=s(et,2);{var le=y=>{var z=Qn(),O=t(z,!0);e(z),_(Q=>i(O,Q),[()=>R()("session.bestiary.no_enemies")]),d(y,z)};p(F,y=>{a(Je).length===0&&y(le)})}e(nt);var Ie=s(nt,2);{var Z=y=>{bn(y,{get isOpen(){return a(A)},get initialData(){return a(S)},onClose:()=>C(A,!1),onSave:U})},Oe=y=>{Tn(y,{get isOpen(){return a(A)},get initialData(){return a(S)},onClose:()=>C(A,!1),onSave:U})};p(Ie,y=>{a(Me)==="sofdl"?y(Z):y(Oe,!1)})}var Re=s(Ie,2);Fn(Re,{get isOpen(){return a($)},get initialData(){return a(Ne)},onClose:()=>C($,!1),onSave:kt});var Qe=s(Re,2);Cs(Qe,{get isOpen(){return a(pe).isOpen},get title(){return a(pe).title},get message(){return a(pe).message},get onConfirm(){return a(pe).onConfirm},onCancel:()=>a(pe).isOpen=!1}),e(P),_((y,z,O,Q)=>{i(mt,` ${y??""}`),i(St,z),i(Ve,` ${O??""}`),i(Le,Q)},[()=>R()("session.bestiary.encounters_title"),()=>R()("session.bestiary.new_encounter"),()=>R()("session.bestiary.title"),()=>R()("session.bestiary.new_enemy")]),d(Y,P),la(),N()}ba(["click"]);var Xn=c('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),Kn=c('<button class="flex items-center gap-1 text-emerald-400 hover:text-emerald-300 transition-colors cursor-pointer"><!> <span class="text-xs font-bold hidden sm:block"> </span></button> <!>',1),eo=c('<div class="flex items-center gap-1 text-yellow-400 animate-pulse"><!> <span class="text-xs font-bold hidden sm:block"> </span></div>'),to=c('<button class="flex items-center gap-1 text-red-400 hover:text-red-300 transition-colors cursor-pointer animate-pulse"><!> <span class="text-xs font-bold hidden sm:block"> </span></button>'),ao=c('<button class="flex items-center gap-1 text-slate-500 hover:text-white transition-colors cursor-pointer"><!> <span class="text-xs hidden sm:block"> </span></button>'),so=c('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),ro=c('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group"><!> <!></button> <div class="flex flex-col"><h1 class="text-base sm:text-lg font-black text-white leading-tight truncate max-w-[140px] sm:max-w-none"> </h1> <span class="text-xs text-indigo-400 font-mono font-black uppercase tracking-wider"> </span></div></div> <div class="hidden md:flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block"> </span></button> <button><!> <span class="hidden min-[400px]:block"> </span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 sm:p-2.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all"><!></button> <button class="p-2 sm:p-2.5 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative"><!> <!></button></div></div></div></header>');function io(Y,r){oa(r,!0);const n=()=>Ut(aa,"$t",N),K=()=>Ut(Ts,"$syncState",N),R=()=>Ut(Ma,"$isHistoryOpen",N),m=()=>Ut($s,"$hasUnreadRolls",N),[N,A]=da();let o=sa(r,"campaignName",3,""),S=sa(r,"gmName",3,"Mestre"),$=sa(r,"activeSubTab",3,"session"),se=sa(r,"onTabChange",3,()=>{}),Ne=sa(r,"onOpenSettings",3,()=>{});var pe=ro(),I=t(pe),D=t(I),M=t(D),V=t(M);V.__click=()=>br(ms("/"));var U=t(V);Ha(U,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var De=s(U,2);Qs(De,{size:18,class:"hidden sm:block opacity-50"}),e(V);var ze=s(V,2),kt=t(ze),re=t(kt,!0);e(kt);var Ce=s(kt,2),me=t(Ce,!0);e(Ce),e(ze),e(M);var je=s(M,2),ye=t(je);ye.__click=()=>se()("session");var Me=t(ye);{let Ve=J(()=>$()==="session"?"opacity-100":"opacity-50");ws(Me,{size:14,get class(){return a(Ve)}})}var Je=s(Me,2),he=t(Je,!0);e(Je),e(ye);var P=s(ye,2);P.__click=()=>se()("bestiary");var oe=t(P);{let Ve=J(()=>$()==="bestiary"?"opacity-100":"opacity-50");Ms(oe,{size:14,get class(){return a(Ve)}})}var ue=s(oe,2),Ee=t(ue,!0);e(ue),e(P),e(je);var we=s(je,2),mt=t(we),lt=t(mt);{var dt=Ve=>{var nt=Kn(),Se=qe(nt);Se.__click=function(...le){Qa?.apply(this,le)};var Pe=t(Se);_s(Pe,{size:16});var Ke=s(Pe,2),Le=t(Ke,!0);e(Ke),e(Se);var et=s(Se,2);{var F=le=>{var Ie=Xn(),Z=t(Ie);bs(Z,{size:14});var Oe=s(Z,2),Re=t(Oe,!0);e(Oe),e(Ie),_(Qe=>{de(Ie,"title",Qe),i(Re,K().peers.length)},[()=>n()("common.status.peers",{values:{count:K().peers.length}})]),d(le,Ie)};p(et,le=>{K().peers.length>0&&le(F)})}_((le,Ie)=>{de(Se,"title",le),i(Le,Ie)},[()=>n()("common.status.connected"),()=>n()("common.status.connected")]),d(Ve,nt)},xt=Ve=>{var nt=It(),Se=qe(nt);{var Pe=Le=>{var et=eo(),F=t(et);dr(F,{size:16,class:"animate-spin"});var le=s(F,2),Ie=t(le,!0);e(le),e(et),_((Z,Oe)=>{de(et,"title",Z),i(Ie,Oe)},[()=>n()("common.status."+K().connectionStatus),()=>n()("common.status."+K().connectionStatus)]),d(Le,et)},Ke=Le=>{var et=It(),F=qe(et);{var le=Z=>{var Oe=to();Oe.__click=function(...z){Qa?.apply(this,z)};var Re=t(Oe);vr(Re,{size:16});var Qe=s(Re,2),y=t(Qe,!0);e(Qe),e(Oe),_((z,O)=>{de(Oe,"title",z),i(y,O)},[()=>n()("common.status.error"),()=>n()("common.status.error")]),d(Z,Oe)},Ie=Z=>{var Oe=ao();Oe.__click=function(...z){Qa?.apply(this,z)};var Re=t(Oe);_r(Re,{size:16});var Qe=s(Re,2),y=t(Qe,!0);e(Qe),e(Oe),_((z,O)=>{de(Oe,"title",z),i(y,O)},[()=>n()("common.status.offline"),()=>n()("common.status.offline")]),d(Z,Oe)};p(F,Z=>{K().connectionStatus==="error"?Z(le):Z(Ie,!1)},!0)}d(Le,et)};p(Se,Le=>{K().connectionStatus==="connecting"||K().connectionStatus==="reconnecting"?Le(Pe):Le(Ke,!1)},!0)}d(Ve,nt)};p(lt,Ve=>{K().connectionStatus==="connected"?Ve(dt):Ve(xt,!1)})}e(mt);var it=s(mt,2);it.__click=function(...Ve){Ne()?.apply(this,Ve)};var St=t(it);lr(St,{size:20}),e(it);var ht=s(it,2);ht.__click=()=>Ma.update(Ve=>!Ve);var ft=t(ht);Ys(ft,{size:20});var Pt=s(ft,2);{var yt=Ve=>{var nt=so();d(Ve,nt)};p(Pt,Ve=>{m()&&Ve(yt)})}e(ht),e(we),e(D),e(I),e(pe),_((Ve,nt,Se,Pe,Ke,Le,et,F)=>{de(V,"aria-label",Ve),de(V,"title",nt),i(re,o()),i(me,S()),Ze(ye,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${$()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),de(ye,"aria-pressed",$()==="session"),i(he,Se),Ze(P,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${$()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),de(P,"aria-pressed",$()==="bestiary"),i(Ee,Pe),de(it,"aria-label",Ke),de(it,"title",Le),de(ht,"aria-label",et),de(ht,"title",F),de(ht,"aria-pressed",R())},[()=>n()("character.header.back_dashboard"),()=>n()("character.header.back_dashboard"),()=>n()("common.labels.session"),()=>n()("common.labels.bestiary"),()=>n()("common.buttons.settings"),()=>n()("common.buttons.settings"),()=>n()("character.header.history"),()=>n()("character.header.history")]),d(Y,pe),la(),A()}ba(["click"]);var no=c('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),oo=c('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),lo=c('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),vo=c('<button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d3</span> <!></button>'),co=c('<button class="bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-indigo-500/20"><span class="text-[10px] opacity-70">d20</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d6</span> <!></button> <!> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">2d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">3d6</span> <!></button> <div class="w-px h-8 bg-white/10 mx-1"></div> <button class="bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><!></button>',1),uo=c('<button class="px-3 py-2 text-left hover:bg-indigo-600/50 rounded-lg text-xs font-mono text-slate-300 transition-colors w-full"> </button>'),bo=c('<div class="absolute bottom-full left-0 right-0 mb-2 bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-xl p-1 shadow-xl max-h-48 overflow-y-auto z-50 flex flex-col gap-0.5 min-w-[12rem]"></div>'),_o=c('<button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button> <div class="relative"><input type="text" class="bg-slate-800 border border-slate-700 rounded-lg pl-3 pr-2 py-2 text-sm text-white focus:outline-none focus:border-indigo-500 w-48 font-mono placeholder:text-slate-600"/> <!></div> <button class="bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white w-10 h-10 rounded-lg flex items-center justify-center transition-colors shadow-lg"><!></button>',1),mo=c('<div class="w-px h-8 bg-white/10 mx-1"></div> <button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button>',1),xo=c('<div class="fixed bottom-24 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0 z-[60] flex flex-col items-center gap-2 max-w-[95vw]"><div class="bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center gap-2 shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 duration-200 relative overflow-visible"><!> <!></div></div>  <div class="fixed inset-0 bg-black/40 z-[55]"></div>',1),fo=c('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!> <!> <div class="hidden md:block fixed bottom-8 left-8 z-[60]"><button class="w-16 h-16 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-[0_0_20px_rgba(79,70,229,0.4)] flex items-center justify-center transition-all active:scale-90 border-2 border-white/10 group"><!></button></div> <nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-6 pt-2 pointer-events-none"><div class="max-w-md mx-auto relative h-16 pointer-events-auto"><div class="absolute inset-0 bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"></div></div> <div class="relative h-full flex items-center justify-around px-2"><button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none"> </span></button> <div class="relative w-16 h-16 -mt-10 flex items-center justify-center"><div class="absolute inset-0 bg-indigo-600/20 rounded-full blur-xl animate-pulse"></div> <button class="relative w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(79,70,229,0.5)] border-4 border-slate-900 transition-all active:scale-90 hover:bg-indigo-500 z-10"><!></button></div> <button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none"> </span></button></div></div></nav> <!> <div class="hidden md:block fixed bottom-8 right-8 z-[60]"><button class="w-14 h-14 bg-slate-800 hover:bg-slate-700 text-indigo-400 hover:text-white rounded-full shadow-lg flex items-center justify-center transition-all active:scale-90 border border-white/10"><!></button></div></div>');function Wo(Y,r){oa(r,!0);const n=()=>Ut(Ls,"$page",N),K=()=>Ut(Hs,"$liveCampaigns",N),R=()=>Ut(aa,"$t",N),m=()=>Ut(Ma,"$isHistoryOpen",N),[N,A]=da();let o=_t("session"),S=_t(!1),$=J(()=>n().params.id),se=J(()=>K().find(F=>F.id===a($))),Ne=J(()=>!!a(se));function pe(F){if(!a($)||!a(se))return;const le={...a(se),...F};ea.set(a($),le),Xa(a($),{name:le.name,gmName:le.gmName}),C(S,!1)}let I=_t(!1),D=_t(ma({isOpen:!1,sides:20,count:1,modifier:0,isCustom:!1,customFormula:""})),M=_t(!1),V=_t("");const U=["1d4","1d6","1d8","1d10","1d12","1d20","1d100","2d6","3d6","1d3","1d6 + 1d3"];let De=J(()=>U.filter(F=>F.startsWith(a(V))&&F!==a(V)));function ze(F,le=1){C(D,{isOpen:!0,sides:F,count:le,modifier:0,isCustom:!1,customFormula:""},!0)}function kt(){C(M,!a(M)),a(M)||C(V,"")}function re(F){F&&(C(D,{isOpen:!0,sides:0,count:0,modifier:0,isCustom:!0,customFormula:F},!0),C(I,!1),C(M,!1),C(V,""))}function Ce(F,le=[],Ie){if(!a(se))return;let Z,Oe="";a(D).isCustom?(Z=Xr(a(D).customFormula),Z.dice&&(Oe=Z.dice.map(Q=>`${Q.count}d${Q.sides}@${Q.results.join(",")}`).join("+"))):Z=Zr(a(D).sides,a(D).count,F);let Re="";(a(D).count>1||a(D).isCustom)&&(Re+=`Dados: [${Z.results.join(", ")}] `),Z.bonusRolls?.length>0&&(Re+=`Bonus Rolls: [${Z.bonusRolls.join(", ")}] -> ${Math.abs(Z.modifierTotal)}`);const Qe=a(se).gmName||Ta(aa)("common.labels.master"),y=()=>{Us.addToHistory({source:"GM",charName:Qe,name:a(D).isCustom?Z.formula:`${a(D).count}d${a(D).sides} ${F?F>0?`+${F}`:F:""}`,description:Re.trim()||null,total:Z.total,formula:Z.formula,crit:Z.crit}),Ta(Ps).autoOpenHistory?Ma.set(!0):Ss(async()=>{const{hasUnreadRolls:Q}=await import("../chunks/D-px-r2z.js").then(ge=>ge.a5);return{hasUnreadRolls:Q}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url).then(({hasUnreadRolls:Q})=>{Q.set(!0)})};Ie?.suppressHistory||(y(),a(D).isOpen=!1);const z=a(D).sides===20&&a(D).count===1&&!a(D).isCustom;return{d20:z?Z.results[0]:void 0,boonBaneDice:z?Z.bonusRolls:[],damageDice:z?[]:Z.results,total:Z.total,formula:Z.formula,commit:y,notation:Oe}}var me=fo(),je=t(me);{var ye=F=>{var le=no(),Ie=qe(le);io(Ie,{get campaignName(){return a(se).name},get gmName(){return a(se).gmName},get activeSubTab(){return a(o)},onTabChange:z=>C(o,z,!0),onOpenSettings:()=>C(S,!0)});var Z=s(Ie,2);{let z=J(()=>JSON.stringify(a(se)));cr(Z,{get isOpen(){return a(S)},get initialData(){return a(z)},onClose:()=>C(S,!1),onSave:pe})}var Oe=s(Z,2),Re=t(Oe);{var Qe=z=>{Pi(z,{get campaign(){return a(se)}})},y=z=>{var O=It(),Q=qe(O);{var ge=be=>{Zn(be,{get campId(){return a($)}})};p(Q,be=>{a(o)==="bestiary"&&be(ge)},!0)}d(z,O)};p(Re,z=>{a(o)==="session"?z(Qe):z(y,!1)})}e(Oe),d(F,le)},Me=F=>{var le=It(),Ie=qe(le);{var Z=Re=>{var Qe=oo(),y=s(t(Qe),2),z=t(y,!0);e(y);var O=s(y,2),Q=t(O,!0);e(O);var ge=s(O,2);ge.__click=()=>window.history.back();var be=s(t(ge));e(ge),e(Qe),_((Ae,tt,st)=>{i(z,Ae),i(Q,tt),i(be,` ${st??""}`)},[()=>R()("campaign.not_found.title"),()=>R()("campaign.not_found.message"),()=>R()("common.buttons.back")]),d(Re,Qe)},Oe=Re=>{var Qe=lo();d(Re,Qe)};p(Ie,Re=>{a(Ne)&&!a(se)?Re(Z):Re(Oe,!1)},!0)}d(F,le)};p(je,F=>{a(Ne)&&a(se)?F(ye):F(Me,!1)})}var Je=s(je,2);fs(Je,{get isOpen(){return m()},onClose:()=>Ma.set(!1)});var he=s(Je,2);{var P=F=>{var le=xo(),Ie=qe(le),Z=t(Ie),Oe=t(Z);{var Re=Q=>{var ge=co(),be=qe(ge);be.__click=()=>{ze(20),C(I,!1)};var Ae=s(t(be),2);za(Ae,{size:16}),e(be);var tt=s(be,2);tt.__click=()=>{ze(6),C(I,!1)};var st=s(t(tt),2);za(st,{size:16}),e(tt);var zt=s(tt,2);{var Be=G=>{var Te=vo();Te.__click=()=>{ze(3),C(I,!1)};var ce=s(t(Te),2);za(ce,{size:16}),e(Te),d(G,Te)};p(zt,G=>{a(se)?.system==="sofdl"&&G(Be)})}var T=s(zt,2);T.__click=()=>{ze(6,2),C(I,!1)};var L=s(t(T),2);za(L,{size:16}),e(T);var E=s(T,2);E.__click=()=>{ze(6,3),C(I,!1)};var ve=s(t(E),2);za(ve,{size:16}),e(E);var q=s(E,4);q.__click=kt;var W=t(q);Xs(W,{size:20}),e(q),_(G=>de(q,"title",G),[()=>R()("session.quick.custom_roll")]),d(Q,ge)},Qe=Q=>{var ge=_o(),be=qe(ge);be.__click=kt;var Ae=t(be);sr(Ae,{size:20}),e(be);var tt=s(be,2),st=t(tt);Mt(st),st.__keydown=E=>E.key==="Enter"&&re(a(V)),Is(st,!0);var zt=s(st,2);{var Be=E=>{var ve=bo();Xe(ve,21,()=>a(De),Ot,(q,W)=>{var G=uo();G.__click=()=>re(a(W));var Te=t(G,!0);e(G),_(()=>i(Te,a(W))),d(q,G)}),e(ve),d(E,ve)};p(zt,E=>{a(De).length>0&&E(Be)})}e(tt);var T=s(tt,2);T.__click=()=>re(a(V));var L=t(T);hr(L,{size:18}),e(T),_(E=>{de(st,"placeholder",E),T.disabled=!a(V)},[()=>R()("session.quick.custom_roll_placeholder")]),bt(st,()=>a(V),E=>C(V,E)),d(Q,ge)};p(Oe,Q=>{a(M)?Q(Qe,!1):Q(Re)})}var y=s(Oe,2);{var z=Q=>{var ge=mo(),be=s(qe(ge),2);be.__click=()=>C(I,!1);var Ae=t(be);ya(Ae,{size:20}),e(be),d(Q,ge)};p(y,Q=>{a(M)||Q(z)})}e(Z),e(Ie);var O=s(Ie,2);O.__click=()=>{C(I,!1),C(M,!1)},d(F,le)};p(he,F=>{a(I)&&F(P)})}var oe=s(he,2),ue=t(oe);ue.__click=()=>C(I,!a(I));var Ee=t(ue);za(Ee,{size:32,class:"group-hover:rotate-12 transition-transform"}),e(ue),e(oe);var we=s(oe,2),mt=t(we),lt=s(t(mt),2),dt=t(lt);dt.__click=()=>{C(o,"session"),C(I,!1)};var xt=t(dt);{let F=J(()=>a(o)==="session"?"animate-in zoom-in-75 duration-300":"");ws(xt,{size:20,get class(){return a(F)}})}var it=s(xt,2),St=t(it,!0);e(it),e(dt);var ht=s(dt,2),ft=s(t(ht),2);ft.__click=()=>C(I,!a(I));var Pt=t(ft);{let F=J(()=>a(I)?"rotate-90":"rotate-0");za(Pt,{size:28,get class(){return`text-white ${a(F)??""} transition-transform duration-300`}})}e(ft),e(ht);var yt=s(ht,2);yt.__click=()=>{C(o,"bestiary"),C(I,!1)};var Ve=t(yt);{let F=J(()=>a(o)==="bestiary"?"animate-in zoom-in-75 duration-300":"");Ms(Ve,{size:20,get class(){return a(F)}})}var nt=s(Ve,2),Se=t(nt,!0);e(nt),e(yt),e(lt),e(mt),e(we);var Pe=s(we,2);{let F=J(()=>a(D).isCustom?R()("session.quick.custom_roll"):`${R()("session.quick.roll_title")} (${a(D).count}d${a(D).sides})`),le=J(()=>a(D).isCustom?"":a(D).sides===20?R()("session.quick.boons_banes"):R()("session.quick.fixed_modifier"));Zs(Pe,{get isOpen(){return a(D).isOpen},get title(){return a(F)},get label(){return a(le)},get customFormula(){return a(D).customFormula},onClose:()=>a(D).isOpen=!1,onRoll:Ce,initialModifier:0})}var Ke=s(Pe,2),Le=t(Ke);Le.__click=()=>window.open(`/campaigns/${a($)}/combat`,"_blank","width=500,height=700,resizable=yes,scrollbars=yes");var et=t(Le);Fa(et,{size:24}),e(Le),e(Ke),e(me),_((F,le,Ie,Z,Oe)=>{de(ue,"title",F),Ze(dt,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(o)==="session"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),i(St,le),de(ft,"aria-label",Ie),Ze(yt,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(o)==="bestiary"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),i(Se,Z),de(Le,"title",Oe)},[()=>R()("session.quick.fab_title"),()=>R()("session.tabs.session"),()=>R()("session.quick.roll_dice"),()=>R()("session.tabs.bestiary"),()=>R()("session.combat_viewer.open")]),d(Y,me),la(),A()}ba(["click","keydown"]);export{Wo as component};
