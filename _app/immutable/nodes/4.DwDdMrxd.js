import{c as Ae,a as o,f,t as sa}from"../chunks/vbI-l42I.js";import{V as Da,P as Pa,b6 as Fa,ae as Ha,aI as Ba,q as Va,a5 as La,ak as qa,e as ta,b7 as Ua,ax as Ca,B as ve,p as Ut,c as a,g as e,D as xe,s as i,r as t,t as T,n as _e,C as je,b as Gt,d as L,_ as Vt,j as $a,ag as xa}from"../chunks/BlobBfBu.js";import{b as Ga,d as Wt,s as x,e as ca}from"../chunks/OaA2MUvX.js";import{l as $t,s as zt,p as Rt,i as N}from"../chunks/BBccnPWr.js";import{a as Ct,s as ra}from"../chunks/iJn5IoH5.js";import{C as ga,W as Wa,p as za}from"../chunks/D4r5fGFG.js";import{I as Et,a as ma,s as da,j as Qa,b as ot,g as ba,U as Ja,h as qt,k as na,f as Za,e as _a,d as ua,r as Ka}from"../chunks/BlDAHNTi.js";import{C as Ea,b as pa,c as Ma,l as Xa,a as Ya}from"../chunks/BuBssglp.js";import{o as ha}from"../chunks/D_FouEMM.js";import{d as er,e as ge,i as qe,c as Dt,r as kt,s as $e,f as fa,g as tr,b as It}from"../chunks/BO950AV2.js";import{X as aa,M as ya,G as la,D as ar,H as Na,C as Oa,a as rr,L as ir,S as sr,b as nr,c as or}from"../chunks/B_qKVCBO.js";import{P as Bt,T as Zt,S as dr}from"../chunks/fU9-t09R.js";import{S as lr,G as vr,P as Sa,u as wa,C as cr}from"../chunks/B4rtq37E.js";import"../chunks/BX-sjYO1.js";import{s as Mt}from"../chunks/-C23ZK4E.js";import{g as ur}from"../chunks/BsQs4fei.js";const br=()=>performance.now(),Ht={tick:l=>requestAnimationFrame(l),now:()=>br(),tasks:new Set};function Ia(){const l=Ht.now();Ht.tasks.forEach(r=>{r.c(l)||(Ht.tasks.delete(r),r.f())}),Ht.tasks.size!==0&&Ht.tick(Ia)}function fr(l){let r;return Ht.tasks.size===0&&Ht.tick(Ia),{promise:new Promise(c=>{Ht.tasks.add(r={c:l,f:c})}),abort(){Ht.tasks.delete(r)}}}function oa(l,r){Ca(()=>{l.dispatchEvent(new CustomEvent(r))})}function pr(l){if(l==="float")return"cssFloat";if(l==="offset")return"cssOffset";if(l.startsWith("--"))return l;const r=l.split("-");return r.length===1?r[0]:r[0]+r.slice(1).map(c=>c[0].toUpperCase()+c.slice(1)).join("")}function ka(l){const r={},c=l.split(";");for(const _ of c){const[s,p]=_.split(":");if(!s||p===void 0)break;const v=pr(s.trim());r[v]=p.trim()}return r}const xr=l=>l;function gr(l,r,c){var _=er,s,p,v,u=null;_.a??={element:l,measure(){s=this.element.getBoundingClientRect()},apply(){if(v?.abort(),p=this.element.getBoundingClientRect(),s.left!==p.left||s.right!==p.right||s.top!==p.top||s.bottom!==p.bottom){const S=r()(this.element,{from:s,to:p},c?.());v=va(this.element,S,void 0,1,()=>{v?.abort(),v=void 0})}},fix(){if(!l.getAnimations().length){var{position:S,width:$,height:E}=getComputedStyle(l);if(S!=="absolute"&&S!=="fixed"){var B=l.style;u={position:B.position,width:B.width,height:B.height,transform:B.transform},B.position="absolute",B.width=$,B.height=E;var U=l.getBoundingClientRect();if(s.left!==U.left||s.top!==U.top){var z=`translate(${s.left-U.left}px, ${s.top-U.top}px)`;B.transform=B.transform?`${B.transform} ${z}`:z}}}},unfix(){if(u){var S=l.style;S.position=u.position,S.width=u.width,S.height=u.height,S.transform=u.transform}}},_.a.element=l}function mr(l,r,c,_){var s=(l&Ua)!==0,p="both",v,u=r.inert,S=r.style.overflow,$,E;function B(){return Ca(()=>v??=c()(r,_?.()??{},{direction:p}))}var U={is_global:s,in(){r.inert=u,oa(r,"introstart"),$=va(r,B(),E,1,()=>{oa(r,"introend"),$?.abort(),$=v=void 0,r.style.overflow=S})},out(D){r.inert=!0,oa(r,"outrostart"),E=va(r,B(),$,0,()=>{oa(r,"outroend"),D?.()})},stop:()=>{$?.abort(),E?.abort()}},z=Da;if((z.transitions??=[]).push(U),Ga){var K=s;if(!K){for(var k=z.parent;k&&(k.f&Pa)!==0;)for(;(k=k.parent)&&(k.f&Fa)===0;);K=!k||(k.f&Ha)!==0}K&&Ba(()=>{Va(()=>U.in())})}}function va(l,r,c,_,s){var p=_===1;if(La(r)){var v,u=!1;return qa(()=>{if(!u){var D=r({direction:p?"in":"out"});v=va(l,D,c,_,s)}}),{abort:()=>{u=!0,v?.abort()},deactivate:()=>v.deactivate(),reset:()=>v.reset(),t:()=>v.t()}}if(c?.deactivate(),!r?.duration)return s(),{abort:ta,deactivate:ta,reset:ta,t:()=>_};const{delay:S=0,css:$,tick:E,easing:B=xr}=r;var U=[];if(p&&c===void 0&&(E&&E(0,1),$)){var z=ka($(0,1));U.push(z,z)}var K=()=>1-_,k=l.animate(U,{duration:S,fill:"forwards"});return k.onfinish=()=>{k.cancel();var D=c?.t()??1-_;c?.abort();var R=_-D,F=r.duration*Math.abs(R),Y=[];if(F>0){var ce=!1;if($)for(var ne=Math.ceil(F/16.666666666666668),ie=0;ie<=ne;ie+=1){var G=D+R*B(ie/ne),V=ka($(G,1-G));Y.push(V),ce||=V.overflow==="hidden"}ce&&(l.style.overflow="hidden"),K=()=>{var he=k.currentTime;return D+R*B(he/F)},E&&fr(()=>{if(k.playState!=="running")return!1;var he=K();return E(he,1-he),!0})}k=l.animate(Y,{duration:F,fill:"forwards"}),k.onfinish=()=>{K=()=>_,E?.(_,1-_),s()}},{abort:()=>{k&&(k.cancel(),k.effect=null,k.onfinish=ta)},deactivate:()=>{s=ta},reset:()=>{_===0&&E?.(1,0)},t:()=>K()}}function _r(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["path",{d:"m6 9 6 6 6-6"}]];Et(l,zt({name:"chevron-down"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function hr(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["path",{d:"m18 15-6-6-6 6"}]];Et(l,zt({name:"chevron-up"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function yr(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335"}],["path",{d:"m9 11 3 3L22 4"}]];Et(l,zt({name:"circle-check-big"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function wr(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];Et(l,zt({name:"copy"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function kr(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["circle",{cx:"12",cy:"12",r:"3"}]];Et(l,zt({name:"eye"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function Cr(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];Et(l,zt({name:"flame"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function $r(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];Et(l,zt({name:"grip-vertical"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function Ra(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];Et(l,zt({name:"layers"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function zr(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];Et(l,zt({name:"library"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function Er(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];Et(l,zt({name:"qr-code"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function Mr(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}]];Et(l,zt({name:"rotate-ccw"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function ja(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];Et(l,zt({name:"save"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function Aa(l,r){const c=$t(r,["children","$$slots","$$events","$$legacy"]);const _=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];Et(l,zt({name:"swords"},()=>c,{get iconNode(){return _},children:(s,p)=>{var v=Ae(),u=ve(v);Mt(u,r,"default",{}),o(s,v)},$$slots:{default:!0}}))}function Nr(l){const r=l-1;return r*r*r+1}function Or(l,{delay:r=0,duration:c=400,easing:_=Nr,axis:s="y"}={}){const p=getComputedStyle(l),v=+p.opacity,u=s==="y"?"height":"width",S=parseFloat(p[u]),$=s==="y"?["top","bottom"]:["left","right"],E=$.map(R=>`${R[0].toUpperCase()}${R.slice(1)}`),B=parseFloat(p[`padding${E[0]}`]),U=parseFloat(p[`padding${E[1]}`]),z=parseFloat(p[`margin${E[0]}`]),K=parseFloat(p[`margin${E[1]}`]),k=parseFloat(p[`border${E[0]}Width`]),D=parseFloat(p[`border${E[1]}Width`]);return{delay:r,duration:c,easing:_,css:R=>`overflow: hidden;opacity: ${Math.min(R*20,1)*v};${u}: ${R*S}px;padding-${$[0]}: ${R*B}px;padding-${$[1]}: ${R*U}px;margin-${$[0]}: ${R*z}px;margin-${$[1]}: ${R*K}px;border-${$[0]}-width: ${R*k}px;border-${$[1]}-width: ${R*D}px;min-${u}: 0`}}var Sr=f('<div class="absolute top-0 right-0 bg-yellow-500/20 text-yellow-400 text-[9px] font-bold px-2 py-0.5 rounded-bl uppercase border-b border-l border-yellow-500/30">Iniciativa</div>'),Ir=f('<span class="text-[10px] bg-slate-950 px-1.5 py-0.5 rounded text-slate-500 border border-slate-800"> </span>'),Rr=f('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),jr=f('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),Ar=f('<button class="text-[9px] bg-red-900/40 text-red-300 px-1.5 py-0.5 rounded border border-red-800 flex items-center gap-1 cursor-pointer hover:bg-red-900/60 transition-colors"> <!></button>'),Tr=f('<button class="w-full text-left text-xs text-slate-300 hover:text-white hover:bg-slate-700 p-1 cursor-pointer rounded" role="menuitem"> </button>'),Dr=f('<button title="Tomar Iniciativa"><!></button>'),Pr=f('<button class="p-1.5 rounded bg-slate-900 text-slate-400 hover:text-white border border-slate-800"><!></button> <button class="p-1.5 rounded bg-slate-900 text-slate-500 hover:text-red-400 border border-slate-800"><!></button>',1),Fr=f('<div class="mb-1"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span></div>'),Hr=f('<div><h5 class="text-indigo-400 font-bold uppercase text-[10px] mb-1">Traços</h5> <!></div>'),Br=f('<div class="mb-1"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span></div>'),Vr=f('<div><h5 class="text-red-400 font-bold uppercase text-[10px] mb-1">Ações</h5> <!></div>'),Lr=f('<div class="mb-1"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span></div>'),qr=f('<div><h5 class="text-orange-400 font-bold uppercase text-[10px] mb-1">Reações</h5> <!></div>'),Ur=f('<div class="mb-1"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span></div>'),Gr=f('<div><h5 class="text-yellow-500 font-bold uppercase text-[10px] mb-1">Fim da Rodada</h5> <!></div>'),Wr=f('<div class="mt-3 pt-3 border-t border-slate-800/50 text-xs"><div class="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-3"><div class="bg-slate-950 p-2 rounded border border-slate-800"><span class="block text-[10px] text-slate-500 uppercase font-bold">Tamanho</span><span class="text-white font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800"><span class="block text-[10px] text-slate-500 uppercase font-bold">Speed</span><span class="text-white font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 col-span-2"><span class="block text-[10px] text-slate-500 uppercase font-bold">Sentidos</span><span class="text-white"> </span></div></div> <div class="space-y-4"><!> <!> <!> <!></div></div>'),Qr=f('<div><!> <div class="flex flex-col md:flex-row gap-4 items-center"><button><!></button> <div class="flex-1 min-w-[200px]"><div class="flex items-center gap-2"><span> </span> <!></div> <div class="relative w-full h-6 bg-slate-950 rounded-lg mt-1.5 overflow-hidden border border-slate-800 group shadow-inner"><div></div> <!> <!> <div class="absolute inset-0 flex items-center justify-center z-20"><span><!></span></div></div> <div class="flex flex-wrap gap-2 mt-2"><!> <div class="relative group/aff"><button class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded border border-slate-700 hover:text-white flex items-center gap-1" aria-haspopup="true"><!> Aflição</button> <div class="absolute top-full left-0 mt-1 bg-slate-800 border border-slate-700 rounded shadow-xl p-2 w-40 z-20 hidden group-hover/aff:block max-h-40 overflow-y-auto custom-scrollbar" role="menu"></div></div></div></div> <div class="flex items-center gap-2 bg-slate-950 p-2 rounded-lg border border-slate-800"><div class="text-center w-10 border-r border-slate-800 pr-2 mr-1"><div class="text-[8px] text-slate-500 uppercase font-bold">Def</div> <div class="font-mono font-bold text-white text-lg"> </div></div> <label class="text-center"><div class="text-[8px] text-red-400 uppercase font-bold mb-0.5">Dano</div> <input type="number" class="w-12 bg-slate-900 border border-slate-800 text-center text-white font-mono font-bold rounded focus:border-red-500 focus:outline-none"/></label> <label class="text-center"><div class="text-[8px] text-green-400 uppercase font-bold mb-0.5">Atual</div> <input type="number" class="w-12 bg-slate-900 border border-slate-800 text-center text-white font-mono font-bold rounded focus:border-green-500 focus:outline-none"/></label> <div class="text-center pl-2 ml-1 border-l border-slate-800"><div class="text-[8px] text-slate-500 uppercase font-bold mb-0.5">Máx</div> <div class="text-slate-400 font-mono font-bold"> </div></div></div> <div class="flex flex-col gap-1"><!></div></div> <!></div>');function Jr(l,r){Ut(r,!0);let c=Rt(r,"updateEnemy",3,(g,h)=>{}),_=Rt(r,"updatePlayer",3,(g,h)=>{}),s=Rt(r,"removeFromCombat",3,g=>{}),p=xe(()=>r.entity.type==="player"),v=xe(()=>r.entity.damage||0),u=xe(()=>r.entity.normalHealth||r.entity.health||10),S=xe(()=>r.entity.currentHealth??e(u)),$=xe(()=>e(v)>=e(S)),E=xe(()=>e(v)>=e(S)/2&&!e($)),B=xe(()=>e(S)>0?Math.min(100,Math.max(0,e(v)/e(S)*100)):100),U=je(!1);function z(g){if(r.entity.type!=="player")return;const h=ma.get(r.entity.id);h&&ma.set(r.entity.id,{...h,...g}),_()(r.entity.id,g),da({id:r.entity.id,...g})}function K(g){const h=parseInt(g.target.value);if(isNaN(h))return;const X={damage:Math.max(0,h)};r.entity.type==="player"?z(X):c()(r.entity.instanceId,X)}function k(g){const h=parseInt(g.target.value);if(isNaN(h))return;const j=Math.max(0,h);let X=e(v);j<e(v)&&(X=j);const w={currentHealth:j,damage:X};r.entity.type==="player"?z(w):c()(r.entity.instanceId,w)}function D(){const g=!r.entity.acted;r.entity.type==="player"?z({acted:g}):c()(r.entity.instanceId,{acted:g})}function R(){r.entity.type==="player"&&z({initiative:!r.entity.initiative})}function F(g){const h=r.entity.afflictions||[],X={afflictions:h.includes(g)?h.filter(w=>w!==g):[...h,g]};r.entity.type==="player"?z(X):c()(r.entity.instanceId,X)}const Y=["Blinded","Confused","Controlled","Cursed","Deafened","Frightened","Held","Impaired","Incapacitated","On Fire","Poisoned","Prone","Slowed","Stunned","Unconscious","Vulnerable","Weakened"];var ce=Qr(),ne=a(ce);{var ie=g=>{var h=Sr();o(g,h)};N(ne,g=>{e(p)&&r.entity.initiative&&g(ie)})}var G=i(ne,2),V=a(G);V.__click=D;var he=a(V);{var H=g=>{lr(g,{size:24,class:"animate-pulse"})},Pe=g=>{var h=Ae(),j=ve(h);{var X=C=>{yr(C,{size:24})},w=C=>{Aa(C,{size:24})};N(j,C=>{r.entity.acted?C(X):C(w,!1)},!0)}o(g,h)};N(he,g=>{e($)?g(H):g(Pe,!1)})}t(V);var Be=i(V,2),Te=a(Be),Ie=a(Te),dt=a(Ie,!0);t(Ie);var lt=i(Ie,2);{var Ze=g=>{var h=Ir(),j=a(h);t(h),T(()=>x(j,`Dif ${r.entity.difficulty??""}`)),o(g,h)};N(lt,g=>{e(p)||g(Ze)})}t(Te);var et=i(Te,2),ze=a(et),oe=i(ze,2);{var Ue=g=>{var h=Rr();T(()=>{$e(h,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10 ${e($)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":e(B)>=80?"bg-gradient-to-r from-red-600 to-rose-500":e(E)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),tr(h,`width: ${e(B)??""}%`)}),o(g,h)};N(oe,g=>{e(B)>0&&g(Ue)})}var Ke=i(oe,2);{var Ge=g=>{var h=jr();o(g,h)};N(Ke,g=>{e(v)===0&&g(Ge)})}var J=i(Ke,2),We=a(J),Xe=a(We);{var ht=g=>{var h=sa("INCAPACITADO");o(g,h)},tt=g=>{var h=Ae(),j=ve(h);{var X=C=>{var P=sa("FERIDO");o(C,P)},w=C=>{var P=Ae(),re=ve(P);{var ee=q=>{var de=sa("SAUDÁVEL");o(q,de)},Z=q=>{var de=sa();T(()=>x(de,`${e(v)??""} DANO`)),o(q,de)};N(re,q=>{e(v)===0?q(ee):q(Z,!1)},!0)}o(C,P)};N(j,C=>{e(E)?C(X):C(w,!1)},!0)}o(g,h)};N(Xe,g=>{e($)?g(ht):g(tt,!1)})}t(We),t(J),t(et);var ft=i(et,2),pt=a(ft);ge(pt,17,()=>r.entity.afflictions||[],qe,(g,h)=>{var j=Ar();j.__click=()=>F(e(h));var X=a(j),w=i(X);aa(w,{size:8}),t(j),T(()=>{Dt(j,"title",`Remover ${e(h)??""}`),x(X,`${e(h)??""} `)}),o(g,j)});var vt=i(pt,2),M=a(vt),O=a(M);Bt(O,{size:8}),_e(),t(M);var Q=i(M,2);ge(Q,21,()=>Y,qe,(g,h)=>{var j=Tr();j.__click=()=>F(e(h));var X=a(j,!0);t(j),T(()=>x(X,e(h))),o(g,j)}),t(Q),t(vt),t(ft),t(Be);var Ee=i(Be,2),Me=a(Ee),Fe=i(a(Me),2),Ne=a(Fe,!0);t(Fe),t(Me);var Ve=i(Me,2),xt=i(a(Ve),2);kt(xt),xt.__input=K,t(Ve);var gt=i(Ve,2),Nt=i(a(gt),2);kt(Nt),Nt.__input=k,t(gt);var at=i(gt,2),jt=i(a(at),2),rt=a(jt,!0);t(jt),t(at),t(Ee);var At=i(Ee,2),He=a(At);{var mt=g=>{var h=Dr();h.__click=R;var j=a(h);Cr(j,{size:16}),t(h),T(()=>$e(h,1,`p-1.5 rounded transition-colors ${r.entity.initiative?"bg-yellow-900/30 text-yellow-400 border border-yellow-700":"bg-slate-800 text-slate-500 hover:text-white"}`)),o(g,h)},Qe=g=>{var h=Pr(),j=ve(h);j.__click=()=>L(U,!e(U));var X=a(j);{var w=ee=>{hr(ee,{size:16})},C=ee=>{_r(ee,{size:16})};N(X,ee=>{e(U)?ee(w):ee(C,!1)})}t(j);var P=i(j,2);P.__click=()=>s()(r.entity.instanceId);var re=a(P);aa(re,{size:16}),t(P),o(g,h)};N(He,g=>{e(p)?g(mt):g(Qe,!1)})}t(At),t(G);var _t=i(G,2);{var Pt=g=>{var h=Wr(),j=a(h),X=a(j),w=i(a(X)),C=a(w,!0);t(w),t(X);var P=i(X,2),re=i(a(P)),ee=a(re,!0);t(re),t(P);var Z=i(P,2),q=i(a(Z)),de=a(q,!0);t(q),t(Z),t(j);var pe=i(j,2),ye=a(pe);{var ct=se=>{var Ce=Hr(),Ye=i(a(Ce),2);ge(Ye,17,()=>r.entity.traits,qe,(it,Re)=>{var Oe=Fr(),me=a(Oe),Le=a(me);t(me);var st=i(me,2),wt=a(st,!0);t(st),t(Oe),T(()=>{x(Le,`${e(Re).name??""}:`),x(wt,e(Re).desc)}),o(it,Oe)}),t(Ce),o(se,Ce)};N(ye,se=>{r.entity.traits&&se(ct)})}var Ot=i(ye,2);{var Je=se=>{var Ce=Vr(),Ye=i(a(Ce),2);ge(Ye,17,()=>r.entity.actions,qe,(it,Re)=>{var Oe=Br(),me=a(Oe),Le=a(me);t(me);var st=i(me,2),wt=a(st,!0);t(st),t(Oe),T(()=>{x(Le,`${e(Re).name??""}:`),x(wt,e(Re).desc)}),o(it,Oe)}),t(Ce),o(se,Ce)};N(Ot,se=>{r.entity.actions&&se(Je)})}var ut=i(Ot,2);{var De=se=>{var Ce=qr(),Ye=i(a(Ce),2);ge(Ye,17,()=>r.entity.reactions,qe,(it,Re)=>{var Oe=Lr(),me=a(Oe),Le=a(me);t(me);var st=i(me,2),wt=a(st,!0);t(st),t(Oe),T(()=>{x(Le,`${e(Re).name??""}:`),x(wt,e(Re).desc)}),o(it,Oe)}),t(Ce),o(se,Ce)};N(ut,se=>{r.entity.reactions&&se(De)})}var St=i(ut,2);{var yt=se=>{var Ce=Gr(),Ye=i(a(Ce),2);ge(Ye,17,()=>r.entity.endOfRound,qe,(it,Re)=>{var Oe=Ur(),me=a(Oe),Le=a(me);t(me);var st=i(me,2),wt=a(st,!0);t(st),t(Oe),T(()=>{x(Le,`${e(Re).name??""}:`),x(wt,e(Re).desc)}),o(it,Oe)}),t(Ce),o(se,Ce)};N(St,se=>{r.entity.endOfRound&&se(yt)})}t(pe),t(h),T(()=>{x(C,r.entity.size||1),x(ee,r.entity.speed||10),x(de,r.entity.senses||"-")}),mr(3,h,()=>Or),o(g,h)};N(_t,g=>{!e(p)&&e(U)&&g(Pt)})}t(ce),T(()=>{$e(ce,1,`bg-slate-900 border rounded-xl p-3 relative transition-all ${r.entity.acted?"opacity-60 border-slate-800":e(p)?"border-indigo-500/30 shadow-md shadow-indigo-900/10":"border-red-900/50 shadow-md shadow-red-900/10"} ${e($)?"ring-2 ring-red-600 bg-red-950/20":""}`),$e(V,1,`w-12 h-12 rounded-lg flex items-center justify-center border-2 transition-all shadow-lg ${e($)?"bg-red-900/20 border-red-600 text-red-500":r.entity.acted?"bg-slate-800 border-slate-700 text-slate-500":e(p)?"bg-indigo-600 hover:bg-indigo-500 border-indigo-400 text-white":"bg-red-900/50 hover:bg-red-800 border-red-700 text-red-200"}`),Dt(V,"title",r.entity.acted?"Já agiu":"Agir"),Dt(V,"aria-label",r.entity.acted?"Já agiu":"Agir"),$e(Ie,1,`font-bold text-lg ${e(p)?"text-white":"text-red-200"}`),x(dt,r.entity.name),$e(ze,1,`absolute inset-0 ${e(v)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),$e(We,1,`text-[11px] font-black uppercase tracking-wider drop-shadow-md ${e($)||e(E)?"text-white":e(v)===0?"text-emerald-300":"text-white/90"}`),x(Ne,r.entity.defense||10),fa(xt,e(v)),fa(Nt,e(S)),x(rt,e(u))}),o(l,ce),Gt()}Wt(["click","input"]);function Zr(l){const r=l-1;return r*r*r+1}function Kr(l,{from:r,to:c},_={}){var{delay:s=0,duration:p=ie=>Math.sqrt(ie)*120,easing:v=Zr}=_,u=getComputedStyle(l),S=u.transform==="none"?"":u.transform,[$,E]=u.transformOrigin.split(" ").map(parseFloat);$/=l.clientWidth,E/=l.clientHeight;var B=Xr(l),U=l.clientWidth/c.width/B,z=l.clientHeight/c.height/B,K=r.left+r.width*$,k=r.top+r.height*E,D=c.left+c.width*$,R=c.top+c.height*E,F=(K-D)*U,Y=(k-R)*z,ce=r.width/c.width,ne=r.height/c.height;return{delay:s,duration:typeof p=="function"?p(Math.sqrt(F*F+Y*Y)):p,easing:v,css:(ie,G)=>{var V=G*F,he=G*Y,H=ie+G*ce,Pe=ie+G*ne;return`transform: ${S} translate(${V}px, ${he}px) scale(${H}, ${Pe});`}}}function Xr(l){if("currentCSSZoom"in l)return l.currentCSSZoom;for(var r=l,c=1;r!==null;)c*=+getComputedStyle(r).zoom,r=r.parentElement;return c}function Yr(l,r=1,c=0){const _=[];let s=0;for(let S=0;S<r;S++){const $=Math.floor(Math.random()*l)+1;_.push($),s+=$}let p=`${r}d${l}`,v=[],u=0;if(c!==0)if(l===20){const S=Math.abs(c);for(let E=0;E<S;E++)v.push(Math.floor(Math.random()*6)+1);const $=Math.max(...v);c>0?(u=$,s+=$,p+=` + ${$} [Boon]`):(u=-$,s-=$,p+=` - ${$} [Bane]`)}else u=c,s+=c,p+=c>0?` + ${c}`:` - ${Math.abs(c)}`;return{total:s,results:_,bonusRolls:v,formula:p,crit:l===20&&_.includes(20),modifierTotal:u}}var ei=f('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),ti=f('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter">Novo pedido de entrada</div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),ai=f('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),ri=f('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1">Sessão</span>'),ii=f('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all" title="Expulsar da Campanha"><!></button></div></div>'),si=f('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center">Nenhum jogador na sessão.</div>'),ni=f('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> Publicar Sessão</button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter">Torne sua sessão visível e obtenha o link de convite</p>',1),oi=f('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img alt="QR Code de Convite" class="w-24 h-24"/></div>'),di=f('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> Copiado!</div>'),li=f('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> Sessão Pública</span></div> <button class="text-slate-500 hover:text-white transition-colors p-1" title="Ver QR Code"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative" aria-label="Copiar link"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1">Retirar de área pública</button>',1),vi=f('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all"><div class="truncate flex-1 flex items-center gap-2"><!> <div><div class="text-sm font-bold text-white truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800"><!></button></div>'),ci=f('<div class="text-center text-slate-600 italic text-xs mt-4">Nenhum inimigo.</div>'),ui=f("<!> <!>",1),bi=f('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800"><!></button></div>'),fi=f('<div class="text-center text-slate-600 italic text-xs mt-4">Nenhum encontro.</div>'),pi=f("<!> <!>",1),xi=f('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> INICIAR COMBATE</button>'),gi=f('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400" title="Voltar Rodada"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase">Rodada</div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2" title="Próxima Rodada"><!> Próxima</button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10">Encerrar</button></div>'),mi=f("<div><!></div>"),_i=f('<div class="text-center text-slate-500 italic py-10">Combate vazio.</div>'),hi=f('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),yi=f('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),wi=f('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl">Fim da Rodada</h3> <p class="text-slate-400 text-sm">Resumo dos efeitos que ocorrem agora.</p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm">Cancelar</button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm">Avançar Rodada</button></div></div></div>'),ki=f('<div class="fixed inset-0 z-[60] flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl border border-slate-700 shadow-2xl p-6 w-full max-w-sm" role="dialog" aria-modal="true"><h3 class="font-bold text-white text-center text-lg mb-4"> </h3> <div class="flex items-center justify-center gap-6 mb-6"><button class="w-12 h-12 rounded-full bg-slate-700 hover:bg-red-500 text-white flex items-center justify-center"><!></button> <div> </div> <button class="w-12 h-12 rounded-full bg-slate-700 hover:bg-green-500 text-white flex items-center justify-center"><!></button></div> <div class="text-xs text-center text-slate-500 mb-6 uppercase font-bold"> </div> <button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 rounded-xl shadow-lg">ROLAR AGORA</button></div></div>'),Ci=f('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),$i=f('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold">Nenhum personagem disponível.</p> <p class="text-[10px] text-slate-600 mt-1">Todos os personagens da campanha já estão na sessão.</p></div>'),zi=f('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg">Gerenciar Sessão</h3> <p class="text-xs text-slate-400">Adicione personagens disponíveis à sessão.</p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Ei=f('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> Personagens <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col h-[400px]"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> Inimigos</button> <button><!> Encontros</button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"></div></div> <!> <div class="fixed bottom-6 left-1/2 -translate-x-1/2 bg-slate-900/90 backdrop-blur-md border border-slate-700 rounded-2xl p-2 flex items-center gap-2 shadow-2xl z-40 animate-in slide-in-from-bottom-4"><div class="px-3 border-r border-slate-700 flex items-center gap-2 text-slate-400 font-bold text-xs uppercase"><!> Quick</div> <button class="bg-slate-800 hover:bg-indigo-600 text-white font-bold w-10 h-10 rounded-xl flex items-center justify-center transition-all hover:-translate-y-1 shadow-lg">d20</button> <button class="bg-slate-800 hover:bg-indigo-600 text-white font-bold w-10 h-10 rounded-xl flex items-center justify-center transition-all hover:-translate-y-1 shadow-lg">d6</button> <button class="bg-slate-800 hover:bg-indigo-600 text-white font-bold w-10 h-10 rounded-xl flex items-center justify-center transition-all hover:-translate-y-1 shadow-lg text-xs">2d6</button> <button class="bg-slate-800 hover:bg-indigo-600 text-white font-bold w-10 h-10 rounded-xl flex items-center justify-center transition-all hover:-translate-y-1 shadow-lg text-xs">3d6</button></div> <!> <!> <!> <!>',1);function Mi(l,r){Ut(r,!0);const c=()=>Ct(Xa,"$liveCharacters",v),_=()=>Ct(pa,"$liveEnemies",v),s=()=>Ct(Ma,"$liveEncounters",v),p=()=>Ct(qt,"$isHistoryOpen",v),[v,u]=ra();let S=je(!1),$=je(!1),E=je(!1);const B={active:!1,round:1};let U=je("enemies"),z=je(!1),K=je(Vt([])),k=je(Vt({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));ha(()=>{if(r.campaign?.id){Qa(r.campaign.id,!0);const n=setInterval(()=>{const d=ot.get(r.campaign.id)||r.campaign;ba(r.campaign.id,{name:d.name,gmName:d.gmName||"Mestre"})},3e4);return()=>{clearInterval(n)}}});const D=xe(()=>typeof window<"u"?`${window.location.origin}/campaigns/${r.campaign?.id}/invite`:"");function R(){e(D)&&(navigator.clipboard.writeText(e(D)),L($,!0),setTimeout(()=>{L($,!1)},2e3))}let F=xe(()=>r.campaign?.sessionRoster||[]),Y=xe(()=>r.campaign?.combat||B),ce=xe(()=>r.campaign?.activeEnemies||[]),ne=xe(()=>r.campaign?.members||[]),ie=xe(()=>Array.from(new Set([...e(F),...e(ne).map(d=>d.id)])).map(d=>{const b=c().find(A=>A.id===d),y=e(ne).find(A=>A.id===d);return b&&y?{...b,...y,lastUpdate:y.lastUpdate}:b||y}).filter(Boolean)),G=xe(()=>e(ie).filter(n=>!n.campaignApproval||n.campaignApproval==="approved")),V=xe(()=>e(ie).filter(n=>n.campaignApproval==="pending")),he=xe(()=>c().filter(n=>!e(F).includes(n.id)&&!e(ne).some(d=>d.id===n.id)));function H(n){if(!r.campaign?.id)return;const b={...ot.get(r.campaign.id)||r.campaign,...n};ot.set(r.campaign.id,b),n.combat&&na(r.campaign.id,n.combat),(n.name||n.gmName)&&ba(r.campaign.id,{name:b.name,gmName:b.gmName})}function Pe(n){if(e(F).includes(n)){const d=e(F).filter(b=>b!==n);H({sessionRoster:d})}else{const d=[...e(F),n];H({sessionRoster:d})}}function Be(n){vt(n,{campaignApproval:"approved"}),da({id:n,campaignApproval:"approved"})}function Te(n){da({id:n,campaignApproval:"rejected",campaignId:null});const b=((ot.get(r.campaign.id)||r.campaign).members||[]).filter(y=>y.id!==n);H({members:b})}function Ie(n){const d=e(ie).find(b=>b.id===n);L(k,{isOpen:!0,title:"Remover da Campanha",message:`Deseja remover ${d?.name||"este personagem"} da campanha? Eles poderão entrar novamente através do link de convite.`,onConfirm:()=>{const b=ot.get(r.campaign.id)||r.campaign;da({id:n,campaignId:null});const y=(b.sessionRoster||[]).filter(m=>m!==n),A=(b.members||[]).filter(m=>m.id!==n),I=(b.activeEnemies||[]).filter(m=>m.type!=="player"||m.id!==n);H({sessionRoster:y,members:A,activeEnemies:I}),e(k).isOpen=!1}},!0)}function dt(n){const b=(ot.get(r.campaign.id)||r.campaign).activeEnemies||[],y={...n,instanceId:`e_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,damage:0,currentHealth:n.health,afflictions:[],acted:!1,initiative:!1};H({activeEnemies:[...b,y]})}function lt(n){const b=(ot.get(r.campaign.id)||r.campaign).activeEnemies||[];let y=[];n.enemies.forEach(A=>{const I=_().find(m=>m.id===A.enemyId);if(I)for(let m=0;m<A.count;m++)y.push({...I,instanceId:`e_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,damage:0,currentHealth:I.health,afflictions:[],acted:!1,initiative:!1})}),H({activeEnemies:[...b,...y]})}function Ze(){H({combat:{active:!0,round:1}}),na(r.campaign.id,{active:!0,round:1})}function et(){const n=e(ce).filter(d=>d.damage<(d.currentHealth??d.health)&&d.endOfRound&&d.endOfRound.length>0).map(d=>({name:d.name,effects:d.endOfRound}));if(n.length>0){L(K,n,!0),L(z,!0);return}ze()}function ze(){const n=ot.get(r.campaign.id)||r.campaign,d=(n.combat?.round||1)+1,b=(n.activeEnemies||[]).map(y=>({...y,acted:!1}));H({combat:{...n.combat,round:d},activeEnemies:b}),na(r.campaign.id,{active:!0,round:d}),L(z,!1)}function oe(n){H({combat:{active:!1,round:1}}),na(r.campaign.id,{active:!1,round:1})}function Ue(n){const d=ot.get(r.campaign.id)||r.campaign;H({activeEnemies:(d.activeEnemies||[]).filter(b=>b.instanceId!==n)})}function Ke(n,d){const b=ot.get(r.campaign.id)||r.campaign;H({activeEnemies:(b.activeEnemies||[]).map(y=>y.instanceId===n?{...y,...d}:y)})}function Ge(){const n=ot.get(r.campaign.id)||r.campaign,d=n.combat?.round||1;d>1&&H({combat:{...n.combat,round:d-1}})}let J=je(Vt({isOpen:!1,sides:20,count:1,modifier:0}));function We(n,d=1){L(J,{isOpen:!0,sides:n,count:d,modifier:0},!0)}function Xe(){ht(e(J).sides,e(J).count,e(J).modifier),e(J).isOpen=!1}function ht(n,d=1,b=0){const y=Yr(n,d,b);let A="";d>1&&(A+=`Dados: [${y.results.join(", ")}] `),y.bonusRolls?.length>0&&(A+=`Bonus Rolls: [${y.bonusRolls.join(", ")}] -> ${Math.abs(y.modifierTotal)}`),Za.addToHistory({source:"GM",charName:"Mestre",name:`${d}d${n} ${b?b>0?`+${b}`:b:""}`,description:A.trim()||null,total:y.total,formula:y.formula,crit:y.crit}),qt.set(!0)}let tt=je(Vt(Date.now()));ha(()=>{const n=setInterval(()=>{L(tt,Date.now(),!0)},1e4);return()=>clearInterval(n)});let ft=xe(()=>(()=>{const n=e(G).filter(m=>e(F).includes(m.id)),d=n.filter(m=>m&&m.initiative).map(m=>({...m,type:"player"})),b=e(ce).map(m=>({...m,type:"enemy"})),y=n.filter(m=>m&&!m.initiative).map(m=>({...m,type:"player"})),A=[...d,...b,...y],I=new Set;return A.filter(m=>{if(!m)return!1;const W=m.type==="player"?m.id:m.instanceId;return I.has(W)?!1:(I.add(W),!0)})})());function pt(n){return n.lastUpdate?e(tt)-n.lastUpdate<6e4:!1}function vt(n,d){const b=ot.get(r.campaign.id)||r.campaign,y=b.members||[],A=y.findIndex(ue=>ue.id===n);let I=y;A!==-1&&(I=[...y],I[A]={...I[A],...d});const m=b.activeEnemies||[],W=m.findIndex(ue=>ue.id===n&&ue.type==="player");let te=m;W!==-1&&(te=[...m],te[W]={...te[W],...d}),H({members:I,activeEnemies:te})}var M=Ei(),O=ve(M),Q=a(O),Ee=a(Q),Me=a(Ee),Fe=a(Me),Ne=a(Fe);Ja(Ne,{size:14,class:"text-indigo-500"});var Ve=i(Ne,2);{var xt=n=>{var d=ei(),b=a(d,!0);t(d),T(()=>x(b,e(G).length)),o(n,d)};N(Ve,n=>{e(G).length>0&&n(xt)})}t(Fe);var gt=i(Fe,2);gt.__click=()=>L(S,!e(S));var Nt=a(gt,!0);t(gt),t(Me);var at=i(Me,2);{var jt=n=>{var d=ai(),b=a(d),y=i(a(b),2),A=a(y);t(y),t(b);var I=i(b,2);ge(I,17,()=>e(V),m=>m.id,(m,W)=>{var te=ti(),ue=a(te),ae=a(ue),be=a(ae,!0);t(ae),_e(2),t(ue);var le=i(ue,2),fe=a(le);fe.__click=()=>Be(e(W).id);var Se=a(fe);ga(Se,{size:14}),t(fe);var we=i(fe,2);we.__click=()=>Te(e(W).id);var nt=a(we);Zt(nt,{size:14}),t(we),t(le),t(te),T(()=>x(be,e(W).name)),o(m,te)}),_e(2),t(d),T(()=>x(A,`Aguardando Aprovação (${e(V).length??""})`)),o(n,d)};N(at,n=>{e(V).length>0&&n(jt)})}var rt=i(at,2),At=a(rt),He=a(At);ge(He,17,()=>e(G),n=>n.id,(n,d)=>{const b=xe(()=>pt(e(d))),y=xe(()=>e(F).includes(e(d).id));var A=ii(),I=a(A),m=i(I,2),W=a(m),te=a(W,!0);t(W);var ue=i(W,2),ae=a(ue);{var be=ke=>{var Ft=ri();o(ke,Ft)};N(ae,ke=>{e(y)&&ke(be)})}var le=i(ae);t(ue),t(m);var fe=i(m,2),Se=a(fe);Se.__click=()=>Pe(e(d).id);var we=a(Se);{var nt=ke=>{ya(ke,{size:14})},Lt=ke=>{Bt(ke,{size:14})};N(we,ke=>{e(y)?ke(nt):ke(Lt,!1)})}t(Se);var Tt=i(Se,2);Tt.__click=()=>Ie(e(d).id);var bt=a(Tt);Zt(bt,{size:14}),t(Tt),t(fe),t(A),T(()=>{$e(A,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${e(b)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${e(b)||e(y)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),$e(I,1,`w-2 h-2 rounded-full ${e(b)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),$e(W,1,`font-bold text-sm ${e(b)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),x(te,e(d).name),x(le,` Lvl ${e(d).level??""} • ${e(d).ancestry??""}`),$e(Se,1,`p-1.5 rounded-lg transition-all ${e(y)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),Dt(Se,"title",e(y)?"Remover da Sessão":"Adicionar à Sessão")}),o(n,A)});var mt=i(He,2);{var Qe=n=>{var d=si();o(n,d)};N(mt,n=>{e(G).length===0&&n(Qe)})}t(At),t(rt);var _t=i(rt,2),Pt=a(_t);{var g=n=>{var d=ni(),b=ve(d);b.__click=()=>H({isPublished:!0});var y=a(b);vr(y,{size:14}),_e(),t(b),_e(2),o(n,d)},h=n=>{var d=li(),b=ve(d),y=a(b),A=a(y),I=a(A);Wa(I,{size:10,class:"animate-pulse"}),_e(),t(A),t(y);var m=i(y,2);m.__click=()=>L(E,!e(E));var W=a(m);Er(W,{size:14}),t(m),t(b);var te=i(b,2);{var ue=bt=>{var ke=oi(),Ft=a(ke);t(ke),T(Jt=>Dt(Ft,"src",Jt),[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(e(D))}`]),o(bt,ke)};N(te,bt=>{e(E)&&bt(ue)})}var ae=i(te,2),be=a(ae),le=a(be);le.__click=R;var fe=a(le,!0);t(le);var Se=i(le,2);Se.__click=R;var we=a(Se);{var nt=bt=>{var ke=di(),Ft=a(ke);ga(Ft,{size:10,class:"inline mr-1"}),_e(),t(ke),o(bt,ke)};N(we,bt=>{e($)&&bt(nt)})}var Lt=i(we,2);wr(Lt,{size:14}),t(Se),t(be),t(ae);var Tt=i(ae,2);Tt.__click=()=>H({isPublished:!1}),T(()=>x(fe,e(D))),o(n,d)};N(Pt,n=>{r.campaign?.isPublished?n(h,!1):n(g)})}t(_t),t(Ee);var j=i(Ee,2),X=a(j),w=a(X);w.__click=()=>L(U,"enemies");var C=a(w);la(C,{size:14}),_e(),t(w);var P=i(w,2);P.__click=()=>L(U,"encounters");var re=a(P);Ra(re,{size:14}),_e(),t(P),t(X);var ee=i(X,2),Z=a(ee);{var q=n=>{var d=ui(),b=ve(d);ge(b,1,_,I=>I.id,(I,m)=>{var W=vi(),te=a(W),ue=a(te);$r(ue,{size:12,class:"text-slate-600 cursor-grab"});var ae=i(ue,2),be=a(ae),le=a(be,!0);t(be);var fe=i(be,2),Se=a(fe);t(fe),t(ae),t(te);var we=i(te,2);we.__click=()=>dt(e(m));var nt=a(we);Bt(nt,{size:16}),t(we),t(W),T(()=>{x(le,e(m).name),x(Se,`Dif ${e(m).difficulty??""}`)}),o(I,W)});var y=i(b,2);{var A=I=>{var m=ci();o(I,m)};N(y,I=>{_().length===0&&I(A)})}o(n,d)},de=n=>{var d=pi(),b=ve(d);ge(b,1,s,I=>I.id,(I,m)=>{var W=bi(),te=a(W),ue=a(te),ae=a(ue,!0);t(ue);var be=i(ue,2),le=a(be);t(be),t(te);var fe=i(te,2);fe.__click=()=>lt(e(m));var Se=a(fe);Sa(Se,{size:14}),t(fe),t(W),T(we=>{x(ae,e(m).name),x(le,`${we??""} Inimigos`)},[()=>e(m).enemies?.reduce((we,nt)=>we+nt.count,0)||0]),o(I,W)});var y=i(b,2);{var A=I=>{var m=fi();o(I,m)};N(y,I=>{s().length===0&&I(A)})}o(n,d)};N(Z,n=>{e(U)==="enemies"?n(q):n(de,!1)})}t(ee),t(j),t(Q);var pe=i(Q,2),ye=a(pe),ct=a(ye),Ot=a(ct);{var Je=n=>{var d=xi();d.__click=Ze;var b=a(d);Aa(b,{size:20}),_e(),t(d),o(n,d)},ut=n=>{var d=gi(),b=a(d);b.__click=Ge;var y=a(b);Oa(y,{size:20}),t(b);var A=i(b,2),I=i(a(A)),m=a(I,!0);t(I),t(A);var W=i(A,2);W.__click=et;var te=a(W);Mr(te,{size:16}),_e(),t(W);var ue=i(W,4);ue.__click=()=>oe(),t(d),T(()=>x(m,e(Y).round)),o(n,d)};N(Ot,n=>{e(Y).active?n(ut,!1):n(Je)})}t(ct),t(ye);var De=i(ye,2),St=a(De);ge(St,25,()=>e(ft),n=>n.type==="player"?n.id:n.instanceId,(n,d)=>{var b=mi(),y=a(b);Jr(y,{get entity(){return e(d)},updateEnemy:Ke,removeFromCombat:Ue,updatePlayer:vt}),t(b),gr(b,()=>Kr,()=>({duration:300})),o(n,b)});var yt=i(St,2);{var se=n=>{var d=_i();o(n,d)};N(yt,n=>{e(ft).length===0&&n(se)})}t(De),t(pe),_e(2),t(O);var Ce=i(O,2);{var Ye=n=>{var d=wi();d.__click=ae=>{ae.target===ae.currentTarget&&L(z,!1)};var b=a(d),y=a(b),A=a(y),I=a(A);rr(I,{size:24}),t(A),_e(2),t(y);var m=i(y,2);ge(m,21,()=>e(K),qe,(ae,be)=>{var le=yi(),fe=a(le),Se=a(fe);la(Se,{size:14,class:"text-slate-500"});var we=i(Se);t(fe);var nt=i(fe,2);ge(nt,21,()=>e(be).effects,qe,(Lt,Tt)=>{var bt=hi(),ke=a(bt),Ft=a(ke);t(ke);var Jt=i(ke,2),Ta=a(Jt,!0);t(Jt),t(bt),T(()=>{x(Ft,`${e(Tt).name??""}:`),x(Ta,e(Tt).desc)}),o(Lt,bt)}),t(nt),t(le),T(()=>x(we,` ${e(be).name??""}`)),o(ae,le)}),t(m);var W=i(m,2),te=a(W);te.__click=()=>L(z,!1);var ue=i(te,2);ue.__click=ze,t(W),t(b),t(d),o(n,d)};N(Ce,n=>{e(z)&&n(Ye)})}var it=i(Ce,2),Re=a(it),Oe=a(Re);ar(Oe,{size:16}),_e(),t(Re);var me=i(Re,2);me.__click=()=>We(20);var Le=i(me,2);Le.__click=()=>We(6);var st=i(Le,2);st.__click=()=>We(6,2);var wt=i(st,2);wt.__click=()=>We(6,3),t(it);var Qt=i(it,2);{var Kt=n=>{var d=ki();d.__click=we=>{we.target===we.currentTarget&&(e(J).isOpen=!1)};var b=a(d),y=a(b),A=a(y);t(y);var I=i(y,2),m=a(I);m.__click=()=>e(J).modifier--;var W=a(m);ya(W,{size:24}),t(m);var te=i(m,2),ue=a(te);t(te);var ae=i(te,2);ae.__click=()=>e(J).modifier++;var be=a(ae);Bt(be,{size:24}),t(ae),t(I);var le=i(I,2),fe=a(le,!0);t(le);var Se=i(le,2);Se.__click=Xe,t(b),t(d),T(()=>{x(A,`Rolagem Rápida (${e(J).count??""}d${e(J).sides??""})`),$e(te,1,`text-4xl font-bold ${e(J).modifier>0?"text-green-400":e(J).modifier<0?"text-red-400":"text-slate-500"}`),x(ue,`${e(J).modifier>0?"+":""}${e(J).modifier??""}`),x(fe,e(J).sides===20?"Boons / Banes":"Modificador Fixo")}),o(n,d)};N(Qt,n=>{e(J).isOpen&&n(Kt)})}var Xt=i(Qt,2);{var Yt=n=>{var d=zi();d.__click=ae=>{ae.target===ae.currentTarget&&L(S,!1)};var b=a(d),y=a(b),A=i(a(y),2);A.__click=()=>L(S,!1);var I=a(A);aa(I,{size:16}),t(A),t(y);var m=i(y,2),W=a(m);ge(W,17,()=>e(he),qe,(ae,be)=>{var le=Ci();le.__click=()=>Pe(e(be).id);var fe=a(le),Se=a(fe,!0);t(fe);var we=i(fe,2),nt=a(we),Lt=a(nt,!0);t(nt);var Tt=i(nt,2),bt=a(Tt);t(Tt),t(we);var ke=i(we,2),Ft=a(ke);Bt(Ft,{size:16}),t(ke),t(le),T(Jt=>{x(Se,Jt),x(Lt,e(be).name),x(bt,`Nível ${e(be).level??""} • ${e(be).ancestry??""}`)},[()=>e(be).name.charAt(0)]),o(ae,le)});var te=i(W,2);{var ue=ae=>{var be=$i(),le=a(be),fe=a(le);la(fe,{size:24}),t(le),_e(4),t(be),o(ae,be)};N(te,ae=>{e(he).length===0&&ae(ue)})}t(m),t(b),t(d),o(n,d)};N(Xt,n=>{e(S)&&n(Yt)})}var ia=i(Xt,2);Na(ia,{get isOpen(){return p()},onClose:()=>qt.set(!1)});var ea=i(ia,2);Ea(ea,{get isOpen(){return e(k).isOpen},get title(){return e(k).title},get message(){return e(k).message},get onConfirm(){return e(k).onConfirm},onCancel:()=>e(k).isOpen=!1}),T(()=>{x(Nt,e(S)?"Fechar":"Adicionar"),$e(w,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${e(U)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),$e(P,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${e(U)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`)}),o(l,M),Gt(),u()}Wt(["click"]);var Ni=f('<div class="space-y-4"><div><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1">Nome</label><input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1">Dificuldade</label><input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1">Tamanho (Size)</label><input id="enemy-size" type="number" step="0.5" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1">Descrição</label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors" placeholder="Breve descrição ou notas sobre a criatura..."></textarea></div> <div class="grid grid-cols-1"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1">Speed</label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div></div>'),Oi=f('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Si=f('<div class="space-y-6"><div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3">Atributos Principais</h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1">Sentidos</label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm" placeholder="Ex: Visão no escuro"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1">Idiomas</label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm" placeholder="Ex: Comum, Élfico"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1">Imunidades</label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm" placeholder="Ex: Fogo, Veneno"/></div></div></div>'),Ii=f('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none" placeholder="Nome"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2" placeholder="Descrição..."></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Ri=f('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded">Vazio</div>'),ji=f('<div><div class="flex justify-between items-center mb-3"><h4> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> Adicionar</button></div> <div class="space-y-3"><!> <!></div></div>'),Ai=f('<div class="space-y-6"></div>'),Ti=f('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),Di=f('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase">Sentidos:</span> <span class="text-white"> </span></div>'),Pi=f('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase">Idiomas:</span> <span class="text-white"> </span></div>'),Fi=f('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase">Imunidades:</span> <span class="text-white"> </span></div>'),Hi=f('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Bi=f('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider">Traços</h4> <!></div>'),Vi=f('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Li=f('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider">Ações</h4> <!></div>'),qi=f('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Ui=f('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider">Reações</h4> <!></div>'),Gi=f('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Wi=f('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider">Fim da Rodada</h4> <!></div>'),Qi=f('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar modal" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-6xl h-[90vh] border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><h3 id="modal-title" class="font-bold text-white text-lg">Editor de Inimigo</h3> <button class="lg:hidden text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50"><button>Geral</button> <button>Atributos</button> <button>Habilidades</button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3"><button class="px-6 py-2 rounded bg-slate-800 hover:bg-slate-700 text-white font-bold transition-colors">Cancelar</button> <button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> Salvar</button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> Pré-visualização</h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide"> </h2> <div class="h-1 w-20 bg-red-600 mb-4 rounded-full"></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]">Defesa</span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]">Vida</span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]">Tamanho</span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]">Speed</span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div></div></div></div></div>');function Ji(l,r){Ut(r,!0);let c=Rt(r,"isOpen",3,!1),_=Rt(r,"initialData",3,"{}"),s=je(Vt(v())),p=je("stats");function v(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}$a(()=>{if(c()&&_())try{const z=JSON.parse(_());Object.keys(z).length===0?L(s,v(),!0):L(s,{...v(),...z},!0)}catch{L(s,v(),!0)}});function u(z){e(s)[z]=[...e(s)[z],{name:"",desc:""}]}function S(z,K){e(s)[z]=e(s)[z].filter((k,D)=>D!==K)}function $(z){z.target===z.currentTarget&&r.onClose()}var E=Ae(),B=ve(E);{var U=z=>{var K=Qi();K.__click=$;var k=a(K),D=a(k),R=a(D),F=i(a(R),2);F.__click=function(...w){r.onClose?.apply(this,w)};var Y=a(F);aa(Y,{size:20}),t(F),t(R);var ce=i(R,2),ne=a(ce);ne.__click=()=>L(p,"stats");var ie=i(ne,2);ie.__click=()=>L(p,"attributes");var G=i(ie,2);G.__click=()=>L(p,"abilities"),t(ce);var V=i(ce,2),he=a(V);{var H=w=>{var C=Ni(),P=a(C),re=i(a(P));kt(re),t(P);var ee=i(P,2),Z=a(ee),q=i(a(Z));kt(q),t(Z);var de=i(Z,2),pe=i(a(de));kt(pe),t(de),t(ee);var ye=i(ee,2),ct=i(a(ye),2);xa(ct),t(ye);var Ot=i(ye,2),Je=a(Ot),ut=i(a(Je));kt(ut),t(Je),t(Ot),t(C),It(re,()=>e(s).name,De=>e(s).name=De),It(q,()=>e(s).difficulty,De=>e(s).difficulty=De),It(pe,()=>e(s).size,De=>e(s).size=De),It(ct,()=>e(s).description,De=>e(s).description=De),It(ut,()=>e(s).speed,De=>e(s).speed=De),o(w,C)},Pe=w=>{var C=Ae(),P=ve(C);{var re=Z=>{var q=Si(),de=a(q),pe=i(a(de),2);ge(pe,20,()=>["str","agi","int","wil"],qe,(yt,se)=>{var Ce=Oi(),Ye=a(Ce),it=a(Ye,!0);t(Ye);var Re=i(Ye,2);kt(Re);var Oe=i(Re,2),me=a(Oe);t(Oe),t(Ce),T(()=>{Dt(Ye,"for",`attr-${se??""}`),x(it,se),Dt(Re,"id",`attr-${se??""}`),$e(Oe,1,`text-xs font-bold ${e(s).stats[se]-10>=0?"text-green-500":"text-red-500"}`),x(me,`${e(s).stats[se]-10>=0?"+":""}${e(s).stats[se]-10}`)}),It(Re,()=>e(s).stats[se],Le=>e(s).stats[se]=Le),o(yt,Ce)}),t(pe),t(de);var ye=i(de,2),ct=a(ye),Ot=i(a(ct));kt(Ot),t(ct);var Je=i(ct,2),ut=i(a(Je));kt(ut),t(Je);var De=i(Je,2),St=i(a(De));kt(St),t(De),t(ye),t(q),It(Ot,()=>e(s).senses,yt=>e(s).senses=yt),It(ut,()=>e(s).languages,yt=>e(s).languages=yt),It(St,()=>e(s).immune,yt=>e(s).immune=yt),o(Z,q)},ee=Z=>{var q=Ae(),de=ve(q);{var pe=ye=>{var ct=Ai();ge(ct,20,()=>[{key:"traits",title:"Traços (Traits)",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",title:"Ações",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",title:"Reações",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",title:"Fim da Rodada",color:"text-yellow-400",border:"border-yellow-500/30"}],qe,(Ot,Je)=>{var ut=ji(),De=a(ut),St=a(De),yt=a(St,!0);t(St);var se=i(St,2);se.__click=()=>u(Je.key);var Ce=a(se);Bt(Ce,{size:12}),_e(),t(se),t(De);var Ye=i(De,2),it=a(Ye);ge(it,17,()=>e(s)[Je.key],qe,(me,Le,st)=>{var wt=Ii(),Qt=a(wt),Kt=a(Qt);kt(Kt);var Xt=i(Kt,2);xa(Xt),t(Qt);var Yt=i(Qt,2);Yt.__click=()=>S(Je.key,st);var ia=a(Yt);Zt(ia,{size:16}),t(Yt),t(wt),It(Kt,()=>e(Le).name,ea=>e(Le).name=ea),It(Xt,()=>e(Le).desc,ea=>e(Le).desc=ea),o(me,wt)});var Re=i(it,2);{var Oe=me=>{var Le=Ri();o(me,Le)};N(Re,me=>{e(s)[Je.key].length===0&&me(Oe)})}t(Ye),t(ut),T(()=>{$e(ut,1,`p-4 bg-slate-900 rounded border ${Je.border??""}`),$e(St,1,`font-bold text-sm uppercase ${Je.color??""}`),x(yt,Je.title)}),o(Ot,ut)}),t(ct),o(ye,ct)};N(de,ye=>{e(p)==="abilities"&&ye(pe)},!0)}o(Z,q)};N(P,Z=>{e(p)==="attributes"?Z(re):Z(ee,!1)},!0)}o(w,C)};N(he,w=>{e(p)==="stats"?w(H):w(Pe,!1)})}t(V);var Be=i(V,2),Te=a(Be);Te.__click=function(...w){r.onClose?.apply(this,w)};var Ie=i(Te,2);Ie.__click=()=>r.onSave(e(s));var dt=a(Ie);ja(dt,{size:18}),_e(),t(Ie),t(Be),t(D);var lt=i(D,2),Ze=a(lt),et=a(Ze),ze=a(et);kr(ze,{size:14}),_e(),t(et),t(Ze);var oe=i(Ze,2),Ue=a(oe),Ke=a(Ue),Ge=a(Ke);t(Ke);var J=i(Ke,2),We=a(J,!0);t(J);var Xe=i(J,4),ht=a(Xe),tt=i(a(ht),2),ft=a(tt,!0);t(tt),t(ht);var pt=i(ht,2),vt=i(a(pt),2),M=a(vt,!0);t(vt),t(pt);var O=i(pt,2),Q=i(a(O),2),Ee=a(Q,!0);t(Q),t(O);var Me=i(O,2),Fe=i(a(Me),2),Ne=a(Fe,!0);t(Fe),t(Me),t(Xe);var Ve=i(Xe,2);ge(Ve,20,()=>["str","agi","int","wil"],qe,(w,C)=>{var P=Ti(),re=a(P),ee=a(re,!0);t(re);var Z=i(re,2),q=a(Z),de=i(q),pe=a(de);t(de),t(Z),t(P),T(()=>{x(ee,C),x(q,`${e(s).stats[C]??""} `),$e(de,1,`text-xs ${e(s).stats[C]-10>=0?"text-green-500":"text-red-500"}`),x(pe,`(${e(s).stats[C]-10>=0?"+":""}${e(s).stats[C]-10})`)}),o(w,P)}),t(Ve);var xt=i(Ve,2),gt=a(xt);{var Nt=w=>{var C=Di(),P=i(a(C),2),re=a(P,!0);t(P),t(C),T(()=>x(re,e(s).senses)),o(w,C)};N(gt,w=>{e(s).senses&&w(Nt)})}var at=i(gt,2);{var jt=w=>{var C=Pi(),P=i(a(C),2),re=a(P,!0);t(P),t(C),T(()=>x(re,e(s).languages)),o(w,C)};N(at,w=>{e(s).languages&&w(jt)})}var rt=i(at,2);{var At=w=>{var C=Fi(),P=i(a(C),2),re=a(P,!0);t(P),t(C),T(()=>x(re,e(s).immune)),o(w,C)};N(rt,w=>{e(s).immune&&w(At)})}t(xt);var He=i(xt,2),mt=a(He);{var Qe=w=>{var C=Bi(),P=i(a(C),2);ge(P,17,()=>e(s).traits,qe,(re,ee)=>{var Z=Hi(),q=a(Z),de=a(q);t(q);var pe=i(q,2),ye=a(pe,!0);t(pe),t(Z),T(()=>{x(de,`${e(ee).name??""}:`),x(ye,e(ee).desc)}),o(re,Z)}),t(C),o(w,C)};N(mt,w=>{e(s).traits.length>0&&w(Qe)})}var _t=i(mt,2);{var Pt=w=>{var C=Li(),P=i(a(C),2);ge(P,17,()=>e(s).actions,qe,(re,ee)=>{var Z=Vi(),q=a(Z),de=a(q);t(q);var pe=i(q,2),ye=a(pe,!0);t(pe),t(Z),T(()=>{x(de,`${e(ee).name??""}:`),x(ye,e(ee).desc)}),o(re,Z)}),t(C),o(w,C)};N(_t,w=>{e(s).actions.length>0&&w(Pt)})}var g=i(_t,2);{var h=w=>{var C=Ui(),P=i(a(C),2);ge(P,17,()=>e(s).reactions,qe,(re,ee)=>{var Z=qi(),q=a(Z),de=a(q);t(q);var pe=i(q,2),ye=a(pe,!0);t(pe),t(Z),T(()=>{x(de,`${e(ee).name??""}:`),x(ye,e(ee).desc)}),o(re,Z)}),t(C),o(w,C)};N(g,w=>{e(s).reactions.length>0&&w(h)})}var j=i(g,2);{var X=w=>{var C=Wi(),P=i(a(C),2);ge(P,17,()=>e(s).endOfRound,qe,(re,ee)=>{var Z=Gi(),q=a(Z),de=a(q);t(q);var pe=i(q,2),ye=a(pe,!0);t(pe),t(Z),T(()=>{x(de,`${e(ee).name??""}:`),x(ye,e(ee).desc)}),o(re,Z)}),t(C),o(w,C)};N(j,w=>{e(s).endOfRound.length>0&&w(X)})}t(He),t(Ue),t(oe),t(lt),t(k),t(K),T(()=>{$e(ne,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${e(p)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),$e(ie,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${e(p)==="attributes"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),$e(G,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${e(p)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),x(Ge,`Dificuldade ${e(s).difficulty??""}`),x(We,e(s).name||"Inimigo"),x(ft,e(s).defense),x(M,e(s).health),x(Ee,e(s).size),x(Ne,e(s).speed)}),o(z,K)};N(B,z=>{c()&&z(U)})}o(l,E),Gt()}Wt(["click"]);var Zi=f('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),Ki=f('<div class="text-center text-slate-600 italic text-sm py-4">Nenhum inimigo adicionado.</div>'),Xi=f('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),Yi=f('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white">Criar/Editar Encontro</h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1">Nome do Encontro</label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500" placeholder="Ex: Emboscada na Cripta"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2">Inimigos no Encontro</h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2">Adicionar Inimigos</h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold">Cancelar</button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> Salvar Encontro</button></div></div></div>');function es(l,r){Ut(r,!0);const c=()=>Ct(pa,"$liveEnemies",_),[_,s]=ra();let p=Rt(r,"isOpen",3,!1),v=Rt(r,"initialData",3,"{}"),u=je(Vt({name:"",enemies:[]}));$a(()=>{if(p()&&v())try{const k=JSON.parse(v());L(u,{name:k.name||"",enemies:k.enemies||[]},!0)}catch{L(u,{name:"",enemies:[]},!0)}});function S(k){e(u).enemies.find(R=>R.enemyId===k)?e(u).enemies=e(u).enemies.map(R=>R.enemyId===k?{...R,count:R.count+1}:R):e(u).enemies=[...e(u).enemies,{enemyId:k,count:1}]}function $(k){e(u).enemies=e(u).enemies.filter((D,R)=>R!==k)}function E(k,D){const R=Math.max(1,parseInt(D)||1);e(u).enemies[k].count=R}function B(k){k.target===k.currentTarget&&r.onClose()}var U=Ae(),z=ve(U);{var K=k=>{var D=Yi();D.__click=B;var R=a(D),F=a(R),Y=i(a(F),2);Y.__click=function(...oe){r.onClose?.apply(this,oe)};var ce=a(Y);aa(ce,{size:20}),t(Y),t(F);var ne=i(F,2),ie=a(ne),G=i(a(ie),2);kt(G),t(ie),t(ne);var V=i(ne,2),he=a(V),H=i(a(he),2),Pe=a(H);ge(Pe,17,()=>e(u).enemies,qe,(oe,Ue,Ke)=>{const Ge=xe(()=>c().find(Q=>Q.id===e(Ue).enemyId));var J=Zi(),We=a(J),Xe=a(We),ht=a(Xe,!0);t(Xe);var tt=i(Xe,2),ft=a(tt);t(tt),t(We);var pt=i(We,2),vt=a(pt);kt(vt),vt.__input=Q=>E(Ke,Q.target.value);var M=i(vt,2);M.__click=()=>$(Ke);var O=a(M);Zt(O,{size:16}),t(M),t(pt),t(J),T(()=>{x(ht,e(Ge)?e(Ge).name:"Desconhecido"),x(ft,`Dif ${(e(Ge)?e(Ge).difficulty:"?")??""}`),fa(vt,e(Ue).count)}),o(oe,J)});var Be=i(Pe,2);{var Te=oe=>{var Ue=Ki();o(oe,Ue)};N(Be,oe=>{e(u).enemies.length===0&&oe(Te)})}t(H),t(he);var Ie=i(he,2),dt=i(a(Ie),2);ge(dt,5,c,oe=>oe.id,(oe,Ue)=>{var Ke=Xi(),Ge=a(Ke),J=a(Ge),We=a(J,!0);t(J);var Xe=i(J,2),ht=a(Xe);t(Xe),t(Ge);var tt=i(Ge,2);tt.__click=()=>S(e(Ue).id);var ft=a(tt);Bt(ft,{size:16}),t(tt),t(Ke),T(()=>{x(We,e(Ue).name),x(ht,`Dif ${e(Ue).difficulty??""}`)}),o(oe,Ke)}),t(dt),t(Ie),t(V);var lt=i(V,2),Ze=a(lt);Ze.__click=function(...oe){r.onClose?.apply(this,oe)};var et=i(Ze,2);et.__click=()=>r.onSave(e(u));var ze=a(et);ja(ze,{size:18}),_e(),t(et),t(lt),t(R),t(D),It(G,()=>e(u).name,oe=>e(u).name=oe),o(k,D)};N(z,k=>{p()&&k(K)})}o(l,U),Gt(),s()}Wt(["click","input"]);var ts=f('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),as=f('<div class="text-[10px] text-slate-600 italic">Vazio</div>'),rs=f('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="font-bold text-white text-base mb-2 group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> Iniciar</button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),is=f('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),ss=f('<div class="mb-4 flex-1"><p> </p> <!></div>'),ns=f('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic">Sem descrição.</div>'),os=f('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all">Editar</button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),ds=f('<div class="text-center text-slate-500 italic col-span-3">Nenhum inimigo cadastrado.</div>'),ls=f('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> Encontros Prontos</h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm">Novo Encontro</span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> Biblioteca de Inimigos</h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm">Novo Inimigo</span></button> <!> <!></div> <!> <!> <!></div>');function vs(l,r){Ut(r,!0);const c=()=>Ct(pa,"$liveEnemies",p),_=()=>Ct(Ma,"$liveEncounters",p),s=()=>Ct(za,"$page",p),[p,v]=ra();let u=je(!1),S=je(null),$=je("{}"),E=je(!1),B=je(null),U=je("{}"),z=je(Vt({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function K(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function k(M=null){L(S,M?M.id:null,!0),L($,JSON.stringify(M||K()),!0),L(u,!0)}let D=Vt(new Set);function R(M){D.has(M)?D.delete(M):D.add(M)}function F(M){const O=e(S)||wa();_a.set(O,{...M,id:O}),L(u,!1)}function Y(M){const O=c().find(Q=>Q.id===M);L(z,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${O?.name||"este inimigo"}"?`,onConfirm:()=>{_a.delete(M),e(z).isOpen=!1}},!0)}function ce(M=null){L(B,M?M.id:null,!0),L(U,JSON.stringify(M||{name:"",enemies:[]}),!0),L(E,!0)}function ne(M){const O=e(B)||wa();ua.set(O,{...M,id:O}),L(E,!1)}function ie(M){const O=_().find(Q=>Q.id===M);L(z,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${O?.name||"este encontro"}"?`,onConfirm:()=>{ua.delete(M),e(z).isOpen=!1}},!0)}function G(M){const O=s().params.id;if(!O||!ot.has(O))return;const Q=ot.get(O),Ee=Q.activeEnemies||[];let Me=[];M.enemies.forEach(Fe=>{const Ne=c().find(Ve=>Ve.id===Fe.enemyId);if(Ne)for(let Ve=0;Ve<Fe.count;Ve++)Me.push({...Ne,instanceId:`e_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,damage:0,currentHealth:Ne.health,afflictions:[],acted:!1,initiative:!1})}),ot.set(O,{...Q,activeEnemies:[...Ee,...Me]})}function V(M,O){M.dataTransfer.setData("text/plain",O.id),M.dataTransfer.effectAllowed="copy"}function he(M){return M.preventDefault(),!1}function H(M,O){M.preventDefault();const Q=M.dataTransfer.getData("text/plain");if(!Q)return;const Ee=O.enemies||[],Me=Ee.find(Ne=>Ne.enemyId===Q);let Fe;Me?Fe=Ee.map(Ne=>Ne.enemyId===Q?{...Ne,count:Ne.count+1}:Ne):Fe=[...Ee,{enemyId:Q,count:1}],ua.set(O.id,{...O,enemies:Fe})}var Pe=ls(),Be=a(Pe),Te=a(Be),Ie=a(Te),dt=a(Ie);Ra(dt,{size:16}),_e(),t(Ie),t(Te);var lt=i(Te,2),Ze=a(lt);Ze.__click=()=>ce();var et=a(Ze);Bt(et,{size:28,class:"group-hover:scale-110 transition-transform"}),_e(2),t(Ze);var ze=i(Ze,2);ge(ze,1,_,M=>M.id,(M,O)=>{var Q=rs(),Ee=a(Q),Me=a(Ee),Fe=a(Me,!0);t(Me);var Ne=i(Me,2),Ve=a(Ne);ge(Ve,17,()=>e(O).enemies||[],qe,(Qe,_t)=>{const Pt=xe(()=>c().find(C=>C.id===e(_t).enemyId));var g=ts(),h=a(g),j=a(h);t(h);var X=i(h,2),w=a(X,!0);t(X),t(g),T(()=>{x(j,`${e(_t).count??""}x`),x(w,e(Pt)?e(Pt).name:"...")}),o(Qe,g)});var xt=i(Ve,2);{var gt=Qe=>{var _t=as();o(Qe,_t)};N(xt,Qe=>{e(O).enemies?.length||Qe(gt)})}t(Ne),t(Ee);var Nt=i(Ee,2),at=a(Nt);at.__click=()=>G(e(O));var jt=a(at);Sa(jt,{size:12,fill:"currentColor"}),_e(),t(at);var rt=i(at,2);rt.__click=()=>ce(e(O));var At=a(rt);dr(At,{size:14}),t(rt);var He=i(rt,2);He.__click=()=>ie(e(O).id);var mt=a(He);Zt(mt,{size:14}),t(He),t(Nt),t(Q),T(()=>{Dt(Q,"aria-label",`Encontro ${e(O).name??""}`),x(Fe,e(O).name)}),ca("dragover",Q,he),ca("drop",Q,Qe=>H(Qe,e(O))),o(M,Q)}),t(lt),t(Be);var oe=i(Be,2),Ue=a(oe),Ke=a(Ue);la(Ke,{size:16}),_e(),t(Ue),t(oe);var Ge=i(oe,2),J=a(Ge);J.__click=()=>k();var We=a(J);Bt(We,{size:32,class:"group-hover:scale-110 transition-transform"}),_e(2),t(J);var Xe=i(J,2);ge(Xe,1,c,M=>M.id,(M,O)=>{var Q=os(),Ee=a(Q),Me=a(Ee),Fe=a(Me,!0);t(Me);var Ne=i(Me,2),Ve=a(Ne);t(Ne),t(Ee);var xt=i(Ee,2);{var gt=He=>{var mt=ss(),Qe=a(mt),_t=a(Qe,!0);t(Qe);var Pt=i(Qe,2);{var g=h=>{var j=is();j.__click=()=>R(e(O).id);var X=a(j,!0);t(j),T(w=>x(X,w),[()=>D.has(e(O).id)?"Ver menos":"Ver mais..."]),o(h,j)};N(Pt,h=>{e(O).description.length>120&&h(g)})}t(mt),T(h=>{$e(Qe,1,`text-xs text-slate-400 leading-relaxed ${h??""}`),x(_t,e(O).description)},[()=>D.has(e(O).id)?"":"line-clamp-3"]),o(He,mt)},Nt=He=>{var mt=ns();o(He,mt)};N(xt,He=>{e(O).description?He(gt):He(Nt,!1)})}var at=i(xt,2),jt=a(at);jt.__click=()=>k(e(O));var rt=i(jt,2);rt.__click=()=>Y(e(O).id);var At=a(rt);Zt(At,{size:14}),t(rt),t(at),t(Q),T(()=>{x(Fe,e(O).name),x(Ve,`Nível ${e(O).difficulty??""}`)}),ca("dragstart",Q,He=>V(He,e(O))),o(M,Q)});var ht=i(Xe,2);{var tt=M=>{var O=ds();o(M,O)};N(ht,M=>{c().length===0&&M(tt)})}t(Ge);var ft=i(Ge,2);Ji(ft,{get isOpen(){return e(u)},get initialData(){return e($)},onClose:()=>L(u,!1),onSave:F});var pt=i(ft,2);es(pt,{get isOpen(){return e(E)},get initialData(){return e(U)},onClose:()=>L(E,!1),onSave:ne});var vt=i(pt,2);Ea(vt,{get isOpen(){return e(z).isOpen},get title(){return e(z).title},get message(){return e(z).message},get onConfirm(){return e(z).onConfirm},onCancel:()=>e(z).isOpen=!1}),t(Pe),o(l,Pe),Gt(),v()}Wt(["click"]);var cs=f('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),us=f('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-2 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group" aria-label="Voltar para Dashboard" title="Voltar para Dashboard"><!> <!></button> <div class="flex flex-col"><h1 class="text-sm sm:text-base font-bold text-white leading-tight truncate max-w-[120px] sm:max-w-none"> </h1> <span class="text-[10px] text-indigo-400 font-mono font-bold uppercase tracking-wider"> </span></div></div> <div class="flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block">Sessão</span></button> <button><!> <span class="hidden min-[400px]:block">Bestiário</span></button></div> <div class="flex items-center gap-1 sm:gap-2"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all" aria-label="Configurações da Campanha" title="Configurações"><!></button> <button class="p-2 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative" aria-label="Toggle Histórico" title="Histórico"><!> <!></button></div></div></div></header>');function bs(l,r){Ut(r,!0);const c=()=>Ct(qt,"$isHistoryOpen",s),_=()=>Ct(Ka,"$rollHistory",s),[s,p]=ra();let v=Rt(r,"campaignName",3,""),u=Rt(r,"gmName",3,"Mestre"),S=Rt(r,"activeSubTab",3,"session"),$=Rt(r,"onTabChange",3,()=>{}),E=Rt(r,"onOpenSettings",3,()=>{});var B=us(),U=a(B),z=a(U),K=a(z),k=a(K);k.__click=()=>ur("/");var D=a(k);Oa(D,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var R=i(D,2);ir(R,{size:18,class:"hidden sm:block opacity-50"}),t(k);var F=i(k,2),Y=a(F),ce=a(Y,!0);t(Y);var ne=i(Y,2),ie=a(ne,!0);t(ne),t(F),t(K);var G=i(K,2),V=a(G);V.__click=()=>$()("session");var he=a(V);{let ze=xe(()=>S()==="session"?"opacity-100":"opacity-50");sr(he,{size:14,get class(){return e(ze)}})}_e(2),t(V);var H=i(V,2);H.__click=()=>$()("bestiary");var Pe=a(H);{let ze=xe(()=>S()==="bestiary"?"opacity-100":"opacity-50");zr(Pe,{size:14,get class(){return e(ze)}})}_e(2),t(H),t(G);var Be=i(G,2),Te=a(Be);Te.__click=function(...ze){E()?.apply(this,ze)};var Ie=a(Te);nr(Ie,{size:18}),t(Te);var dt=i(Te,2);dt.__click=()=>qt.update(ze=>!ze);var lt=a(dt);or(lt,{size:18});var Ze=i(lt,2);{var et=ze=>{var oe=cs();o(ze,oe)};N(Ze,ze=>{_()&&_().length>0&&ze(et)})}t(dt),t(Be),t(z),t(U),t(B),T(()=>{x(ce,v()),x(ie,u()),$e(V,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${S()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),Dt(V,"aria-pressed",S()==="session"),$e(H,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${S()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),Dt(H,"aria-pressed",S()==="bestiary"),Dt(dt,"aria-pressed",c())}),o(l,B),Gt(),p()}Wt(["click"]);var fs=f('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),ps=f('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight">Campanha Não Encontrada</h1> <p class="text-slate-400 mb-8 max-w-md">Esta campanha não existe na sua base local ou foi removida. Crie uma nova campanha através da página inicial.</p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> Voltar</button></div>'),xs=f('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),gs=f('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!></div>');function js(l,r){Ut(r,!0);const c=()=>Ct(za,"$page",p),_=()=>Ct(Ya,"$liveCampaigns",p),s=()=>Ct(qt,"$isHistoryOpen",p),[p,v]=ra();let u=je("session"),S=je(!1),$=xe(()=>c().params.id),E=xe(()=>_().find(F=>F.id===e($))),B=xe(()=>!!e(E));function U(F){if(!e($)||!e(E))return;const Y={...e(E),...F};ot.set(e($),Y),ba(e($),{name:Y.name,gmName:Y.gmName}),L(S,!1)}var z=gs(),K=a(z);{var k=F=>{var Y=fs(),ce=ve(Y);bs(ce,{get campaignName(){return e(E).name},get gmName(){return e(E).gmName},get activeSubTab(){return e(u)},onTabChange:H=>L(u,H,!0),onOpenSettings:()=>L(S,!0)});var ne=i(ce,2);{let H=xe(()=>JSON.stringify(e(E)));cr(ne,{get isOpen(){return e(S)},get initialData(){return e(H)},onClose:()=>L(S,!1),onSave:U})}var ie=i(ne,2),G=a(ie);{var V=H=>{Mi(H,{get campaign(){return e(E)}})},he=H=>{var Pe=Ae(),Be=ve(Pe);{var Te=Ie=>{vs(Ie,{})};N(Be,Ie=>{e(u)==="bestiary"&&Ie(Te)},!0)}o(H,Pe)};N(G,H=>{e(u)==="session"?H(V):H(he,!1)})}t(ie),o(F,Y)},D=F=>{var Y=Ae(),ce=ve(Y);{var ne=G=>{var V=ps(),he=i(a(V),6);he.__click=()=>window.history.back(),t(V),o(G,V)},ie=G=>{var V=xs();o(G,V)};N(ce,G=>{e(B)&&!e(E)?G(ne):G(ie,!1)},!0)}o(F,Y)};N(K,F=>{e(B)&&e(E)?F(k):F(D,!1)})}var R=i(K,2);Na(R,{get isOpen(){return s()},onClose:()=>qt.set(!1)}),t(z),o(l,z),Gt(),v()}Wt(["click"]);export{js as component};
