const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/BPjVGcEY.js","../chunks/X4qjwA50.js","../chunks/JmLgoKLb.js","../chunks/CjDeeOcX.js","../chunks/Da70ei3y.js"])))=>i.map(i=>d[i]);
import{a as oa,s as Ut,_ as Es}from"../chunks/CjDeeOcX.js";import"../chunks/DsnmJJEf.js";import{B as $t,o as Fe,k as d,p as la,v as da,j as c,q as t,x as a,u as s,z as G,A as e,t as x,O as Fa,w as C,y as bt,n as Ea,D as Ga,a2 as ga,at as ha,bq as Ss}from"../chunks/X4qjwA50.js";import{d as ma,s as i,o as ss,g as Aa,e as ja}from"../chunks/JmLgoKLb.js";import{e as Ye,s as Qe,i as Mt,$ as aa,r as jt,a as de,f as Qa,g as Ra,h as $s}from"../chunks/Da70ei3y.js";import{l as ua,s as ba,i as y,p as sa}from"../chunks/BGpg0XVn.js";import{d as rs,h as Na,j as Is,c as is,e as ea,k as Ya,l as Ds,m as Ma,n as Da,u as $a,b as ut,o as vs,f as ns,g as Va,p as Rs,q as Ns,t as As,v as Ts}from"../chunks/BPjVGcEY.js";import{p as Us}from"../chunks/BTbfDH87.js";import{C as cs,D as Oa,l as Ps,c as Ka,d as us,a as Fs,e as Hs}from"../chunks/Cq1FyKpK.js";import{a as Ls,t as Ta,f as Ua}from"../chunks/J-RRPI-t.js";import{U as bs,C as os,W as xs,r as _s}from"../chunks/CNM1CDlp.js";import{A as qs,a as Bs,b as Ia,B as Ws,T as Js,E as es,M as fs,G as Ca,H as ms,R as Gs,C as Vs,I as ps,s as gs,c as hs,S as ys,L as Qs,d as Ys,D as Zs,e as Xs}from"../chunks/uDxbagFm.js";import{k as ts}from"../chunks/BDCFw3lJ.js";import{M as Ks,X as ya,P as ra,a as Pa,c as er,b as fa,C as Ha,d as tr,e as ws,D as za,A as ar}from"../chunks/CMwilp5d.js";import{C as ks,G as pa,P as Za,S as sr,a as rr}from"../chunks/B3TrY5Wj.js";import"../chunks/B6lYapqp.js";import{I as xa,s as _a}from"../chunks/CRJZpbrG.js";import{b as zs}from"../chunks/BpzvJAE_.js";import{g as ir}from"../chunks/BY0CqP7n.js";import{W as nr}from"../chunks/D8hSSIaG.js";function or(F,r){const o=ua(r,["children","$$slots","$$events","$$legacy"]);const J=[["path",{d:"m6 9 6 6 6-6"}]];xa(F,ba({name:"chevron-down"},()=>o,{get iconNode(){return J},children:(S,_)=>{var M=$t(),$=Fe(M);_a($,r,"default",{}),d(S,M)},$$slots:{default:!0}}))}function lr(F,r){const o=ua(r,["children","$$slots","$$events","$$legacy"]);const J=[["path",{d:"m18 15-6-6-6 6"}]];xa(F,ba({name:"chevron-up"},()=>o,{get iconNode(){return J},children:(S,_)=>{var M=$t(),$=Fe(M);_a($,r,"default",{}),d(S,M)},$$slots:{default:!0}}))}function dr(F,r){const o=ua(r,["children","$$slots","$$events","$$legacy"]);const J=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];xa(F,ba({name:"copy"},()=>o,{get iconNode(){return J},children:(S,_)=>{var M=$t(),$=Fe(M);_a($,r,"default",{}),d(S,M)},$$slots:{default:!0}}))}function vr(F,r){const o=ua(r,["children","$$slots","$$events","$$legacy"]);const J=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];xa(F,ba({name:"flame"},()=>o,{get iconNode(){return J},children:(S,_)=>{var M=$t(),$=Fe(M);_a($,r,"default",{}),d(S,M)},$$slots:{default:!0}}))}function cr(F,r){const o=ua(r,["children","$$slots","$$events","$$legacy"]);const J=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];xa(F,ba({name:"grip-vertical"},()=>o,{get iconNode(){return J},children:(S,_)=>{var M=$t(),$=Fe(M);_a($,r,"default",{}),d(S,M)},$$slots:{default:!0}}))}function Xa(F,r){const o=ua(r,["children","$$slots","$$events","$$legacy"]);const J=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];xa(F,ba({name:"layers"},()=>o,{get iconNode(){return J},children:(S,_)=>{var M=$t(),$=Fe(M);_a($,r,"default",{}),d(S,M)},$$slots:{default:!0}}))}function Cs(F,r){const o=ua(r,["children","$$slots","$$events","$$legacy"]);const J=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];xa(F,ba({name:"library"},()=>o,{get iconNode(){return J},children:(S,_)=>{var M=$t(),$=Fe(M);_a($,r,"default",{}),d(S,M)},$$slots:{default:!0}}))}function ur(F,r){const o=ua(r,["children","$$slots","$$events","$$legacy"]);const J=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];xa(F,ba({name:"qr-code"},()=>o,{get iconNode(){return J},children:(S,_)=>{var M=$t(),$=Fe(M);_a($,r,"default",{}),d(S,M)},$$slots:{default:!0}}))}function as(F,r){const o=ua(r,["children","$$slots","$$events","$$legacy"]);const J=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];xa(F,ba({name:"save"},()=>o,{get iconNode(){return J},children:(S,_)=>{var M=$t(),$=Fe(M);_a($,r,"default",{}),d(S,M)},$$slots:{default:!0}}))}function br(F,r){const o=ua(r,["children","$$slots","$$events","$$legacy"]);const J=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]];xa(F,ba({name:"send"},()=>o,{get iconNode(){return J},children:(S,_)=>{var M=$t(),$=Fe(M);_a($,r,"default",{}),d(S,M)},$$slots:{default:!0}}))}function js(F,r){const o=ua(r,["children","$$slots","$$events","$$legacy"]);const J=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];xa(F,ba({name:"swords"},()=>o,{get iconNode(){return J},children:(S,_)=>{var M=$t(),$=Fe(M);_a($,r,"default",{}),d(S,M)},$$slots:{default:!0}}))}function xr(F){let r=!1;return document.body&&(document.body.appendChild(F),r=!0),{destroy(){r&&F.parentNode&&F.parentNode.removeChild(F)}}}var _r=c("<button> <!></button>"),fr=c('<p class="text-xs text-slate-600 italic"> </p>'),mr=c('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),pr=c('<div class="space-y-1"></div>'),gr=c('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),hr=c("<div><!></div>");function yr(F,r){la(r,!0);const o=()=>Ut(aa,"$t",J),[J,S]=oa();var _=$t(),M=Fe(_);{var $=n=>{var w=hr(),N=t(w);{let Z=G(()=>o()("session.affliction_modal.title"));Ks(N,{get isOpen(){return r.isOpen},get onClose(){return r.onClose},get title(){return a(Z)},maxWidth:"max-w-md",children:(ae,me)=>{var D=gr(),R=Fe(D);Ye(R,21,()=>Object.keys(qs),Mt,(he,Me)=>{const Je=G(()=>r.afflictions.includes(a(Me)));var ge=_r();ge.__click=()=>r.onToggle(a(Me));var U=t(ge),ne=s(U);{var ve=Oe=>{ks(Oe,{size:14,class:"text-red-400"})};y(ne,Oe=>{a(Je)&&Oe(ve)})}e(ge),x(Oe=>{Qe(ge,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(Je)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),i(U,`${Oe??""} `)},[()=>o()(`character.afflictions.${a(Me)}`)]),d(he,ge)}),e(R);var E=s(R,2),V=t(E),T=t(V),$e=t(T,!0);e(T);var ze=s(T,2);{var kt=he=>{var Me=fr(),Je=t(Me,!0);e(Me),x(ge=>i(Je,ge),[()=>o()("session.affliction_modal.none_selected")]),d(he,Me)},se=he=>{var Me=pr();Ye(Me,21,()=>r.afflictions,Mt,(Je,ge)=>{var U=mr(),ne=t(U),ve=t(ne);e(ne);var Oe=s(ne,2),ye=t(Oe,!0);e(Oe),e(U),x((xt,it)=>{i(ve,`${xt??""}:`),i(ye,it)},[()=>o()(`character.afflictions.${a(ge)}`),()=>o()(`sofww.afflictions.${a(ge).toLowerCase().replace(" ","_")}.effect`)]),d(Je,U)}),e(Me),d(he,Me)};y(ze,he=>{r.afflictions.length===0?he(kt):he(se,!1)})}e(V);var Ce=s(V,2),ue=t(Ce);ue.__click=function(...he){r.onClose?.apply(this,he)};var je=t(ue,!0);e(ue),e(Ce),e(E),x((he,Me)=>{i($e,he),i(je,Me)},[()=>o()("session.affliction_modal.effects"),()=>o()("session.affliction_modal.done")]),d(ae,D)},$$slots:{default:!0}})}e(w),Bs(w,Z=>xr?.(Z)),d(n,w)};y(M,n=>{r.isOpen&&n($)})}d(F,_),da(),S()}ma(["click"]);var wr=c('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),kr=c('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),zr=c('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),Cr=c("<button><!></button>"),jr=c('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),Mr=c('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),Or=c('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),Er=c('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),Sr=c('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),$r=c('<div class="flex flex-col items-center justify-between bg-cyan-950/20 border border-cyan-500/30 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-cyan-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div>'),Ir=c('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),Dr=c('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),Rr=c('<div class="grid grid-cols-2 gap-4 mb-4"><div class="p-3 rounded-xl bg-purple-950/20 border border-purple-500/30 flex justify-between items-center group/ins"><div><span class="text-[9px] text-purple-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div> <div class="p-3 rounded-xl bg-red-950/20 border border-red-500/30 flex justify-between items-center group/cor"><div><span class="text-[9px] text-red-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div></div>'),Nr=c("<!> ",1),Ar=c('<div><div class="text-emerald-500 text-[10px] font-black uppercase mb-2 flex items-center gap-2"> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="flex flex-wrap gap-2"></div></div>'),Tr=c('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),Ur=c('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),Pr=c('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <!> <div class="grid grid-cols-2 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"><!> <!></div></div>'),Fr=c('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div> <!></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function Hr(F,r){la(r,!0);const o=()=>Ut(aa,"$t",J),[J,S]=oa();let _=sa(r,"updateEnemy",3,(f,b)=>{}),M=sa(r,"updatePlayer",3,(f,b)=>{}),$=sa(r,"removeFromCombat",3,f=>{}),n=G(()=>r.entity.type==="player"),w=G(()=>r.entity.system==="sofdl"),N=G(()=>r.entity.damage||0),Z=G(()=>r.entity.normalHealth||r.entity.health||10),ae=G(()=>r.entity.currentHealth??a(Z)),me=G(()=>a(N)>=a(ae)),D=G(()=>a(N)>=a(ae)/2&&!a(me)),R=G(()=>a(ae)>0?Math.min(100,Math.max(0,a(N)/a(ae)*100)):100),E=bt(!1),V=bt(!1);Fa(()=>{const f=r.entity.afflictions||[],b=f.includes("Incapacitated");if(a(me)&&!b){const z={afflictions:[...f,"Incapacitated"]};r.entity.type==="player"?T(z):_()(r.entity.instanceId,z)}else if(!a(me)&&b){const z={afflictions:f.filter(ke=>ke!=="Incapacitated")};r.entity.type==="player"?T(z):_()(r.entity.instanceId,z)}});function T(f){if(r.entity.type!=="player")return;const b=rs.get(r.entity.id);b&&rs.set(r.entity.id,{...b,...f}),M()(r.entity.id,f),Na({id:r.entity.id,...f})}function $e(f){const b=parseInt(f.target.value);if(isNaN(b))return;const z={damage:Math.max(0,b)};r.entity.type==="player"?T(z):_()(r.entity.instanceId,z)}function ze(f){const b=parseInt(f.target.value);if(isNaN(b))return;const O=Math.max(0,b);let z=a(N);O<a(N)&&(z=O);const ke={currentHealth:O,damage:z};r.entity.type==="player"?T(ke):_()(r.entity.instanceId,ke)}function kt(){const f=!r.entity.acted;r.entity.type==="player"?T({acted:f}):_()(r.entity.instanceId,{acted:f})}function se(){r.entity.type==="player"&&T({initiative:!r.entity.initiative})}function Ce(f){const b=r.entity.afflictions||[],z={afflictions:b.includes(f)?b.filter(ke=>ke!==f):[...b,f]};r.entity.type==="player"?T(z):_()(r.entity.instanceId,z)}var ue=Fr(),je=t(ue);{var he=f=>{var b=wr(),O=t(b,!0);e(b),x(z=>i(O,z),[()=>o()("session.combat_card.initiative")]),d(f,b)};y(je,f=>{a(n)&&r.entity.initiative&&f(he)})}var Me=s(je,2);{var Je=f=>{var b=kr();d(f,b)};y(Me,f=>{a(me)&&f(Je)})}var ge=s(Me,2),U=t(ge),ne=t(U),ve=t(ne),Oe=t(ve);ts(Oe,()=>r.entity.imageUrl,f=>{{let b=G(()=>r.entity.name.charAt(0));Ia(f,{get hash(){return r.entity.imageUrl},get alt(){return r.entity.name},size:"custom",get fallbackText(){return a(b)}})}}),e(ve);var ye=s(ve,2);ye.__click=kt;var xt=t(ye);{var it=f=>{Pa(f,{size:14,class:""})},nt=f=>{var b=$t(),O=Fe(b);{var z=We=>{ks(We,{size:14})},ke=We=>{js(We,{size:14})};y(O,We=>{r.entity.acted?We(z):We(ke,!1)},!0)}d(f,b)};y(xt,f=>{a(me)?f(it):f(nt,!1)})}e(ye),e(ne);var _t=s(ne,2),at=t(_t),St=t(at),gt=t(St),ft=t(gt),Pt=t(ft,!0);e(ft);var ht=s(ft,2);{var Ge=f=>{var b=zr(),O=t(b);e(b),x(()=>i(O,`Dif ${r.entity.difficulty??""}`)),d(f,b)};y(ht,f=>{a(n)||f(Ge)})}e(gt),e(St);var Xe=s(St,2),Ee=t(Xe);Ee.__click=()=>C(E,!a(E));var Ae=t(Ee);{var P=f=>{lr(f,{size:14})},be=f=>{or(f,{size:14})};y(Ae,f=>{a(E)?f(P):f(be,!1)})}e(Ee);var He=s(Ee,2);{var oe=f=>{var b=Cr();b.__click=se;var O=t(b);vr(O,{size:14}),e(b),x(z=>{Qe(b,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${r.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),de(b,"title",z)},[()=>o()("session.combat_card.initiative")]),d(f,b)},Le=f=>{var b=jr();b.__click=()=>$()(r.entity.instanceId);var O=t(b);ya(O,{size:14}),e(b),d(f,b)};y(He,f=>{a(n)?f(oe):f(Le,!1)})}e(Xe),e(at);var De=s(at,2),Ze=t(De),dt=s(Ze,2);{var Te=f=>{var b=Mr();x(()=>{Qe(b,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10
                            ${a(me)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(R)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(D)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),Ra(b,`width: ${a(R)??""}%`)}),d(f,b)};y(dt,f=>{a(R)>0&&f(Te)})}var vt=s(dt,2);{var p=f=>{var b=Or();d(f,b)};y(vt,f=>{a(N)===0&&f(p)})}var I=s(vt,2);{var j=f=>{var b=Er(),O=t(b),z=t(O,!0);e(O),e(b),x(ke=>i(z,ke),[()=>o()("session.combat_card.incapacitated")]),d(f,b)},we=f=>{var b=$t(),O=Fe(b);{var z=ke=>{var We=Sr(),tt=t(We),et=t(tt,!0);e(tt),e(We),x(zt=>i(et,zt),[()=>o()("session.combat_card.injured")]),d(ke,We)};y(O,ke=>{a(D)&&ke(z)},!0)}d(f,b)};y(I,f=>{a(me)?f(j):f(we,!1)})}e(De);var Se=s(De,2),Ie=t(Se),qe=t(Ie),yt=t(qe),st=t(yt,!0);e(yt);var Ot=s(yt,2),pe=t(Ot,!0);e(Ot),e(qe);var H=s(qe,2),A=t(H),L=t(A,!0);e(A);var X=s(A,2);jt(X),X.__input=$e,Ea(2),e(H);var B=s(H,2),Q=t(B),le=t(Q,!0);e(Q);var Ke=s(Q,2),xe=t(Ke);jt(xe),xe.__input=ze;var ce=s(xe,2),Y=t(ce);e(ce),e(Ke),e(B);var Re=s(B,2);{var _e=f=>{var b=$r(),O=t(b),z=t(O,!0);e(O);var ke=s(O,2),We=t(ke,!0);e(ke),e(b),x(tt=>{i(z,tt),i(We,r.entity.perception||10)},[()=>o()("sofdl.attributes.perception")]),d(f,b)};y(Re,f=>{a(w)&&f(_e)})}e(Ie);var Be=s(Ie,2),ot=t(Be);Ye(ot,17,()=>r.entity.afflictions||[],Mt,(f,b)=>{var O=Ir();O.__click=()=>Ce(a(b));var z=t(O),ke=s(z);ya(ke,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(O),x(()=>i(z,`${a(b)??""} `)),d(f,O)});var lt=s(ot,2);lt.__click=()=>C(V,!0);var ct=t(lt);ra(ct,{size:10});var Ft=s(ct);e(lt),e(Be),e(Se),e(_t),e(U),e(ge);var It=s(ge,2);{var Vt=f=>{var b=Pr(),O=t(b),z=t(O),ke=t(z),We=t(ke,!0);e(ke),Ea(2),e(z);var tt=s(z,2);Ye(tt,21,()=>a(w)?["strength","agility","intellect","will"]:["str","agi","int","wil"],Mt,(l,v)=>{const u=G(()=>a(w)?r.entity.attributes?.[a(v)]??10:r.entity.stats?.[a(v)]??r.entity.attributes?.[a(v)]??10),g=G(()=>a(u)-10);var W=Dr(),m=t(W),k=t(m,!0);e(m);var h=s(m,2),re=t(h,!0);e(h);var q=s(h,2),ee=t(q);e(q),e(W),x(K=>{i(k,K),i(re,a(u)),Qe(q,1,`text-[9px] font-bold ${a(g)>=0?"text-emerald-500":"text-red-500"}`),i(ee,`${a(g)>=0?"+":""}${a(g)??""}`)},[()=>a(w)?a(v).slice(0,3):a(v)]),d(l,W)}),e(tt),e(O);var et=s(O,2);{var zt=l=>{var v=Rr(),u=t(v),g=t(u),W=t(g),m=t(W,!0);e(W);var k=s(W,2),h=t(k,!0);e(k),e(g);var re=s(g,2);Ws(re,{size:20,class:"text-purple-500/30 group-hover/ins:text-purple-500 transition-colors"}),e(u);var q=s(u,2),ee=t(q),K=t(ee),fe=t(K,!0);e(K);var ie=s(K,2),Ue=t(ie,!0);e(ie),e(ee);var te=s(ee,2);Pa(te,{size:20,class:"text-red-500/30 group-hover/cor:text-red-500 transition-colors"}),e(q),e(v),x((Pe,Ne)=>{i(m,Pe),i(h,r.entity.insanity||0),i(fe,Ne),i(Ue,r.entity.corruption||0)},[()=>o()("sofdl.attributes.insanity"),()=>o()("sofdl.attributes.corruption")]),d(l,v)};y(et,l=>{a(w)&&l(zt)})}var Ct=s(et,2),Ht=t(Ct),Dt=t(Ht),Bt=t(Dt,!0);e(Dt);var Gt=s(Dt,2),Xt=t(Gt,!0);e(Gt),e(Ht);var ta=s(Ht,2),Jt=t(ta),Wt=t(Jt,!0);e(Jt);var Qt=s(Jt,2),ca=t(Qt,!0);e(Qt),e(ta),e(Ct);var Zt=s(Ct,2),mt=t(Zt);{var Tt=l=>{var v=Ar(),u=t(v),g=t(u);Ea(),e(u);var W=s(u,2);Ye(W,21,()=>r.entity.senses,Mt,(m,k)=>{const h=G(()=>{const[ee,K]=a(k).split(":");return{key:ee,val:K}}),re=G(()=>o()(`character.senses.list.${a(h).key}`)+(a(h).val?` ${a(h).val}`:"")),q=G(()=>o()(`character.senses.descriptions.${a(h).key}`));Js(m,{get text(){return a(q)},class:"text-xs bg-emerald-950/30 text-emerald-200 px-3 py-1.5 rounded border border-emerald-900/50 font-bold flex items-center gap-2 cursor-help whitespace-nowrap",children:(ee,K)=>{var fe=Nr(),ie=Fe(fe);es(ie,{size:12,class:"text-emerald-500 flex-shrink-0"});var Ue=s(ie);x(()=>i(Ue,` ${a(re)??""}`)),d(ee,fe)},$$slots:{default:!0}})}),e(W),e(v),x(m=>i(g,`${m??""} `),[()=>o()("character.senses.title")]),d(l,v)};y(mt,l=>{r.entity.senses&&r.entity.senses.length>0&&l(Tt)})}var ia=s(mt,2);Ye(ia,16,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],Mt,(l,v)=>{var u=$t(),g=Fe(u);{var W=m=>{var k=Ur(),h=t(k),re=t(h);Ea(),e(h);var q=s(h,2);Ye(q,21,()=>r.entity[v.key],Mt,(ee,K)=>{var fe=Tr(),ie=t(fe),Ue=t(ie,!0);e(ie);var te=s(ie,2),Pe=t(te,!0);e(te),e(fe),x(()=>{i(Ue,a(K).name),i(Pe,a(K).description||a(K).effect)}),d(ee,fe)}),e(q),e(k),x(()=>{Qe(h,1,`${v.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),i(re,`${v.label??""} `)}),d(m,k)};y(g,m=>{r.entity[v.key]&&r.entity[v.key].length>0&&m(W)})}d(l,u)}),e(Zt),e(b),x((l,v,u)=>{i(We,l),i(Bt,v),i(Xt,r.entity.size||1),i(Wt,u),i(ca,r.entity.speed||10)},[()=>o()("session.combat_card.attributes"),()=>o()("session.combat_card.size"),()=>o()("session.combat_card.speed")]),d(f,b)};y(It,f=>{a(E)&&f(Vt)})}var At=s(It,2);{let f=G(()=>r.entity.afflictions||[]);yr(At,{get isOpen(){return a(V)},onClose:()=>C(V,!1),get afflictions(){return a(f)},onToggle:Ce})}e(ue),x((f,b,O,z,ke)=>{Qe(ue,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(n)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),Qe(ve,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(me)?"border-red-600 grayscale brightness-50":a(n)?"border-indigo-500/50":"border-red-900/50"}`),Qe(ye,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${r.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(n)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),de(ye,"title",f),Qe(ft,1,`text-base font-bold truncate leading-snug ${a(n)?"text-white":"text-red-100 font-serif tracking-wide"}`),i(Pt,r.entity.name),Qe(Ze,1,`absolute inset-0 w-full ${a(N)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),i(st,b),i(pe,r.entity.defense||10),i(L,O),Qa(X,a(N)),Qe(B,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(me)?"bg-red-950/50 border-red-500":a(D)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),Qe(Q,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(me)?"text-red-400":a(D)?"text-orange-400":"text-emerald-400"}`),i(le,z),Qa(xe,a(ae)),i(Y,`/${a(Z)??""}`),i(Ft,` ${ke??""}`)},[()=>r.entity.acted?o()("session.combat_card.acted"):o()("session.combat_card.act"),()=>o()("session.combat_card.defense"),()=>o()("session.combat_card.damage"),()=>o()("session.combat_card.health"),()=>o()("session.combat_card.add_affliction")]),d(F,ue),da(),S()}ma(["click","input"]);function Lr(F,{from:r,to:o},J={}){var{delay:S=0,duration:_=se=>Math.sqrt(se)*120,easing:M=er}=J,$=getComputedStyle(F),n=$.transform==="none"?"":$.transform,[w,N]=$.transformOrigin.split(" ").map(parseFloat);w/=F.clientWidth,N/=F.clientHeight;var Z=qr(F),ae=F.clientWidth/o.width/Z,me=F.clientHeight/o.height/Z,D=r.left+r.width*w,R=r.top+r.height*N,E=o.left+o.width*w,V=o.top+o.height*N,T=(D-E)*ae,$e=(R-V)*me,ze=r.width/o.width,kt=r.height/o.height;return{delay:S,duration:typeof _=="function"?_(Math.sqrt(T*T+$e*$e)):_,easing:M,css:(se,Ce)=>{var ue=Ce*T,je=Ce*$e,he=se+Ce*ze,Me=se+Ce*kt;return`transform: ${n} translate(${ue}px, ${je}px) scale(${he}, ${Me});`}}}function qr(F){if("currentCSSZoom"in F)return F.currentCSSZoom;for(var r=F,o=1;r!==null;)o*=+getComputedStyle(r).zoom,r=r.parentElement;return o}function Br(F,r=1,o=0){const J=[];let S=0;for(let n=0;n<r;n++){const w=Math.floor(Math.random()*F)+1;J.push(w),S+=w}let _=`${r}d${F}`,M=[],$=0;if(o!==0)if(F===20){const n=Math.abs(o);for(let N=0;N<n;N++)M.push(Math.floor(Math.random()*6)+1);const w=Math.max(...M);o>0?($=w,S+=w,_+=` + ${w} [Boon]`):($=-w,S-=w,_+=` - ${w} [Bane]`)}else $=o,S+=o,_+=o>0?` + ${o}`:` - ${Math.abs(o)}`;return{total:S,results:J,bonusRolls:M,formula:_,crit:F===20&&J.includes(20),modifierTotal:$,dice:[{sides:F,count:r,results:J}]}}function Wr(F){const r=F.replace(/\s+/g,""),o=/([+-]?)(?:(\d+)?d(\d+)|(\d+))/g;let J=0,S="";const _=[],M=[];let $,n=!0;for(;($=o.exec(r))!==null;){if($[0]===""){o.lastIndex++;continue}const N=($[1]||"+")==="-"?-1:1,Z=$[2],ae=$[3],me=$[4];if(ae){const D=Z?parseInt(Z):1,R=parseInt(ae),E=[];let V=0;for(let kt=0;kt<D;kt++){const se=Math.floor(Math.random()*R)+1;E.push(se),V+=se}_.push(...E),M.push({sides:R,count:D,results:E});const T=V*N;J+=T;const $e=n&&N===1?"":N===1?" + ":" - ";D===1&&R===3&&E[0];const ze=`${$e}${D}d${R}[${E.join(",")}]`;S+=ze}else if(me){const D=parseInt(me);J+=D*N;const E=`${n&&N===1?"":N===1?" + ":" - "}${D}`;S+=E}n=!1}return{total:J,results:_,bonusRolls:[],formula:S.trim(),crit:!1,modifierTotal:0,dice:M}}function Jr(F,r,o){const J=o.map(n=>({...n,type:"enemy"}));if(F==="standard"){const n=r.filter(ae=>ae.initiative).map(ae=>({...ae,type:"player",isFast:!0})),w=r.filter(ae=>!ae.initiative).map(ae=>({...ae,type:"player",isFast:!1})),N=J.filter(ae=>ae.initiative).map(ae=>({...ae,isFast:!0})),Z=J.filter(ae=>!ae.initiative).map(ae=>({...ae,isFast:!1}));return[...n,...N,...w,...Z]}if(F==="individual")return[...r.map(w=>({...w,type:"player",totalInit:(w.initiativeRoll||0)+(w.attributes?.agility||10)-10})),...J.map(w=>({...w,type:"enemy",totalInit:(w.initiativeRoll||0)+(w.attributes?.agility||10)-10}))].sort((w,N)=>N.totalInit-w.totalInit);const S=r.filter(n=>n&&n.initiative).map(n=>({...n,type:"player"})),_=r.filter(n=>n&&!n.initiative).map(n=>({...n,type:"player"})),M=[...S,...J,..._],$=new Set;return M.filter(n=>{if(!n)return!1;const w=n.type==="player"?n.id:n.instanceId;return $.has(w)?!1:($.add(w),!0)})}var Gr=c('<div class="h-full border-r border-slate-900/30 last:border-0"></div>'),Vr=c('<div class="flex flex-col items-center"><span> </span> <span class="text-[8px] font-mono text-slate-600"><!></span></div>'),Qr=c('<div class="space-y-4 w-full"><div class="relative h-3 w-full bg-slate-800 rounded-full overflow-hidden border border-slate-700/50 shadow-inner"><div class="absolute inset-0 flex"></div> <div><div class="absolute inset-0 bg-white/10 animate-pulse"></div></div></div> <div class="flex justify-between w-full px-1"></div></div>');function Ms(F,r){la(r,!0);const o=()=>Ut(aa,"$t",J),[J,S]=oa();let _=G(()=>()=>{for(let D=0;D<r.segments.length;D++)if(r.value<=r.segments[D].max)return D;return r.segments.length-1}),M=G(()=>()=>{const D=a(_)(),R=D===0?0:r.segments[D-1].max,E=r.segments[D].max;if(D===r.segments.length-1&&r.value>E)return 1;const V=E-R;return V===0?1:Math.min(1,Math.max(0,(r.value-R)/V))}),$=G(()=>()=>{const D=a(_)(),R=100/r.segments.length;return D*R+a(M)()*R}),n=G(()=>r.segments[a(_)()].color);var w=Qr(),N=t(w),Z=t(N);Ye(Z,21,()=>r.segments,Mt,(D,R)=>{var E=Gr();x(()=>Ra(E,`width: ${100/r.segments.length}%`)),d(D,E)}),e(Z);var ae=s(Z,2);e(N);var me=s(N,2);Ye(me,21,()=>r.segments,Mt,(D,R,E)=>{var V=Vr(),T=t(V),$e=t(T,!0);e(T);var ze=s(T,2),kt=t(ze);{var se=ue=>{var je=Ga();x(()=>i(je,`${r.segments[E-1].max+1}+`)),d(ue,je)},Ce=ue=>{var je=$t(),he=Fe(je);{var Me=ge=>{var U=Ga();x(()=>i(U,a(R).max)),d(ge,U)},Je=ge=>{var U=Ga();x(()=>i(U,a(R).max)),d(ge,U)};y(he,ge=>{E===0?ge(Me):ge(Je,!1)},!0)}d(ue,je)};y(kt,ue=>{E===r.segments.length-1?ue(se):ue(Ce,!1)})}e(ze),e(V),x((ue,je)=>{Ra(V,`width: ${100/r.segments.length}%`),Qe(T,1,`text-[9px] font-black uppercase tracking-tighter transition-colors ${ue??""}`,"svelte-1ix6916"),i($e,je)},[()=>E===a(_)()?a(n).replace("bg-","text-"):"text-slate-500",()=>o()("campaign.difficulty."+a(R).key)]),d(D,V)}),e(me),e(w),x(D=>{Qe(ae,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out rounded-full ${a(n)??""}`,"svelte-1ix6916"),Ra(ae,`width: ${D??""}%`)},[()=>a($)()]),d(F,w),da(),S()}var Yr=c('<div><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-2"><!> <span class="text-xs font-black uppercase tracking-widest"> </span></div> <div class="text-xs font-bold uppercase opacity-70"> </div></div> <div class="flex items-center justify-between mb-6"><div><div class="text-3xl font-black leading-none"> </div> <div class="text-[10px] font-bold uppercase opacity-50 mt-1"> </div></div> <div class="text-right"><div class="text-sm font-black uppercase"> </div> <div class="text-[10px] font-bold opacity-40 mt-1 flex items-center justify-end gap-1"><span class="uppercase tracking-tighter"> </span> <span> </span></div></div></div> <!></div>');function ls(F,r){la(r,!0);const o=()=>Ut(aa,"$t",J),[J,S]=oa(),_={starting:{easy:3,avgMin:4,avgMax:15,challMin:16,challMax:30,hard:31,maxCreature:25},novice:{easy:10,avgMin:11,avgMax:30,challMin:31,challMax:50,hard:51,maxCreature:100},expert:{easy:30,avgMin:31,avgMax:50,challMin:51,challMax:125,hard:126,maxCreature:250},master:{easy:50,avgMin:51,avgMax:125,challMin:126,challMax:200,hard:201,maxCreature:null}};let M=G(()=>_[r.tier]||_.starting),$=G(()=>()=>r.totalDifficulty<=a(M).easy?"easy":r.totalDifficulty<=a(M).avgMax?"average":r.totalDifficulty<=a(M).challMax?"challenging":"hard"),n=G(()=>[{key:"easy",max:a(M).easy,color:"bg-green-500"},{key:"average",max:a(M).avgMax,color:"bg-yellow-500"},{key:"challenging",max:a(M).challMax,color:"bg-orange-500"},{key:"hard",max:a(M).challMax*1.5,color:"bg-red-500"}]),w=G(()=>()=>{switch(a($)()){case"easy":return"text-green-400 bg-green-500/10 border-green-500/30";case"average":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/30";case"challenging":return"text-orange-400 bg-orange-500/10 border-orange-500/30";case"hard":return"text-red-400 bg-red-500/10 border-red-500/30";default:return"text-slate-400 bg-slate-500/10 border-slate-500/30"}});var N=Yr(),Z=t(N),ae=t(Z),me=t(ae);Pa(me,{size:18});var D=s(me,2),R=t(D,!0);e(D),e(ae);var E=s(ae,2),V=t(E,!0);e(E),e(Z);var T=s(Z,2),$e=t(T),ze=t($e),kt=t(ze,!0);e(ze);var se=s(ze,2),Ce=t(se,!0);e(se),e($e);var ue=s($e,2),je=t(ue),he=t(je,!0);e(je);var Me=s(je,2),Je=t(Me),ge=t(Je);e(Je);var U=s(Je,2),ne=t(U,!0);e(U),e(Me),e(ue),e(T);var ve=s(T,2);Ms(ve,{get value(){return r.totalDifficulty},get segments(){return a(n)}}),e(N),x((Oe,ye,xt,it,nt,_t,at)=>{Qe(N,1,`rounded-xl border p-4 ${Oe??""} shadow-lg`),i(R,ye),i(V,xt),i(kt,r.totalDifficulty),i(Ce,it),i(he,nt),i(ge,`${_t??""}:`),i(ne,at)},[()=>a(w)(),()=>o()("campaign.difficulty.title"),()=>o()("campaign.settings.tiers."+r.tier),()=>o()("campaign.difficulty.total"),()=>o()("campaign.difficulty."+a($)()),()=>o()("campaign.difficulty.max_creature"),()=>a(M).maxCreature??o()("campaign.difficulty.none")]),d(F,N),da(),S()}var Zr=c('<div><div class="flex items-center justify-between mb-4"><div class="flex items-center gap-2"><!> <span class="text-xs font-black uppercase tracking-widest"> </span></div> <div class="flex items-center gap-2 text-xs font-bold uppercase opacity-70"><span> </span> <span class="text-[10px] bg-black/20 px-2 py-0.5 rounded"> </span></div></div> <div class="flex items-center justify-between mb-6"><div><div class="text-3xl font-black leading-none"> </div> <div class="text-[10px] font-bold uppercase opacity-50 mt-1"> </div></div> <div class="text-right"><div class="text-sm font-black uppercase"> </div> <div class="text-[10px] font-medium opacity-50 mt-1 uppercase tracking-tighter"> </div></div></div> <!></div>');function ds(F,r){la(r,!0);const o=()=>Ut(aa,"$t",J),[J,S]=oa(),_={starting:{easy:.5,average:1,hard:1.5},novice:{easy:1,average:2,hard:3},expert:{easy:2,average:4,hard:6},master:{easy:4,average:8,hard:12}};let M=G(()=>_[r.tier]||_.novice),$=G(()=>({easy:a(M).easy*r.playerCount,average:a(M).average*r.playerCount,hard:a(M).hard*r.playerCount})),n=G(()=>()=>r.totalDifficulty<=a($).easy?"easy":r.totalDifficulty<=a($).average?"average":"hard"),w=G(()=>[{key:"easy",max:a($).easy,color:"bg-green-500"},{key:"average",max:a($).average,color:"bg-yellow-500"},{key:"hard",max:a($).hard*1.5,color:"bg-red-500"}]),N=G(()=>()=>{switch(a(n)()){case"easy":return"text-green-400 bg-green-500/10 border-green-500/30";case"average":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/30";case"hard":return"text-red-400 bg-red-500/10 border-red-500/30";default:return"text-slate-400 bg-slate-500/10 border-slate-500/30"}});var Z=Zr(),ae=t(Z),me=t(ae),D=t(me);Pa(D,{size:18});var R=s(D,2),E=t(R,!0);e(R),e(me);var V=s(me,2),T=t(V),$e=t(T,!0);e(T);var ze=s(T,2),kt=t(ze,!0);e(ze),e(V),e(ae);var se=s(ae,2),Ce=t(se),ue=t(Ce),je=t(ue,!0);e(ue);var he=s(ue,2),Me=t(he,!0);e(he),e(Ce);var Je=s(Ce,2),ge=t(Je),U=t(ge,!0);e(ge);var ne=s(ge,2),ve=t(ne);e(ne),e(Je),e(se);var Oe=s(se,2);Ms(Oe,{get value(){return r.totalDifficulty},get segments(){return a(w)}}),e(Z),x((ye,xt,it,nt,_t,at,St)=>{Qe(Z,1,`rounded-xl border p-4 ${ye??""} shadow-lg`),i(E,xt),i($e,it),i(kt,nt),i(je,r.totalDifficulty),i(Me,_t),i(U,at),i(ve,`${a(M).average??""}/${St??""}`)},[()=>a(N)(),()=>o()("campaign.difficulty.title"),()=>o()("campaign.settings.tiers."+r.tier),()=>o()("campaign.difficulty.players",{values:{count:r.playerCount}}),()=>o()("campaign.difficulty.total"),()=>o()("campaign.difficulty."+a(n)()),()=>o()("common.labels.master")]),d(F,Z),da(),S()}var Xr=c('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),Kr=c('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),ei=c('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),ti=c('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),ai=c('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),si=c('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),ri=c('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),ii=c('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),ni=c('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),oi=c('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),li=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1 flex items-center gap-2"><!> <div class="min-w-0 flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),di=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),vi=c("<!> <!>",1),ci=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),ui=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),bi=c("<!> <!>",1),xi=c('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),_i=c('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),fi=c('<div class="lg:hidden"><!></div>'),mi=c("<div><!></div>"),pi=c('<div class="text-center text-slate-500 italic py-10"> </div>'),gi=c('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),hi=c('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),yi=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),wi=c('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),ki=c('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),zi=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Ci=c('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1 flex flex-col"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),ji=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Mi=c("<!> <!>",1),Oi=c('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),Ei=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Si=c("<!> <!>",1),$i=c('<div class="fixed inset-0 z-50 flex justify-end bg-black/60"><div class="w-full max-w-[300px] h-full bg-slate-900 border-l border-slate-800 p-4 shadow-2xl animate-in slide-in-from-right duration-300"><div class="flex justify-between items-center mb-4"><h3 class="font-bold text-white uppercase tracking-widest text-sm flex items-center gap-2"><!> </h3> <button class="bg-slate-800 p-2 rounded-lg text-slate-400 hover:text-white"><!></button></div> <div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="h-[calc(100%-100px)] overflow-y-auto custom-scrollbar space-y-2"><!></div></div></div>'),Ii=c('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="hidden lg:flex flex-col h-[400px] bg-slate-900 border border-slate-800 rounded-xl p-4"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4" role="region" aria-label="Combat Zone"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <!> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"><!></div></div> <!> <!> <!> <button class="lg:hidden fixed bottom-24 right-4 bg-slate-800 text-white p-3 rounded-full shadow-lg border border-slate-700 z-40 active:scale-90 transition-transform" aria-label="Add Enemy"><!></button> <!> <!>',1);function Di(F,r){la(r,!0);const o=()=>Ut(Ps,"$liveCharacters",$),J=()=>Ut(Ka,"$liveEnemies",$),S=()=>Ut(us,"$liveEncounters",$),_=()=>Ut(aa,"$t",$),M=()=>Ut(Ma,"$isHistoryOpen",$),[$,n]=oa();let w=bt(!1),N=bt(!1),Z=bt(!1),ae=bt(!1);const me={active:!1,round:1};let D=bt("enemies"),R=bt(!1),E=bt(ga([])),V=bt(ga({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));ss(()=>{if(r.campaign?.id){Is(r.campaign.id,!0);const l=Aa(aa)("common.labels.master");is.update(u=>({...u,campaignId:r.campaign.id,name:r.campaign.gmName||l}));const v=setInterval(()=>{const u=ea.get(r.campaign.id)||r.campaign,g=Aa(aa)("common.labels.master");Ya(r.campaign.id,{name:u.name,gmName:u.gmName||g})},3e4);return()=>{clearInterval(v),Ds(),is.update(u=>({...u,campaignId:null}))}}});const T=G(()=>typeof window<"u"?`${window.location.origin}${_s("/campaigns/[id]/invite",{id:r.campaign?.id})}`:"");function $e(){a(T)&&(navigator.clipboard.writeText(a(T)),C(Z,!0),setTimeout(()=>{C(Z,!1)},2e3))}let ze=G(()=>r.campaign?.sessionRoster||[]),kt=G(()=>r.campaign?.combat||me),se=G(()=>r.campaign?.activeEnemies||[]),Ce=G(()=>r.campaign?.members||[]),ue=G(()=>r.campaign?.initiativeStyle||"dle"),je=G(()=>r.campaign?.tier||Fs(r.campaign?.system)),he=G(()=>a(se).reduce((l,v)=>l+(v.difficulty||0),0)),Me=G(()=>a(ze).length||1),Je=G(()=>Array.from(new Set([...a(ze),...a(Ce).map(v=>v.id)])).map(v=>{const u=o().find(W=>W.id===v),g=a(Ce).find(W=>W.id===v);return u&&g?{...u,...g,lastUpdate:g.lastUpdate}:u||g}).filter(Boolean)),ge=G(()=>a(Je).filter(l=>!l.campaignApproval||l.campaignApproval==="approved")),U=G(()=>a(Je).filter(l=>l.campaignApproval==="pending")),ne=G(()=>o().filter(l=>!a(ze).includes(l.id)&&!a(Ce).some(v=>v.id===l.id)&&(l.system||Oa)===(r.campaign?.system||Oa))),ve=G(()=>J().filter(l=>{const v=(l.system||Oa)===(r.campaign?.system||Oa),u=l.campaignId===r.campaign?.id||l.global;return v&&u})),Oe=G(()=>S().filter(l=>(l.system||Oa)===(r.campaign?.system||Oa)&&!0));function ye(l){if(!r.campaign?.id)return;const u={...ea.get(r.campaign.id)||r.campaign,...l};ea.set(r.campaign.id,u),l.combat&&Da(r.campaign.id,l.combat),(l.name||l.gmName)&&Ya(r.campaign.id,{name:u.name,gmName:u.gmName})}function xt(l){if(a(ze).includes(l)){const v=a(ze).filter(u=>u!==l);ye({sessionRoster:v})}else{const v=[...a(ze),l];ye({sessionRoster:v})}}function it(l){He(l,{campaignApproval:"approved"}),Na({id:l,campaignApproval:"approved"})}function nt(l){Na({id:l,campaignApproval:"rejected",campaignId:null});const u=((ea.get(r.campaign.id)||r.campaign).members||[]).filter(g=>g.id!==l);ye({members:u})}function _t(l){const v=a(Je).find(u=>u.id===l);C(V,{isOpen:!0,title:_()("session.players.remove_title"),message:_()("session.players.remove_message",{values:{name:v?.name||"este personagem"}}),onConfirm:()=>{const u=ea.get(r.campaign.id)||r.campaign;Na({id:l,campaignId:null});const g=(u.sessionRoster||[]).filter(k=>k!==l),W=(u.members||[]).filter(k=>k.id!==l),m=(u.activeEnemies||[]).filter(k=>k.type!=="player"||k.id!==l);ye({sessionRoster:g,members:W,activeEnemies:m}),a(V).isOpen=!1}},!0)}function at(l){const u=(ea.get(r.campaign.id)||r.campaign).activeEnemies||[],g={...l,instanceId:$a(),damage:0,currentHealth:l.health,afflictions:[],acted:!1,initiative:!1};ye({activeEnemies:[...u,g]})}function St(l){const u=(ea.get(r.campaign.id)||r.campaign).activeEnemies||[];let g=[];l.enemies.forEach(W=>{const m=J().find(k=>k.id===W.enemyId);if(m)for(let k=0;k<W.count;k++)g.push({...m,instanceId:$a(),damage:0,currentHealth:m.health,afflictions:[],acted:!1,initiative:!1})}),ye({activeEnemies:[...u,...g]})}function gt(){ye({combat:{active:!0,round:1}}),Da(r.campaign.id,{active:!0,round:1})}function ft(){const l=a(se).filter(v=>v.damage<(v.currentHealth??v.health)&&v.endOfRound&&v.endOfRound.length>0).map(v=>({name:v.name,effects:v.endOfRound}));if(l.length>0){C(E,l,!0),C(R,!0);return}Pt()}function Pt(){const l=ea.get(r.campaign.id)||r.campaign,v=(l.combat?.round||1)+1,u=(l.activeEnemies||[]).map(g=>({...g,acted:!1}));ye({combat:{...l.combat,round:v},activeEnemies:u}),Da(r.campaign.id,{active:!0,round:v}),C(R,!1)}function ht(l){ye({combat:{active:!1,round:1}}),Da(r.campaign.id,{active:!1,round:1})}function Ge(l){const v=ea.get(r.campaign.id)||r.campaign;ye({activeEnemies:(v.activeEnemies||[]).filter(u=>u.instanceId!==l)})}function Xe(l,v){const u=ea.get(r.campaign.id)||r.campaign;ye({activeEnemies:(u.activeEnemies||[]).map(g=>g.instanceId===l?{...g,...v}:g)})}function Ee(){const l=ea.get(r.campaign.id)||r.campaign,v=l.combat?.round||1;v>1&&ye({combat:{...l.combat,round:v-1}})}let Ae=bt(ga(Date.now()));ss(()=>{const l=setInterval(()=>{C(Ae,Date.now(),!0)},1e4);return()=>clearInterval(l)});let P=G(()=>(()=>{const l=a(ge).filter(v=>a(ze).includes(v.id));return Jr(a(ue),l,a(se))})());function be(l){return l.lastUpdate?a(Ae)-l.lastUpdate<6e4:!1}function He(l,v){const u=ea.get(r.campaign.id)||r.campaign,g=u.members||[],W=g.findIndex(q=>q.id===l);let m=g;W!==-1&&(m=[...g],m[W]={...m[W],...v});const k=u.activeEnemies||[],h=k.findIndex(q=>q.id===l&&q.type==="player");let re=k;h!==-1&&(re=[...k],re[h]={...re[h],...v}),ye({members:m,activeEnemies:re})}function oe(l,v,u){l.dataTransfer&&(l.dataTransfer.setData("application/json",JSON.stringify({item:v,type:u})),l.dataTransfer.effectAllowed="copy")}function Le(l){return l.preventDefault(),!1}function De(l){l.preventDefault();const v=l.dataTransfer?.getData("application/json");if(v)try{const{item:u,type:g}=JSON.parse(v);g==="enemy"?at(u):g==="encounter"&&St(u)}catch(u){console.error("Drop error",u)}}var Ze=Ii(),dt=Fe(Ze),Te=t(dt),vt=t(Te),p=t(vt),I=t(p),j=t(I);bs(j,{size:14,class:"text-indigo-500"});var we=s(j),Se=s(we);{var Ie=l=>{var v=Xr(),u=t(v,!0);e(v),x(()=>i(u,a(ge).length)),d(l,v)};y(Se,l=>{a(ge).length>0&&l(Ie)})}e(I);var qe=s(I,2);qe.__click=()=>C(w,!a(w));var yt=t(qe,!0);e(qe),e(p);var st=s(p,2);{var Ot=l=>{var v=ei(),u=t(v),g=s(t(u),2),W=t(g);e(g),e(u);var m=s(u,2);Ye(m,17,()=>a(U),k=>k.id,(k,h)=>{var re=Kr(),q=t(re),ee=t(q),K=t(ee,!0);e(ee);var fe=s(ee,2),ie=t(fe,!0);e(fe),e(q);var Ue=s(q,2),te=t(Ue);te.__click=()=>it(a(h).id);var Pe=t(te);os(Pe,{size:14}),e(te);var Ne=s(te,2);Ne.__click=()=>nt(a(h).id);var wt=t(Ne);fa(wt,{size:14}),e(Ne),e(Ue),e(re),x(pt=>{i(K,a(h).name),i(ie,pt)},[()=>_()("session.players.new_request")]),d(k,re)}),Ea(2),e(v),x(k=>i(W,`${k??""} (${a(U).length??""})`),[()=>_()("session.players.waiting_approval")]),d(l,v)};y(st,l=>{a(U).length>0&&l(Ot)})}var pe=s(st,2),H=t(pe),A=t(H);Ye(A,17,()=>a(ge),l=>l.id,(l,v)=>{const u=G(()=>be(a(v))),g=G(()=>a(ze).includes(a(v).id));var W=ai(),m=t(W),k=s(m,2),h=t(k),re=t(h,!0);e(h);var q=s(h,2),ee=t(q);{var K=Ve=>{var rt=ti(),Et=t(rt,!0);e(rt),x(qt=>i(Et,qt),[()=>_()("common.labels.session")]),d(Ve,rt)};y(ee,Ve=>{a(g)&&Ve(K)})}var fe=s(ee);e(q),e(k);var ie=s(k,2),Ue=t(ie);Ue.__click=()=>xt(a(v).id);var te=t(Ue);{var Pe=Ve=>{fs(Ve,{size:14})},Ne=Ve=>{ra(Ve,{size:14})};y(te,Ve=>{a(g)?Ve(Pe):Ve(Ne,!1)})}e(Ue);var wt=s(Ue,2);wt.__click=()=>_t(a(v).id);var pt=t(wt);fa(pt,{size:14}),e(wt),e(ie),e(W),x((Ve,rt,Et)=>{Qe(W,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(u)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(u)||a(g)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),Qe(m,1,`w-2 h-2 rounded-full ${a(u)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),Qe(h,1,`font-bold text-sm ${a(u)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),i(re,a(v).name),i(fe,` ${Ve??""} ${a(v).level??""} • ${a(v).ancestry??""}`),Qe(Ue,1,`p-1.5 rounded-lg transition-all ${a(g)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),de(Ue,"title",rt),de(wt,"title",Et)},[()=>_()("common.labels.level"),()=>a(g)?_()("session.players.remove_from_session"):_()("session.players.add_to_session"),()=>_()("session.players.kick_from_campaign")]),d(l,W)});var L=s(A,2);{var X=l=>{var v=si(),u=t(v,!0);e(v),x(g=>i(u,g),[()=>_()("session.players.none")]),d(l,v)};y(L,l=>{a(ge).length===0&&l(X)})}e(H),e(pe);var B=s(pe,2),Q=t(B);{var le=l=>{var v=ri(),u=Fe(v);u.__click=()=>ye({isPublished:!0});var g=t(u);pa(g,{size:14});var W=s(g);e(u);var m=s(u,2),k=t(m,!0);e(m),x((h,re)=>{i(W,` ${h??""}`),i(k,re)},[()=>_()("session.publish.publish_session"),()=>_()("session.publish.make_visible")]),d(l,v)},Ke=l=>{var v=oi(),u=Fe(v),g=t(u),W=t(g),m=t(W);xs(m,{size:10,class:"animate-pulse"});var k=s(m);e(W),e(g);var h=s(g,2);h.__click=()=>C(ae,!a(ae));var re=t(h);ur(re,{size:14}),e(h),e(u);var q=s(u,2);{var ee=rt=>{var Et=ii(),qt=t(Et);e(Et),x((Rt,Nt)=>{de(qt,"src",Rt),de(qt,"alt",Nt)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(T))}`,()=>_()("session.publish.qr_alt")]),d(rt,Et)};y(q,rt=>{a(ae)&&rt(ee)})}var K=s(q,2),fe=t(K),ie=t(fe);ie.__click=$e;var Ue=t(ie,!0);e(ie);var te=s(ie,2);te.__click=$e;var Pe=t(te);{var Ne=rt=>{var Et=ni(),qt=t(Et);os(qt,{size:10,class:"inline mr-1"});var Rt=s(qt);e(Et),x(Nt=>i(Rt,` ${Nt??""}`),[()=>_()("common.buttons.copied")]),d(rt,Et)};y(Pe,rt=>{a(Z)&&rt(Ne)})}var wt=s(Pe,2);dr(wt,{size:14}),e(te),e(fe),e(K);var pt=s(K,2);pt.__click=()=>ye({isPublished:!1});var Ve=t(pt,!0);e(pt),x((rt,Et,qt,Rt)=>{i(k,` ${rt??""}`),de(h,"title",Et),i(Ue,a(T)),de(te,"aria-label",qt),i(Ve,Rt)},[()=>_()("session.publish.public_session"),()=>_()("session.publish.qr_code"),()=>_()("session.publish.copy_link"),()=>_()("session.publish.remove_public")]),d(l,v)};y(Q,l=>{r.campaign?.isPublished?l(Ke,!1):l(le)})}e(B),e(vt);var xe=s(vt,2),ce=t(xe),Y=t(ce);Y.__click=()=>C(D,"enemies");var Re=t(Y);Ca(Re,{size:14});var _e=s(Re);e(Y);var Be=s(Y,2);Be.__click=()=>C(D,"encounters");var ot=t(Be);Xa(ot,{size:14});var lt=s(ot);e(Be),e(ce);var ct=s(ce,2),Ft=t(ct);{var It=l=>{var v=vi(),u=Fe(v);Ye(u,17,()=>a(ve),m=>m.id,(m,k)=>{var h=li(),re=t(h),q=t(re);cr(q,{size:12,class:"text-slate-600 cursor-grab"});var ee=s(q,2),K=t(ee),fe=t(K),ie=s(fe);{var Ue=pt=>{pa(pt,{size:10,class:"text-indigo-400"})};y(ie,pt=>{a(k).global&&pt(Ue)})}e(K);var te=s(K,2),Pe=t(te);e(te),e(ee),e(re);var Ne=s(re,2);Ne.__click=()=>at(a(k));var wt=t(Ne);ra(wt,{size:16}),e(Ne),e(h),x(pt=>{i(fe,`${a(k).name??""} `),i(Pe,`${pt??""} ${a(k).difficulty??""}`)},[()=>_()("session.enemies.difficulty")]),ja("dragstart",h,pt=>oe(pt,a(k),"enemy")),d(m,h)});var g=s(u,2);{var W=m=>{var k=di(),h=t(k,!0);e(k),x(re=>i(h,re),[()=>_()("session.enemies.none")]),d(m,k)};y(g,m=>{a(ve).length===0&&m(W)})}d(l,v)},Vt=l=>{var v=bi(),u=Fe(v);Ye(u,17,()=>a(Oe),m=>m.id,(m,k)=>{var h=ci(),re=t(h),q=t(re),ee=t(q),K=s(ee);{var fe=Ne=>{pa(Ne,{size:10,class:"text-indigo-400"})};y(K,Ne=>{a(k).global&&Ne(fe)})}e(q);var ie=s(q,2),Ue=t(ie);e(ie),e(re);var te=s(re,2);te.__click=()=>St(a(k));var Pe=t(te);Za(Pe,{size:14}),e(te),e(h),x((Ne,wt)=>{i(ee,`${a(k).name??""} `),i(Ue,`${Ne??""} ${wt??""}`)},[()=>a(k).enemies?.reduce((Ne,wt)=>Ne+wt.count,0)||0,()=>_()("session.enemies.title")]),ja("dragstart",h,Ne=>oe(Ne,a(k),"encounter")),d(m,h)});var g=s(u,2);{var W=m=>{var k=ui(),h=t(k,!0);e(k),x(re=>i(h,re),[()=>_()("session.enemies.no_encounters")]),d(m,k)};y(g,m=>{a(Oe).length===0&&m(W)})}d(l,v)};y(Ft,l=>{a(D)==="enemies"?l(It):l(Vt,!1)})}e(ct),e(xe),e(Te);var At=s(Te,2),f=t(At),b=t(f),O=t(b);{var z=l=>{var v=xi();v.__click=gt;var u=t(v);js(u,{size:20});var g=s(u);e(v),x(W=>i(g,` ${W??""}`),[()=>_()("session.combat.start")]),d(l,v)},ke=l=>{var v=_i(),u=t(v);u.__click=Ee;var g=t(u);Ha(g,{size:20}),e(u);var W=s(u,2),m=t(W),k=t(m,!0);e(m);var h=s(m),re=t(h,!0);e(h),e(W);var q=s(W,2);q.__click=ft;var ee=t(q);Gs(ee,{size:16});var K=s(ee);e(q);var fe=s(q,4);fe.__click=()=>ht();var ie=t(fe,!0);e(fe),e(v),x((Ue,te,Pe,Ne,wt)=>{de(u,"title",Ue),i(k,te),i(re,a(kt).round),de(q,"title",Pe),i(K,` ${Ne??""}`),i(ie,wt)},[()=>_()("session.combat.previous"),()=>_()("session.combat.round"),()=>_()("session.combat.next"),()=>_()("session.combat.next"),()=>_()("session.combat.end")]),d(l,v)};y(O,l=>{a(kt).active?l(ke,!1):l(z)})}e(b),e(f);var We=s(f,2);{var tt=l=>{var v=fi(),u=t(v);{var g=m=>{ls(m,{get tier(){return a(je)},get totalDifficulty(){return a(he)}})},W=m=>{ds(m,{get tier(){return a(je)},get totalDifficulty(){return a(he)},get playerCount(){return a(Me)}})};y(u,m=>{r.campaign?.system==="sofdl"?m(g):m(W,!1)})}e(v),d(l,v)};y(We,l=>{a(se).length>0&&l(tt)})}var et=s(We,2),zt=t(et);Ye(zt,25,()=>a(P),l=>l.type==="player"?l.id:l.instanceId,(l,v)=>{var u=mi(),g=t(u);Hr(g,{get entity(){return a(v)},updateEnemy:Xe,removeFromCombat:Ge,updatePlayer:He}),e(u),Ls(u,()=>Lr,()=>({duration:300})),d(l,u)});var Ct=s(zt,2);{var Ht=l=>{var v=pi(),u=t(v,!0);e(v),x(g=>i(u,g),[()=>_()("session.combat.empty")]),d(l,v)};y(Ct,l=>{a(P).length===0&&l(Ht)})}e(et),e(At);var Dt=s(At,2),Bt=t(Dt);{var Gt=l=>{var v=$t(),u=Fe(v);{var g=m=>{ls(m,{get tier(){return a(je)},get totalDifficulty(){return a(he)}})},W=m=>{ds(m,{get tier(){return a(je)},get totalDifficulty(){return a(he)},get playerCount(){return a(Me)}})};y(u,m=>{r.campaign?.system==="sofdl"?m(g):m(W,!1)})}d(l,v)};y(Bt,l=>{a(se).length>0&&l(Gt)})}e(Dt),e(dt);var Xt=s(dt,2);{var ta=l=>{var v=yi();v.__click=Ne=>{Ne.target===Ne.currentTarget&&C(R,!1)};var u=t(v),g=t(u),W=t(g),m=t(W);Vs(m,{size:24}),e(W);var k=s(W,2),h=t(k),re=t(h,!0);e(h);var q=s(h,2),ee=t(q,!0);e(q),e(k),e(g);var K=s(g,2);Ye(K,21,()=>a(E),Mt,(Ne,wt)=>{var pt=hi(),Ve=t(pt),rt=t(Ve);Ca(rt,{size:14,class:"text-slate-500"});var Et=s(rt);e(Ve);var qt=s(Ve,2);Ye(qt,21,()=>a(wt).effects,Mt,(Rt,Nt)=>{var Lt=gi(),Yt=t(Lt),Kt=t(Yt);e(Yt);var va=s(Yt,2),wa=t(va,!0);e(va),e(Lt),x(()=>{i(Kt,`${a(Nt).name??""}:`),i(wa,a(Nt).desc)}),d(Rt,Lt)}),e(qt),e(pt),x(()=>i(Et,` ${a(wt).name??""}`)),d(Ne,pt)}),e(K);var fe=s(K,2),ie=t(fe);ie.__click=()=>C(R,!1);var Ue=t(ie,!0);e(ie);var te=s(ie,2);te.__click=Pt;var Pe=t(te,!0);e(te),e(fe),e(u),e(v),x((Ne,wt,pt,Ve)=>{i(re,Ne),i(ee,wt),i(Ue,pt),i(Pe,Ve)},[()=>_()("session.end_of_round.title"),()=>_()("session.end_of_round.summary"),()=>_()("common.buttons.cancel"),()=>_()("session.end_of_round.advance")]),d(l,v)};y(Xt,l=>{a(R)&&l(ta)})}var Jt=s(Xt,2);{var Wt=l=>{var v=zi();v.__click=te=>{te.target===te.currentTarget&&C(w,!1)};var u=t(v),g=t(u),W=t(g),m=t(W),k=t(m,!0);e(m);var h=s(m,2),re=t(h,!0);e(h),e(W);var q=s(W,2);q.__click=()=>C(w,!1);var ee=t(q);ya(ee,{size:16}),e(q),e(g);var K=s(g,2),fe=t(K);Ye(fe,17,()=>a(ne),Mt,(te,Pe)=>{var Ne=wi();Ne.__click=()=>xt(a(Pe).id);var wt=t(Ne),pt=t(wt,!0);e(wt);var Ve=s(wt,2),rt=t(Ve),Et=t(rt,!0);e(rt);var qt=s(rt,2),Rt=t(qt);e(qt),e(Ve);var Nt=s(Ve,2),Lt=t(Nt);ra(Lt,{size:16}),e(Nt),e(Ne),x((Yt,Kt)=>{i(pt,Yt),i(Et,a(Pe).name),i(Rt,`${Kt??""} ${a(Pe).level??""} • ${a(Pe).ancestry??""}`)},[()=>a(Pe).name.charAt(0),()=>_()("common.labels.level")]),d(te,Ne)});var ie=s(fe,2);{var Ue=te=>{var Pe=ki(),Ne=t(Pe),wt=t(Ne);Ca(wt,{size:24}),e(Ne);var pt=s(Ne,2),Ve=t(pt,!0);e(pt);var rt=s(pt,2),Et=t(rt,!0);e(rt),e(Pe),x((qt,Rt)=>{i(Ve,qt),i(Et,Rt)},[()=>_()("session.manage_session.no_available"),()=>_()("session.manage_session.all_in_session")]),d(te,Pe)};y(ie,te=>{a(ne).length===0&&te(Ue)})}e(K),e(u),e(v),x((te,Pe)=>{i(k,te),i(re,Pe)},[()=>_()("session.manage_session.title"),()=>_()("session.manage_session.description")]),d(l,v)};y(Jt,l=>{a(w)&&l(Wt)})}var Qt=s(Jt,2);{var ca=l=>{var v=$i();v.__click=Ve=>{Ve.target===Ve.currentTarget&&C(N,!1)};var u=t(v),g=t(u),W=t(g),m=t(W);Ca(m,{size:16});var k=s(m);e(W);var h=s(W,2);h.__click=()=>C(N,!1);var re=t(h);ya(re,{size:18}),e(h),e(g);var q=s(g,2),ee=t(q);ee.__click=()=>C(D,"enemies");var K=t(ee);Ca(K,{size:14});var fe=s(K);e(ee);var ie=s(ee,2);ie.__click=()=>C(D,"encounters");var Ue=t(ie);Xa(Ue,{size:14});var te=s(Ue);e(ie),e(q);var Pe=s(q,2),Ne=t(Pe);{var wt=Ve=>{var rt=Mi(),Et=Fe(rt);Ye(Et,17,()=>a(ve),Nt=>Nt.id,(Nt,Lt)=>{var Yt=Ci(),Kt=t(Yt),va=t(Kt),wa=t(va),La=s(wa);{var qa=na=>{pa(na,{size:10,class:"text-indigo-400"})};y(La,na=>{a(Lt).global&&na(qa)})}e(va);var Sa=s(va,2),Ba=t(Sa);e(Sa),e(Kt);var ka=s(Kt,2);ka.__click=()=>{at(a(Lt)),C(N,!1)};var Wa=t(ka);ra(Wa,{size:16}),e(ka),e(Yt),x(na=>{i(wa,`${a(Lt).name??""} `),i(Ba,`${na??""} ${a(Lt).difficulty??""}`)},[()=>_()("session.enemies.difficulty")]),d(Nt,Yt)});var qt=s(Et,2);{var Rt=Nt=>{var Lt=ji(),Yt=t(Lt,!0);e(Lt),x(Kt=>i(Yt,Kt),[()=>_()("session.enemies.none")]),d(Nt,Lt)};y(qt,Nt=>{a(ve).length===0&&Nt(Rt)})}d(Ve,rt)},pt=Ve=>{var rt=Si(),Et=Fe(rt);Ye(Et,17,()=>a(Oe),Nt=>Nt.id,(Nt,Lt)=>{var Yt=Oi(),Kt=t(Yt),va=t(Kt),wa=t(va),La=s(wa);{var qa=na=>{pa(na,{size:10,class:"text-indigo-400"})};y(La,na=>{a(Lt).global&&na(qa)})}e(va);var Sa=s(va,2),Ba=t(Sa);e(Sa),e(Kt);var ka=s(Kt,2);ka.__click=()=>{St(a(Lt)),C(N,!1)};var Wa=t(ka);Za(Wa,{size:16}),e(ka),e(Yt),x((na,Ja)=>{i(wa,`${a(Lt).name??""} `),i(Ba,`${na??""} ${Ja??""}`)},[()=>a(Lt).enemies?.reduce((na,Ja)=>na+Ja.count,0)||0,()=>_()("session.enemies.title")]),d(Nt,Yt)});var qt=s(Et,2);{var Rt=Nt=>{var Lt=Ei(),Yt=t(Lt,!0);e(Lt),x(Kt=>i(Yt,Kt),[()=>_()("session.enemies.no_encounters")]),d(Nt,Lt)};y(qt,Nt=>{a(Oe).length===0&&Nt(Rt)})}d(Ve,rt)};y(Ne,Ve=>{a(D)==="enemies"?Ve(wt):Ve(pt,!1)})}e(Pe),e(u),e(v),x((Ve,rt,Et)=>{i(k,` ${Ve??""}`),Qe(ee,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(D)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(fe,` ${rt??""}`),Qe(ie,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(D)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(te,` ${Et??""}`)},[()=>_()("session.enemies.title"),()=>_()("session.enemies.title"),()=>_()("session.enemies.encounters")]),d(l,v)};y(Qt,l=>{a(N)&&l(ca)})}var Zt=s(Qt,2);Zt.__click=()=>C(N,!0);var mt=t(Zt);Ca(mt,{size:24}),e(Zt);var Tt=s(Zt,2);ms(Tt,{get isOpen(){return M()},onClose:()=>Ma.set(!1)});var ia=s(Tt,2);cs(ia,{get isOpen(){return a(V).isOpen},get title(){return a(V).title},get message(){return a(V).message},get onConfirm(){return a(V).onConfirm},onCancel:()=>a(V).isOpen=!1}),x((l,v,u,g)=>{i(we,` ${l??""} `),i(yt,v),Qe(Y,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(D)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(_e,` ${u??""}`),Qe(Be,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(D)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(lt,` ${g??""}`)},[()=>_()("session.players.title"),()=>a(w)?_()("session.players.close"):_()("session.players.add"),()=>_()("session.enemies.title"),()=>_()("session.enemies.encounters")]),ja("dragover",At,Le),ja("drop",At,De),d(F,Ze),da(),n()}ma(["click"]);var Ri=c('<span class="text-[10px] text-indigo-300 uppercase font-bold mb-2 block"> </span>'),Ni=c('<div><!> <div class="flex items-center justify-between bg-black/40 rounded-xl p-1.5 border border-white/5"><button type="button" class="w-10 h-10 flex items-center justify-center bg-slate-800 hover:bg-slate-700 text-slate-300 rounded-lg transition-all active:scale-90 disabled:opacity-50 disabled:cursor-not-allowed"><!></button> <div class="flex flex-col items-center min-w-[3rem]"><span class="text-2xl font-black text-white leading-none tracking-tighter"> </span></div> <button type="button" class="w-10 h-10 flex items-center justify-center bg-indigo-600 hover:bg-indigo-500 text-white rounded-lg transition-all active:scale-90 shadow-lg shadow-indigo-500/20 disabled:opacity-50 disabled:cursor-not-allowed"><!></button></div></div>');function Os(F,r){la(r,!0);const o=()=>Ut(aa,"$t",J),[J,S]=oa();function _(){const T=r.steps.indexOf(r.value);if(T>0)r.onUpdate(r.steps[T-1]);else if(T===-1){const $e=[...r.steps].reverse().find(ze=>ze<r.value);$e!==void 0?r.onUpdate($e):r.onUpdate(r.steps[0])}}function M(){const T=r.steps.indexOf(r.value);if(T!==-1&&T<r.steps.length-1)r.onUpdate(r.steps[T+1]);else if(T===-1){const $e=r.steps.find(ze=>ze>r.value);$e!==void 0?r.onUpdate($e):r.onUpdate(r.steps[r.steps.length-1])}}var $=Ni(),n=t($);{var w=T=>{var $e=Ri(),ze=t($e,!0);e($e),x(()=>i(ze,r.label)),d(T,$e)};y(n,T=>{r.label&&T(w)})}var N=s(n,2),Z=t(N);Z.__click=_;var ae=t(Z);fs(ae,{size:18}),e(Z);var me=s(Z,2),D=t(me),R=t(D,!0);e(D),e(me);var E=s(me,2);E.__click=M;var V=t(E);ra(V,{size:18}),e(E),e(N),e($),x((T,$e)=>{de(Z,"aria-label",T),Z.disabled=r.value<=r.steps[0],i(R,r.value),de(E,"aria-label",$e),E.disabled=r.value>=r.steps[r.steps.length-1]},[()=>o()("common.buttons.decrease"),()=>o()("common.buttons.increase")]),d(F,$),da(),S()}ma(["click"]);var Ai=c('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),Ti=c('<div class="text-xs text-slate-500 italic mt-2 leading-relaxed opacity-75"> </div>'),Ui=c('<span class="text-slate-400"> </span>'),Pi=c('<span class="text-slate-400"> </span>'),Fi=c('<div class="text-sm mb-4"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span></div>'),Hi=c('<div class="mb-3 text-sm"><span class="font-bold text-indigo-400"> </span> <span class="text-slate-300 ml-1"> </span></div>'),Li=c('<span class="text-slate-300"> </span>'),qi=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span> <span class="text-white ml-1"> </span> <!></div>'),Bi=c('<div class="mt-4"><h4 class="text-red-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Wi=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),Ji=c('<div class="mt-4"><h4 class="text-orange-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Gi=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),Vi=c('<div class="mt-4"><h4 class="text-yellow-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),Qi=c('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl"><div class="flex items-start gap-3 mb-4"><!> <div class="flex-1 min-w-0"><div class="flex items-baseline gap-2"><h2 class="text-xl font-bold text-white font-serif tracking-wide"> </h2> <span class="text-red-500 font-bold text-sm"> </span></div> <div class="text-sm text-slate-400 mt-1"> </div> <!></div></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <span class="text-slate-500 font-bold ml-3"> </span> <span class="text-white ml-1"> </span></div> <div class="text-sm mb-3"><span class="text-white"><span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> </span></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <!> <div class="border-t border-slate-700 my-4"></div> <!> <!> <!> <!></div>'),Yi=c('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc-text" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc-text" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-desc" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div class="flex items-center gap-2 mt-4"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),Zi=c('<div class="bg-slate-900 p-3 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Xi=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div class="flex flex-col"><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-perception" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-perception" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-speed-notes" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed-notes" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-senses" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[80px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div></div></div>'),Ki=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),en=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-2"><div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <select class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm"><option> </option><option> </option></select></div> <div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/> <input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/></div> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),tn=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),an=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),sn=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="p-4 bg-slate-900 rounded border border-indigo-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-indigo-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-red-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-red-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-orange-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-orange-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-yellow-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-yellow-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div></div>'),rn=c('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),nn=c('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" aria-label="Close" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-start justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function on(F,r){la(r,!0);const o=()=>Ut(aa,"$t",J),[J,S]=oa(),_=U=>{var ne=Qi(),ve=t(ne),Oe=t(ve);{var ye=b=>{var O=Ai(),z=t(O);Ia(z,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom"}),e(O),d(b,O)};y(Oe,b=>{a(n).imageUrl&&b(ye)})}var xt=s(Oe,2),it=t(xt),nt=t(it),_t=t(nt,!0);e(nt);var at=s(nt,2),St=t(at);e(at),e(it);var gt=s(it,2),ft=t(gt);e(gt);var Pt=s(gt,2);{var ht=b=>{var O=Ti(),z=t(O,!0);e(O),x(()=>i(z,a(n).description)),d(b,O)};y(Pt,b=>{a(n).description&&b(ht)})}e(xt),e(ve);var Ge=s(ve,2),Xe=t(Ge),Ee=t(Xe,!0);e(Xe);var Ae=s(Xe,2),P=t(Ae);e(Ae);var be=s(Ae,2);{var He=b=>{var O=Ui(),z=t(O);e(O),x(()=>i(z,`; ${a(n).senses??""}`)),d(b,O)};y(be,b=>{a(n).senses&&b(He)})}e(Ge);var oe=s(Ge,2),Le=t(oe),De=t(Le,!0);e(Le);var Ze=s(Le,2),dt=t(Ze,!0);e(Ze);var Te=s(Ze,2),vt=t(Te,!0);e(Te);var p=s(Te,2),I=t(p,!0);e(p),e(oe);var j=s(oe,2),we=t(j),Se=t(we),Ie=t(Se,!0);e(Se);var qe=s(Se),yt=s(qe),st=t(yt,!0);e(yt);var Ot=s(yt),pe=s(Ot),H=t(pe,!0);e(pe);var A=s(pe),L=s(A),X=t(L,!0);e(L);var B=s(L);e(we),e(j);var Q=s(j,2),le=t(Q),Ke=t(le,!0);e(le);var xe=s(le,2),ce=t(xe,!0);e(xe);var Y=s(xe,2);{var Re=b=>{var O=Pi(),z=t(O);e(O),x(()=>i(z,`; ${a(n).speedNotes??""}`)),d(b,O)};y(Y,b=>{a(n).speedNotes&&b(Re)})}e(Q);var _e=s(Q,2);{var Be=b=>{var O=Fi(),z=t(O),ke=t(z,!0);e(z);var We=s(z,2),tt=t(We,!0);e(We),e(O),x(et=>{i(ke,et),i(tt,a(n).immunities)},[()=>o()("session.enemy_modal.immunities")]),d(b,O)};y(_e,b=>{a(n).immunities&&b(Be)})}var ot=s(_e,4);{var lt=b=>{var O=$t(),z=Fe(O);Ye(z,17,()=>a(n).traits,Mt,(ke,We)=>{var tt=Hi(),et=t(tt),zt=t(et,!0);e(et);var Ct=s(et,2),Ht=t(Ct,!0);e(Ct),e(tt),x(()=>{i(zt,a(We).name),i(Ht,a(We).desc)}),d(ke,tt)}),d(b,O)};y(ot,b=>{a(n).traits.length>0&&b(lt)})}var ct=s(ot,2);{var Ft=b=>{var O=Bi(),z=t(O),ke=t(z,!0);e(z);var We=s(z,2);Ye(We,17,()=>a(n).attackOptions,Mt,(tt,et)=>{var zt=qi(),Ct=t(zt),Ht=t(Ct,!0);e(Ct);var Dt=s(Ct,2),Bt=t(Dt);e(Dt);var Gt=s(Dt,2),Xt=t(Gt);e(Gt);var ta=s(Gt,2);{var Jt=Wt=>{var Qt=Li(),ca=t(Qt);e(Qt),x(()=>i(ca,`; ${a(et).desc??""}`)),d(Wt,Qt)};y(ta,Wt=>{a(et).desc&&Wt(Jt)})}e(zt),x(Wt=>{i(Ht,a(et).name),i(Bt,`(${Wt??""})`),i(Xt,`${a(et).attackRoll??""} (${a(et).damage??""})`)},[()=>a(et).type==="melee"?o()("session.enemy_modal.melee").toLowerCase():o()("session.enemy_modal.ranged").toLowerCase()]),d(tt,zt)}),e(O),x(tt=>i(ke,tt),[()=>o()("session.enemy_modal.attack_options")]),d(b,O)};y(ct,b=>{a(n).attackOptions.length>0&&b(Ft)})}var It=s(ct,2);{var Vt=b=>{var O=Ji(),z=t(O),ke=t(z,!0);e(z);var We=s(z,2);Ye(We,17,()=>a(n).specialAttacks,Mt,(tt,et)=>{var zt=Wi(),Ct=t(zt),Ht=t(Ct,!0);e(Ct);var Dt=s(Ct,2),Bt=t(Dt,!0);e(Dt),e(zt),x(()=>{i(Ht,a(et).name),i(Bt,a(et).desc)}),d(tt,zt)}),e(O),x(tt=>i(ke,tt),[()=>o()("session.enemy_modal.special_attacks")]),d(b,O)};y(It,b=>{a(n).specialAttacks.length>0&&b(Vt)})}var At=s(It,2);{var f=b=>{var O=Vi(),z=t(O),ke=t(z,!0);e(z);var We=s(z,2);Ye(We,17,()=>a(n).endOfRound,Mt,(tt,et)=>{var zt=Gi(),Ct=t(zt),Ht=t(Ct,!0);e(Ct);var Dt=s(Ct,2),Bt=t(Dt,!0);e(Dt),e(zt),x(()=>{i(Ht,a(et).name),i(Bt,a(et).desc)}),d(tt,zt)}),e(O),x(tt=>i(ke,tt),[()=>o()("session.enemy_modal.end_of_round")]),d(b,O)};y(At,b=>{a(n).endOfRound.length>0&&b(f)})}e(ne),x((b,O,z,ke,We,tt,et,zt,Ct,Ht,Dt,Bt,Gt,Xt,ta,Jt,Wt)=>{i(_t,b),i(St,`${O??""} ${a(n).difficulty??""}`),i(ft,`${z??""} ${ke??""} ${a(n).descriptors??""}`),i(Ee,We),i(P,`${a(n).perception??""} (${tt??""})`),i(De,et),i(dt,a(n).defense),i(vt,zt),i(I,a(n).health),i(Ie,Ct),i(qe,` ${a(n).attributes.strength??""} (${Ht??""}), `),i(st,Dt),i(Ot,` ${a(n).attributes.agility??""} (${Bt??""}), `),i(H,Gt),i(A,` ${a(n).attributes.intellect??""} (${Xt??""}), `),i(X,ta),i(B,` ${a(n).attributes.will??""} (${Jt??""})`),i(Ke,Wt),i(ce,a(n).speed)},[()=>a(n).name||o()("session.enemy_modal.enemy_default"),()=>o()("session.enemies.difficulty").toUpperCase(),()=>o()("session.enemy_modal.size"),()=>V(a(n).size),()=>o()("sofdl.attributes.perception"),()=>E(a(n).perception),()=>o()("session.enemy_modal.defense"),()=>o()("session.enemy_modal.health"),()=>o()("sofdl.attributes.strength"),()=>E(a(n).attributes.strength),()=>o()("sofdl.attributes.agility"),()=>E(a(n).attributes.agility),()=>o()("sofdl.attributes.intellect"),()=>E(a(n).attributes.intellect),()=>o()("sofdl.attributes.will"),()=>E(a(n).attributes.will),()=>o()("session.enemy_modal.speed")]),d(U,ne)};let M=sa(r,"isOpen",3,!1),$=sa(r,"initialData",3,"{}"),n=bt(ga(R())),w=bt("general"),N=bt(!1),Z=bt(""),ae=bt(void 0);function me(U){const ne=U.target.files;if(ne&&ne.length>0){const ve=ne[0],Oe=new FileReader;Oe.onload=()=>{C(Z,Oe.result,!0),C(N,!0)},Oe.readAsDataURL(ve)}U.target&&(U.target.value="")}async function D(U){try{const ne=await gs(U);a(n).imageUrl=ne,C(N,!1)}catch(ne){console.error(ne),alert(ne.message||"Erro ao salvar imagem")}}function R(){return{name:"",difficulty:1,size:1,description:"",descriptors:"",perception:10,senses:"",defense:10,health:10,attributes:{strength:10,agility:10,intellect:10,will:10},speed:10,speedNotes:"",immunities:"",traits:[],attackOptions:[],specialAttacks:[],endOfRound:[],imageUrl:"",global:!1}}function E(U){const ne=U-10;return ne>=0?`+${ne}`:`${ne}`}function V(U){return U===.125?"1/8":U===.5?"1/2":U}Fa(()=>{if(M()&&$())try{const U=JSON.parse($());Object.keys(U).length===0?C(n,R(),!0):C(n,{...R(),...U},!0)}catch{C(n,R(),!0)}});function T(){a(n).traits=[...a(n).traits,{name:"",desc:""}]}function $e(U){a(n).traits=a(n).traits.filter((ne,ve)=>ve!==U)}function ze(){a(n).attackOptions=[...a(n).attackOptions,{name:"",type:"melee",attackRoll:"+0",damage:"1d6",desc:""}]}function kt(U){a(n).attackOptions=a(n).attackOptions.filter((ne,ve)=>ve!==U)}function se(){a(n).specialAttacks=[...a(n).specialAttacks,{name:"",desc:""}]}function Ce(U){a(n).specialAttacks=a(n).specialAttacks.filter((ne,ve)=>ve!==U)}function ue(){a(n).endOfRound=[...a(n).endOfRound,{name:"",desc:""}]}function je(U){a(n).endOfRound=a(n).endOfRound.filter((ne,ve)=>ve!==U)}function he(U){}var Me=$t(),Je=Fe(Me);{var ge=U=>{var ne=nn(),ve=Fe(ne);ve.__click=he;var Oe=t(ve),ye=t(Oe),xt=t(ye),it=t(xt),nt=t(it);nt.__click=function(...pe){r.onClose?.apply(this,pe)};var _t=t(nt);Ha(_t,{size:24}),e(nt);var at=s(nt,2),St=t(at,!0);e(at),e(it);var gt=s(it,2);gt.__click=function(...pe){r.onClose?.apply(this,pe)};var ft=t(gt);ya(ft,{size:20}),e(gt),e(xt);var Pt=s(xt,2),ht=t(Pt);ht.__click=()=>C(w,"general");var Ge=t(ht,!0);e(ht);var Xe=s(ht,2);Xe.__click=()=>C(w,"stats");var Ee=t(Xe,!0);e(Xe);var Ae=s(Xe,2);Ae.__click=()=>C(w,"abilities");var P=t(Ae,!0);e(Ae);var be=s(Ae,2);be.__click=()=>C(w,"preview");var He=t(be,!0);e(be),e(Pt);var oe=s(Pt,2),Le=t(oe);{var De=pe=>{var H=Yi(),A=t(H),L=t(A);L.__click=()=>a(ae)?.click();var X=t(L),B=t(X);ts(B,()=>a(n).imageUrl,z=>{Ia(z,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom",fallbackText:"?"})}),e(X);var Q=s(X,2),le=t(Q);hs(le,{size:20,class:"text-white"}),e(Q),e(L);var Ke=s(L,2),xe=t(Ke),ce=t(xe,!0);e(xe);var Y=s(xe,2);jt(Y),e(Ke),e(A);var Re=s(A,2),_e=t(Re),Be=t(_e,!0);e(_e);var ot=s(_e,2);ha(ot),e(Re);var lt=s(Re,2),ct=t(lt),Ft=t(ct,!0);e(ct);var It=s(ct,2);jt(It),e(lt);var Vt=s(lt,2),At=t(Vt);jt(At);var f=s(At,2),b=t(f);pa(b,{size:14});var O=s(b);e(f),e(Vt),e(H),x((z,ke,We,tt,et,zt)=>{i(ce,z),i(Be,ke),de(ot,"placeholder",We),i(Ft,tt),de(It,"placeholder",et),i(O,` ${zt??""}`)},[()=>o()("session.enemy_modal.name"),()=>o()("session.enemy_modal.description"),()=>o()("session.enemy_modal.description_placeholder"),()=>o()("session.enemy_modal.descriptors"),()=>o()("session.enemy_modal.descriptors_placeholder"),()=>o()("session.enemy_modal.global_enemy")]),ut(Y,()=>a(n).name,z=>a(n).name=z),ut(ot,()=>a(n).description,z=>a(n).description=z),ut(It,()=>a(n).descriptors,z=>a(n).descriptors=z),vs(At,()=>a(n).global,z=>a(n).global=z),d(pe,H)},Ze=pe=>{var H=$t(),A=Fe(H);{var L=B=>{var Q=Xi(),le=t(Q),Ke=t(le),xe=t(Ke),ce=t(xe,!0);e(xe);var Y=s(xe,2);{let m=G(()=>a(n).difficulty??0);Os(Y,{get value(){return a(m)},onUpdate:k=>a(n).difficulty=k,steps:[0,1,5,10,25,50,100,250,500,750,1e3]})}e(Ke);var Re=s(Ke,2),_e=t(Re),Be=t(_e,!0);e(_e);var ot=s(_e,2);{let m=G(()=>a(n).size||1);ys(ot,{get value(){return a(m)},onUpdate:k=>a(n).size=k})}e(Re),e(le);var lt=s(le,2),ct=t(lt),Ft=t(ct),It=t(Ft,!0);e(Ft);var Vt=s(Ft,2);jt(Vt),e(ct);var At=s(ct,2),f=t(At),b=t(f,!0);e(f);var O=s(f,2);jt(O),e(At),e(lt);var z=s(lt,2),ke=t(z),We=t(ke),tt=t(We,!0);e(We);var et=s(We,2);jt(et),e(ke);var zt=s(ke,2),Ct=t(zt),Ht=t(Ct,!0);e(Ct);var Dt=s(Ct,2);jt(Dt),e(zt),e(z);var Bt=s(z,2),Gt=t(Bt),Xt=t(Gt,!0);e(Gt);var ta=s(Gt,2);Ye(ta,5,()=>[{key:"strength",label:o()("sofdl.attributes.strength")},{key:"agility",label:o()("sofdl.attributes.agility")},{key:"intellect",label:o()("sofdl.attributes.intellect")},{key:"will",label:o()("sofdl.attributes.will")}],Mt,(m,k)=>{var h=Zi(),re=t(h),q=t(re,!0);e(re);var ee=s(re,2);jt(ee);var K=s(ee,2),fe=t(K,!0);e(K),e(h),x((ie,Ue)=>{de(re,"for",`attr-${a(k).key??""}`),de(re,"title",a(k).label),i(q,ie),de(ee,"id",`attr-${a(k).key??""}`),Qe(K,1,`text-xs font-bold ${a(n).attributes[a(k).key]-10>=0?"text-green-500":"text-red-500"}`),i(fe,Ue)},[()=>a(k).label.substring(0,3),()=>E(a(n).attributes[a(k).key])]),ut(ee,()=>a(n).attributes[a(k).key],ie=>a(n).attributes[a(k).key]=ie),d(m,h)}),e(ta),e(Bt);var Jt=s(Bt,2),Wt=t(Jt),Qt=t(Wt),ca=t(Qt,!0);e(Qt);var Zt=s(Qt,2);jt(Zt),e(Wt);var mt=s(Wt,2),Tt=t(mt),ia=t(Tt,!0);e(Tt);var l=s(Tt,2);jt(l),e(mt);var v=s(mt,2),u=t(v),g=t(u,!0);e(u);var W=s(u,2);ha(W),e(v),e(Jt),e(Q),x((m,k,h,re,q,ee,K,fe,ie,Ue,te,Pe,Ne)=>{i(ce,m),i(Be,k),i(It,h),i(b,re),i(tt,q),i(Ht,ee),i(Xt,K),i(ca,fe),de(Zt,"placeholder",ie),i(ia,Ue),de(l,"placeholder",te),i(g,Pe),de(W,"placeholder",Ne)},[()=>o()("session.enemy_modal.difficulty"),()=>o()("session.enemy_modal.size"),()=>o()("session.enemy_modal.speed"),()=>o()("session.enemy_modal.health"),()=>o()("session.enemy_modal.defense"),()=>o()("sofdl.attributes.perception"),()=>o()("session.enemy_modal.main_attributes"),()=>o()("session.enemy_modal.speed_notes"),()=>o()("session.enemy_modal.speed_notes_placeholder"),()=>o()("session.enemy_modal.senses"),()=>o()("session.enemy_modal.senses_placeholder_sotdl"),()=>o()("session.enemy_modal.immunities"),()=>o()("session.enemy_modal.immunities_placeholder_sotdl")]),ut(Vt,()=>a(n).speed,m=>a(n).speed=m),ut(O,()=>a(n).health,m=>a(n).health=m),ut(et,()=>a(n).defense,m=>a(n).defense=m),ut(Dt,()=>a(n).perception,m=>a(n).perception=m),ut(Zt,()=>a(n).speedNotes,m=>a(n).speedNotes=m),ut(l,()=>a(n).senses,m=>a(n).senses=m),ut(W,()=>a(n).immunities,m=>a(n).immunities=m),d(B,Q)},X=B=>{var Q=$t(),le=Fe(Q);{var Ke=ce=>{var Y=sn(),Re=t(Y),_e=t(Re),Be=t(_e),ot=t(Be,!0);e(Be),e(_e);var lt=s(_e,2),ct=t(lt);Ye(ct,17,()=>a(n).traits,Mt,(k,h,re)=>{var q=Ki(),ee=t(q),K=t(ee);jt(K);var fe=s(K,2);ha(fe),e(ee);var ie=s(ee,2);ie.__click=()=>$e(re);var Ue=t(ie);fa(Ue,{size:16}),e(ie),e(q),x((te,Pe)=>{de(K,"placeholder",te),de(fe,"placeholder",Pe)},[()=>o()("session.enemy_modal.name_placeholder"),()=>o()("session.enemy_modal.desc_placeholder")]),ut(K,()=>a(h).name,te=>a(h).name=te),ut(fe,()=>a(h).desc,te=>a(h).desc=te),d(k,q)});var Ft=s(ct,2);Ft.__click=T;var It=t(Ft),Vt=t(It);ra(Vt,{size:16}),e(It);var At=s(It);e(Ft),e(lt),e(Re);var f=s(Re,2),b=t(f),O=t(b),z=t(O,!0);e(O),e(b);var ke=s(b,2),We=t(ke);Ye(We,17,()=>a(n).attackOptions,Mt,(k,h,re)=>{var q=en(),ee=t(q),K=t(ee),fe=t(K);jt(fe);var ie=s(fe,2),Ue=t(ie),te=t(Ue,!0);e(Ue),Ue.value=Ue.__value="melee";var Pe=s(Ue),Ne=t(Pe,!0);e(Pe),Pe.value=Pe.__value="ranged",e(ie),e(K);var wt=s(K,2),pt=t(wt);jt(pt);var Ve=s(pt,2);jt(Ve),e(wt);var rt=s(wt,2);ha(rt),e(ee);var Et=s(ee,2);Et.__click=()=>kt(re);var qt=t(Et);fa(qt,{size:16}),e(Et),e(q),x((Rt,Nt,Lt,Yt,Kt,va)=>{de(fe,"placeholder",Rt),i(te,Nt),i(Ne,Lt),de(pt,"placeholder",Yt),de(Ve,"placeholder",Kt),de(rt,"placeholder",va)},[()=>o()("session.enemy_modal.name_placeholder"),()=>o()("session.enemy_modal.melee"),()=>o()("session.enemy_modal.ranged"),()=>o()("session.enemy_modal.attack_placeholder"),()=>o()("session.enemy_modal.damage_placeholder"),()=>o()("session.enemy_modal.desc_effects_placeholder")]),ut(fe,()=>a(h).name,Rt=>a(h).name=Rt),$s(ie,()=>a(h).type,Rt=>a(h).type=Rt),ut(pt,()=>a(h).attackRoll,Rt=>a(h).attackRoll=Rt),ut(Ve,()=>a(h).damage,Rt=>a(h).damage=Rt),ut(rt,()=>a(h).desc,Rt=>a(h).desc=Rt),d(k,q)});var tt=s(We,2);tt.__click=ze;var et=t(tt),zt=t(et);ra(zt,{size:16}),e(et);var Ct=s(et);e(tt),e(ke),e(f);var Ht=s(f,2),Dt=t(Ht),Bt=t(Dt),Gt=t(Bt,!0);e(Bt),e(Dt);var Xt=s(Dt,2),ta=t(Xt);Ye(ta,17,()=>a(n).specialAttacks,Mt,(k,h,re)=>{var q=tn(),ee=t(q),K=t(ee);jt(K);var fe=s(K,2);ha(fe),e(ee);var ie=s(ee,2);ie.__click=()=>Ce(re);var Ue=t(ie);fa(Ue,{size:16}),e(ie),e(q),x((te,Pe)=>{de(K,"placeholder",te),de(fe,"placeholder",Pe)},[()=>o()("session.enemy_modal.name_placeholder"),()=>o()("session.enemy_modal.desc_placeholder")]),ut(K,()=>a(h).name,te=>a(h).name=te),ut(fe,()=>a(h).desc,te=>a(h).desc=te),d(k,q)});var Jt=s(ta,2);Jt.__click=se;var Wt=t(Jt),Qt=t(Wt);ra(Qt,{size:16}),e(Wt);var ca=s(Wt);e(Jt),e(Xt),e(Ht);var Zt=s(Ht,2),mt=t(Zt),Tt=t(mt),ia=t(Tt,!0);e(Tt),e(mt);var l=s(mt,2),v=t(l);Ye(v,17,()=>a(n).endOfRound,Mt,(k,h,re)=>{var q=an(),ee=t(q),K=t(ee);jt(K);var fe=s(K,2);ha(fe),e(ee);var ie=s(ee,2);ie.__click=()=>je(re);var Ue=t(ie);fa(Ue,{size:16}),e(ie),e(q),x((te,Pe)=>{de(K,"placeholder",te),de(fe,"placeholder",Pe)},[()=>o()("session.enemy_modal.name_placeholder"),()=>o()("session.enemy_modal.desc_placeholder")]),ut(K,()=>a(h).name,te=>a(h).name=te),ut(fe,()=>a(h).desc,te=>a(h).desc=te),d(k,q)});var u=s(v,2);u.__click=ue;var g=t(u),W=t(g);ra(W,{size:16}),e(g);var m=s(g);e(u),e(l),e(Zt),e(Y),x((k,h,re,q,ee,K,fe,ie)=>{i(ot,k),i(At,` ${h??""}`),i(z,re),i(Ct,` ${q??""}`),i(Gt,ee),i(ca,` ${K??""}`),i(ia,fe),i(m,` ${ie??""}`)},[()=>o()("session.enemy_modal.traits"),()=>o()("common.buttons.add"),()=>o()("session.enemy_modal.attack_options"),()=>o()("common.buttons.add"),()=>o()("session.enemy_modal.special_attacks"),()=>o()("common.buttons.add"),()=>o()("session.enemy_modal.end_of_round"),()=>o()("common.buttons.add")]),d(ce,Y)},xe=ce=>{var Y=$t(),Re=Fe(Y);{var _e=Be=>{var ot=rn(),lt=t(ot);_(lt),e(ot),d(Be,ot)};y(Re,Be=>{a(w)==="preview"&&Be(_e)},!0)}d(ce,Y)};y(le,ce=>{a(w)==="abilities"?ce(Ke):ce(xe,!1)},!0)}d(B,Q)};y(A,B=>{a(w)==="stats"?B(L):B(X,!1)},!0)}d(pe,H)};y(Le,pe=>{a(w)==="general"?pe(De):pe(Ze,!1)})}e(oe);var dt=s(oe,2),Te=t(dt);Te.__click=()=>r.onSave(a(n));var vt=t(Te);as(vt,{size:18});var p=s(vt);e(Te),e(dt),e(ye);var I=s(ye,2),j=t(I),we=t(j),Se=t(we);es(Se,{size:14});var Ie=s(Se);e(we),e(j);var qe=s(j,2),yt=t(qe);_(yt),e(qe),e(I),e(Oe),e(ve);var st=s(ve,2);st.__change=me,zs(st,pe=>C(ae,pe),()=>a(ae));var Ot=s(st,2);ps(Ot,{get isOpen(){return a(N)},get imageUrl(){return a(Z)},onClose:()=>C(N,!1),onCrop:D}),x((pe,H,A,L,X,B,Q)=>{i(St,pe),Qe(ht,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(w)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Ge,H),Qe(Xe,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(w)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Ee,A),Qe(Ae,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(w)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(P,L),Qe(be,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(w)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(He,X),i(p,` ${B??""}`),i(Ie,` ${Q??""}`)},[()=>o()("session.enemy_modal.title"),()=>o()("session.enemy_modal.tab_general"),()=>o()("session.enemy_modal.tab_stats"),()=>o()("session.enemy_modal.tab_abilities"),()=>o()("session.enemy_modal.preview"),()=>o()("common.buttons.save"),()=>o()("session.enemy_modal.preview")]),Ta(3,Oe,()=>Ua,()=>({y:20,duration:300})),Ta(3,ve,()=>Ua,()=>({duration:200,opacity:1})),d(U,ne)};y(Je,U=>{M()&&U(ge)})}d(F,Me),da(),S()}ma(["click","change"]);var ln=c('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),dn=c('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),vn=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),cn=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),un=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),bn=c('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),xn=c('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),_n=c('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),fn=c('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),mn=c('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),pn=c('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),gn=c('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),hn=c('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),yn=c('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div>'),wn=c('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="flex items-center gap-2"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),kn=c('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),zn=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div class="flex flex-col"><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div> <div class="flex flex-col"><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-damage" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-damage" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 text-center border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),Cn=c('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),jn=c('<div><div class="mb-3"><h4> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div>'),Mn=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"></div>'),On=c('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),En=c('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function Sn(F,r){la(r,!0);const o=()=>Ut(aa,"$t",J),[J,S]=oa(),_=se=>{var Ce=yn(),ue=t(Ce),je=t(ue);e(ue);var he=s(ue,2),Me=t(he);{var Je=H=>{var A=ln(),L=t(A);Ia(L,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom"}),e(A),d(H,A)};y(Me,H=>{a(n).imageUrl&&H(Je)})}var ge=s(Me,2),U=t(ge),ne=t(U,!0);e(U),Ea(2),e(ge),e(he);var ve=s(he,2),Oe=t(ve),ye=t(Oe),xt=t(ye,!0);e(ye);var it=s(ye,2),nt=t(it,!0);e(it),e(Oe);var _t=s(Oe,2),at=t(_t),St=t(at,!0);e(at);var gt=s(at,2),ft=t(gt,!0);e(gt),e(_t);var Pt=s(_t,2),ht=t(Pt),Ge=t(ht,!0);e(ht);var Xe=s(ht,2),Ee=t(Xe,!0);e(Xe),e(Pt);var Ae=s(Pt,2),P=t(Ae),be=t(P,!0);e(P);var He=s(P,2),oe=t(He,!0);e(He),e(Ae),e(ve);var Le=s(ve,2);Ye(Le,20,()=>["str","agi","int","wil"],Mt,(H,A)=>{var L=dn(),X=t(L),B=t(X,!0);e(X);var Q=s(X,2),le=t(Q),Ke=s(le),xe=t(Ke);e(Ke),e(Q),e(L),x(()=>{i(B,A),i(le,`${a(n).stats[A]??""} `),Qe(Ke,1,`text-xs ${a(n).stats[A]-10>=0?"text-green-500":"text-red-500"}`),i(xe,`(${a(n).stats[A]-10>=0?"+":""}${a(n).stats[A]-10})`)}),d(H,L)}),e(Le);var De=s(Le,2),Ze=t(De);{var dt=H=>{var A=vn(),L=t(A),X=t(L);e(L);var B=s(L,2),Q=t(B,!0);e(B),e(A),x(le=>{i(X,`${le??""}:`),i(Q,a(n).senses)},[()=>o()("session.enemy_modal.senses")]),d(H,A)};y(Ze,H=>{a(n).senses&&H(dt)})}var Te=s(Ze,2);{var vt=H=>{var A=cn(),L=t(A),X=t(L);e(L);var B=s(L,2),Q=t(B,!0);e(B),e(A),x(le=>{i(X,`${le??""}:`),i(Q,a(n).languages)},[()=>o()("session.enemy_modal.languages")]),d(H,A)};y(Te,H=>{a(n).languages&&H(vt)})}var p=s(Te,2);{var I=H=>{var A=un(),L=t(A),X=t(L);e(L);var B=s(L,2),Q=t(B,!0);e(B),e(A),x(le=>{i(X,`${le??""}:`),i(Q,a(n).immune)},[()=>o()("session.enemy_modal.immunities")]),d(H,A)};y(p,H=>{a(n).immune&&H(I)})}e(De);var j=s(De,2),we=t(j);{var Se=H=>{var A=xn(),L=t(A),X=t(L,!0);e(L);var B=s(L,2);Ye(B,17,()=>a(n).traits,Mt,(Q,le,Ke,xe)=>{var ce=bn(),Y=t(ce),Re=t(Y);e(Y);var _e=s(Y,2),Be=t(_e,!0);e(_e),e(ce),x(()=>{i(Re,`${a(le).name??""}:`),i(Be,a(le).desc)}),d(Q,ce)}),e(A),x(Q=>i(X,Q),[()=>o()("session.enemy_modal.traits")]),d(H,A)};y(we,H=>{a(n).traits.length>0&&H(Se)})}var Ie=s(we,2);{var qe=H=>{var A=fn(),L=t(A),X=t(L,!0);e(L);var B=s(L,2);Ye(B,17,()=>a(n).actions,Mt,(Q,le,Ke,xe)=>{var ce=_n(),Y=t(ce),Re=t(Y);e(Y);var _e=s(Y,2),Be=t(_e,!0);e(_e),e(ce),x(()=>{i(Re,`${a(le).name??""}:`),i(Be,a(le).desc)}),d(Q,ce)}),e(A),x(Q=>i(X,Q),[()=>o()("session.enemy_modal.actions")]),d(H,A)};y(Ie,H=>{a(n).actions.length>0&&H(qe)})}var yt=s(Ie,2);{var st=H=>{var A=pn(),L=t(A),X=t(L,!0);e(L);var B=s(L,2);Ye(B,17,()=>a(n).reactions,Mt,(Q,le,Ke,xe)=>{var ce=mn(),Y=t(ce),Re=t(Y);e(Y);var _e=s(Y,2),Be=t(_e,!0);e(_e),e(ce),x(()=>{i(Re,`${a(le).name??""}:`),i(Be,a(le).desc)}),d(Q,ce)}),e(A),x(Q=>i(X,Q),[()=>o()("session.enemy_modal.reactions")]),d(H,A)};y(yt,H=>{a(n).reactions.length>0&&H(st)})}var Ot=s(yt,2);{var pe=H=>{var A=hn(),L=t(A),X=t(L,!0);e(L);var B=s(L,2);Ye(B,17,()=>a(n).endOfRound,Mt,(Q,le,Ke,xe)=>{var ce=gn(),Y=t(ce),Re=t(Y);e(Y);var _e=s(Y,2),Be=t(_e,!0);e(_e),e(ce),x(()=>{i(Re,`${a(le).name??""}:`),i(Be,a(le).desc)}),d(Q,ce)}),e(A),x(Q=>i(X,Q),[()=>o()("session.enemy_modal.end_of_round")]),d(H,A)};y(Ot,H=>{a(n).endOfRound.length>0&&H(pe)})}e(j),e(Ce),x((H,A,L,X,B,Q)=>{i(je,`${H??""} ${a(n).difficulty??""}`),i(ne,A),i(xt,L),i(nt,a(n).defense),i(St,X),i(ft,a(n).health),i(Ge,B),i(Ee,a(n).size),i(be,Q),i(oe,a(n).speed)},[()=>o()("session.enemy_modal.difficulty"),()=>a(n).name||o()("session.enemy_modal.enemy_default"),()=>o()("session.enemy_modal.defense"),()=>o()("session.enemy_modal.health"),()=>o()("session.enemy_modal.size"),()=>o()("session.enemy_modal.speed")]),d(se,Ce)};let M=sa(r,"isOpen",3,!1),$=sa(r,"initialData",3,"{}"),n=bt(ga(R())),w=bt("general"),N=bt(!1),Z=bt(""),ae=bt(void 0);function me(se){const Ce=se.target.files;if(Ce&&Ce.length>0){const ue=Ce[0],je=new FileReader;je.onload=()=>{C(Z,je.result,!0),C(N,!0)},je.readAsDataURL(ue)}se.target&&(se.target.value="")}async function D(se){try{const Ce=await gs(se);a(n).imageUrl=Ce,C(N,!1)}catch(Ce){console.error(Ce),alert(Ce.message||"Erro ao salvar imagem")}}function R(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[],global:!1}}Fa(()=>{if(M()&&$())try{const se=JSON.parse($());Object.keys(se).length===0?C(n,R(),!0):C(n,{...R(),...se},!0)}catch{C(n,R(),!0)}});function E(se){a(n)[se]=[...a(n)[se],{name:"",desc:""}]}function V(se,Ce){a(n)[se]=a(n)[se].filter((ue,je)=>je!==Ce)}function T(se){}var $e=$t(),ze=Fe($e);{var kt=se=>{var Ce=En(),ue=Fe(Ce);ue.__click=T;var je=t(ue),he=t(je),Me=t(he),Je=t(Me),ge=t(Je);ge.__click=function(...j){r.onClose?.apply(this,j)};var U=t(ge);Ha(U,{size:24}),e(ge);var ne=s(ge,2),ve=t(ne,!0);e(ne),e(Je);var Oe=s(Je,2);Oe.__click=function(...j){r.onClose?.apply(this,j)};var ye=t(Oe);ya(ye,{size:20}),e(Oe),e(Me);var xt=s(Me,2),it=t(xt);it.__click=()=>C(w,"general");var nt=t(it,!0);e(it);var _t=s(it,2);_t.__click=()=>C(w,"stats");var at=t(_t,!0);e(_t);var St=s(_t,2);St.__click=()=>C(w,"abilities");var gt=t(St,!0);e(St);var ft=s(St,2);ft.__click=()=>C(w,"preview");var Pt=t(ft,!0);e(ft),e(xt);var ht=s(xt,2),Ge=t(ht);{var Xe=j=>{var we=wn(),Se=t(we),Ie=t(Se);Ie.__click=()=>a(ae)?.click();var qe=t(Ie),yt=t(qe);ts(yt,()=>a(n).imageUrl,_e=>{Ia(_e,{get hash(){return a(n).imageUrl},get alt(){return a(n).name},size:"custom",fallbackText:"?"})}),e(qe);var st=s(qe,2),Ot=t(st);hs(Ot,{size:20,class:"text-white"}),e(st),e(Ie);var pe=s(Ie,2),H=t(pe),A=t(H,!0);e(H);var L=s(H,2);jt(L),e(pe),e(Se);var X=s(Se,2),B=t(X),Q=t(B,!0);e(B);var le=s(B,2);ha(le),e(X);var Ke=s(X,2),xe=t(Ke);jt(xe);var ce=s(xe,2),Y=t(ce);pa(Y,{size:14});var Re=s(Y);e(ce),e(Ke),e(we),x((_e,Be,ot,lt)=>{i(A,_e),i(Q,Be),de(le,"placeholder",ot),i(Re,` ${lt??""}`)},[()=>o()("session.enemy_modal.name"),()=>o()("session.enemy_modal.description"),()=>o()("session.enemy_modal.description_placeholder"),()=>o()("session.enemy_modal.global_enemy")]),ut(L,()=>a(n).name,_e=>a(n).name=_e),ut(le,()=>a(n).description,_e=>a(n).description=_e),vs(xe,()=>a(n).global,_e=>a(n).global=_e),d(j,we)},Ee=j=>{var we=$t(),Se=Fe(we);{var Ie=yt=>{var st=zn(),Ot=t(st),pe=t(Ot),H=t(pe),A=t(H,!0);e(H);var L=s(H,2);{let mt=G(()=>a(n).difficulty??1);Os(L,{get value(){return a(mt)},onUpdate:Tt=>a(n).difficulty=Tt,steps:[1,2,4,8,16,32,64,128]})}e(pe);var X=s(pe,2),B=t(X),Q=t(B,!0);e(B);var le=s(B,2);{let mt=G(()=>a(n).size||1);ys(le,{get value(){return a(mt)},onUpdate:Tt=>a(n).size=Tt})}e(X),e(Ot);var Ke=s(Ot,2),xe=t(Ke),ce=t(xe),Y=t(ce,!0);e(ce);var Re=s(ce);jt(Re),e(xe);var _e=s(xe,2),Be=t(_e),ot=t(Be,!0);e(Be);var lt=s(Be);jt(lt),e(_e),e(Ke);var ct=s(Ke,2),Ft=t(ct),It=t(Ft),Vt=t(It,!0);e(It);var At=s(It);jt(At),e(Ft);var f=s(Ft,2),b=t(f),O=t(b,!0);e(b);var z=s(b);jt(z),e(f),e(ct);var ke=s(ct,2),We=t(ke),tt=t(We,!0);e(We);var et=s(We,2);Ye(et,20,()=>["str","agi","int","wil"],Mt,(mt,Tt)=>{var ia=kn(),l=t(ia),v=t(l,!0);e(l);var u=s(l,2);jt(u);var g=s(u,2),W=t(g);e(g),e(ia),x(m=>{de(l,"for",`attr-${Tt??""}`),i(v,m),de(u,"id",`attr-${Tt??""}`),Qe(g,1,`text-xs font-bold ${a(n).stats[Tt]-10>=0?"text-green-500":"text-red-500"}`),i(W,`${a(n).stats[Tt]-10>=0?"+":""}${a(n).stats[Tt]-10}`)},[()=>o()("sofww.attributes."+Tt).substring(0,3)]),ut(u,()=>a(n).stats[Tt],m=>a(n).stats[Tt]=m),d(mt,ia)}),e(et),e(ke);var zt=s(ke,2),Ct=t(zt),Ht=t(Ct),Dt=t(Ht,!0);e(Ht);var Bt=s(Ht);jt(Bt),e(Ct);var Gt=s(Ct,2),Xt=t(Gt),ta=t(Xt,!0);e(Xt);var Jt=s(Xt);jt(Jt),e(Gt);var Wt=s(Gt,2),Qt=t(Wt),ca=t(Qt,!0);e(Qt);var Zt=s(Qt);jt(Zt),e(Wt),e(zt),e(st),x((mt,Tt,ia,l,v,u,g,W,m,k,h,re,q)=>{i(A,mt),i(Q,Tt),i(Y,ia),i(ot,l),i(Vt,v),i(O,u),i(tt,g),i(Dt,W),de(Bt,"placeholder",m),i(ta,k),de(Jt,"placeholder",h),i(ca,re),de(Zt,"placeholder",q)},[()=>o()("session.enemy_modal.difficulty"),()=>o()("session.enemy_modal.size"),()=>o()("session.enemy_modal.defense"),()=>o()("session.enemy_modal.health"),()=>o()("session.enemy_modal.damage"),()=>o()("session.enemy_modal.speed"),()=>o()("session.enemy_modal.main_attributes"),()=>o()("session.enemy_modal.senses"),()=>o()("session.enemy_modal.senses_placeholder"),()=>o()("session.enemy_modal.languages"),()=>o()("session.enemy_modal.languages_placeholder"),()=>o()("session.enemy_modal.immunities"),()=>o()("session.enemy_modal.immunities_placeholder")]),ut(Re,()=>a(n).defense,mt=>a(n).defense=mt),ut(lt,()=>a(n).health,mt=>a(n).health=mt),ut(At,()=>a(n).damage,mt=>a(n).damage=mt),ut(z,()=>a(n).speed,mt=>a(n).speed=mt),ut(Bt,()=>a(n).senses,mt=>a(n).senses=mt),ut(Jt,()=>a(n).languages,mt=>a(n).languages=mt),ut(Zt,()=>a(n).immune,mt=>a(n).immune=mt),d(yt,st)},qe=yt=>{var st=$t(),Ot=Fe(st);{var pe=A=>{var L=Mn();Ye(L,20,()=>[{key:"traits",label:"traits",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",label:"actions",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",label:"reactions",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",label:"end_of_round",color:"text-yellow-400",border:"border-yellow-500/30"}],Mt,(X,B)=>{var Q=jn(),le=t(Q),Ke=t(le),xe=t(Ke,!0);e(Ke),e(le);var ce=s(le,2),Y=t(ce);Ye(Y,17,()=>a(n)[B.key],Mt,(lt,ct,Ft)=>{var It=Cn(),Vt=t(It),At=t(Vt);jt(At);var f=s(At,2);ha(f),e(Vt);var b=s(Vt,2);b.__click=()=>V(B.key,Ft);var O=t(b);fa(O,{size:16}),e(b),e(It),x((z,ke)=>{de(At,"placeholder",z),de(f,"placeholder",ke)},[()=>o()("session.enemy_modal.name_placeholder"),()=>o()("session.enemy_modal.desc_placeholder")]),ut(At,()=>a(ct).name,z=>a(ct).name=z),ut(f,()=>a(ct).desc,z=>a(ct).desc=z),d(lt,It)});var Re=s(Y,2);Re.__click=()=>E(B.key);var _e=t(Re),Be=t(_e);ra(Be,{size:16}),e(_e);var ot=s(_e);e(Re),e(ce),e(Q),x((lt,ct)=>{Qe(Q,1,`p-4 bg-slate-900 rounded border ${B.border??""}`),Qe(Ke,1,`font-bold text-sm uppercase ${B.color??""}`),i(xe,lt),i(ot,` ${ct??""}`)},[()=>o()("session.enemy_modal."+B.label),()=>o()("common.buttons.add")]),d(X,Q)}),e(L),d(A,L)},H=A=>{var L=$t(),X=Fe(L);{var B=Q=>{var le=On(),Ke=t(le);_(Ke),e(le),d(Q,le)};y(X,Q=>{a(w)==="preview"&&Q(B)},!0)}d(A,L)};y(Ot,A=>{a(w)==="abilities"?A(pe):A(H,!1)},!0)}d(yt,st)};y(Se,yt=>{a(w)==="stats"?yt(Ie):yt(qe,!1)},!0)}d(j,we)};y(Ge,j=>{a(w)==="general"?j(Xe):j(Ee,!1)})}e(ht);var Ae=s(ht,2),P=t(Ae);P.__click=()=>r.onSave(a(n));var be=t(P);as(be,{size:18});var He=s(be);e(P),e(Ae),e(he);var oe=s(he,2),Le=t(oe),De=t(Le),Ze=t(De);es(Ze,{size:14});var dt=s(Ze);e(De),e(Le);var Te=s(Le,2),vt=t(Te);_(vt),e(Te),e(oe),e(je),e(ue);var p=s(ue,2);p.__change=me,zs(p,j=>C(ae,j),()=>a(ae));var I=s(p,2);ps(I,{get isOpen(){return a(N)},get imageUrl(){return a(Z)},onClose:()=>C(N,!1),onCrop:D}),x((j,we,Se,Ie,qe,yt,st,Ot)=>{de(ue,"aria-label",j),i(ve,we),Qe(it,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(w)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(nt,Se),Qe(_t,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(w)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(at,Ie),Qe(St,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(w)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(gt,qe),Qe(ft,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(w)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Pt,yt),i(He,` ${st??""}`),i(dt,` ${Ot??""}`)},[()=>o()("session.enemy_modal.close"),()=>o()("session.enemy_modal.title"),()=>o()("session.enemy_modal.tab_general"),()=>o()("session.enemy_modal.tab_stats"),()=>o()("session.enemy_modal.tab_abilities"),()=>o()("session.enemy_modal.preview"),()=>o()("common.buttons.save"),()=>o()("session.enemy_modal.preview")]),Ta(3,je,()=>Ua,()=>({y:20,duration:300})),Ta(3,ue,()=>Ua,()=>({duration:200,opacity:1})),d(se,Ce)};y(ze,se=>{M()&&se(kt)})}d(F,$e),da(),S()}ma(["click","change"]);var $n=c('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),In=c('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),Dn=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),Rn=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function Nn(F,r){la(r,!0);const o=()=>Ut(aa,"$t",S),J=()=>Ut(Ka,"$liveEnemies",S),[S,_]=oa();let M=sa(r,"isOpen",3,!1),$=sa(r,"initialData",3,"{}"),n=bt(ga({name:"",enemies:[]}));Fa(()=>{if(M()&&$())try{const E=JSON.parse($());C(n,{name:E.name||"",enemies:E.enemies||[]},!0)}catch{C(n,{name:"",enemies:[]},!0)}});function w(E){a(n).enemies.find(T=>T.enemyId===E)?a(n).enemies=a(n).enemies.map(T=>T.enemyId===E?{...T,count:T.count+1}:T):a(n).enemies=[...a(n).enemies,{enemyId:E,count:1}]}function N(E){a(n).enemies=a(n).enemies.filter((V,T)=>T!==E)}function Z(E,V){const T=Math.max(1,parseInt(V)||1);a(n).enemies[E].count=T}function ae(E){}var me=$t(),D=Fe(me);{var R=E=>{var V=Rn();V.__click=ae;var T=t(V),$e=t(T),ze=t($e),kt=t(ze,!0);e(ze);var se=s(ze,2);se.__click=function(...Ee){r.onClose?.apply(this,Ee)};var Ce=t(se);ya(Ce,{size:20}),e(se),e($e);var ue=s($e,2),je=t(ue),he=t(je),Me=t(he,!0);e(he);var Je=s(he,2);jt(Je),e(je),e(ue);var ge=s(ue,2),U=t(ge),ne=t(U),ve=t(ne,!0);e(ne);var Oe=s(ne,2),ye=t(Oe);Ye(ye,17,()=>a(n).enemies,Mt,(Ee,Ae,P)=>{const be=G(()=>J().find(j=>j.id===a(Ae).enemyId));var He=$n(),oe=t(He),Le=t(oe),De=t(Le,!0);e(Le);var Ze=s(Le,2),dt=t(Ze);e(Ze),e(oe);var Te=s(oe,2),vt=t(Te);jt(vt),vt.__input=j=>Z(P,j.target.value);var p=s(vt,2);p.__click=()=>N(P);var I=t(p);fa(I,{size:16}),e(p),e(Te),e(He),x(j=>{i(De,j),i(dt,`Dif ${(a(be)?a(be).difficulty:"?")??""}`),Qa(vt,a(Ae).count)},[()=>a(be)?a(be).name:o()("session.encounter_modal.unknown")]),d(Ee,He)});var xt=s(ye,2);{var it=Ee=>{var Ae=In(),P=t(Ae,!0);e(Ae),x(be=>i(P,be),[()=>o()("session.encounter_modal.none_added")]),d(Ee,Ae)};y(xt,Ee=>{a(n).enemies.length===0&&Ee(it)})}e(Oe),e(U);var nt=s(U,2),_t=t(nt),at=t(_t,!0);e(_t);var St=s(_t,2);Ye(St,5,J,Ee=>Ee.id,(Ee,Ae)=>{var P=Dn(),be=t(P),He=t(be),oe=t(He,!0);e(He);var Le=s(He,2),De=t(Le);e(Le),e(be);var Ze=s(be,2);Ze.__click=()=>w(a(Ae).id);var dt=t(Ze);ra(dt,{size:16}),e(Ze),e(P),x(()=>{i(oe,a(Ae).name),i(De,`Dif ${a(Ae).difficulty??""}`)}),d(Ee,P)}),e(St),e(nt),e(ge);var gt=s(ge,2),ft=t(gt);ft.__click=function(...Ee){r.onClose?.apply(this,Ee)};var Pt=t(ft,!0);e(ft);var ht=s(ft,2);ht.__click=()=>r.onSave(a(n));var Ge=t(ht);as(Ge,{size:18});var Xe=s(Ge);e(ht),e(gt),e(T),e(V),x((Ee,Ae,P,be,He,oe,Le,De)=>{de(V,"aria-label",Ee),i(kt,Ae),i(Me,P),de(Je,"placeholder",be),i(ve,He),i(at,oe),i(Pt,Le),i(Xe,` ${De??""}`)},[()=>o()("session.encounter_modal.close"),()=>o()("session.encounter_modal.title"),()=>o()("session.encounter_modal.name"),()=>o()("session.encounter_modal.name_placeholder"),()=>o()("session.encounter_modal.enemies_in_encounter"),()=>o()("session.encounter_modal.add_enemies"),()=>o()("common.buttons.cancel"),()=>o()("session.encounter_modal.save_encounter")]),ut(Je,()=>a(n).name,Ee=>a(n).name=Ee),d(E,V)};y(D,E=>{M()&&E(R)})}d(F,me),da(),_()}ma(["click","input"]);var An=c('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),Tn=c('<div class="text-[10px] text-slate-600 italic"> </div>'),Un=c('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="flex items-center gap-2 mb-2"><div class="font-bold text-white text-base group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <!></div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),Pn=c('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),Fn=c('<div class="mb-4 flex-1"><p> </p> <!></div>'),Hn=c('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),Ln=c('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><div class="flex items-center gap-2"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <!></div> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),qn=c('<div class="text-center text-slate-500 italic col-span-3"> </div>'),Bn=c('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function Wn(F,r){la(r,!0);const o=()=>Ut(Ka,"$liveEnemies",_),J=()=>Ut(us,"$liveEncounters",_),S=()=>Ut(aa,"$t",_),[_,M]=oa();let $=bt(!1),n=bt(null),w=bt("{}"),N=bt(!1),Z=bt(null),ae=bt("{}"),me=bt(ga({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function D(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function R(p=null){C(n,p?p.id:null,!0),p?C(w,JSON.stringify(p),!0):a(Me)==="sofdl"?C(w,"{}"):C(w,JSON.stringify(D()),!0),C($,!0)}let E=ga(new Set);function V(p){E.has(p)?E.delete(p):E.add(p)}function T(p){const I=a(n)||$a(),j=ea.get(r.campId);ns.set(I,{...p,id:I,campaignId:r.campId,system:j?.system||"sofww"}),C($,!1)}function $e(p){const I=o().find(j=>j.id===p);C(me,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${I?.name||"este inimigo"}"?`,onConfirm:()=>{ns.delete(p),a(me).isOpen=!1}},!0)}function ze(p=null){C(Z,p?p.id:null,!0),C(ae,JSON.stringify(p||{name:"",enemies:[]}),!0),C(N,!0)}function kt(p){const I=a(Z)||$a();Va.set(I,{...p,id:I,system:a(Me)}),C(N,!1)}function se(p){const I=J().find(j=>j.id===p);C(me,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${I?.name||"este encontro"}"?`,onConfirm:()=>{Va.delete(p),a(me).isOpen=!1}},!0)}function Ce(p){const I=ea.get(r.campId);if(!I)return;const j=I.activeEnemies||[];let we=[];p.enemies.forEach(Se=>{const Ie=o().find(qe=>qe.id===Se.enemyId);if(Ie)for(let qe=0;qe<Se.count;qe++)we.push({...Ie,instanceId:$a(),damage:0,currentHealth:Ie.health,afflictions:[],acted:!1,initiative:!1})}),ea.set(r.campId,{...I,activeEnemies:[...j,...we]})}function ue(p,I){p.dataTransfer.setData("text/plain",I.id),p.dataTransfer.effectAllowed="copy"}function je(p){return p.preventDefault(),!1}function he(p,I){p.preventDefault();const j=p.dataTransfer.getData("text/plain");if(!j)return;const we=I.enemies||[],Se=we.find(qe=>qe.enemyId===j);let Ie;Se?Ie=we.map(qe=>qe.enemyId===j?{...qe,count:qe.count+1}:qe):Ie=[...we,{enemyId:j,count:1}],Va.set(I.id,{...I,enemies:Ie})}let Me=G(()=>ea.get(r.campId)?.system||"sofww"),Je=G(()=>o().filter(p=>{const j=(p.system||"sofww")===a(Me),we=p.global===!0,Se=p.campaignId===r.campId;return j&&(we||Se)})),ge=G(()=>J().filter(p=>{const j=(p.system||"sofww")===a(Me),we=p.global===!0,Se=p.campaignId===r.campId;return j&&(we||Se)}));var U=Bn(),ne=t(U),ve=t(ne),Oe=t(ve),ye=t(Oe);Xa(ye,{size:16});var xt=s(ye);e(Oe),e(ve);var it=s(ve,2),nt=t(it);nt.__click=()=>ze();var _t=t(nt);ra(_t,{size:28,class:"group-hover:scale-110 transition-transform"});var at=s(_t,2),St=t(at,!0);e(at),e(nt);var gt=s(nt,2);Ye(gt,17,()=>a(ge),p=>p.id,(p,I)=>{var j=Un(),we=t(j),Se=t(we),Ie=t(Se),qe=t(Ie,!0);e(Ie);var yt=s(Ie,2);{var st=Y=>{pa(Y,{size:12,class:"text-indigo-400"})};y(yt,Y=>{a(I).global&&Y(st)})}e(Se);var Ot=s(Se,2),pe=t(Ot);Ye(pe,17,()=>a(I).enemies||[],Mt,(Y,Re)=>{const _e=G(()=>o().find(It=>It.id===a(Re).enemyId));var Be=An(),ot=t(Be),lt=t(ot);e(ot);var ct=s(ot,2),Ft=t(ct,!0);e(ct),e(Be),x(()=>{i(lt,`${a(Re).count??""}x`),i(Ft,a(_e)?a(_e).name:"...")}),d(Y,Be)});var H=s(pe,2);{var A=Y=>{var Re=Tn(),_e=t(Re,!0);e(Re),x(Be=>i(_e,Be),[()=>S()("session.bestiary.empty_encounter")]),d(Y,Re)};y(H,Y=>{a(I).enemies?.length||Y(A)})}e(Ot),e(we);var L=s(we,2),X=t(L);X.__click=()=>Ce(a(I));var B=t(X);Za(B,{size:12,fill:"currentColor"});var Q=s(B);e(X);var le=s(X,2);le.__click=()=>ze(a(I));var Ke=t(le);tr(Ke,{size:14}),e(le);var xe=s(le,2);xe.__click=()=>se(a(I).id);var ce=t(xe);fa(ce,{size:14}),e(xe),e(L),e(j),x(Y=>{de(j,"aria-label",`Encontro ${a(I).name??""}`),i(qe,a(I).name),i(Q,` ${Y??""}`)},[()=>S()("session.bestiary.start")]),ja("dragover",j,je),ja("drop",j,Y=>he(Y,a(I))),d(p,j)}),e(it),e(ne);var ft=s(ne,2),Pt=t(ft),ht=t(Pt);Ca(ht,{size:16});var Ge=s(ht);e(Pt),e(ft);var Xe=s(ft,2),Ee=t(Xe);Ee.__click=()=>R();var Ae=t(Ee);ra(Ae,{size:32,class:"group-hover:scale-110 transition-transform"});var P=s(Ae,2),be=t(P,!0);e(P),e(Ee);var He=s(Ee,2);Ye(He,17,()=>a(Je),p=>p.id,(p,I)=>{var j=Ln(),we=t(j),Se=t(we),Ie=t(Se),qe=t(Ie,!0);e(Ie);var yt=s(Ie,2);{var st=xe=>{pa(xe,{size:14,class:"text-indigo-400"})};y(yt,xe=>{a(I).global&&xe(st)})}e(Se);var Ot=s(Se,2),pe=t(Ot);e(Ot),e(we);var H=s(we,2);{var A=xe=>{var ce=Fn(),Y=t(ce),Re=t(Y,!0);e(Y);var _e=s(Y,2);{var Be=ot=>{var lt=Pn();lt.__click=()=>V(a(I).id);var ct=t(lt,!0);e(lt),x(Ft=>i(ct,Ft),[()=>E.has(a(I).id)?S()("session.bestiary.see_less"):S()("session.bestiary.see_more")]),d(ot,lt)};y(_e,ot=>{a(I).description.length>120&&ot(Be)})}e(ce),x(ot=>{Qe(Y,1,`text-xs text-slate-400 leading-relaxed ${ot??""}`),i(Re,a(I).description)},[()=>E.has(a(I).id)?"":"line-clamp-3"]),d(xe,ce)},L=xe=>{var ce=Hn(),Y=t(ce,!0);e(ce),x(Re=>i(Y,Re),[()=>S()("session.bestiary.no_description")]),d(xe,ce)};y(H,xe=>{a(I).description?xe(A):xe(L,!1)})}var X=s(H,2),B=t(X);B.__click=()=>R(a(I));var Q=t(B,!0);e(B);var le=s(B,2);le.__click=()=>$e(a(I).id);var Ke=t(le);fa(Ke,{size:14}),e(le),e(X),e(j),x((xe,ce)=>{i(qe,a(I).name),i(pe,`${xe??""} ${a(I).difficulty??""}`),i(Q,ce)},[()=>S()("session.bestiary.level"),()=>S()("common.buttons.edit")]),ja("dragstart",j,xe=>ue(xe,a(I))),d(p,j)});var oe=s(He,2);{var Le=p=>{var I=qn(),j=t(I,!0);e(I),x(we=>i(j,we),[()=>S()("session.bestiary.no_enemies")]),d(p,I)};y(oe,p=>{a(Je).length===0&&p(Le)})}e(Xe);var De=s(Xe,2);{var Ze=p=>{on(p,{get isOpen(){return a($)},get initialData(){return a(w)},onClose:()=>C($,!1),onSave:T})},dt=p=>{Sn(p,{get isOpen(){return a($)},get initialData(){return a(w)},onClose:()=>C($,!1),onSave:T})};y(De,p=>{a(Me)==="sofdl"?p(Ze):p(dt,!1)})}var Te=s(De,2);Nn(Te,{get isOpen(){return a(N)},get initialData(){return a(ae)},onClose:()=>C(N,!1),onSave:kt});var vt=s(Te,2);cs(vt,{get isOpen(){return a(me).isOpen},get title(){return a(me).title},get message(){return a(me).message},get onConfirm(){return a(me).onConfirm},onCancel:()=>a(me).isOpen=!1}),e(U),x((p,I,j,we)=>{i(xt,` ${p??""}`),i(St,I),i(Ge,` ${j??""}`),i(be,we)},[()=>S()("session.bestiary.encounters_title"),()=>S()("session.bestiary.new_encounter"),()=>S()("session.bestiary.title"),()=>S()("session.bestiary.new_enemy")]),d(F,U),da(),M()}ma(["click"]);var Jn=c('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),Gn=c('<div class="flex items-center gap-1 text-emerald-400"><!> <span class="text-xs font-bold hidden sm:block"> </span></div> <!>',1),Vn=c('<div class="flex items-center gap-1 text-slate-500"><!> <span class="text-xs hidden sm:block"> </span></div>'),Qn=c('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),Yn=c('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group"><!> <!></button> <div class="flex flex-col"><h1 class="text-base sm:text-lg font-black text-white leading-tight truncate max-w-[140px] sm:max-w-none"> </h1> <span class="text-xs text-indigo-400 font-mono font-black uppercase tracking-wider"> </span></div></div> <div class="hidden md:flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block"> </span></button> <button><!> <span class="hidden min-[400px]:block"> </span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 sm:p-2.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all"><!></button> <button class="p-2 sm:p-2.5 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative"><!> <!></button></div></div></div></header>');function Zn(F,r){la(r,!0);const o=()=>Ut(aa,"$t",M),J=()=>Ut(Rs,"$syncState",M),S=()=>Ut(Ma,"$isHistoryOpen",M),_=()=>Ut(Ns,"$hasUnreadRolls",M),[M,$]=oa();let n=sa(r,"campaignName",3,""),w=sa(r,"gmName",3,"Mestre"),N=sa(r,"activeSubTab",3,"session"),Z=sa(r,"onTabChange",3,()=>{}),ae=sa(r,"onOpenSettings",3,()=>{});var me=Yn(),D=t(me),R=t(D),E=t(R),V=t(E);V.__click=()=>ir(_s("/"));var T=t(V);Ha(T,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var $e=s(T,2);Qs($e,{size:18,class:"hidden sm:block opacity-50"}),e(V);var ze=s(V,2),kt=t(ze),se=t(kt,!0);e(kt);var Ce=s(kt,2),ue=t(Ce,!0);e(Ce),e(ze),e(E);var je=s(E,2),he=t(je);he.__click=()=>Z()("session");var Me=t(he);{let Ge=G(()=>N()==="session"?"opacity-100":"opacity-50");ws(Me,{size:14,get class(){return a(Ge)}})}var Je=s(Me,2),ge=t(Je,!0);e(Je),e(he);var U=s(he,2);U.__click=()=>Z()("bestiary");var ne=t(U);{let Ge=G(()=>N()==="bestiary"?"opacity-100":"opacity-50");Cs(ne,{size:14,get class(){return a(Ge)}})}var ve=s(ne,2),Oe=t(ve,!0);e(ve),e(U),e(je);var ye=s(je,2),xt=t(ye),it=t(xt);{var nt=Ge=>{var Xe=Gn(),Ee=Fe(Xe),Ae=t(Ee);xs(Ae,{size:16});var P=s(Ae,2),be=t(P,!0);e(P),e(Ee);var He=s(Ee,2);{var oe=Le=>{var De=Jn(),Ze=t(De);bs(Ze,{size:14});var dt=s(Ze,2),Te=t(dt,!0);e(dt),e(De),x(vt=>{de(De,"title",vt),i(Te,J().peers.length)},[()=>o()("common.status.peers",{values:{count:J().peers.length}})]),d(Le,De)};y(He,Le=>{J().peers.length>0&&Le(oe)})}x((Le,De)=>{de(Ee,"title",Le),i(be,De)},[()=>o()("common.status.connected"),()=>o()("common.status.connected")]),d(Ge,Xe)},_t=Ge=>{var Xe=Vn(),Ee=t(Xe);nr(Ee,{size:16});var Ae=s(Ee,2),P=t(Ae,!0);e(Ae),e(Xe),x((be,He)=>{de(Xe,"title",be),i(P,He)},[()=>o()("common.status.offline"),()=>o()("common.status.offline")]),d(Ge,Xe)};y(it,Ge=>{J().isConnected?Ge(nt):Ge(_t,!1)})}e(xt);var at=s(xt,2);at.__click=function(...Ge){ae()?.apply(this,Ge)};var St=t(at);sr(St,{size:20}),e(at);var gt=s(at,2);gt.__click=()=>Ma.update(Ge=>!Ge);var ft=t(gt);Ys(ft,{size:20});var Pt=s(ft,2);{var ht=Ge=>{var Xe=Qn();d(Ge,Xe)};y(Pt,Ge=>{_()&&Ge(ht)})}e(gt),e(ye),e(R),e(D),e(me),x((Ge,Xe,Ee,Ae,P,be,He,oe)=>{de(V,"aria-label",Ge),de(V,"title",Xe),i(se,n()),i(ue,w()),Qe(he,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${N()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),de(he,"aria-pressed",N()==="session"),i(ge,Ee),Qe(U,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${N()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),de(U,"aria-pressed",N()==="bestiary"),i(Oe,Ae),de(at,"aria-label",P),de(at,"title",be),de(gt,"aria-label",He),de(gt,"title",oe),de(gt,"aria-pressed",S())},[()=>o()("character.header.back_dashboard"),()=>o()("character.header.back_dashboard"),()=>o()("common.labels.session"),()=>o()("common.labels.bestiary"),()=>o()("common.buttons.settings"),()=>o()("common.buttons.settings"),()=>o()("character.header.history"),()=>o()("character.header.history")]),d(F,me),da(),$()}ma(["click"]);var Xn=c('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),Kn=c('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),eo=c('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),to=c('<button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d3</span> <!></button>'),ao=c('<button class="bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-indigo-500/20"><span class="text-[10px] opacity-70">d20</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d6</span> <!></button> <!> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">2d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">3d6</span> <!></button> <div class="w-px h-8 bg-white/10 mx-1"></div> <button class="bg-slate-800 hover:bg-slate-700 text-slate-300 hover:text-white w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><!></button>',1),so=c('<button class="px-3 py-2 text-left hover:bg-indigo-600/50 rounded-lg text-xs font-mono text-slate-300 transition-colors w-full"> </button>'),ro=c('<div class="absolute bottom-full left-0 right-0 mb-2 bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-xl p-1 shadow-xl max-h-48 overflow-y-auto z-50 flex flex-col gap-0.5 min-w-[12rem]"></div>'),io=c('<button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button> <div class="relative"><input type="text" class="bg-slate-800 border border-slate-700 rounded-lg pl-3 pr-2 py-2 text-sm text-white focus:outline-none focus:border-indigo-500 w-48 font-mono placeholder:text-slate-600"/> <!></div> <button class="bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white w-10 h-10 rounded-lg flex items-center justify-center transition-colors shadow-lg"><!></button>',1),no=c('<div class="w-px h-8 bg-white/10 mx-1"></div> <button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button>',1),oo=c('<div class="fixed bottom-24 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0 z-[60] flex flex-col items-center gap-2 max-w-[95vw]"><div class="bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center gap-2 shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 duration-200 relative overflow-visible"><!> <!></div></div>  <div class="fixed inset-0 bg-black/40 z-[55]"></div>',1),lo=c('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!> <!> <div class="hidden md:block fixed bottom-8 left-8 z-[60]"><button class="w-16 h-16 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-[0_0_20px_rgba(79,70,229,0.4)] flex items-center justify-center transition-all active:scale-90 border-2 border-white/10 group"><!></button></div> <nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-6 pt-2 pointer-events-none"><div class="max-w-md mx-auto relative h-16 pointer-events-auto"><div class="absolute inset-0 bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"></div></div> <div class="relative h-full flex items-center justify-around px-2"><button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none"> </span></button> <div class="relative w-16 h-16 -mt-10 flex items-center justify-center"><div class="absolute inset-0 bg-indigo-600/20 rounded-full blur-xl animate-pulse"></div> <button class="relative w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(79,70,229,0.5)] border-4 border-slate-900 transition-all active:scale-90 hover:bg-indigo-500 z-10"><!></button></div> <button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none"> </span></button></div></div></nav> <!></div>');function So(F,r){la(r,!0);const o=()=>Ut(Us,"$page",M),J=()=>Ut(Hs,"$liveCampaigns",M),S=()=>Ut(aa,"$t",M),_=()=>Ut(Ma,"$isHistoryOpen",M),[M,$]=oa();let n=bt("session"),w=bt(!1),N=G(()=>o().params.id),Z=G(()=>J().find(P=>P.id===a(N))),ae=G(()=>!!a(Z));function me(P){if(!a(N)||!a(Z))return;const be={...a(Z),...P};ea.set(a(N),be),Ya(a(N),{name:be.name,gmName:be.gmName}),C(w,!1)}let D=bt(!1),R=bt(ga({isOpen:!1,sides:20,count:1,modifier:0,isCustom:!1,customFormula:""})),E=bt(!1),V=bt("");const T=["1d4","1d6","1d8","1d10","1d12","1d20","1d100","2d6","3d6","1d3","1d6 + 1d3"];let $e=G(()=>T.filter(P=>P.startsWith(a(V))&&P!==a(V)));function ze(P,be=1){C(R,{isOpen:!0,sides:P,count:be,modifier:0,isCustom:!1,customFormula:""},!0)}function kt(){C(E,!a(E)),a(E)||C(V,"")}function se(P){P&&(C(R,{isOpen:!0,sides:0,count:0,modifier:0,isCustom:!0,customFormula:P},!0),C(D,!1),C(E,!1),C(V,""))}function Ce(P,be=[],He){if(!a(Z))return;let oe,Le="";a(R).isCustom?(oe=Wr(a(R).customFormula),oe.dice&&(Le=oe.dice.map(p=>`${p.count}d${p.sides}@${p.results.join(",")}`).join("+"))):oe=Br(a(R).sides,a(R).count,P);let De="";(a(R).count>1||a(R).isCustom)&&(De+=`Dados: [${oe.results.join(", ")}] `),oe.bonusRolls?.length>0&&(De+=`Bonus Rolls: [${oe.bonusRolls.join(", ")}] -> ${Math.abs(oe.modifierTotal)}`);const Ze=a(Z).gmName||Aa(aa)("common.labels.master"),dt=()=>{As.addToHistory({source:"GM",charName:Ze,name:a(R).isCustom?oe.formula:`${a(R).count}d${a(R).sides} ${P?P>0?`+${P}`:P:""}`,description:De.trim()||null,total:oe.total,formula:oe.formula,crit:oe.crit}),Aa(Ts).autoOpenHistory?Ma.set(!0):Es(async()=>{const{hasUnreadRolls:p}=await import("../chunks/BPjVGcEY.js").then(I=>I.a6);return{hasUnreadRolls:p}},__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(({hasUnreadRolls:p})=>{p.set(!0)})};He?.suppressHistory||(dt(),a(R).isOpen=!1);const Te=a(R).sides===20&&a(R).count===1&&!a(R).isCustom;return{d20:Te?oe.results[0]:void 0,boonBaneDice:Te?oe.bonusRolls:[],damageDice:Te?[]:oe.results,total:oe.total,formula:oe.formula,commit:dt,notation:Le}}var ue=lo(),je=t(ue);{var he=P=>{var be=Xn(),He=Fe(be);Zn(He,{get campaignName(){return a(Z).name},get gmName(){return a(Z).gmName},get activeSubTab(){return a(n)},onTabChange:Te=>C(n,Te,!0),onOpenSettings:()=>C(w,!0)});var oe=s(He,2);{let Te=G(()=>JSON.stringify(a(Z)));rr(oe,{get isOpen(){return a(w)},get initialData(){return a(Te)},onClose:()=>C(w,!1),onSave:me})}var Le=s(oe,2),De=t(Le);{var Ze=Te=>{Di(Te,{get campaign(){return a(Z)}})},dt=Te=>{var vt=$t(),p=Fe(vt);{var I=j=>{Wn(j,{get campId(){return a(N)}})};y(p,j=>{a(n)==="bestiary"&&j(I)},!0)}d(Te,vt)};y(De,Te=>{a(n)==="session"?Te(Ze):Te(dt,!1)})}e(Le),d(P,be)},Me=P=>{var be=$t(),He=Fe(be);{var oe=De=>{var Ze=Kn(),dt=s(t(Ze),2),Te=t(dt,!0);e(dt);var vt=s(dt,2),p=t(vt,!0);e(vt);var I=s(vt,2);I.__click=()=>window.history.back();var j=s(t(I));e(I),e(Ze),x((we,Se,Ie)=>{i(Te,we),i(p,Se),i(j,` ${Ie??""}`)},[()=>S()("campaign.not_found.title"),()=>S()("campaign.not_found.message"),()=>S()("common.buttons.back")]),d(De,Ze)},Le=De=>{var Ze=eo();d(De,Ze)};y(He,De=>{a(ae)&&!a(Z)?De(oe):De(Le,!1)},!0)}d(P,be)};y(je,P=>{a(ae)&&a(Z)?P(he):P(Me,!1)})}var Je=s(je,2);ms(Je,{get isOpen(){return _()},onClose:()=>Ma.set(!1)});var ge=s(Je,2);{var U=P=>{var be=oo(),He=Fe(be),oe=t(He),Le=t(oe);{var De=p=>{var I=ao(),j=Fe(I);j.__click=()=>{ze(20),C(D,!1)};var we=s(t(j),2);za(we,{size:16}),e(j);var Se=s(j,2);Se.__click=()=>{ze(6),C(D,!1)};var Ie=s(t(Se),2);za(Ie,{size:16}),e(Se);var qe=s(Se,2);{var yt=X=>{var B=to();B.__click=()=>{ze(3),C(D,!1)};var Q=s(t(B),2);za(Q,{size:16}),e(B),d(X,B)};y(qe,X=>{a(Z)?.system==="sofdl"&&X(yt)})}var st=s(qe,2);st.__click=()=>{ze(6,2),C(D,!1)};var Ot=s(t(st),2);za(Ot,{size:16}),e(st);var pe=s(st,2);pe.__click=()=>{ze(6,3),C(D,!1)};var H=s(t(pe),2);za(H,{size:16}),e(pe);var A=s(pe,4);A.__click=kt;var L=t(A);Xs(L,{size:20}),e(A),x(X=>de(A,"title",X),[()=>S()("session.quick.custom_roll")]),d(p,I)},Ze=p=>{var I=io(),j=Fe(I);j.__click=kt;var we=t(j);ar(we,{size:20}),e(j);var Se=s(j,2),Ie=t(Se);jt(Ie),Ie.__keydown=pe=>pe.key==="Enter"&&se(a(V)),Ss(Ie,!0);var qe=s(Ie,2);{var yt=pe=>{var H=ro();Ye(H,21,()=>a($e),Mt,(A,L)=>{var X=so();X.__click=()=>se(a(L));var B=t(X,!0);e(X),x(()=>i(B,a(L))),d(A,X)}),e(H),d(pe,H)};y(qe,pe=>{a($e).length>0&&pe(yt)})}e(Se);var st=s(Se,2);st.__click=()=>se(a(V));var Ot=t(st);br(Ot,{size:18}),e(st),x(pe=>{de(Ie,"placeholder",pe),st.disabled=!a(V)},[()=>S()("session.quick.custom_roll_placeholder")]),ut(Ie,()=>a(V),pe=>C(V,pe)),d(p,I)};y(Le,p=>{a(E)?p(Ze,!1):p(De)})}var dt=s(Le,2);{var Te=p=>{var I=no(),j=s(Fe(I),2);j.__click=()=>C(D,!1);var we=t(j);ya(we,{size:20}),e(j),d(p,I)};y(dt,p=>{a(E)||p(Te)})}e(oe),e(He);var vt=s(He,2);vt.__click=()=>{C(D,!1),C(E,!1)},d(P,be)};y(ge,P=>{a(D)&&P(U)})}var ne=s(ge,2),ve=t(ne);ve.__click=()=>C(D,!a(D));var Oe=t(ve);za(Oe,{size:32,class:"group-hover:rotate-12 transition-transform"}),e(ve),e(ne);var ye=s(ne,2),xt=t(ye),it=s(t(xt),2),nt=t(it);nt.__click=()=>{C(n,"session"),C(D,!1)};var _t=t(nt);{let P=G(()=>a(n)==="session"?"animate-in zoom-in-75 duration-300":"");ws(_t,{size:20,get class(){return a(P)}})}var at=s(_t,2),St=t(at,!0);e(at),e(nt);var gt=s(nt,2),ft=s(t(gt),2);ft.__click=()=>C(D,!a(D));var Pt=t(ft);{let P=G(()=>a(D)?"rotate-90":"rotate-0");za(Pt,{size:28,get class(){return`text-white ${a(P)??""} transition-transform duration-300`}})}e(ft),e(gt);var ht=s(gt,2);ht.__click=()=>{C(n,"bestiary"),C(D,!1)};var Ge=t(ht);{let P=G(()=>a(n)==="bestiary"?"animate-in zoom-in-75 duration-300":"");Cs(Ge,{size:20,get class(){return a(P)}})}var Xe=s(Ge,2),Ee=t(Xe,!0);e(Xe),e(ht),e(it),e(xt),e(ye);var Ae=s(ye,2);{let P=G(()=>a(R).isCustom?S()("session.quick.custom_roll"):`${S()("session.quick.roll_title")} (${a(R).count}d${a(R).sides})`),be=G(()=>a(R).isCustom?"":a(R).sides===20?S()("session.quick.boons_banes"):S()("session.quick.fixed_modifier"));Zs(Ae,{get isOpen(){return a(R).isOpen},get title(){return a(P)},get label(){return a(be)},get customFormula(){return a(R).customFormula},onClose:()=>a(R).isOpen=!1,onRoll:Ce,initialModifier:0})}e(ue),x((P,be,He,oe)=>{de(ve,"title",P),Qe(nt,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(n)==="session"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),i(St,be),de(ft,"aria-label",He),Qe(ht,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(n)==="bestiary"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),i(Ee,oe)},[()=>S()("session.quick.fab_title"),()=>S()("session.tabs.session"),()=>S()("session.quick.roll_dice"),()=>S()("session.tabs.bestiary")]),d(F,ue),da(),$()}ma(["click","keydown"]);export{So as component};
