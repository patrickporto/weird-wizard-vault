import"../chunks/DsnmJJEf.js";import{v as Ke,w as $e,k as d,x as Yt,z as ea,j as x,B as t,y as a,A as r,T as be,I as e,t as g,L as $a,F as I,R as De,n as Wt,a2 as Xt,ag as Ca}from"../chunks/D6Pz1OcM.js";import{d as ta,s as i,o as ja,g as ha,e as pa}from"../chunks/CCHuTdEV.js";import{l as Ot,s as It,i as S,p as Tt}from"../chunks/DSn_IzLH.js";import{e as He,s as Oe,i as ot,$ as qt,r as Mt,a as qe,j as ya,f as Ja}from"../chunks/D_y7S3KX.js";import{s as aa,a as st}from"../chunks/DRdbpf1Q.js";import{p as Za}from"../chunks/CjWsk5yp.js";import{A as Xa,d as Ea,n as _a,a as Ka,c as Ma,e as $t,o as wa,q as Ya,t as na,v as ma,u as xa,b as Pt,f as Oa,g as ga,x as er,m as tr,l as ar}from"../chunks/D9LWGkM2.js";import{C as Na,b as za,c as Sa,l as rr,a as sr}from"../chunks/C0Q8mMo1.js";import{b as ir}from"../chunks/BouNVTfo.js";import{U as Ra,W as Pa,r as Ta}from"../chunks/BQ-QHdNf.js";import{a as nr,A as ka,M as or,G as fa,H as Aa,C as Da,b as lr,I as dr,s as vr,c as cr,L as ur,S as Ha,d as br,D as da,e as xr}from"../chunks/BZL6QL_u.js";import{k as La}from"../chunks/CKU9AWyW.js";import{M as mr,X as va,P as Kt,c as _r,T as ca,b as fr,a as pr}from"../chunks/CfkvuZVU.js";import{C as Ua,G as gr,P as qa,a as hr}from"../chunks/Dxz7SzsP.js";import"../chunks/1d2PQuzn.js";import{I as Nt,s as St}from"../chunks/B3F2ylC7.js";import{C as Ia}from"../chunks/CbZQP7Ee.js";import{b as yr}from"../chunks/BowTBLkD.js";import{g as wr}from"../chunks/BwJOTeE9.js";import{W as kr}from"../chunks/Bm5tccWN.js";function $r(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["path",{d:"m6 9 6 6 6-6"}]];Nt(j,It({name:"chevron-down"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function zr(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["path",{d:"m18 15-6-6-6 6"}]];Nt(j,It({name:"chevron-up"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function Cr(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];Nt(j,It({name:"copy"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function jr(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["circle",{cx:"12",cy:"12",r:"3"}]];Nt(j,It({name:"eye"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function Er(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];Nt(j,It({name:"flame"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function Mr(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];Nt(j,It({name:"grip-vertical"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function Fa(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];Nt(j,It({name:"layers"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function Ba(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];Nt(j,It({name:"library"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function Or(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];Nt(j,It({name:"qr-code"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function Ir(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}]];Nt(j,It({name:"rotate-ccw"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function Va(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];Nt(j,It({name:"save"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function Nr(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["path",{d:"m12.5 17-.5-1-.5 1h1z"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"9",cy:"12",r:"1"}]];Nt(j,It({name:"skull"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function Wa(j,s){const n=Ot(s,["children","$$slots","$$events","$$legacy"]);const u=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];Nt(j,It({name:"swords"},()=>n,{get iconNode(){return u},children:(k,F)=>{var $=Ke(),l=$e($);St(l,s,"default",{}),d(k,$)},$$slots:{default:!0}}))}function Sr(j){let s=!1;return document.body&&(document.body.appendChild(j),s=!0),{destroy(){s&&j.parentNode&&j.parentNode.removeChild(j)}}}var Rr=x("<button> <!></button>"),Pr=x('<p class="text-xs text-slate-600 italic"> </p>'),Tr=x('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),Ar=x('<div class="space-y-1"></div>'),Dr=x('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),Hr=x("<div><!></div>");function Lr(j,s){Yt(s,!0);const n=()=>st(qt,"$t",u),[u,k]=aa();var F=Ke(),$=$e(F);{var l=E=>{var H=Hr(),re=t(H);{let Y=be(()=>n()("session.affliction_modal.title"));mr(re,{get isOpen(){return s.isOpen},get onClose(){return s.onClose},get title(){return a(Y)},maxWidth:"max-w-md",children:(Ie,fe)=>{var Z=Dr(),ve=$e(Z);He(ve,21,()=>Object.keys(Xa),ot,(X,W)=>{const he=be(()=>s.afflictions.includes(a(W)));var ze=Rr();ze.__click=()=>s.onToggle(a(W));var Pe=t(ze),ye=r(Pe);{var tt=Me=>{Ua(Me,{size:14,class:"text-red-400"})};S(ye,Me=>{a(he)&&Me(tt)})}e(ze),g(Me=>{Oe(ze,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(he)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),i(Pe,`${Me??""} `)},[()=>n()(`character.afflictions.${a(W)}`)]),d(X,ze)}),e(ve);var L=r(ve,2),ee=t(L),se=t(ee),Ne=t(se,!0);e(se);var Ye=r(se,2);{var te=X=>{var W=Pr(),he=t(W,!0);e(W),g(ze=>i(he,ze),[()=>n()("session.affliction_modal.none_selected")]),d(X,W)},ie=X=>{var W=Ar();He(W,21,()=>s.afflictions,ot,(he,ze)=>{var Pe=Tr(),ye=t(Pe),tt=t(ye);e(ye);var Me=r(ye,2),Fe=t(Me,!0);e(Me),e(Pe),g((nt,Ze)=>{i(tt,`${nt??""}:`),i(Fe,Ze)},[()=>n()(`character.afflictions.${a(ze)}`),()=>n()(`sofww.afflictions.${a(ze).toLowerCase().replace(" ","_")}.effect`)]),d(he,Pe)}),e(W),d(X,W)};S(Ye,X=>{s.afflictions.length===0?X(te):X(ie,!1)})}e(ee);var xe=r(ee,2),ge=t(xe);ge.__click=function(...X){s.onClose?.apply(this,X)};var Le=t(ge,!0);e(ge),e(xe),e(L),g((X,W)=>{i(Ne,X),i(Le,W)},[()=>n()("session.affliction_modal.effects"),()=>n()("session.affliction_modal.done")]),d(Ie,Z)},$$slots:{default:!0}})}e(H),nr(H,Y=>Sr?.(Y)),d(E,H)};S($,E=>{s.isOpen&&E(l)})}d(j,F),ea(),k()}ta(["click"]);var Ur=x('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),qr=x('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),Fr=x('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),Br=x("<button><!></button>"),Vr=x('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),Wr=x('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),Gr=x('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),Qr=x('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),Jr=x('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),Zr=x('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),Xr=x('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),Kr=x('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),Yr=x('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),es=x('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <div class="grid grid-cols-3 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"></div></div>'),ts=x('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function as(j,s){Yt(s,!0);const n=()=>st(qt,"$t",u),[u,k]=aa();let F=Tt(s,"updateEnemy",3,(m,w)=>{}),$=Tt(s,"updatePlayer",3,(m,w)=>{}),l=Tt(s,"removeFromCombat",3,m=>{}),E=be(()=>s.entity.type==="player"),H=be(()=>s.entity.damage||0),re=be(()=>s.entity.normalHealth||s.entity.health||10),Y=be(()=>s.entity.currentHealth??a(re)),Ie=be(()=>a(H)>=a(Y)),fe=be(()=>a(H)>=a(Y)/2&&!a(Ie)),Z=be(()=>a(Y)>0?Math.min(100,Math.max(0,a(H)/a(Y)*100)):100),ve=De(!1),L=De(!1);$a(()=>{const m=s.entity.afflictions||[],w=m.includes("Incapacitated");if(a(Ie)&&!w){const de={afflictions:[...m,"Incapacitated"]};s.entity.type==="player"?ee(de):F()(s.entity.instanceId,de)}else if(!a(Ie)&&w){const de={afflictions:m.filter(Ae=>Ae!=="Incapacitated")};s.entity.type==="player"?ee(de):F()(s.entity.instanceId,de)}});function ee(m){if(s.entity.type!=="player")return;const w=Ea.get(s.entity.id);w&&Ea.set(s.entity.id,{...w,...m}),$()(s.entity.id,m),_a({id:s.entity.id,...m})}function se(m){const w=parseInt(m.target.value);if(isNaN(w))return;const de={damage:Math.max(0,w)};s.entity.type==="player"?ee(de):F()(s.entity.instanceId,de)}function Ne(m){const w=parseInt(m.target.value);if(isNaN(w))return;const oe=Math.max(0,w);let de=a(H);oe<a(H)&&(de=oe);const Ae={currentHealth:oe,damage:de};s.entity.type==="player"?ee(Ae):F()(s.entity.instanceId,Ae)}function Ye(){const m=!s.entity.acted;s.entity.type==="player"?ee({acted:m}):F()(s.entity.instanceId,{acted:m})}function te(){s.entity.type==="player"&&ee({initiative:!s.entity.initiative})}function ie(m){const w=s.entity.afflictions||[],de={afflictions:w.includes(m)?w.filter(Ae=>Ae!==m):[...w,m]};s.entity.type==="player"?ee(de):F()(s.entity.instanceId,de)}var xe=ts(),ge=t(xe);{var Le=m=>{var w=Ur(),oe=t(w,!0);e(w),g(de=>i(oe,de),[()=>n()("session.combat_card.initiative")]),d(m,w)};S(ge,m=>{a(E)&&s.entity.initiative&&m(Le)})}var X=r(ge,2);{var W=m=>{var w=qr();d(m,w)};S(X,m=>{a(Ie)&&m(W)})}var he=r(X,2),ze=t(he),Pe=t(ze),ye=t(Pe),tt=t(ye);La(tt,()=>s.entity.imageUrl,m=>{{let w=be(()=>s.entity.name.charAt(0));ka(m,{get hash(){return s.entity.imageUrl},get alt(){return s.entity.name},size:"custom",get fallbackText(){return a(w)}})}}),e(ye);var Me=r(ye,2);Me.__click=Ye;var Fe=t(Me);{var nt=m=>{Nr(m,{size:14,class:""})},Ze=m=>{var w=Ke(),oe=$e(w);{var de=_t=>{Ua(_t,{size:14})},Ae=_t=>{Wa(_t,{size:14})};S(oe,_t=>{s.entity.acted?_t(de):_t(Ae,!1)},!0)}d(m,w)};S(Fe,m=>{a(Ie)?m(nt):m(Ze,!1)})}e(Me),e(Pe);var lt=r(Pe,2),it=t(lt),Q=t(it),ae=t(Q),G=t(ae),pe=t(G,!0);e(G);var Ce=r(G,2);{var je=m=>{var w=Fr(),oe=t(w);e(w),g(()=>i(oe,`Dif ${s.entity.difficulty??""}`)),d(m,w)};S(Ce,m=>{a(E)||m(je)})}e(ae),e(Q);var we=r(Q,2),Se=t(we);Se.__click=()=>I(ve,!a(ve));var q=t(Se);{var me=m=>{zr(m,{size:14})},le=m=>{$r(m,{size:14})};S(q,m=>{a(ve)?m(me):m(le,!1)})}e(Se);var ne=r(Se,2);{var ke=m=>{var w=Br();w.__click=te;var oe=t(w);Er(oe,{size:14}),e(w),g(de=>{Oe(w,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${s.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),qe(w,"title",de)},[()=>n()("session.combat_card.initiative")]),d(m,w)},We=m=>{var w=Vr();w.__click=()=>l()(s.entity.instanceId);var oe=t(w);va(oe,{size:14}),e(w),d(m,w)};S(ne,m=>{a(E)?m(ke):m(We,!1)})}e(we),e(it);var Be=r(it,2),C=t(Be),z=r(C,2);{var ce=m=>{var w=Wr();g(()=>{Oe(w,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10 
                            ${a(Ie)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(Z)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(fe)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),Ja(w,`width: ${a(Z)??""}%`)}),d(m,w)};S(z,m=>{a(Z)>0&&m(ce)})}var Ee=r(z,2);{var Ge=m=>{var w=Gr();d(m,w)};S(Ee,m=>{a(H)===0&&m(Ge)})}var Xe=r(Ee,2);{var Te=m=>{var w=Qr(),oe=t(w),de=t(oe,!0);e(oe),e(w),g(Ae=>i(de,Ae),[()=>n()("session.combat_card.incapacitated")]),d(m,w)},dt=m=>{var w=Ke(),oe=$e(w);{var de=Ae=>{var _t=Jr(),Bt=t(_t),Vt=t(Bt,!0);e(Bt),e(_t),g(o=>i(Vt,o),[()=>n()("session.combat_card.injured")]),d(Ae,_t)};S(oe,Ae=>{a(fe)&&Ae(de)},!0)}d(m,w)};S(Xe,m=>{a(Ie)?m(Te):m(dt,!1)})}e(Be);var At=r(Be,2),Ct=t(At),gt=t(Ct),xt=t(gt),jt=t(xt,!0);e(xt);var Dt=r(xt,2),ht=t(Dt,!0);e(Dt),e(gt);var yt=r(gt,2),Re=t(yt),vt=t(Re,!0);e(Re);var Ve=r(Re,2);Mt(Ve),Ve.__input=se,Wt(2),e(yt);var at=r(yt,2),ct=t(at),wt=t(ct,!0);e(ct);var mt=r(ct,2),ft=t(mt);Mt(ft),ft.__input=Ne;var Ht=r(ft,2),Ft=t(Ht);e(Ht),e(mt),e(at),e(Ct);var Lt=r(Ct,2),Jt=t(Lt);He(Jt,17,()=>s.entity.afflictions||[],ot,(m,w)=>{var oe=Zr();oe.__click=()=>ie(a(w));var de=t(oe),Ae=r(de);va(Ae,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(oe),g(()=>i(de,`${a(w)??""} `)),d(m,oe)});var Gt=r(Jt,2);Gt.__click=()=>I(L,!0);var oa=t(Gt);Kt(oa,{size:10});var ra=r(oa);e(Gt),e(Lt),e(At),e(lt),e(ze),e(he);var Zt=r(he,2);{var sa=m=>{var w=es(),oe=t(w),de=t(oe),Ae=t(de),_t=t(Ae,!0);e(Ae),Wt(2),e(de);var Bt=r(de,2);He(Bt,20,()=>["str","agi","int","wil"],ot,(M,y)=>{var V=Xr(),P=t(V),D=t(P,!0);e(P);var J=r(P,2),ue=t(J,!0);e(J);var _e=r(J,2),Ue=t(_e);e(_e),e(V),g(()=>{i(D,y),i(ue,s.entity.stats?.[y]??s.entity.attributes?.[y]??10),Oe(_e,1,`text-[9px] font-bold ${(s.entity.stats?.[y]??s.entity.attributes?.[y]??10)-10>=0?"text-emerald-500":"text-red-500"}`),i(Ue,`${(s.entity.stats?.[y]??s.entity.attributes?.[y]??10)-10>=0?"+":""}${(s.entity.stats?.[y]??s.entity.attributes?.[y]??10)-10}`)}),d(M,V)}),e(Bt),e(oe);var Vt=r(oe,2),o=t(Vt),v=t(o),c=t(v,!0);e(v);var h=r(v,2),B=t(h,!0);e(h),e(o);var R=r(o,2),p=t(R),b=t(p,!0);e(p);var _=r(p,2),f=t(_,!0);e(_),e(R);var U=r(R,2),A=t(U),N=t(A,!0);e(A);var O=r(A,2),K=t(O,!0);e(O),e(U),e(Vt);var T=r(Vt,2);He(T,20,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],ot,(M,y)=>{var V=Ke(),P=$e(V);{var D=J=>{var ue=Yr(),_e=t(ue),Ue=t(_e);Wt(),e(_e);var rt=r(_e,2);He(rt,21,()=>s.entity[y.key],ot,(kt,ut)=>{var bt=Kr(),zt=t(bt),Ut=t(zt,!0);e(zt);var Qe=r(zt,2),Je=t(Qe,!0);e(Qe),e(bt),g(()=>{i(Ut,a(ut).name),i(Je,a(ut).description||a(ut).effect)}),d(kt,bt)}),e(rt),e(ue),g(()=>{Oe(_e,1,`${y.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),i(Ue,`${y.label??""} `)}),d(J,ue)};S(P,J=>{s.entity[y.key]&&s.entity[y.key].length>0&&J(D)})}d(M,V)}),e(T),e(w),g((M,y,V,P)=>{i(_t,M),i(c,y),i(B,s.entity.size||1),i(b,V),i(f,s.entity.speed||10),i(N,P),i(K,s.entity.defense||10)},[()=>n()("session.combat_card.attributes"),()=>n()("session.combat_card.size"),()=>n()("session.combat_card.speed"),()=>n()("session.combat_card.defense")]),d(m,w)};S(Zt,m=>{a(ve)&&m(sa)})}var la=r(Zt,2);{let m=be(()=>s.entity.afflictions||[]);Lr(la,{get isOpen(){return a(L)},onClose:()=>I(L,!1),get afflictions(){return a(m)},onToggle:ie})}e(xe),g((m,w,oe,de,Ae)=>{Oe(xe,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(E)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),Oe(ye,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(Ie)?"border-red-600 grayscale brightness-50":a(E)?"border-indigo-500/50":"border-red-900/50"}`),Oe(Me,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${s.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(E)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),qe(Me,"title",m),Oe(G,1,`text-base font-bold truncate leading-snug ${a(E)?"text-white":"text-red-100 font-serif tracking-wide"}`),i(pe,s.entity.name),Oe(C,1,`absolute inset-0 w-full ${a(H)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),i(jt,w),i(ht,s.entity.defense||10),i(vt,oe),ya(Ve,a(H)),Oe(at,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(Ie)?"bg-red-950/50 border-red-500":a(fe)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),Oe(ct,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(Ie)?"text-red-400":a(fe)?"text-orange-400":"text-emerald-400"}`),i(wt,de),ya(ft,a(Y)),i(Ft,`/${a(re)??""}`),i(ra,` ${Ae??""}`)},[()=>s.entity.acted?n()("session.combat_card.acted"):n()("session.combat_card.act"),()=>n()("session.combat_card.defense"),()=>n()("session.combat_card.damage"),()=>n()("session.combat_card.health"),()=>n()("session.combat_card.add_affliction")]),d(j,xe),ea(),k()}ta(["click","input"]);function rs(j,{from:s,to:n},u={}){var{delay:k=0,duration:F=ie=>Math.sqrt(ie)*120,easing:$=_r}=u,l=getComputedStyle(j),E=l.transform==="none"?"":l.transform,[H,re]=l.transformOrigin.split(" ").map(parseFloat);H/=j.clientWidth,re/=j.clientHeight;var Y=ss(j),Ie=j.clientWidth/n.width/Y,fe=j.clientHeight/n.height/Y,Z=s.left+s.width*H,ve=s.top+s.height*re,L=n.left+n.width*H,ee=n.top+n.height*re,se=(Z-L)*Ie,Ne=(ve-ee)*fe,Ye=s.width/n.width,te=s.height/n.height;return{delay:k,duration:typeof F=="function"?F(Math.sqrt(se*se+Ne*Ne)):F,easing:$,css:(ie,xe)=>{var ge=xe*se,Le=xe*Ne,X=ie+xe*Ye,W=ie+xe*te;return`transform: ${E} translate(${ge}px, ${Le}px) scale(${X}, ${W});`}}}function ss(j){if("currentCSSZoom"in j)return j.currentCSSZoom;for(var s=j,n=1;s!==null;)n*=+getComputedStyle(s).zoom,s=s.parentElement;return n}function is(j,s=1,n=0){const u=[];let k=0;for(let E=0;E<s;E++){const H=Math.floor(Math.random()*j)+1;u.push(H),k+=H}let F=`${s}d${j}`,$=[],l=0;if(n!==0)if(j===20){const E=Math.abs(n);for(let re=0;re<E;re++)$.push(Math.floor(Math.random()*6)+1);const H=Math.max(...$);n>0?(l=H,k+=H,F+=` + ${H} [Boon]`):(l=-H,k-=H,F+=` - ${H} [Bane]`)}else l=n,k+=n,F+=n>0?` + ${n}`:` - ${Math.abs(n)}`;return{total:k,results:u,bonusRolls:$,formula:F,crit:j===20&&u.includes(20),modifierTotal:l}}var ns=x('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),os=x('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),ls=x('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),ds=x('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),vs=x('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),cs=x('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),us=x('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),bs=x('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),xs=x('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),ms=x('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),_s=x('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all"><div class="truncate flex-1 flex items-center gap-2"><!> <div><div class="text-sm font-bold text-white truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800"><!></button></div>'),fs=x('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),ps=x("<!> <!>",1),gs=x('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800"><!></button></div>'),hs=x('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),ys=x("<!> <!>",1),ws=x('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),ks=x('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),$s=x("<div><!></div>"),zs=x('<div class="text-center text-slate-500 italic py-10"> </div>'),Cs=x('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),js=x('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),Es=x('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),Ms=x('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),Os=x('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),Is=x('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Ns=x('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col h-[400px]"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"></div></div> <!> <!> <!> <!>',1);function Ss(j,s){Yt(s,!0);const n=()=>st(rr,"$liveCharacters",l),u=()=>st(qt,"$t",l),k=()=>st(za,"$liveEnemies",l),F=()=>st(Sa,"$liveEncounters",l),$=()=>st(na,"$isHistoryOpen",l),[l,E]=aa();let H=De(!1),re=De(!1),Y=De(!1);const Ie={active:!1,round:1};let fe=De("enemies"),Z=De(!1),ve=De(Xt([])),L=De(Xt({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));ja(()=>{if(s.campaign?.id){Ka(s.campaign.id,!0);const o=ha(qt)("common.labels.master");Ma.update(c=>({...c,campaignId:s.campaign.id,name:s.campaign.gmName||o}));const v=setInterval(()=>{const c=$t.get(s.campaign.id)||s.campaign,h=ha(qt)("common.labels.master");wa(s.campaign.id,{name:c.name,gmName:c.gmName||h})},3e4);return()=>{clearInterval(v),Ya(),Ma.update(c=>({...c,campaignId:null}))}}});const ee=be(()=>typeof window<"u"?`${window.location.origin}${Ta("/campaigns/[id]/invite",{id:s.campaign?.id})}`:"");function se(){a(ee)&&(navigator.clipboard.writeText(a(ee)),I(re,!0),setTimeout(()=>{I(re,!1)},2e3))}let Ne=be(()=>s.campaign?.sessionRoster||[]),Ye=be(()=>s.campaign?.combat||Ie),te=be(()=>s.campaign?.activeEnemies||[]),ie=be(()=>s.campaign?.members||[]),xe=be(()=>Array.from(new Set([...a(Ne),...a(ie).map(v=>v.id)])).map(v=>{const c=n().find(B=>B.id===v),h=a(ie).find(B=>B.id===v);return c&&h?{...c,...h,lastUpdate:h.lastUpdate}:c||h}).filter(Boolean)),ge=be(()=>a(xe).filter(o=>!o.campaignApproval||o.campaignApproval==="approved")),Le=be(()=>a(xe).filter(o=>o.campaignApproval==="pending")),X=be(()=>n().filter(o=>!a(Ne).includes(o.id)&&!a(ie).some(v=>v.id===o.id)));function W(o){if(!s.campaign?.id)return;const c={...$t.get(s.campaign.id)||s.campaign,...o};$t.set(s.campaign.id,c),o.combat&&ma(s.campaign.id,o.combat),(o.name||o.gmName)&&wa(s.campaign.id,{name:c.name,gmName:c.gmName})}function he(o){if(a(Ne).includes(o)){const v=a(Ne).filter(c=>c!==o);W({sessionRoster:v})}else{const v=[...a(Ne),o];W({sessionRoster:v})}}function ze(o){je(o,{campaignApproval:"approved"}),_a({id:o,campaignApproval:"approved"})}function Pe(o){_a({id:o,campaignApproval:"rejected",campaignId:null});const c=(($t.get(s.campaign.id)||s.campaign).members||[]).filter(h=>h.id!==o);W({members:c})}function ye(o){const v=a(xe).find(c=>c.id===o);I(L,{isOpen:!0,title:u()("session.players.remove_title"),message:u()("session.players.remove_message",{values:{name:v?.name||"este personagem"}}),onConfirm:()=>{const c=$t.get(s.campaign.id)||s.campaign;_a({id:o,campaignId:null});const h=(c.sessionRoster||[]).filter(p=>p!==o),B=(c.members||[]).filter(p=>p.id!==o),R=(c.activeEnemies||[]).filter(p=>p.type!=="player"||p.id!==o);W({sessionRoster:h,members:B,activeEnemies:R}),a(L).isOpen=!1}},!0)}function tt(o){const c=($t.get(s.campaign.id)||s.campaign).activeEnemies||[],h={...o,instanceId:xa(),damage:0,currentHealth:o.health,afflictions:[],acted:!1,initiative:!1};W({activeEnemies:[...c,h]})}function Me(o){const c=($t.get(s.campaign.id)||s.campaign).activeEnemies||[];let h=[];o.enemies.forEach(B=>{const R=k().find(p=>p.id===B.enemyId);if(R)for(let p=0;p<B.count;p++)h.push({...R,instanceId:xa(),damage:0,currentHealth:R.health,afflictions:[],acted:!1,initiative:!1})}),W({activeEnemies:[...c,...h]})}function Fe(){W({combat:{active:!0,round:1}}),ma(s.campaign.id,{active:!0,round:1})}function nt(){const o=a(te).filter(v=>v.damage<(v.currentHealth??v.health)&&v.endOfRound&&v.endOfRound.length>0).map(v=>({name:v.name,effects:v.endOfRound}));if(o.length>0){I(ve,o,!0),I(Z,!0);return}Ze()}function Ze(){const o=$t.get(s.campaign.id)||s.campaign,v=(o.combat?.round||1)+1,c=(o.activeEnemies||[]).map(h=>({...h,acted:!1}));W({combat:{...o.combat,round:v},activeEnemies:c}),ma(s.campaign.id,{active:!0,round:v}),I(Z,!1)}function lt(o){W({combat:{active:!1,round:1}}),ma(s.campaign.id,{active:!1,round:1})}function it(o){const v=$t.get(s.campaign.id)||s.campaign;W({activeEnemies:(v.activeEnemies||[]).filter(c=>c.instanceId!==o)})}function Q(o,v){const c=$t.get(s.campaign.id)||s.campaign;W({activeEnemies:(c.activeEnemies||[]).map(h=>h.instanceId===o?{...h,...v}:h)})}function ae(){const o=$t.get(s.campaign.id)||s.campaign,v=o.combat?.round||1;v>1&&W({combat:{...o.combat,round:v-1}})}let G=De(Xt(Date.now()));ja(()=>{const o=setInterval(()=>{I(G,Date.now(),!0)},1e4);return()=>clearInterval(o)});let pe=be(()=>(()=>{const o=a(ge).filter(p=>a(Ne).includes(p.id)),v=o.filter(p=>p&&p.initiative).map(p=>({...p,type:"player"})),c=a(te).map(p=>({...p,type:"enemy"})),h=o.filter(p=>p&&!p.initiative).map(p=>({...p,type:"player"})),B=[...v,...c,...h],R=new Set;return B.filter(p=>{if(!p)return!1;const b=p.type==="player"?p.id:p.instanceId;return R.has(b)?!1:(R.add(b),!0)})})());function Ce(o){return o.lastUpdate?a(G)-o.lastUpdate<6e4:!1}function je(o,v){const c=$t.get(s.campaign.id)||s.campaign,h=c.members||[],B=h.findIndex(f=>f.id===o);let R=h;B!==-1&&(R=[...h],R[B]={...R[B],...v});const p=c.activeEnemies||[],b=p.findIndex(f=>f.id===o&&f.type==="player");let _=p;b!==-1&&(_=[...p],_[b]={..._[b],...v}),W({members:R,activeEnemies:_})}var we=Ns(),Se=$e(we),q=t(Se),me=t(q),le=t(me),ne=t(le),ke=t(ne);Ra(ke,{size:14,class:"text-indigo-500"});var We=r(ke),Be=r(We);{var C=o=>{var v=ns(),c=t(v,!0);e(v),g(()=>i(c,a(ge).length)),d(o,v)};S(Be,o=>{a(ge).length>0&&o(C)})}e(ne);var z=r(ne,2);z.__click=()=>I(H,!a(H));var ce=t(z,!0);e(z),e(le);var Ee=r(le,2);{var Ge=o=>{var v=ls(),c=t(v),h=r(t(c),2),B=t(h);e(h),e(c);var R=r(c,2);He(R,17,()=>a(Le),p=>p.id,(p,b)=>{var _=os(),f=t(_),U=t(f),A=t(U,!0);e(U);var N=r(U,2),O=t(N,!0);e(N),e(f);var K=r(f,2),T=t(K);T.__click=()=>ze(a(b).id);var M=t(T);Ia(M,{size:14}),e(T);var y=r(T,2);y.__click=()=>Pe(a(b).id);var V=t(y);ca(V,{size:14}),e(y),e(K),e(_),g(P=>{i(A,a(b).name),i(O,P)},[()=>u()("session.players.new_request")]),d(p,_)}),Wt(2),e(v),g(p=>i(B,`${p??""} (${a(Le).length??""})`),[()=>u()("session.players.waiting_approval")]),d(o,v)};S(Ee,o=>{a(Le).length>0&&o(Ge)})}var Xe=r(Ee,2),Te=t(Xe),dt=t(Te);He(dt,17,()=>a(ge),o=>o.id,(o,v)=>{const c=be(()=>Ce(a(v))),h=be(()=>a(Ne).includes(a(v).id));var B=vs(),R=t(B),p=r(R,2),b=t(p),_=t(b,!0);e(b);var f=r(b,2),U=t(f);{var A=D=>{var J=ds(),ue=t(J,!0);e(J),g(_e=>i(ue,_e),[()=>u()("common.labels.session")]),d(D,J)};S(U,D=>{a(h)&&D(A)})}var N=r(U);e(f),e(p);var O=r(p,2),K=t(O);K.__click=()=>he(a(v).id);var T=t(K);{var M=D=>{or(D,{size:14})},y=D=>{Kt(D,{size:14})};S(T,D=>{a(h)?D(M):D(y,!1)})}e(K);var V=r(K,2);V.__click=()=>ye(a(v).id);var P=t(V);ca(P,{size:14}),e(V),e(O),e(B),g((D,J,ue)=>{Oe(B,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(c)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(c)||a(h)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),Oe(R,1,`w-2 h-2 rounded-full ${a(c)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),Oe(b,1,`font-bold text-sm ${a(c)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),i(_,a(v).name),i(N,` ${D??""} ${a(v).level??""} • ${a(v).ancestry??""}`),Oe(K,1,`p-1.5 rounded-lg transition-all ${a(h)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),qe(K,"title",J),qe(V,"title",ue)},[()=>u()("common.labels.level"),()=>a(h)?u()("session.players.remove_from_session"):u()("session.players.add_to_session"),()=>u()("session.players.kick_from_campaign")]),d(o,B)});var At=r(dt,2);{var Ct=o=>{var v=cs(),c=t(v,!0);e(v),g(h=>i(c,h),[()=>u()("session.players.none")]),d(o,v)};S(At,o=>{a(ge).length===0&&o(Ct)})}e(Te),e(Xe);var gt=r(Xe,2),xt=t(gt);{var jt=o=>{var v=us(),c=$e(v);c.__click=()=>W({isPublished:!0});var h=t(c);gr(h,{size:14});var B=r(h);e(c);var R=r(c,2),p=t(R,!0);e(R),g((b,_)=>{i(B,` ${b??""}`),i(p,_)},[()=>u()("session.publish.publish_session"),()=>u()("session.publish.make_visible")]),d(o,v)},Dt=o=>{var v=ms(),c=$e(v),h=t(c),B=t(h),R=t(B);Pa(R,{size:10,class:"animate-pulse"});var p=r(R);e(B),e(h);var b=r(h,2);b.__click=()=>I(Y,!a(Y));var _=t(b);Or(_,{size:14}),e(b),e(c);var f=r(c,2);{var U=J=>{var ue=bs(),_e=t(ue);e(ue),g((Ue,rt)=>{qe(_e,"src",Ue),qe(_e,"alt",rt)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(ee))}`,()=>u()("session.publish.qr_alt")]),d(J,ue)};S(f,J=>{a(Y)&&J(U)})}var A=r(f,2),N=t(A),O=t(N);O.__click=se;var K=t(O,!0);e(O);var T=r(O,2);T.__click=se;var M=t(T);{var y=J=>{var ue=xs(),_e=t(ue);Ia(_e,{size:10,class:"inline mr-1"});var Ue=r(_e);e(ue),g(rt=>i(Ue,` ${rt??""}`),[()=>u()("common.buttons.copied")]),d(J,ue)};S(M,J=>{a(re)&&J(y)})}var V=r(M,2);Cr(V,{size:14}),e(T),e(N),e(A);var P=r(A,2);P.__click=()=>W({isPublished:!1});var D=t(P,!0);e(P),g((J,ue,_e,Ue)=>{i(p,` ${J??""}`),qe(b,"title",ue),i(K,a(ee)),qe(T,"aria-label",_e),i(D,Ue)},[()=>u()("session.publish.public_session"),()=>u()("session.publish.qr_code"),()=>u()("session.publish.copy_link"),()=>u()("session.publish.remove_public")]),d(o,v)};S(xt,o=>{s.campaign?.isPublished?o(Dt,!1):o(jt)})}e(gt),e(me);var ht=r(me,2),yt=t(ht),Re=t(yt);Re.__click=()=>I(fe,"enemies");var vt=t(Re);fa(vt,{size:14});var Ve=r(vt);e(Re);var at=r(Re,2);at.__click=()=>I(fe,"encounters");var ct=t(at);Fa(ct,{size:14});var wt=r(ct);e(at),e(yt);var mt=r(yt,2),ft=t(mt);{var Ht=o=>{var v=ps(),c=$e(v);He(c,1,k,R=>R.id,(R,p)=>{var b=_s(),_=t(b),f=t(_);Mr(f,{size:12,class:"text-slate-600 cursor-grab"});var U=r(f,2),A=t(U),N=t(A,!0);e(A);var O=r(A,2),K=t(O);e(O),e(U),e(_);var T=r(_,2);T.__click=()=>tt(a(p));var M=t(T);Kt(M,{size:16}),e(T),e(b),g(y=>{i(N,a(p).name),i(K,`${y??""} ${a(p).difficulty??""}`)},[()=>u()("session.enemies.difficulty")]),d(R,b)});var h=r(c,2);{var B=R=>{var p=fs(),b=t(p,!0);e(p),g(_=>i(b,_),[()=>u()("session.enemies.none")]),d(R,p)};S(h,R=>{k().length===0&&R(B)})}d(o,v)},Ft=o=>{var v=ys(),c=$e(v);He(c,1,F,R=>R.id,(R,p)=>{var b=gs(),_=t(b),f=t(_),U=t(f,!0);e(f);var A=r(f,2),N=t(A);e(A),e(_);var O=r(_,2);O.__click=()=>Me(a(p));var K=t(O);qa(K,{size:14}),e(O),e(b),g((T,M)=>{i(U,a(p).name),i(N,`${T??""} ${M??""}`)},[()=>a(p).enemies?.reduce((T,M)=>T+M.count,0)||0,()=>u()("session.enemies.title")]),d(R,b)});var h=r(c,2);{var B=R=>{var p=hs(),b=t(p,!0);e(p),g(_=>i(b,_),[()=>u()("session.enemies.no_encounters")]),d(R,p)};S(h,R=>{F().length===0&&R(B)})}d(o,v)};S(ft,o=>{a(fe)==="enemies"?o(Ht):o(Ft,!1)})}e(mt),e(ht),e(q);var Lt=r(q,2),Jt=t(Lt),Gt=t(Jt),oa=t(Gt);{var ra=o=>{var v=ws();v.__click=Fe;var c=t(v);Wa(c,{size:20});var h=r(c);e(v),g(B=>i(h,` ${B??""}`),[()=>u()("session.combat.start")]),d(o,v)},Zt=o=>{var v=ks(),c=t(v);c.__click=ae;var h=t(c);Da(h,{size:20}),e(c);var B=r(c,2),R=t(B),p=t(R,!0);e(R);var b=r(R),_=t(b,!0);e(b),e(B);var f=r(B,2);f.__click=nt;var U=t(f);Ir(U,{size:16});var A=r(U);e(f);var N=r(f,4);N.__click=()=>lt();var O=t(N,!0);e(N),e(v),g((K,T,M,y,V)=>{qe(c,"title",K),i(p,T),i(_,a(Ye).round),qe(f,"title",M),i(A,` ${y??""}`),i(O,V)},[()=>u()("session.combat.previous"),()=>u()("session.combat.round"),()=>u()("session.combat.next"),()=>u()("session.combat.next"),()=>u()("session.combat.end")]),d(o,v)};S(oa,o=>{a(Ye).active?o(Zt,!1):o(ra)})}e(Gt),e(Jt);var sa=r(Jt,2),la=t(sa);He(la,25,()=>a(pe),o=>o.type==="player"?o.id:o.instanceId,(o,v)=>{var c=$s(),h=t(c);as(h,{get entity(){return a(v)},updateEnemy:Q,removeFromCombat:it,updatePlayer:je}),e(c),ir(c,()=>rs,()=>({duration:300})),d(o,c)});var m=r(la,2);{var w=o=>{var v=zs(),c=t(v,!0);e(v),g(h=>i(c,h),[()=>u()("session.combat.empty")]),d(o,v)};S(m,o=>{a(pe).length===0&&o(w)})}e(sa),e(Lt),Wt(2),e(Se);var oe=r(Se,2);{var de=o=>{var v=Es();v.__click=y=>{y.target===y.currentTarget&&I(Z,!1)};var c=t(v),h=t(c),B=t(h),R=t(B);lr(R,{size:24}),e(B);var p=r(B,2),b=t(p),_=t(b,!0);e(b);var f=r(b,2),U=t(f,!0);e(f),e(p),e(h);var A=r(h,2);He(A,21,()=>a(ve),ot,(y,V)=>{var P=js(),D=t(P),J=t(D);fa(J,{size:14,class:"text-slate-500"});var ue=r(J);e(D);var _e=r(D,2);He(_e,21,()=>a(V).effects,ot,(Ue,rt)=>{var kt=Cs(),ut=t(kt),bt=t(ut);e(ut);var zt=r(ut,2),Ut=t(zt,!0);e(zt),e(kt),g(()=>{i(bt,`${a(rt).name??""}:`),i(Ut,a(rt).desc)}),d(Ue,kt)}),e(_e),e(P),g(()=>i(ue,` ${a(V).name??""}`)),d(y,P)}),e(A);var N=r(A,2),O=t(N);O.__click=()=>I(Z,!1);var K=t(O,!0);e(O);var T=r(O,2);T.__click=Ze;var M=t(T,!0);e(T),e(N),e(c),e(v),g((y,V,P,D)=>{i(_,y),i(U,V),i(K,P),i(M,D)},[()=>u()("session.end_of_round.title"),()=>u()("session.end_of_round.summary"),()=>u()("common.buttons.cancel"),()=>u()("session.end_of_round.advance")]),d(o,v)};S(oe,o=>{a(Z)&&o(de)})}var Ae=r(oe,2);{var _t=o=>{var v=Is();v.__click=T=>{T.target===T.currentTarget&&I(H,!1)};var c=t(v),h=t(c),B=t(h),R=t(B),p=t(R,!0);e(R);var b=r(R,2),_=t(b,!0);e(b),e(B);var f=r(B,2);f.__click=()=>I(H,!1);var U=t(f);va(U,{size:16}),e(f),e(h);var A=r(h,2),N=t(A);He(N,17,()=>a(X),ot,(T,M)=>{var y=Ms();y.__click=()=>he(a(M).id);var V=t(y),P=t(V,!0);e(V);var D=r(V,2),J=t(D),ue=t(J,!0);e(J);var _e=r(J,2),Ue=t(_e);e(_e),e(D);var rt=r(D,2),kt=t(rt);Kt(kt,{size:16}),e(rt),e(y),g((ut,bt)=>{i(P,ut),i(ue,a(M).name),i(Ue,`${bt??""} ${a(M).level??""} • ${a(M).ancestry??""}`)},[()=>a(M).name.charAt(0),()=>u()("common.labels.level")]),d(T,y)});var O=r(N,2);{var K=T=>{var M=Os(),y=t(M),V=t(y);fa(V,{size:24}),e(y);var P=r(y,2),D=t(P,!0);e(P);var J=r(P,2),ue=t(J,!0);e(J),e(M),g((_e,Ue)=>{i(D,_e),i(ue,Ue)},[()=>u()("session.manage_session.no_available"),()=>u()("session.manage_session.all_in_session")]),d(T,M)};S(O,T=>{a(X).length===0&&T(K)})}e(A),e(c),e(v),g((T,M)=>{i(p,T),i(_,M)},[()=>u()("session.manage_session.title"),()=>u()("session.manage_session.description")]),d(o,v)};S(Ae,o=>{a(H)&&o(_t)})}var Bt=r(Ae,2);Aa(Bt,{get isOpen(){return $()},onClose:()=>na.set(!1)});var Vt=r(Bt,2);Na(Vt,{get isOpen(){return a(L).isOpen},get title(){return a(L).title},get message(){return a(L).message},get onConfirm(){return a(L).onConfirm},onCancel:()=>a(L).isOpen=!1}),g((o,v,c,h)=>{i(We,` ${o??""} `),i(ce,v),Oe(Re,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(fe)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(Ve,` ${c??""}`),Oe(at,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(fe)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),i(wt,` ${h??""}`)},[()=>u()("session.players.title"),()=>a(H)?u()("session.players.close"):u()("session.players.add"),()=>u()("session.enemies.title"),()=>u()("session.enemies.encounters")]),d(j,we),ea(),E()}ta(["click"]);var Rs=x('<div class="space-y-4"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-size" type="number" step="0.5" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="grid grid-cols-1"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div></div>'),Ps=x('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Ts=x('<div class="space-y-6"><div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),As=x('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none" placeholder="Nome"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2" placeholder="Descrição..."></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Ds=x('<div class="text-xs text-slate-600 italic text-center py-4 border-2 border-dashed border-slate-800 rounded"> </div>'),Hs=x('<div><div class="flex justify-between items-center mb-3"><h4> </h4> <button class="text-xs bg-slate-800 px-2 py-1 rounded hover:bg-slate-700 text-white flex items-center gap-1 border border-slate-700"><!> </button></div> <div class="space-y-3"><!> <!></div></div>'),Ls=x('<div class="space-y-6"></div>'),Us=x('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),qs=x('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),Fs=x('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Bs=x('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Vs=x('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Ws=x('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Gs=x('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Qs=x('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Js=x('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Zs=x('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Xs=x('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Ks=x('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Ys=x('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),ei=x('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-6xl h-[90vh] border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><h3 id="modal-title" class="font-bold text-white text-lg"> </h3> <button class="lg:hidden text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50"><button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3"><button class="px-6 py-2 rounded bg-slate-800 hover:bg-slate-700 text-white font-bold transition-colors"> </button> <button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function ti(j,s){Yt(s,!0);const n=()=>st(qt,"$t",u),[u,k]=aa();let F=Tt(s,"isOpen",3,!1),$=Tt(s,"initialData",3,"{}"),l=De(Xt(Z())),E=De("stats"),H=De(!1),re=De(""),Y=De(void 0);function Ie(te){const ie=te.target.files;if(ie&&ie.length>0){const xe=ie[0],ge=new FileReader;ge.onload=()=>{I(re,ge.result,!0),I(H,!0)},ge.readAsDataURL(xe)}te.target&&(te.target.value="")}async function fe(te){try{const ie=await vr(te);a(l).imageUrl=ie,I(H,!1)}catch(ie){console.error(ie),alert(ie.message||"Erro ao salvar imagem")}}function Z(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}$a(()=>{if(F()&&$())try{const te=JSON.parse($());Object.keys(te).length===0?I(l,Z(),!0):I(l,{...Z(),...te},!0)}catch{I(l,Z(),!0)}});function ve(te){a(l)[te]=[...a(l)[te],{name:"",desc:""}]}function L(te,ie){a(l)[te]=a(l)[te].filter((xe,ge)=>ge!==ie)}function ee(te){}var se=Ke(),Ne=$e(se);{var Ye=te=>{var ie=ei(),xe=$e(ie);xe.__click=ee;var ge=t(xe),Le=t(ge),X=t(Le),W=t(X),he=t(W,!0);e(W);var ze=r(W,2);ze.__click=function(...b){s.onClose?.apply(this,b)};var Pe=t(ze);va(Pe,{size:20}),e(ze),e(X);var ye=r(X,2),tt=t(ye);tt.__click=()=>I(E,"stats");var Me=t(tt,!0);e(tt);var Fe=r(tt,2);Fe.__click=()=>I(E,"attributes");var nt=t(Fe,!0);e(Fe);var Ze=r(Fe,2);Ze.__click=()=>I(E,"abilities");var lt=t(Ze,!0);e(Ze),e(ye);var it=r(ye,2),Q=t(it);{var ae=b=>{var _=Rs(),f=t(_),U=t(f);U.__click=()=>a(Y)?.click();var A=t(U),N=t(A);La(N,()=>a(l).imageUrl,et=>{ka(et,{get hash(){return a(l).imageUrl},get alt(){return a(l).name},size:"custom",fallbackText:"?"})}),e(A);var O=r(A,2),K=t(O);cr(K,{size:20,class:"text-white"}),e(O),e(U);var T=r(U,2),M=t(T),y=t(M,!0);e(M);var V=r(M,2);Mt(V),e(T),e(f);var P=r(f,2),D=t(P),J=t(D),ue=t(J,!0);e(J);var _e=r(J);Mt(_e),e(D);var Ue=r(D,2),rt=t(Ue),kt=t(rt,!0);e(rt);var ut=r(rt);Mt(ut),e(Ue),e(P);var bt=r(P,2),zt=t(bt),Ut=t(zt,!0);e(zt);var Qe=r(zt,2);Ca(Qe),e(bt);var Je=r(bt,2),Rt=t(Je),pt=t(Rt),Qt=t(pt,!0);e(pt);var Et=r(pt);Mt(Et),e(Rt),e(Je),e(_),g((et,ia,ua,ba,Ga,Qa)=>{i(y,et),i(ue,ia),i(kt,ua),i(Ut,ba),qe(Qe,"placeholder",Ga),i(Qt,Qa)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.speed")]),Pt(V,()=>a(l).name,et=>a(l).name=et),Pt(_e,()=>a(l).difficulty,et=>a(l).difficulty=et),Pt(ut,()=>a(l).size,et=>a(l).size=et),Pt(Qe,()=>a(l).description,et=>a(l).description=et),Pt(Et,()=>a(l).speed,et=>a(l).speed=et),d(b,_)},G=b=>{var _=Ke(),f=$e(_);{var U=N=>{var O=Ts(),K=t(O),T=t(K),M=t(T,!0);e(T);var y=r(T,2);He(y,20,()=>["str","agi","int","wil"],ot,(Qe,Je)=>{var Rt=Ps(),pt=t(Rt),Qt=t(pt,!0);e(pt);var Et=r(pt,2);Mt(Et);var et=r(Et,2),ia=t(et);e(et),e(Rt),g(()=>{qe(pt,"for",`attr-${Je??""}`),i(Qt,Je),qe(Et,"id",`attr-${Je??""}`),Oe(et,1,`text-xs font-bold ${a(l).stats[Je]-10>=0?"text-green-500":"text-red-500"}`),i(ia,`${a(l).stats[Je]-10>=0?"+":""}${a(l).stats[Je]-10}`)}),Pt(Et,()=>a(l).stats[Je],ua=>a(l).stats[Je]=ua),d(Qe,Rt)}),e(y),e(K);var V=r(K,2),P=t(V),D=t(P),J=t(D,!0);e(D);var ue=r(D);Mt(ue),e(P);var _e=r(P,2),Ue=t(_e),rt=t(Ue,!0);e(Ue);var kt=r(Ue);Mt(kt),e(_e);var ut=r(_e,2),bt=t(ut),zt=t(bt,!0);e(bt);var Ut=r(bt);Mt(Ut),e(ut),e(V),e(O),g((Qe,Je,Rt,pt,Qt,Et,et)=>{i(M,Qe),i(J,Je),qe(ue,"placeholder",Rt),i(rt,pt),qe(kt,"placeholder",Qt),i(zt,Et),qe(Ut,"placeholder",et)},[()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder"),()=>n()("session.enemy_modal.languages"),()=>n()("session.enemy_modal.languages_placeholder"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder")]),Pt(ue,()=>a(l).senses,Qe=>a(l).senses=Qe),Pt(kt,()=>a(l).languages,Qe=>a(l).languages=Qe),Pt(Ut,()=>a(l).immune,Qe=>a(l).immune=Qe),d(N,O)},A=N=>{var O=Ke(),K=$e(O);{var T=M=>{var y=Ls();He(y,20,()=>[{key:"traits",title:"Traços (Traits)",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",title:"Ações",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",title:"Reações",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",title:"Fim da Rodada",color:"text-yellow-400",border:"border-yellow-500/30"}],ot,(V,P)=>{var D=Hs(),J=t(D),ue=t(J),_e=t(ue,!0);e(ue);var Ue=r(ue,2);Ue.__click=()=>ve(P.key);var rt=t(Ue);Kt(rt,{size:12});var kt=r(rt);e(Ue),e(J);var ut=r(J,2),bt=t(ut);He(bt,17,()=>a(l)[P.key],ot,(Qe,Je,Rt)=>{var pt=As(),Qt=t(pt),Et=t(Qt);Mt(Et);var et=r(Et,2);Ca(et),e(Qt);var ia=r(Qt,2);ia.__click=()=>L(P.key,Rt);var ua=t(ia);ca(ua,{size:16}),e(ia),e(pt),Pt(Et,()=>a(Je).name,ba=>a(Je).name=ba),Pt(et,()=>a(Je).desc,ba=>a(Je).desc=ba),d(Qe,pt)});var zt=r(bt,2);{var Ut=Qe=>{var Je=Ds(),Rt=t(Je,!0);e(Je),g(pt=>i(Rt,pt),[()=>n()("session.enemy_modal.empty")]),d(Qe,Je)};S(zt,Qe=>{a(l)[P.key].length===0&&Qe(Ut)})}e(ut),e(D),g(Qe=>{Oe(D,1,`p-4 bg-slate-900 rounded border ${P.border??""}`),Oe(ue,1,`font-bold text-sm uppercase ${P.color??""}`),i(_e,P.title),i(kt,` ${Qe??""}`)},[()=>n()("session.enemy_modal.add")]),d(V,D)}),e(y),d(M,y)};S(K,M=>{a(E)==="abilities"&&M(T)},!0)}d(N,O)};S(f,N=>{a(E)==="attributes"?N(U):N(A,!1)},!0)}d(b,_)};S(Q,b=>{a(E)==="stats"?b(ae):b(G,!1)})}e(it);var pe=r(it,2),Ce=t(pe);Ce.__click=function(...b){s.onClose?.apply(this,b)};var je=t(Ce,!0);e(Ce);var we=r(Ce,2);we.__click=()=>s.onSave(a(l));var Se=t(we);Va(Se,{size:18});var q=r(Se);e(we),e(pe),e(Le);var me=r(Le,2),le=t(me),ne=t(le),ke=t(ne);jr(ke,{size:14});var We=r(ke);e(ne),e(le);var Be=r(le,2),C=t(Be),z=t(C),ce=t(z);e(z);var Ee=r(z,2),Ge=t(Ee);{var Xe=b=>{var _=Us(),f=t(_);ka(f,{get hash(){return a(l).imageUrl},get alt(){return a(l).name},size:"custom"}),e(_),d(b,_)};S(Ge,b=>{a(l).imageUrl&&b(Xe)})}var Te=r(Ge,2),dt=t(Te),At=t(dt,!0);e(dt),Wt(2),e(Te),e(Ee);var Ct=r(Ee,2),gt=t(Ct),xt=t(gt),jt=t(xt,!0);e(xt);var Dt=r(xt,2),ht=t(Dt,!0);e(Dt),e(gt);var yt=r(gt,2),Re=t(yt),vt=t(Re,!0);e(Re);var Ve=r(Re,2),at=t(Ve,!0);e(Ve),e(yt);var ct=r(yt,2),wt=t(ct),mt=t(wt,!0);e(wt);var ft=r(wt,2),Ht=t(ft,!0);e(ft),e(ct);var Ft=r(ct,2),Lt=t(Ft),Jt=t(Lt,!0);e(Lt);var Gt=r(Lt,2),oa=t(Gt,!0);e(Gt),e(Ft),e(Ct);var ra=r(Ct,2);He(ra,20,()=>["str","agi","int","wil"],ot,(b,_)=>{var f=qs(),U=t(f),A=t(U,!0);e(U);var N=r(U,2),O=t(N),K=r(O),T=t(K);e(K),e(N),e(f),g(()=>{i(A,_),i(O,`${a(l).stats[_]??""} `),Oe(K,1,`text-xs ${a(l).stats[_]-10>=0?"text-green-500":"text-red-500"}`),i(T,`(${a(l).stats[_]-10>=0?"+":""}${a(l).stats[_]-10})`)}),d(b,f)}),e(ra);var Zt=r(ra,2),sa=t(Zt);{var la=b=>{var _=Fs(),f=t(_),U=t(f);e(f);var A=r(f,2),N=t(A,!0);e(A),e(_),g(O=>{i(U,`${O??""}:`),i(N,a(l).senses)},[()=>n()("session.enemy_modal.senses")]),d(b,_)};S(sa,b=>{a(l).senses&&b(la)})}var m=r(sa,2);{var w=b=>{var _=Bs(),f=t(_),U=t(f);e(f);var A=r(f,2),N=t(A,!0);e(A),e(_),g(O=>{i(U,`${O??""}:`),i(N,a(l).languages)},[()=>n()("session.enemy_modal.languages")]),d(b,_)};S(m,b=>{a(l).languages&&b(w)})}var oe=r(m,2);{var de=b=>{var _=Vs(),f=t(_),U=t(f);e(f);var A=r(f,2),N=t(A,!0);e(A),e(_),g(O=>{i(U,`${O??""}:`),i(N,a(l).immune)},[()=>n()("session.enemy_modal.immunities")]),d(b,_)};S(oe,b=>{a(l).immune&&b(de)})}e(Zt);var Ae=r(Zt,2),_t=t(Ae);{var Bt=b=>{var _=Gs(),f=t(_),U=t(f,!0);e(f);var A=r(f,2);He(A,17,()=>a(l).traits,ot,(N,O,K,T)=>{var M=Ws(),y=t(M),V=t(y);e(y);var P=r(y,2),D=t(P,!0);e(P),e(M),g(()=>{i(V,`${a(O).name??""}:`),i(D,a(O).desc)}),d(N,M)}),e(_),g(N=>i(U,N),[()=>n()("session.enemy_modal.traits")]),d(b,_)};S(_t,b=>{a(l).traits.length>0&&b(Bt)})}var Vt=r(_t,2);{var o=b=>{var _=Js(),f=t(_),U=t(f,!0);e(f);var A=r(f,2);He(A,17,()=>a(l).actions,ot,(N,O,K,T)=>{var M=Qs(),y=t(M),V=t(y);e(y);var P=r(y,2),D=t(P,!0);e(P),e(M),g(()=>{i(V,`${a(O).name??""}:`),i(D,a(O).desc)}),d(N,M)}),e(_),g(N=>i(U,N),[()=>n()("session.enemy_modal.actions")]),d(b,_)};S(Vt,b=>{a(l).actions.length>0&&b(o)})}var v=r(Vt,2);{var c=b=>{var _=Xs(),f=t(_),U=t(f,!0);e(f);var A=r(f,2);He(A,17,()=>a(l).reactions,ot,(N,O,K,T)=>{var M=Zs(),y=t(M),V=t(y);e(y);var P=r(y,2),D=t(P,!0);e(P),e(M),g(()=>{i(V,`${a(O).name??""}:`),i(D,a(O).desc)}),d(N,M)}),e(_),g(N=>i(U,N),[()=>n()("session.enemy_modal.reactions")]),d(b,_)};S(v,b=>{a(l).reactions.length>0&&b(c)})}var h=r(v,2);{var B=b=>{var _=Ys(),f=t(_),U=t(f,!0);e(f);var A=r(f,2);He(A,17,()=>a(l).endOfRound,ot,(N,O,K,T)=>{var M=Ks(),y=t(M),V=t(y);e(y);var P=r(y,2),D=t(P,!0);e(P),e(M),g(()=>{i(V,`${a(O).name??""}:`),i(D,a(O).desc)}),d(N,M)}),e(_),g(N=>i(U,N),[()=>n()("session.enemy_modal.end_of_round")]),d(b,_)};S(h,b=>{a(l).endOfRound.length>0&&b(B)})}e(Ae),e(C),e(Be),e(me),e(ge),e(xe);var R=r(xe,2);R.__change=Ie,yr(R,b=>I(Y,b),()=>a(Y));var p=r(R,2);dr(p,{get isOpen(){return a(H)},get imageUrl(){return a(re)},onClose:()=>I(H,!1),onCrop:fe}),g((b,_,f,U,A,N,O,K,T,M,y,V,P,D)=>{qe(xe,"aria-label",b),i(he,_),Oe(tt,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(E)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(Me,f),Oe(Fe,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(E)==="attributes"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(nt,U),Oe(Ze,1,`flex-1 py-3 text-sm font-bold border-b-2 transition-colors ${a(E)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),i(lt,A),i(je,N),i(q,` ${O??""}`),i(We,` ${K??""}`),i(ce,`${T??""} ${a(l).difficulty??""}`),i(At,M),i(jt,y),i(ht,a(l).defense),i(vt,V),i(at,a(l).health),i(mt,P),i(Ht,a(l).size),i(Jt,D),i(oa,a(l).speed)},[()=>n()("session.enemy_modal.close"),()=>n()("session.enemy_modal.title"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_attributes"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("common.buttons.cancel"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview"),()=>n()("session.enemy_modal.difficulty"),()=>a(l).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed")]),d(te,ie)};S(Ne,te=>{F()&&te(Ye)})}d(j,se),ea(),k()}ta(["click","change"]);var ai=x('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),ri=x('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),si=x('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),ii=x('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function ni(j,s){Yt(s,!0);const n=()=>st(qt,"$t",k),u=()=>st(za,"$liveEnemies",k),[k,F]=aa();let $=Tt(s,"isOpen",3,!1),l=Tt(s,"initialData",3,"{}"),E=De(Xt({name:"",enemies:[]}));$a(()=>{if($()&&l())try{const L=JSON.parse(l());I(E,{name:L.name||"",enemies:L.enemies||[]},!0)}catch{I(E,{name:"",enemies:[]},!0)}});function H(L){a(E).enemies.find(se=>se.enemyId===L)?a(E).enemies=a(E).enemies.map(se=>se.enemyId===L?{...se,count:se.count+1}:se):a(E).enemies=[...a(E).enemies,{enemyId:L,count:1}]}function re(L){a(E).enemies=a(E).enemies.filter((ee,se)=>se!==L)}function Y(L,ee){const se=Math.max(1,parseInt(ee)||1);a(E).enemies[L].count=se}function Ie(L){}var fe=Ke(),Z=$e(fe);{var ve=L=>{var ee=ii();ee.__click=Ie;var se=t(ee),Ne=t(se),Ye=t(Ne),te=t(Ye,!0);e(Ye);var ie=r(Ye,2);ie.__click=function(...q){s.onClose?.apply(this,q)};var xe=t(ie);va(xe,{size:20}),e(ie),e(Ne);var ge=r(Ne,2),Le=t(ge),X=t(Le),W=t(X,!0);e(X);var he=r(X,2);Mt(he),e(Le),e(ge);var ze=r(ge,2),Pe=t(ze),ye=t(Pe),tt=t(ye,!0);e(ye);var Me=r(ye,2),Fe=t(Me);He(Fe,17,()=>a(E).enemies,ot,(q,me,le)=>{const ne=be(()=>u().find(dt=>dt.id===a(me).enemyId));var ke=ai(),We=t(ke),Be=t(We),C=t(Be,!0);e(Be);var z=r(Be,2),ce=t(z);e(z),e(We);var Ee=r(We,2),Ge=t(Ee);Mt(Ge),Ge.__input=dt=>Y(le,dt.target.value);var Xe=r(Ge,2);Xe.__click=()=>re(le);var Te=t(Xe);ca(Te,{size:16}),e(Xe),e(Ee),e(ke),g(dt=>{i(C,dt),i(ce,`Dif ${(a(ne)?a(ne).difficulty:"?")??""}`),ya(Ge,a(me).count)},[()=>a(ne)?a(ne).name:n()("session.encounter_modal.unknown")]),d(q,ke)});var nt=r(Fe,2);{var Ze=q=>{var me=ri(),le=t(me,!0);e(me),g(ne=>i(le,ne),[()=>n()("session.encounter_modal.none_added")]),d(q,me)};S(nt,q=>{a(E).enemies.length===0&&q(Ze)})}e(Me),e(Pe);var lt=r(Pe,2),it=t(lt),Q=t(it,!0);e(it);var ae=r(it,2);He(ae,5,u,q=>q.id,(q,me)=>{var le=si(),ne=t(le),ke=t(ne),We=t(ke,!0);e(ke);var Be=r(ke,2),C=t(Be);e(Be),e(ne);var z=r(ne,2);z.__click=()=>H(a(me).id);var ce=t(z);Kt(ce,{size:16}),e(z),e(le),g(()=>{i(We,a(me).name),i(C,`Dif ${a(me).difficulty??""}`)}),d(q,le)}),e(ae),e(lt),e(ze);var G=r(ze,2),pe=t(G);pe.__click=function(...q){s.onClose?.apply(this,q)};var Ce=t(pe,!0);e(pe);var je=r(pe,2);je.__click=()=>s.onSave(a(E));var we=t(je);Va(we,{size:18});var Se=r(we);e(je),e(G),e(se),e(ee),g((q,me,le,ne,ke,We,Be,C)=>{qe(ee,"aria-label",q),i(te,me),i(W,le),qe(he,"placeholder",ne),i(tt,ke),i(Q,We),i(Ce,Be),i(Se,` ${C??""}`)},[()=>n()("session.encounter_modal.close"),()=>n()("session.encounter_modal.title"),()=>n()("session.encounter_modal.name"),()=>n()("session.encounter_modal.name_placeholder"),()=>n()("session.encounter_modal.enemies_in_encounter"),()=>n()("session.encounter_modal.add_enemies"),()=>n()("common.buttons.cancel"),()=>n()("session.encounter_modal.save_encounter")]),Pt(he,()=>a(E).name,q=>a(E).name=q),d(L,ee)};S(Z,L=>{$()&&L(ve)})}d(j,fe),ea(),F()}ta(["click","input"]);var oi=x('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),li=x('<div class="text-[10px] text-slate-600 italic"> </div>'),di=x('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="font-bold text-white text-base mb-2 group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),vi=x('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),ci=x('<div class="mb-4 flex-1"><p> </p> <!></div>'),ui=x('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),bi=x('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),xi=x('<div class="text-center text-slate-500 italic col-span-3"> </div>'),mi=x('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function _i(j,s){Yt(s,!0);const n=()=>st(za,"$liveEnemies",F),u=()=>st(Sa,"$liveEncounters",F),k=()=>st(qt,"$t",F),[F,$]=aa();let l=De(!1),E=De(null),H=De("{}"),re=De(!1),Y=De(null),Ie=De("{}"),fe=De(Xt({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function Z(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function ve(C=null){I(E,C?C.id:null,!0),I(H,JSON.stringify(C||Z()),!0),I(l,!0)}let L=Xt(new Set);function ee(C){L.has(C)?L.delete(C):L.add(C)}function se(C){const z=a(E)||xa();Oa.set(z,{...C,id:z}),I(l,!1)}function Ne(C){const z=n().find(ce=>ce.id===C);I(fe,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${z?.name||"este inimigo"}"?`,onConfirm:()=>{Oa.delete(C),a(fe).isOpen=!1}},!0)}function Ye(C=null){I(Y,C?C.id:null,!0),I(Ie,JSON.stringify(C||{name:"",enemies:[]}),!0),I(re,!0)}function te(C){const z=a(Y)||xa();ga.set(z,{...C,id:z}),I(re,!1)}function ie(C){const z=u().find(ce=>ce.id===C);I(fe,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${z?.name||"este encontro"}"?`,onConfirm:()=>{ga.delete(C),a(fe).isOpen=!1}},!0)}function xe(C){const z=$t.get(s.campId);if(!z)return;const ce=z.activeEnemies||[];let Ee=[];C.enemies.forEach(Ge=>{const Xe=n().find(Te=>Te.id===Ge.enemyId);if(Xe)for(let Te=0;Te<Ge.count;Te++)Ee.push({...Xe,instanceId:xa(),damage:0,currentHealth:Xe.health,afflictions:[],acted:!1,initiative:!1})}),$t.set(s.campId,{...z,activeEnemies:[...ce,...Ee]})}function ge(C,z){C.dataTransfer.setData("text/plain",z.id),C.dataTransfer.effectAllowed="copy"}function Le(C){return C.preventDefault(),!1}function X(C,z){C.preventDefault();const ce=C.dataTransfer.getData("text/plain");if(!ce)return;const Ee=z.enemies||[],Ge=Ee.find(Te=>Te.enemyId===ce);let Xe;Ge?Xe=Ee.map(Te=>Te.enemyId===ce?{...Te,count:Te.count+1}:Te):Xe=[...Ee,{enemyId:ce,count:1}],ga.set(z.id,{...z,enemies:Xe})}var W=mi(),he=t(W),ze=t(he),Pe=t(ze),ye=t(Pe);Fa(ye,{size:16});var tt=r(ye);e(Pe),e(ze);var Me=r(ze,2),Fe=t(Me);Fe.__click=()=>Ye();var nt=t(Fe);Kt(nt,{size:28,class:"group-hover:scale-110 transition-transform"});var Ze=r(nt,2),lt=t(Ze,!0);e(Ze),e(Fe);var it=r(Fe,2);He(it,1,u,C=>C.id,(C,z)=>{var ce=di(),Ee=t(ce),Ge=t(Ee),Xe=t(Ge,!0);e(Ge);var Te=r(Ge,2),dt=t(Te);He(dt,17,()=>a(z).enemies||[],ot,(Ve,at)=>{const ct=be(()=>n().find(Lt=>Lt.id===a(at).enemyId));var wt=oi(),mt=t(wt),ft=t(mt);e(mt);var Ht=r(mt,2),Ft=t(Ht,!0);e(Ht),e(wt),g(()=>{i(ft,`${a(at).count??""}x`),i(Ft,a(ct)?a(ct).name:"...")}),d(Ve,wt)});var At=r(dt,2);{var Ct=Ve=>{var at=li(),ct=t(at,!0);e(at),g(wt=>i(ct,wt),[()=>k()("session.bestiary.empty_encounter")]),d(Ve,at)};S(At,Ve=>{a(z).enemies?.length||Ve(Ct)})}e(Te),e(Ee);var gt=r(Ee,2),xt=t(gt);xt.__click=()=>xe(a(z));var jt=t(xt);qa(jt,{size:12,fill:"currentColor"});var Dt=r(jt);e(xt);var ht=r(xt,2);ht.__click=()=>Ye(a(z));var yt=t(ht);fr(yt,{size:14}),e(ht);var Re=r(ht,2);Re.__click=()=>ie(a(z).id);var vt=t(Re);ca(vt,{size:14}),e(Re),e(gt),e(ce),g(Ve=>{qe(ce,"aria-label",`Encontro ${a(z).name??""}`),i(Xe,a(z).name),i(Dt,` ${Ve??""}`)},[()=>k()("session.bestiary.start")]),pa("dragover",ce,Le),pa("drop",ce,Ve=>X(Ve,a(z))),d(C,ce)}),e(Me),e(he);var Q=r(he,2),ae=t(Q),G=t(ae);fa(G,{size:16});var pe=r(G);e(ae),e(Q);var Ce=r(Q,2),je=t(Ce);je.__click=()=>ve();var we=t(je);Kt(we,{size:32,class:"group-hover:scale-110 transition-transform"});var Se=r(we,2),q=t(Se,!0);e(Se),e(je);var me=r(je,2);He(me,1,n,C=>C.id,(C,z)=>{var ce=bi(),Ee=t(ce),Ge=t(Ee),Xe=t(Ge,!0);e(Ge);var Te=r(Ge,2),dt=t(Te);e(Te),e(Ee);var At=r(Ee,2);{var Ct=Re=>{var vt=ci(),Ve=t(vt),at=t(Ve,!0);e(Ve);var ct=r(Ve,2);{var wt=mt=>{var ft=vi();ft.__click=()=>ee(a(z).id);var Ht=t(ft,!0);e(ft),g(Ft=>i(Ht,Ft),[()=>L.has(a(z).id)?k()("session.bestiary.see_less"):k()("session.bestiary.see_more")]),d(mt,ft)};S(ct,mt=>{a(z).description.length>120&&mt(wt)})}e(vt),g(mt=>{Oe(Ve,1,`text-xs text-slate-400 leading-relaxed ${mt??""}`),i(at,a(z).description)},[()=>L.has(a(z).id)?"":"line-clamp-3"]),d(Re,vt)},gt=Re=>{var vt=ui(),Ve=t(vt,!0);e(vt),g(at=>i(Ve,at),[()=>k()("session.bestiary.no_description")]),d(Re,vt)};S(At,Re=>{a(z).description?Re(Ct):Re(gt,!1)})}var xt=r(At,2),jt=t(xt);jt.__click=()=>ve(a(z));var Dt=t(jt,!0);e(jt);var ht=r(jt,2);ht.__click=()=>Ne(a(z).id);var yt=t(ht);ca(yt,{size:14}),e(ht),e(xt),e(ce),g((Re,vt)=>{i(Xe,a(z).name),i(dt,`${Re??""} ${a(z).difficulty??""}`),i(Dt,vt)},[()=>k()("session.bestiary.level"),()=>k()("common.buttons.edit")]),pa("dragstart",ce,Re=>ge(Re,a(z))),d(C,ce)});var le=r(me,2);{var ne=C=>{var z=xi(),ce=t(z,!0);e(z),g(Ee=>i(ce,Ee),[()=>k()("session.bestiary.no_enemies")]),d(C,z)};S(le,C=>{n().length===0&&C(ne)})}e(Ce);var ke=r(Ce,2);ti(ke,{get isOpen(){return a(l)},get initialData(){return a(H)},onClose:()=>I(l,!1),onSave:se});var We=r(ke,2);ni(We,{get isOpen(){return a(re)},get initialData(){return a(Ie)},onClose:()=>I(re,!1),onSave:te});var Be=r(We,2);Na(Be,{get isOpen(){return a(fe).isOpen},get title(){return a(fe).title},get message(){return a(fe).message},get onConfirm(){return a(fe).onConfirm},onCancel:()=>a(fe).isOpen=!1}),e(W),g((C,z,ce,Ee)=>{i(tt,` ${C??""}`),i(lt,z),i(pe,` ${ce??""}`),i(q,Ee)},[()=>k()("session.bestiary.encounters_title"),()=>k()("session.bestiary.new_encounter"),()=>k()("session.bestiary.title"),()=>k()("session.bestiary.new_enemy")]),d(j,W),ea(),$()}ta(["click"]);var fi=x('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),pi=x('<div class="flex items-center gap-1 text-emerald-400"><!> <span class="text-xs font-bold hidden sm:block"> </span></div> <!>',1),gi=x('<div class="flex items-center gap-1 text-slate-500"><!> <span class="text-xs hidden sm:block"> </span></div>'),hi=x('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),yi=x('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group" aria-label="Voltar para Dashboard" title="Voltar para Dashboard"><!> <!></button> <div class="flex flex-col"><h1 class="text-base sm:text-lg font-black text-white leading-tight truncate max-w-[140px] sm:max-w-none"> </h1> <span class="text-xs text-indigo-400 font-mono font-black uppercase tracking-wider"> </span></div></div> <div class="hidden md:flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block">Sessão</span></button> <button><!> <span class="hidden min-[400px]:block">Bestiário</span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 sm:p-2.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all" aria-label="Configurações da Campanha" title="Configurações"><!></button> <button class="p-2 sm:p-2.5 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative" aria-label="Toggle Histórico" title="Histórico"><!> <!></button></div></div></div></header>');function wi(j,s){Yt(s,!0);const n=()=>st(er,"$syncState",$),u=()=>st(qt,"$t",$),k=()=>st(na,"$isHistoryOpen",$),F=()=>st(tr,"$rollHistory",$),[$,l]=aa();let E=Tt(s,"campaignName",3,""),H=Tt(s,"gmName",3,"Mestre"),re=Tt(s,"activeSubTab",3,"session"),Y=Tt(s,"onTabChange",3,()=>{}),Ie=Tt(s,"onOpenSettings",3,()=>{});var fe=yi(),Z=t(fe),ve=t(Z),L=t(ve),ee=t(L);ee.__click=()=>wr(Ta("/"));var se=t(ee);Da(se,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var Ne=r(se,2);ur(Ne,{size:18,class:"hidden sm:block opacity-50"}),e(ee);var Ye=r(ee,2),te=t(Ye),ie=t(te,!0);e(te);var xe=r(te,2),ge=t(xe,!0);e(xe),e(Ye),e(L);var Le=r(L,2),X=t(Le);X.__click=()=>Y()("session");var W=t(X);{let G=be(()=>re()==="session"?"opacity-100":"opacity-50");Ha(W,{size:14,get class(){return a(G)}})}Wt(2),e(X);var he=r(X,2);he.__click=()=>Y()("bestiary");var ze=t(he);{let G=be(()=>re()==="bestiary"?"opacity-100":"opacity-50");Ba(ze,{size:14,get class(){return a(G)}})}Wt(2),e(he),e(Le);var Pe=r(Le,2),ye=t(Pe),tt=t(ye);{var Me=G=>{var pe=pi(),Ce=$e(pe),je=t(Ce);Pa(je,{size:16});var we=r(je,2),Se=t(we,!0);e(we),e(Ce);var q=r(Ce,2);{var me=le=>{var ne=fi(),ke=t(ne);Ra(ke,{size:14});var We=r(ke,2),Be=t(We,!0);e(We),e(ne),g(C=>{qe(ne,"title",C),i(Be,n().peers.length)},[()=>u()("common.status.peers",{count:n().peers.length})]),d(le,ne)};S(q,le=>{n().peers.length>0&&le(me)})}g((le,ne)=>{qe(Ce,"title",le),i(Se,ne)},[()=>u()("common.status.connected"),()=>u()("common.status.connected")]),d(G,pe)},Fe=G=>{var pe=gi(),Ce=t(pe);kr(Ce,{size:16});var je=r(Ce,2),we=t(je,!0);e(je),e(pe),g((Se,q)=>{qe(pe,"title",Se),i(we,q)},[()=>u()("common.status.offline"),()=>u()("common.status.offline")]),d(G,pe)};S(tt,G=>{n().isConnected?G(Me):G(Fe,!1)})}e(ye);var nt=r(ye,2);nt.__click=function(...G){Ie()?.apply(this,G)};var Ze=t(nt);pr(Ze,{size:20}),e(nt);var lt=r(nt,2);lt.__click=()=>na.update(G=>!G);var it=t(lt);br(it,{size:20});var Q=r(it,2);{var ae=G=>{var pe=hi();d(G,pe)};S(Q,G=>{F()&&F().length>0&&G(ae)})}e(lt),e(Pe),e(ve),e(Z),e(fe),g(()=>{i(ie,E()),i(ge,H()),Oe(X,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${re()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),qe(X,"aria-pressed",re()==="session"),Oe(he,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${re()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),qe(he,"aria-pressed",re()==="bestiary"),qe(lt,"aria-pressed",k())}),d(j,fe),ea(),l()}ta(["click"]);var ki=x('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),$i=x('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),zi=x('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),Ci=x('<div class="fixed bottom-24 left-1/2 -translate-x-1/2 md:left-auto md:right-8 md:translate-x-0 z-[60] flex flex-col items-center gap-2"><div class="bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center gap-2 shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 duration-200"><button class="bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-indigo-500/20"><span class="text-[10px] opacity-70">d20</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">2d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">3d6</span> <!></button> <div class="w-px h-8 bg-white/10 mx-1"></div> <button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button></div></div>  <div class="fixed inset-0 bg-black/40 z-[55]"></div>',1),ji=x('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!> <!> <div class="hidden md:block fixed bottom-8 right-8 z-[60]"><button class="w-16 h-16 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-[0_0_20px_rgba(79,70,229,0.4)] flex items-center justify-center transition-all active:scale-90 border-2 border-white/10 group" title="Rolagens Rápidas"><!></button></div> <nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-6 pt-2 pointer-events-none"><div class="max-w-md mx-auto relative h-16 pointer-events-auto"><div class="absolute inset-0 bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"></div></div> <div class="relative h-full flex items-center justify-around px-2"><button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Sessão</span></button> <div class="relative w-16 h-16 -mt-10 flex items-center justify-center"><div class="absolute inset-0 bg-indigo-600/20 rounded-full blur-xl animate-pulse"></div> <button class="relative w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(79,70,229,0.5)] border-4 border-slate-900 transition-all active:scale-90 hover:bg-indigo-500 z-10" aria-label="Rolar Dados"><!></button></div> <button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Bestiário</span></button></div></div></nav> <!></div>');function Ji(j,s){Yt(s,!0);const n=()=>st(Za,"$page",$),u=()=>st(sr,"$liveCampaigns",$),k=()=>st(qt,"$t",$),F=()=>st(na,"$isHistoryOpen",$),[$,l]=aa();let E=De("session"),H=De(!1),re=be(()=>n().params.id),Y=be(()=>u().find(Q=>Q.id===a(re))),Ie=be(()=>!!a(Y));function fe(Q){if(!a(re)||!a(Y))return;const ae={...a(Y),...Q};$t.set(a(re),ae),wa(a(re),{name:ae.name,gmName:ae.gmName}),I(H,!1)}let Z=De(!1),ve=De(Xt({isOpen:!1,sides:20,count:1,modifier:0}));function L(Q,ae=1){I(ve,{isOpen:!0,sides:Q,count:ae,modifier:0},!0)}function ee(Q){if(!a(Y))return;const ae=is(a(ve).sides,a(ve).count,Q);let G="";a(ve).count>1&&(G+=`Dados: [${ae.results.join(", ")}] `),ae.bonusRolls?.length>0&&(G+=`Bonus Rolls: [${ae.bonusRolls.join(", ")}] -> ${Math.abs(ae.modifierTotal)}`);const pe=a(Y).gmName||ha(qt)("common.labels.master");ar.addToHistory({source:"GM",charName:pe,name:`${a(ve).count}d${a(ve).sides} ${Q?Q>0?`+${Q}`:Q:""}`,description:G.trim()||null,total:ae.total,formula:ae.formula,crit:ae.crit}),na.set(!0),a(ve).isOpen=!1}var se=ji(),Ne=t(se);{var Ye=Q=>{var ae=ki(),G=$e(ae);wi(G,{get campaignName(){return a(Y).name},get gmName(){return a(Y).gmName},get activeSubTab(){return a(E)},onTabChange:q=>I(E,q,!0),onOpenSettings:()=>I(H,!0)});var pe=r(G,2);{let q=be(()=>JSON.stringify(a(Y)));hr(pe,{get isOpen(){return a(H)},get initialData(){return a(q)},onClose:()=>I(H,!1),onSave:fe})}var Ce=r(pe,2),je=t(Ce);{var we=q=>{Ss(q,{get campaign(){return a(Y)}})},Se=q=>{var me=Ke(),le=$e(me);{var ne=ke=>{_i(ke,{get campId(){return a(re)}})};S(le,ke=>{a(E)==="bestiary"&&ke(ne)},!0)}d(q,me)};S(je,q=>{a(E)==="session"?q(we):q(Se,!1)})}e(Ce),d(Q,ae)},te=Q=>{var ae=Ke(),G=$e(ae);{var pe=je=>{var we=$i(),Se=r(t(we),2),q=t(Se,!0);e(Se);var me=r(Se,2),le=t(me,!0);e(me);var ne=r(me,2);ne.__click=()=>window.history.back();var ke=r(t(ne));e(ne),e(we),g((We,Be,C)=>{i(q,We),i(le,Be),i(ke,` ${C??""}`)},[()=>k()("campaign.not_found.title"),()=>k()("campaign.not_found.message"),()=>k()("common.buttons.back")]),d(je,we)},Ce=je=>{var we=zi();d(je,we)};S(G,je=>{a(Ie)&&!a(Y)?je(pe):je(Ce,!1)},!0)}d(Q,ae)};S(Ne,Q=>{a(Ie)&&a(Y)?Q(Ye):Q(te,!1)})}var ie=r(Ne,2);Aa(ie,{get isOpen(){return F()},onClose:()=>na.set(!1)});var xe=r(ie,2);{var ge=Q=>{var ae=Ci(),G=$e(ae),pe=t(G),Ce=t(pe);Ce.__click=()=>{L(20),I(Z,!1)};var je=r(t(Ce),2);da(je,{size:16}),e(Ce);var we=r(Ce,2);we.__click=()=>{L(6),I(Z,!1)};var Se=r(t(we),2);da(Se,{size:16}),e(we);var q=r(we,2);q.__click=()=>{L(6,2),I(Z,!1)};var me=r(t(q),2);da(me,{size:16}),e(q);var le=r(q,2);le.__click=()=>{L(6,3),I(Z,!1)};var ne=r(t(le),2);da(ne,{size:16}),e(le);var ke=r(le,4);ke.__click=()=>I(Z,!1);var We=t(ke);va(We,{size:20}),e(ke),e(pe),e(G);var Be=r(G,2);Be.__click=()=>I(Z,!1),d(Q,ae)};S(xe,Q=>{a(Z)&&Q(ge)})}var Le=r(xe,2),X=t(Le);X.__click=()=>I(Z,!a(Z));var W=t(X);da(W,{size:32,class:"group-hover:rotate-12 transition-transform"}),e(X),e(Le);var he=r(Le,2),ze=t(he),Pe=r(t(ze),2),ye=t(Pe);ye.__click=()=>{I(E,"session"),I(Z,!1)};var tt=t(ye);{let Q=be(()=>a(E)==="session"?"animate-in zoom-in-75 duration-300":"");Ha(tt,{size:20,get class(){return a(Q)}})}Wt(2),e(ye);var Me=r(ye,2),Fe=r(t(Me),2);Fe.__click=()=>I(Z,!a(Z));var nt=t(Fe);{let Q=be(()=>a(Z)?"rotate-90":"rotate-0");da(nt,{size:28,get class(){return`text-white ${a(Q)??""} transition-transform duration-300`}})}e(Fe),e(Me);var Ze=r(Me,2);Ze.__click=()=>{I(E,"bestiary"),I(Z,!1)};var lt=t(Ze);{let Q=be(()=>a(E)==="bestiary"?"animate-in zoom-in-75 duration-300":"");Ba(lt,{size:20,get class(){return a(Q)}})}Wt(2),e(Ze),e(Pe),e(ze),e(he);var it=r(he,2);{let Q=be(()=>`${k()("session.quick.roll_title")} (${a(ve).count}d${a(ve).sides})`),ae=be(()=>a(ve).sides===20?k()("session.quick.boons_banes"):k()("session.quick.fixed_modifier"));xr(it,{get isOpen(){return a(ve).isOpen},get title(){return a(Q)},get label(){return a(ae)},onClose:()=>a(ve).isOpen=!1,onRoll:ee,initialModifier:0})}e(se),g(()=>{Oe(ye,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(E)==="session"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),Oe(Ze,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(E)==="bestiary"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`)}),d(j,se),ea(),l()}ta(["click"]);export{Ji as component};
