import"../chunks/DsnmJJEf.js";import{B as At,o as Je,k as d,p as ua,v as ba,j as c,q as t,x as a,u as s,z as pe,A as e,t as _,O as Ra,w as k,y as _t,n as va,a2 as ca,at as xa}from"../chunks/CeF9Pysg.js";import{d as _a,s as r,o as Ga,g as Ta,e as ha}from"../chunks/CG7HK1rV.js";import{l as ra,s as ia,i as h,p as Kt}from"../chunks/dZMd9PJ3.js";import{e as Ve,s as tt,i as Ct,$ as ta,r as bt,a as be,h as Ua,g as _s,j as ps}from"../chunks/BdIRB7Hx.js";import{a as pa,s as qt}from"../chunks/CIaeXpBv.js";import{p as xs}from"../chunks/CZTQvedf.js";import{d as Wa,m as Ma,j as ms,c as Qa,e as Qt,n as Pa,o as fs,q as ya,t as Ea,u as Oa,b as ot,v as Ya,f as Va,g as Aa,x as gs,y as hs,z as ys}from"../chunks/DOdbJzaW.js";import{C as Ka,D as wa,l as ws,b as Fa,c as es,a as ks}from"../chunks/BaxZDONH.js";import{b as zs,t as Sa,f as Ia}from"../chunks/xr51uyWC.js";import{U as ts,C as Za,W as as,r as ss}from"../chunks/DPDeLwY0.js";import{A as $s,a as Cs,b as ja,B as Os,T as js,E as qa,M as Es,G as ga,H as rs,C as Na,R as Ms,c as Ss,I as is,s as ns,d as os,S as ls,L as Is,e as ds,f as Rs,D as ka,g as Ns}from"../chunks/CzncZ1NF.js";import{k as Ba}from"../chunks/Kfm9o0Gg.js";import{M as Ds,X as ma,P as ea,a as Xa,c as As,T as sa,b as Ts}from"../chunks/BsLGdO_u.js";import{C as vs,G as da,P as Ha,S as Us,a as Ps}from"../chunks/BcyHxcqt.js";import"../chunks/C3FPqVk7.js";import{I as na,s as oa}from"../chunks/DhGkR45b.js";import{b as cs}from"../chunks/CWVXqVlC.js";import{g as Hs}from"../chunks/ZDXGsid_.js";import{W as Ls}from"../chunks/BdfQ1NTG.js";function Fs(Q,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const oe=[["path",{d:"m6 9 6 6 6-6"}]];na(Q,ia({name:"chevron-down"},()=>n,{get iconNode(){return oe},children:(J,x)=>{var G=At(),V=Je(G);oa(V,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function qs(Q,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const oe=[["path",{d:"m18 15-6-6-6 6"}]];na(Q,ia({name:"chevron-up"},()=>n,{get iconNode(){return oe},children:(J,x)=>{var G=At(),V=Je(G);oa(V,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function Bs(Q,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const oe=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];na(Q,ia({name:"copy"},()=>n,{get iconNode(){return oe},children:(J,x)=>{var G=At(),V=Je(G);oa(V,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function Js(Q,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const oe=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4"}]];na(Q,ia({name:"flame"},()=>n,{get iconNode(){return oe},children:(J,x)=>{var G=At(),V=Je(G);oa(V,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function Gs(Q,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const oe=[["circle",{cx:"9",cy:"12",r:"1"}],["circle",{cx:"9",cy:"5",r:"1"}],["circle",{cx:"9",cy:"19",r:"1"}],["circle",{cx:"15",cy:"12",r:"1"}],["circle",{cx:"15",cy:"5",r:"1"}],["circle",{cx:"15",cy:"19",r:"1"}]];na(Q,ia({name:"grip-vertical"},()=>n,{get iconNode(){return oe},children:(J,x)=>{var G=At(),V=Je(G);oa(V,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function La(Q,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const oe=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17"}]];na(Q,ia({name:"layers"},()=>n,{get iconNode(){return oe},children:(J,x)=>{var G=At(),V=Je(G);oa(V,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function us(Q,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const oe=[["path",{d:"m16 6 4 14"}],["path",{d:"M12 6v14"}],["path",{d:"M8 8v12"}],["path",{d:"M4 4v16"}]];na(Q,ia({name:"library"},()=>n,{get iconNode(){return oe},children:(J,x)=>{var G=At(),V=Je(G);oa(V,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function Ws(Q,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const oe=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3"}],["path",{d:"M21 21v.01"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7"}],["path",{d:"M3 12h.01"}],["path",{d:"M12 3h.01"}],["path",{d:"M12 16v.01"}],["path",{d:"M16 12h1"}],["path",{d:"M21 12v.01"}],["path",{d:"M12 21v-1"}]];na(Q,ia({name:"qr-code"},()=>n,{get iconNode(){return oe},children:(J,x)=>{var G=At(),V=Je(G);oa(V,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function Ja(Q,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const oe=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];na(Q,ia({name:"save"},()=>n,{get iconNode(){return oe},children:(J,x)=>{var G=At(),V=Je(G);oa(V,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function bs(Q,o){const n=ra(o,["children","$$slots","$$events","$$legacy"]);const oe=[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21"}]];na(Q,ia({name:"swords"},()=>n,{get iconNode(){return oe},children:(J,x)=>{var G=At(),V=Je(G);oa(V,o,"default",{}),d(J,G)},$$slots:{default:!0}}))}function Qs(Q){let o=!1;return document.body&&(document.body.appendChild(Q),o=!0),{destroy(){o&&Q.parentNode&&Q.parentNode.removeChild(Q)}}}var Vs=c("<button> <!></button>"),Zs=c('<p class="text-xs text-slate-600 italic"> </p>'),Xs=c('<div class="text-xs leading-tight"><span class="text-red-400 font-bold"> </span> <span class="text-slate-400"> </span></div>'),Ys=c('<div class="space-y-1"></div>'),Ks=c('<div class="grid grid-cols-2 gap-2 max-h-[60vh] overflow-y-auto custom-scrollbar p-1"></div> <div class="mt-4 pt-3 border-t border-slate-800 flex flex-col gap-2"><div class="p-3 bg-slate-900/50 rounded-lg border border-slate-700/50 min-h-[60px]"><p class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </p> <!></div> <div class="flex justify-end mt-2"><button class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold text-sm shadow hover:bg-indigo-500 transition-colors w-full sm:w-auto"> </button></div></div>',1),er=c("<div><!></div>");function tr(Q,o){ua(o,!0);const n=()=>qt(ta,"$t",oe),[oe,J]=pa();var x=At(),G=Je(x);{var V=i=>{var y=er(),te=t(y);{let He=pe(()=>n()("session.affliction_modal.title"));Ds(te,{get isOpen(){return o.isOpen},get onClose(){return o.onClose},get title(){return a(He)},maxWidth:"max-w-md",children:(we,Ze)=>{var Ce=Ks(),Oe=Je(Ce);Ve(Oe,21,()=>Object.keys($s),Ct,(xe,Se)=>{const ut=pe(()=>o.afflictions.includes(a(Se)));var Fe=Vs();Fe.__click=()=>o.onToggle(a(Se));var A=t(Fe),M=s(A);{var he=De=>{vs(De,{size:14,class:"text-red-400"})};h(M,De=>{a(ut)&&De(he)})}e(Fe),_(De=>{tt(Fe,1,`flex items-center justify-between px-3 py-2 rounded-lg border text-xs font-bold transition-all ${a(ut)?"bg-red-500/20 border-red-500 text-red-100":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-750"}`),r(A,`${De??""} `)},[()=>n()(`character.afflictions.${a(Se)}`)]),d(xe,Fe)}),e(Oe);var de=s(Oe,2),Te=t(de),ge=t(Te),Rt=t(ge,!0);e(ge);var kt=s(ge,2);{var Ht=xe=>{var Se=Zs(),ut=t(Se,!0);e(Se),_(Fe=>r(ut,Fe),[()=>n()("session.affliction_modal.none_selected")]),d(xe,Se)},ke=xe=>{var Se=Ys();Ve(Se,21,()=>o.afflictions,Ct,(ut,Fe)=>{var A=Xs(),M=t(A),he=t(M);e(M);var De=s(M,2),vt=t(De,!0);e(De),e(A),_((Ot,rt)=>{r(he,`${Ot??""}:`),r(vt,rt)},[()=>n()(`character.afflictions.${a(Fe)}`),()=>n()(`sofww.afflictions.${a(Fe).toLowerCase().replace(" ","_")}.effect`)]),d(ut,A)}),e(Se),d(xe,Se)};h(kt,xe=>{o.afflictions.length===0?xe(Ht):xe(ke,!1)})}e(Te);var Ie=s(Te,2),Xe=t(Ie);Xe.__click=function(...xe){o.onClose?.apply(this,xe)};var at=t(Xe,!0);e(Xe),e(Ie),e(de),_((xe,Se)=>{r(Rt,xe),r(at,Se)},[()=>n()("session.affliction_modal.effects"),()=>n()("session.affliction_modal.done")]),d(we,Ce)},$$slots:{default:!0}})}e(y),Cs(y,He=>Qs?.(He)),d(i,y)};h(G,i=>{o.isOpen&&i(V)})}d(Q,x),ba(),J()}_a(["click"]);var ar=c('<div class="absolute top-0 right-0 bg-gradient-to-l from-yellow-600/20 to-transparent border-l border-b border-yellow-500/30 text-yellow-500 text-[9px] font-black tracking-widest px-3 py-1 rounded-bl-xl z-20 uppercase shadow-[0_0_10px_rgba(234,179,8,0.2)]"> </div>'),sr=c('<div class="absolute inset-0 bg-red-950/40 animate-pulse z-0 pointer-events-none"></div>'),rr=c('<span class="text-[9px] font-black bg-red-950/40 text-red-500 px-1.5 py-0.5 rounded border border-red-900/30 uppercase tracking-wider flex-shrink-0"> </span>'),ir=c("<button><!></button>"),nr=c('<button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800/50 text-slate-600 hover:text-red-400 hover:bg-red-950/30 border border-slate-700/50 transition-colors"><!></button>'),or=c('<div><div class="absolute inset-0 bg-gradient-to-b from-white/20 to-transparent"></div></div>'),lr=c('<div class="absolute inset-0 bg-gradient-to-r from-emerald-500/20 via-emerald-400/30 to-emerald-500/20 z-10"><div class="absolute inset-0 bg-gradient-to-b from-white/10 to-transparent"></div></div>'),dr=c('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),vr=c('<div class="absolute inset-0 flex items-center justify-center pointer-events-none z-20"><span class="text-[9px] font-black uppercase text-white drop-shadow-[0_1px_1px_rgba(0,0,0,0.8)] tracking-widest leading-none mt-0.5"> </span></div>'),cr=c('<div class="flex flex-col items-center justify-between bg-cyan-950/20 border border-cyan-500/30 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-cyan-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div>'),ur=c('<button class="text-[9px] bg-red-500/10 text-red-400 px-1.5 py-0.5 rounded border border-red-500/20 hover:bg-red-500/20 hover:border-red-500/40 transition-all flex items-center gap-1 group/btn"> <!></button>'),br=c('<div class="bg-slate-900/50 p-2 rounded border border-slate-800/50 text-center"><span class="text-[9px] text-slate-500 uppercase font-black block mb-0.5"> </span> <div class="text-white font-bold font-mono text-lg leading-none"> </div> <div> </div></div>'),_r=c('<div class="grid grid-cols-2 gap-4 mb-4"><div class="p-3 rounded-xl bg-purple-950/20 border border-purple-500/30 flex justify-between items-center group/ins"><div><span class="text-[9px] text-purple-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div> <div class="p-3 rounded-xl bg-red-950/20 border border-red-500/30 flex justify-between items-center group/cor"><div><span class="text-[9px] text-red-400 uppercase font-black block"> </span> <span class="text-white font-bold text-lg font-mono leading-none"> </span></div> <!></div></div>'),pr=c("<!> ",1),xr=c('<div><div class="text-emerald-500 text-[10px] font-black uppercase mb-2 flex items-center gap-2"> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="flex flex-wrap gap-2"></div></div>'),mr=c('<div class="text-sm bg-slate-900/30 p-2 rounded border border-slate-800/30"><span class="font-bold text-slate-300"> </span> <span class="text-slate-400 text-xs block mt-1 leading-relaxed"> </span></div>'),fr=c('<div><div> <span class="h-px flex-1 bg-current opacity-20"></span></div> <div class="grid gap-2"></div></div>'),gr=c('<div class="border-t border-slate-800/50 bg-slate-950/30 p-4"><div class="mb-4"><div class="text-slate-500 font-bold uppercase text-[10px] mb-2 flex items-center gap-2"><span> </span> <div class="h-px flex-1 bg-slate-800"></div></div> <div class="grid grid-cols-4 gap-2"></div></div> <!> <div class="grid grid-cols-2 gap-4 mb-4"><div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div> <div class="p-2 rounded bg-slate-900/50 border border-slate-800/50 flex flex-col items-center"><span class="text-[9px] text-slate-500 uppercase font-black"> </span> <span class="text-white font-bold"> </span></div></div> <div class="space-y-4"><!> <!></div></div>'),hr=c('<div><!> <!> <div class="relative z-10 p-4"><div class="flex items-start gap-4 mb-3"><div class="relative flex-shrink-0"><div><!></div> <button><!></button></div> <div class="flex-1 min-w-0"><div class="flex justify-between items-start mb-1"><div class="flex flex-col min-w-0 mr-2"><div class="flex items-center gap-2"><h3> </h3> <!></div></div> <div class="flex gap-1 flex-shrink-0"><button class="w-7 h-7 flex items-center justify-center rounded bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700 border border-slate-700/50 transition-colors"><!></button> <!></div></div>  <div class="relative w-full h-3.5 sm:h-4 bg-slate-950 rounded-full border border-white/5 overflow-hidden shadow-inner group-hover:border-white/20 transition-all mb-2"><div></div> <!> <!> <!></div> <div class="flex flex-col sm:flex-row gap-3"><div class="flex items-start gap-1.5"><div class="flex flex-col items-center justify-between bg-slate-900 border border-slate-700 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm"><span class="text-[9px] font-black text-slate-400 uppercase tracking-wider mb-0.5"> </span> <span class="text-xl font-bold text-white font-mono leading-none"> </span></div> <div class="flex flex-col items-center justify-between bg-red-950/30 border border-red-900/50 rounded-lg p-1.5 w-[4.5rem] h-[3.75rem] shadow-sm relative group/dmg"><span class="text-[9px] font-black text-red-400 uppercase tracking-wider mb-0.5"> </span> <input type="number" class="w-full bg-transparent text-center text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none placeholder-red-800"/> <span class="absolute -top-1 -right-1 flex h-2 w-2 opacity-0 group-hover/dmg:opacity-100 transition-opacity"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span></span></div> <div><span> </span> <div class="flex items-baseline gap-0.5 justify-center w-full"><input type="number" class="w-full bg-transparent text-right text-white font-mono font-bold text-xl focus:outline-none p-0 leading-none"/> <span class="text-[10px] text-slate-500 font-mono self-end mb-0.5 opacity-70"> </span></div></div> <!></div> <div class="flex flex-wrap gap-1.5 items-center flex-1"><!> <button class="text-[10px] sm:text-[9px] font-bold text-slate-500 hover:text-indigo-400 px-1.5 py-0.5 rounded border border-transparent hover:border-indigo-500/30 hover:bg-indigo-500/10 transition-all flex items-center gap-1 whitespace-nowrap"><!> </button></div></div></div></div></div>  <!> <!></div>');function yr(Q,o){ua(o,!0);const n=()=>qt(ta,"$t",oe),[oe,J]=pa();let x=Kt(o,"updateEnemy",3,(p,u)=>{}),G=Kt(o,"updatePlayer",3,(p,u)=>{}),V=Kt(o,"removeFromCombat",3,p=>{}),i=pe(()=>o.entity.type==="player"),y=pe(()=>o.entity.system==="sofdl"),te=pe(()=>o.entity.damage||0),He=pe(()=>o.entity.normalHealth||o.entity.health||10),we=pe(()=>o.entity.currentHealth??a(He)),Ze=pe(()=>a(te)>=a(we)),Ce=pe(()=>a(te)>=a(we)/2&&!a(Ze)),Oe=pe(()=>a(we)>0?Math.min(100,Math.max(0,a(te)/a(we)*100)):100),de=_t(!1),Te=_t(!1);Ra(()=>{const p=o.entity.afflictions||[],u=p.includes("Incapacitated");if(a(Ze)&&!u){const m={afflictions:[...p,"Incapacitated"]};o.entity.type==="player"?ge(m):x()(o.entity.instanceId,m)}else if(!a(Ze)&&u){const m={afflictions:p.filter(ue=>ue!=="Incapacitated")};o.entity.type==="player"?ge(m):x()(o.entity.instanceId,m)}});function ge(p){if(o.entity.type!=="player")return;const u=Wa.get(o.entity.id);u&&Wa.set(o.entity.id,{...u,...p}),G()(o.entity.id,p),Ma({id:o.entity.id,...p})}function Rt(p){const u=parseInt(p.target.value);if(isNaN(u))return;const m={damage:Math.max(0,u)};o.entity.type==="player"?ge(m):x()(o.entity.instanceId,m)}function kt(p){const u=parseInt(p.target.value);if(isNaN(u))return;const f=Math.max(0,u);let m=a(te);f<a(te)&&(m=f);const ue={currentHealth:f,damage:m};o.entity.type==="player"?ge(ue):x()(o.entity.instanceId,ue)}function Ht(){const p=!o.entity.acted;o.entity.type==="player"?ge({acted:p}):x()(o.entity.instanceId,{acted:p})}function ke(){o.entity.type==="player"&&ge({initiative:!o.entity.initiative})}function Ie(p){const u=o.entity.afflictions||[],m={afflictions:u.includes(p)?u.filter(ue=>ue!==p):[...u,p]};o.entity.type==="player"?ge(m):x()(o.entity.instanceId,m)}var Xe=hr(),at=t(Xe);{var xe=p=>{var u=ar(),f=t(u,!0);e(u),_(m=>r(f,m),[()=>n()("session.combat_card.initiative")]),d(p,u)};h(at,p=>{a(i)&&o.entity.initiative&&p(xe)})}var Se=s(at,2);{var ut=p=>{var u=sr();d(p,u)};h(Se,p=>{a(Ze)&&p(ut)})}var Fe=s(Se,2),A=t(Fe),M=t(A),he=t(M),De=t(he);Ba(De,()=>o.entity.imageUrl,p=>{{let u=pe(()=>o.entity.name.charAt(0));ja(p,{get hash(){return o.entity.imageUrl},get alt(){return o.entity.name},size:"custom",get fallbackText(){return a(u)}})}}),e(he);var vt=s(he,2);vt.__click=Ht;var Ot=t(vt);{var rt=p=>{Xa(p,{size:14,class:""})},yt=p=>{var u=At(),f=Je(u);{var m=Ae=>{vs(Ae,{size:14})},ue=Ae=>{bs(Ae,{size:14})};h(f,Ae=>{o.entity.acted?Ae(m):Ae(ue,!1)},!0)}d(p,u)};h(Ot,p=>{a(Ze)?p(rt):p(yt,!1)})}e(vt),e(M);var zt=s(M,2),X=t(zt),_e=t(X),Ue=t(_e),Ge=t(Ue),pt=t(Ge,!0);e(Ge);var We=s(Ge,2);{var ve=p=>{var u=rr(),f=t(u);e(u),_(()=>r(f,`Dif ${o.entity.difficulty??""}`)),d(p,u)};h(We,p=>{a(i)||p(ve)})}e(Ue),e(_e);var je=s(_e,2),F=t(je);F.__click=()=>k(de,!a(de));var ce=t(F);{var Ee=p=>{qs(p,{size:14})},Re=p=>{Fs(p,{size:14})};h(ce,p=>{a(de)?p(Ee):p(Re,!1)})}e(F);var Le=s(F,2);{var lt=p=>{var u=ir();u.__click=ke;var f=t(u);Js(f,{size:14}),e(u),_(m=>{tt(u,1,`w-7 h-7 flex items-center justify-center rounded transition-all ${o.entity.initiative?"bg-yellow-500 text-yellow-950 shadow-lg shadow-yellow-500/20":"bg-slate-800 text-slate-500 hover:text-white hover:bg-slate-700"}`),be(u,"title",m)},[()=>n()("session.combat_card.initiative")]),d(p,u)},qe=p=>{var u=nr();u.__click=()=>V()(o.entity.instanceId);var f=t(u);ma(f,{size:14}),e(u),d(p,u)};h(Le,p=>{a(i)?p(lt):p(qe,!1)})}e(je),e(X);var it=s(X,2),wt=t(it),Ut=s(wt,2);{var St=p=>{var u=or();_(()=>{tt(u,1,`absolute top-0 left-0 h-full transition-all duration-500 ease-out z-10
                            ${a(Ze)?"bg-gradient-to-r from-red-600 via-red-500 to-rose-500 animate-pulse":a(Oe)>=80?"bg-gradient-to-r from-red-600 to-rose-500":a(Ce)?"bg-gradient-to-r from-amber-600 to-orange-500":"bg-gradient-to-r from-orange-500 to-amber-400"}`),_s(u,`width: ${a(Oe)??""}%`)}),d(p,u)};h(Ut,p=>{a(Oe)>0&&p(St)})}var Pt=s(Ut,2);{var $=p=>{var u=lr();d(p,u)};h(Pt,p=>{a(te)===0&&p($)})}var q=s(Pt,2);{var D=p=>{var u=dr(),f=t(u),m=t(f,!0);e(f),e(u),_(ue=>r(m,ue),[()=>n()("session.combat_card.incapacitated")]),d(p,u)},Me=p=>{var u=At(),f=Je(u);{var m=ue=>{var Ae=vr(),Be=t(Ae),Qe=t(Be,!0);e(Be),e(Ae),_(xt=>r(Qe,xt),[()=>n()("session.combat_card.injured")]),d(ue,Ae)};h(f,ue=>{a(Ce)&&ue(m)},!0)}d(p,u)};h(q,p=>{a(Ze)?p(D):p(Me,!1)})}e(it);var Ye=s(it,2),Ke=t(Ye),st=t(Ke),gt=t(st),jt=t(gt,!0);e(gt);var Et=s(gt,2),et=t(Et,!0);e(Et),e(st);var T=s(st,2),j=t(T),S=t(j,!0);e(j);var le=s(j,2);bt(le),le.__input=Rt,va(2),e(T);var B=s(T,2),U=t(B),Z=t(U,!0);e(U);var Ne=s(U,2),re=t(Ne);bt(re),re.__input=kt;var ne=s(re,2),H=t(ne);e(ne),e(Ne),e(B);var ze=s(B,2);{var ie=p=>{var u=cr(),f=t(u),m=t(f,!0);e(f);var ue=s(f,2),Ae=t(ue,!0);e(ue),e(u),_(Be=>{r(m,Be),r(Ae,o.entity.perception||10)},[()=>n()("sofdl.attributes.perception")]),d(p,u)};h(ze,p=>{a(y)&&p(ie)})}e(Ke);var Pe=s(Ke,2),dt=t(Pe);Ve(dt,17,()=>o.entity.afflictions||[],Ct,(p,u)=>{var f=ur();f.__click=()=>Ie(a(u));var m=t(f),ue=s(m);ma(ue,{size:8,class:"opacity-50 group-hover/btn:opacity-100"}),e(f),_(()=>r(m,`${a(u)??""} `)),d(p,f)});var nt=s(dt,2);nt.__click=()=>k(Te,!0);var ct=t(nt);ea(ct,{size:10});var Mt=s(ct);e(nt),e(Pe),e(Ye),e(zt),e(A),e(Fe);var $t=s(Fe,2);{var Bt=p=>{var u=gr(),f=t(u),m=t(f),ue=t(m),Ae=t(ue,!0);e(ue),va(2),e(m);var Be=s(m,2);Ve(Be,21,()=>a(y)?["strength","agility","intellect","will"]:["str","agi","int","wil"],Ct,(W,I)=>{const ae=pe(()=>a(y)?o.entity.attributes?.[a(I)]??10:o.entity.stats?.[a(I)]??o.entity.attributes?.[a(I)]??10),me=pe(()=>a(ae)-10);var $e=br(),E=t($e),K=t(E,!0);e(E);var g=s(E,2),se=t(g,!0);e(g);var O=s(g,2),L=t(O);e(O),e($e),_(N=>{r(K,N),r(se,a(ae)),tt(O,1,`text-[9px] font-bold ${a(me)>=0?"text-emerald-500":"text-red-500"}`),r(L,`${a(me)>=0?"+":""}${a(me)??""}`)},[()=>a(y)?a(I).slice(0,3):a(I)]),d(W,$e)}),e(Be),e(f);var Qe=s(f,2);{var xt=W=>{var I=_r(),ae=t(I),me=t(ae),$e=t(me),E=t($e,!0);e($e);var K=s($e,2),g=t(K,!0);e(K),e(me);var se=s(me,2);Os(se,{size:20,class:"text-purple-500/30 group-hover/ins:text-purple-500 transition-colors"}),e(ae);var O=s(ae,2),L=t(O),N=t(L),R=t(N,!0);e(N);var P=s(N,2),fe=t(P,!0);e(P),e(L);var ye=s(L,2);Xa(ye,{size:20,class:"text-red-500/30 group-hover/cor:text-red-500 transition-colors"}),e(O),e(I),_((ft,ht)=>{r(E,ft),r(g,o.entity.insanity||0),r(R,ht),r(fe,o.entity.corruption||0)},[()=>n()("sofdl.attributes.insanity"),()=>n()("sofdl.attributes.corruption")]),d(W,I)};h(Qe,W=>{a(y)&&W(xt)})}var mt=s(Qe,2),Nt=t(mt),Dt=t(Nt),Tt=t(Dt,!0);e(Dt);var Jt=s(Dt,2),Wt=t(Jt,!0);e(Jt),e(Nt);var Vt=s(Nt,2),l=t(Vt),v=t(l,!0);e(l);var b=s(l,2),z=t(b,!0);e(b),e(Vt),e(mt);var Y=s(mt,2),w=t(Y);{var C=W=>{var I=xr(),ae=t(I),me=t(ae);va(),e(ae);var $e=s(ae,2);Ve($e,21,()=>o.entity.senses,Ct,(E,K)=>{const g=pe(()=>{const[L,N]=a(K).split(":");return{key:L,val:N}}),se=pe(()=>n()(`character.senses.list.${a(g).key}`)+(a(g).val?` ${a(g).val}`:"")),O=pe(()=>n()(`character.senses.descriptions.${a(g).key}`));js(E,{get text(){return a(O)},class:"text-xs bg-emerald-950/30 text-emerald-200 px-3 py-1.5 rounded border border-emerald-900/50 font-bold flex items-center gap-2 cursor-help whitespace-nowrap",children:(L,N)=>{var R=pr(),P=Je(R);qa(P,{size:12,class:"text-emerald-500 flex-shrink-0"});var fe=s(P);_(()=>r(fe,` ${a(se)??""}`)),d(L,R)},$$slots:{default:!0}})}),e($e),e(I),_(E=>r(me,`${E??""} `),[()=>n()("character.senses.title")]),d(W,I)};h(w,W=>{o.entity.senses&&o.entity.senses.length>0&&W(C)})}var ee=s(w,2);Ve(ee,16,()=>[{key:"traits",label:"Traços",color:"text-amber-500"},{key:"actions",label:"Ações",color:"text-red-400"},{key:"reactions",label:"Reações",color:"text-indigo-400"},{key:"end_of_round",label:"Fim da Rodada",color:"text-emerald-400"}],Ct,(W,I)=>{var ae=At(),me=Je(ae);{var $e=E=>{var K=fr(),g=t(K),se=t(g);va(),e(g);var O=s(g,2);Ve(O,21,()=>o.entity[I.key],Ct,(L,N)=>{var R=mr(),P=t(R),fe=t(P,!0);e(P);var ye=s(P,2),ft=t(ye,!0);e(ye),e(R),_(()=>{r(fe,a(N).name),r(ft,a(N).description||a(N).effect)}),d(L,R)}),e(O),e(K),_(()=>{tt(g,1,`${I.color??""} text-[10px] font-black uppercase mb-2 flex items-center gap-2`),r(se,`${I.label??""} `)}),d(E,K)};h(me,E=>{o.entity[I.key]&&o.entity[I.key].length>0&&E($e)})}d(W,ae)}),e(Y),e(u),_((W,I,ae)=>{r(Ae,W),r(Tt,I),r(Wt,o.entity.size||1),r(v,ae),r(z,o.entity.speed||10)},[()=>n()("session.combat_card.attributes"),()=>n()("session.combat_card.size"),()=>n()("session.combat_card.speed")]),d(p,u)};h($t,p=>{a(de)&&p(Bt)})}var Lt=s($t,2);{let p=pe(()=>o.entity.afflictions||[]);tr(Lt,{get isOpen(){return a(Te)},onClose:()=>k(Te,!1),get afflictions(){return a(p)},onToggle:Ie})}e(Xe),_((p,u,f,m,ue)=>{tt(Xe,1,`group relative overflow-hidden transition-all duration-300 rounded-2xl border ${a(i)?"bg-slate-900/80 border-indigo-500/30 hover:border-indigo-500/50 hover:shadow-indigo-900/20":"bg-slate-950/80 border-red-900/30 hover:border-red-800/50 hover:shadow-red-900/10"} shadow-lg backdrop-blur-sm`),tt(he,1,`w-14 h-14 rounded-2xl overflow-hidden border-2 shadow-xl transition-transform group-hover:scale-105 ${a(Ze)?"border-red-600 grayscale brightness-50":a(i)?"border-indigo-500/50":"border-red-900/50"}`),tt(vt,1,`absolute -bottom-2 -right-2 w-7 h-7 rounded-lg flex items-center justify-center border shadow-lg transition-all hover:scale-110 z-20 ${o.entity.acted?"bg-slate-800 border-slate-600 text-slate-500":a(i)?"bg-indigo-600 border-indigo-400 text-white":"bg-red-600 border-red-400 text-white"}`),be(vt,"title",p),tt(Ge,1,`text-base font-bold truncate leading-snug ${a(i)?"text-white":"text-red-100 font-serif tracking-wide"}`),r(pt,o.entity.name),tt(wt,1,`absolute inset-0 w-full ${a(te)===0?"bg-emerald-900/20":"bg-slate-900/50"}`),r(jt,u),r(et,o.entity.defense||10),r(S,f),Ua(le,a(te)),tt(B,1,`flex flex-col items-center justify-between border rounded-lg p-1.5 w-[5.5rem] h-[3.75rem] shadow-sm relative transition-colors ${a(Ze)?"bg-red-950/50 border-red-500":a(Ce)?"bg-orange-950/30 border-orange-500":"bg-emerald-950/30 border-emerald-900/50"}`),tt(U,1,`text-[9px] font-black uppercase tracking-wider mb-0.5 ${a(Ze)?"text-red-400":a(Ce)?"text-orange-400":"text-emerald-400"}`),r(Z,m),Ua(re,a(we)),r(H,`/${a(He)??""}`),r(Mt,` ${ue??""}`)},[()=>o.entity.acted?n()("session.combat_card.acted"):n()("session.combat_card.act"),()=>n()("session.combat_card.defense"),()=>n()("session.combat_card.damage"),()=>n()("session.combat_card.health"),()=>n()("session.combat_card.add_affliction")]),d(Q,Xe),ba(),J()}_a(["click","input"]);function wr(Q,{from:o,to:n},oe={}){var{delay:J=0,duration:x=ke=>Math.sqrt(ke)*120,easing:G=As}=oe,V=getComputedStyle(Q),i=V.transform==="none"?"":V.transform,[y,te]=V.transformOrigin.split(" ").map(parseFloat);y/=Q.clientWidth,te/=Q.clientHeight;var He=kr(Q),we=Q.clientWidth/n.width/He,Ze=Q.clientHeight/n.height/He,Ce=o.left+o.width*y,Oe=o.top+o.height*te,de=n.left+n.width*y,Te=n.top+n.height*te,ge=(Ce-de)*we,Rt=(Oe-Te)*Ze,kt=o.width/n.width,Ht=o.height/n.height;return{delay:J,duration:typeof x=="function"?x(Math.sqrt(ge*ge+Rt*Rt)):x,easing:G,css:(ke,Ie)=>{var Xe=Ie*ge,at=Ie*Rt,xe=ke+Ie*kt,Se=ke+Ie*Ht;return`transform: ${i} translate(${Xe}px, ${at}px) scale(${xe}, ${Se});`}}}function kr(Q){if("currentCSSZoom"in Q)return Q.currentCSSZoom;for(var o=Q,n=1;o!==null;)n*=+getComputedStyle(o).zoom,o=o.parentElement;return n}function zr(Q,o=1,n=0){const oe=[];let J=0;for(let i=0;i<o;i++){const y=Math.floor(Math.random()*Q)+1;oe.push(y),J+=y}let x=`${o}d${Q}`,G=[],V=0;if(n!==0)if(Q===20){const i=Math.abs(n);for(let te=0;te<i;te++)G.push(Math.floor(Math.random()*6)+1);const y=Math.max(...G);n>0?(V=y,J+=y,x+=` + ${y} [Boon]`):(V=-y,J-=y,x+=` - ${y} [Bane]`)}else V=n,J+=n,x+=n>0?` + ${n}`:` - ${Math.abs(n)}`;return{total:J,results:oe,bonusRolls:G,formula:x,crit:Q===20&&oe.includes(20),modifierTotal:V}}function $r(Q,o,n){const oe=n.map(i=>({...i,type:"enemy"}));if(Q==="standard"){const i=o.filter(we=>we.initiative).map(we=>({...we,type:"player",isFast:!0})),y=o.filter(we=>!we.initiative).map(we=>({...we,type:"player",isFast:!1})),te=oe.filter(we=>we.initiative).map(we=>({...we,isFast:!0})),He=oe.filter(we=>!we.initiative).map(we=>({...we,isFast:!1}));return[...i,...te,...y,...He]}if(Q==="individual")return[...o.map(y=>({...y,type:"player",totalInit:(y.initiativeRoll||0)+(y.attributes?.agility||10)-10})),...oe.map(y=>({...y,type:"enemy",totalInit:(y.initiativeRoll||0)+(y.attributes?.agility||10)-10}))].sort((y,te)=>te.totalInit-y.totalInit);const J=o.filter(i=>i&&i.initiative).map(i=>({...i,type:"player"})),x=o.filter(i=>i&&!i.initiative).map(i=>({...i,type:"player"})),G=[...J,...oe,...x],V=new Set;return G.filter(i=>{if(!i)return!1;const y=i.type==="player"?i.id:i.instanceId;return V.has(y)?!1:(V.add(y),!0)})}var Cr=c('<span class="text-[10px] bg-slate-800 text-slate-400 px-1.5 py-0.5 rounded-full"> </span>'),Or=c('<div class="p-3 rounded-xl border border-amber-500/30 bg-amber-500/5 flex items-center gap-3 transition-all hover:bg-amber-500/10 shadow-sm"><div class="flex-1"><div class="font-bold text-sm text-amber-200 leading-none"> </div> <div class="text-[9px] text-amber-500/60 font-medium mt-1 uppercase tracking-tighter"> </div></div> <div class="flex items-center gap-1.5"><button class="p-2 rounded-lg bg-green-600/20 text-green-400 hover:bg-green-600 hover:text-white transition-all shadow-lg active:scale-90" title="Aprovar"><!></button> <button class="p-2 rounded-lg bg-red-600/20 text-red-400 hover:bg-red-600 hover:text-white transition-all shadow-lg active:scale-90" title="Recusar"><!></button></div></div>'),jr=c('<div class="space-y-2 animate-in fade-in slide-in-from-top-2"><div class="flex items-center gap-2 px-1"><div class="w-1.5 h-1.5 rounded-full bg-amber-500 animate-pulse"></div> <span class="text-[10px] font-black text-amber-500 uppercase tracking-wider"> </span></div> <!> <div class="h-px bg-slate-800/50 mx-2 my-2"></div></div>'),Er=c('<span class="text-indigo-400 font-bold uppercase tracking-tighter mr-1"> </span>'),Mr=c('<div><div></div> <div class="flex-1"><div> </div> <div class="text-[10px] text-slate-500 font-medium"><!> </div></div> <div class="flex items-center gap-1"><button><!></button> <button class="text-slate-600 hover:text-red-400 p-1.5 hover:bg-red-400/10 rounded-lg transition-all"><!></button></div></div>'),Sr=c('<div class="text-xs text-slate-600 italic p-6 border-2 border-dashed border-slate-800 rounded-xl text-center"> </div>'),Ir=c('<button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-black uppercase text-[10px] tracking-[0.2em] shadow-lg shadow-indigo-900/20 transition-all active:scale-[0.98] flex items-center justify-center gap-2"><!> </button> <p class="text-[9px] text-slate-600 text-center font-bold uppercase tracking-tighter"> </p>',1),Rr=c('<div class="flex justify-center p-3 bg-white rounded-xl mb-2 animate-in zoom-in-95 duration-200 shadow-xl mx-auto w-32 h-32"><img class="w-24 h-24"/></div>'),Nr=c('<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-green-500 text-white text-[10px] font-bold rounded shadow-lg animate-in fade-in slide-in-from-bottom-1 whitespace-nowrap"><!> </div>'),Dr=c('<div class="flex items-center justify-between"><div class="flex items-center gap-2"><span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-1"><!> </span></div> <button class="text-slate-500 hover:text-white transition-colors p-1"><!></button></div> <!> <div class="relative group"><div class="flex gap-1"><div class="flex-1 bg-slate-950 border border-slate-800 rounded-lg p-2 text-[10px] text-slate-400 font-mono truncate cursor-pointer hover:border-slate-700 transition-colors flex items-center"> </div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-all active:scale-95 shadow-lg shadow-indigo-900/20 relative"><!> <!></button></div></div> <button class="w-full text-[9px] text-slate-600 hover:text-red-400 font-bold uppercase tracking-widest transition-colors mt-1"> </button>',1),Ar=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1 flex items-center gap-2"><!> <div class="min-w-0 flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),Tr=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Ur=c("<!> <!>",1),Pr=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 group hover:border-indigo-500/30 transition-all cursor-move hover:bg-slate-800/50" draggable="true"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-slate-500 hover:text-indigo-400 p-1 ml-2 bg-slate-900 rounded border border-slate-800 hover:bg-slate-800"><!></button></div>'),Hr=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),Lr=c("<!> <!>",1),Fr=c('<button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold flex items-center gap-2 shadow-lg shadow-green-900/20"><!> </button>'),qr=c('<div class="flex items-center gap-4"><button class="p-2 hover:bg-slate-700 rounded text-slate-400"><!></button> <div class="text-center"><div class="text-[10px] font-bold text-slate-500 uppercase"> </div><div class="text-3xl font-mono font-bold text-white leading-none"> </div></div> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded font-bold flex items-center gap-2"><!> </button> <div class="h-8 w-px bg-slate-700 mx-2"></div> <button class="text-red-400 hover:text-red-300 text-xs font-bold px-3 py-2 border border-red-900/30 rounded bg-red-900/10"> </button></div>'),Br=c("<div><!></div>"),Jr=c('<div class="text-center text-slate-500 italic py-10"> </div>'),Gr=c('<div class="text-sm"><span class="font-bold text-yellow-500"> </span> <span class="text-slate-300"> </span></div>'),Wr=c('<div class="bg-slate-900 border border-slate-700 rounded-lg p-4"><h4 class="font-bold text-white mb-2 pb-2 border-b border-slate-800 flex items-center gap-2"><!> </h4> <div class="space-y-2"></div></div>'),Qr=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-lg border border-slate-700 shadow-2xl p-6 relative" role="dialog" aria-modal="true"><div class="flex items-center gap-3 mb-6"><div class="p-3 bg-yellow-900/20 rounded-full border border-yellow-500/30 text-yellow-500"><!></div> <div><h3 class="font-bold text-white text-xl"> </h3> <p class="text-slate-400 text-sm"> </p></div></div> <div class="space-y-4 mb-8 max-h-[60vh] overflow-y-auto custom-scrollbar"></div> <div class="flex gap-3"><button class="flex-1 py-1.5 rounded bg-slate-700 hover:bg-slate-600 text-white font-bold text-sm"> </button> <button class="flex-1 py-1.5 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold text-sm"> </button></div></div></div>'),Vr=c('<button class="w-full text-left flex items-center gap-3 p-3 bg-slate-900 border border-slate-700 hover:border-indigo-500 hover:bg-indigo-500/10 rounded-xl group transition-all"><div class="w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-sm font-bold text-slate-500 group-hover:text-indigo-400 border border-slate-700 group-hover:border-indigo-500/30"> </div> <div class="flex-1"><div class="font-bold text-white group-hover:text-indigo-300"> </div> <div class="text-[10px] text-slate-500"> </div></div> <div class="bg-slate-800 p-2 rounded-lg text-slate-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors"><!></div></button>'),Zr=c('<div class="text-center py-8"><div class="w-12 h-12 bg-slate-700/50 rounded-full flex items-center justify-center mx-auto mb-3 text-slate-500"><!></div> <p class="text-slate-500 text-sm font-bold"> </p> <p class="text-[10px] text-slate-600 mt-1"> </p></div>'),Xr=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" aria-label="Fechar" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-md border border-slate-700 shadow-2xl p-6" role="dialog" aria-modal="true"><div class="flex justify-between items-center mb-6"><div><h3 class="font-bold text-white text-lg"> </h3> <p class="text-xs text-slate-400"> </p></div> <button class="bg-slate-700 hover:bg-slate-600 p-2 rounded-lg text-white transition-colors"><!></button></div> <div class="space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2"><!> <!></div></div></div>'),Yr=c('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1 flex flex-col"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),Kr=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),ei=c("<!> <!>",1),ti=c('<div class="flex justify-between items-center bg-slate-950 p-3 rounded-xl border border-slate-800 group active:border-indigo-500/50 transition-all"><div class="truncate flex-1"><div class="text-sm font-bold text-white truncate flex items-center gap-1"> <!></div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-white hover:bg-indigo-600 p-2 bg-slate-800 rounded-lg border border-slate-700"><!></button></div>'),ai=c('<div class="text-center text-slate-600 italic text-xs mt-4"> </div>'),si=c("<!> <!>",1),ri=c('<div class="fixed inset-0 z-50 flex justify-end bg-black/60"><div class="w-full max-w-[300px] h-full bg-slate-900 border-l border-slate-800 p-4 shadow-2xl animate-in slide-in-from-right duration-300"><div class="flex justify-between items-center mb-4"><h3 class="font-bold text-white uppercase tracking-widest text-sm flex items-center gap-2"><!> </h3> <button class="bg-slate-800 p-2 rounded-lg text-slate-400 hover:text-white"><!></button></div> <div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="h-[calc(100%-100px)] overflow-y-auto custom-scrollbar space-y-2"><!></div></div></div>'),ii=c('<div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full relative"><div class="space-y-6"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex flex-col gap-4"><div class="flex justify-between items-center bg-slate-950/50 p-2 rounded-lg border border-slate-800"><h3 class="text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-2"><!> <!></h3> <button class="text-[10px] bg-slate-800 hover:bg-slate-700 text-white px-2.5 py-1.5 rounded-md font-bold transition-all border border-slate-700 active:scale-95"> </button></div> <!> <div class="space-y-2 flex-1 overflow-y-auto max-h-[300px] custom-scrollbar pr-1"><div class="space-y-2"><!> <!></div></div> <div class="pt-4 border-t border-slate-800 space-y-3"><!></div></div> <div class="hidden lg:flex flex-col h-[400px] bg-slate-900 border border-slate-800 rounded-xl p-4"><div class="flex items-center gap-2 mb-3 bg-slate-950 p-1 rounded-lg border border-slate-800"><button><!> </button> <button><!> </button></div> <div class="flex-1 overflow-y-auto pr-1 custom-scrollbar space-y-2"><!></div></div></div> <div class="lg:col-span-2 space-y-4" role="region" aria-label="Combat Zone"><div class="bg-slate-900 border border-slate-800 rounded-xl p-4 flex justify-between items-center shadow-lg sticky top-0 z-20"><div class="flex items-center gap-4"><!></div></div> <div class="space-y-3 pb-20"><!> <!></div></div> <div class="hidden lg:flex flex-col gap-4"></div></div> <!> <!> <!> <button class="lg:hidden fixed bottom-24 right-4 bg-slate-800 text-white p-3 rounded-full shadow-lg border border-slate-700 z-40 active:scale-90 transition-transform" aria-label="Add Enemy"><!></button> <!> <!>',1);function ni(Q,o){ua(o,!0);const n=()=>qt(ws,"$liveCharacters",V),oe=()=>qt(Fa,"$liveEnemies",V),J=()=>qt(es,"$liveEncounters",V),x=()=>qt(ta,"$t",V),G=()=>qt(ya,"$isHistoryOpen",V),[V,i]=pa();let y=_t(!1),te=_t(!1),He=_t(!1),we=_t(!1);const Ze={active:!1,round:1};let Ce=_t("enemies"),Oe=_t(!1),de=_t(ca([])),Te=_t(ca({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));Ga(()=>{if(o.campaign?.id){ms(o.campaign.id,!0);const l=Ta(ta)("common.labels.master");Qa.update(b=>({...b,campaignId:o.campaign.id,name:o.campaign.gmName||l}));const v=setInterval(()=>{const b=Qt.get(o.campaign.id)||o.campaign,z=Ta(ta)("common.labels.master");Pa(o.campaign.id,{name:b.name,gmName:b.gmName||z})},3e4);return()=>{clearInterval(v),fs(),Qa.update(b=>({...b,campaignId:null}))}}});const ge=pe(()=>typeof window<"u"?`${window.location.origin}${ss("/campaigns/[id]/invite",{id:o.campaign?.id})}`:"");function Rt(){a(ge)&&(navigator.clipboard.writeText(a(ge)),k(He,!0),setTimeout(()=>{k(He,!1)},2e3))}let kt=pe(()=>o.campaign?.sessionRoster||[]),Ht=pe(()=>o.campaign?.combat||Ze),ke=pe(()=>o.campaign?.activeEnemies||[]),Ie=pe(()=>o.campaign?.members||[]),Xe=pe(()=>o.campaign?.initiativeStyle||"dle"),at=pe(()=>Array.from(new Set([...a(kt),...a(Ie).map(v=>v.id)])).map(v=>{const b=n().find(Y=>Y.id===v),z=a(Ie).find(Y=>Y.id===v);return b&&z?{...b,...z,lastUpdate:z.lastUpdate}:b||z}).filter(Boolean)),xe=pe(()=>a(at).filter(l=>!l.campaignApproval||l.campaignApproval==="approved")),Se=pe(()=>a(at).filter(l=>l.campaignApproval==="pending")),ut=pe(()=>n().filter(l=>!a(kt).includes(l.id)&&!a(Ie).some(v=>v.id===l.id)&&(l.system||wa)===(o.campaign?.system||wa))),Fe=pe(()=>oe().filter(l=>{const v=(l.system||wa)===(o.campaign?.system||wa),b=l.campaignId===o.campaign?.id||l.global;return v&&b})),A=pe(()=>J().filter(l=>(l.system||wa)===(o.campaign?.system||wa)&&!0));function M(l){if(!o.campaign?.id)return;const b={...Qt.get(o.campaign.id)||o.campaign,...l};Qt.set(o.campaign.id,b),l.combat&&Ea(o.campaign.id,l.combat),(l.name||l.gmName)&&Pa(o.campaign.id,{name:b.name,gmName:b.gmName})}function he(l){if(a(kt).includes(l)){const v=a(kt).filter(b=>b!==l);M({sessionRoster:v})}else{const v=[...a(kt),l];M({sessionRoster:v})}}function De(l){ce(l,{campaignApproval:"approved"}),Ma({id:l,campaignApproval:"approved"})}function vt(l){Ma({id:l,campaignApproval:"rejected",campaignId:null});const b=((Qt.get(o.campaign.id)||o.campaign).members||[]).filter(z=>z.id!==l);M({members:b})}function Ot(l){const v=a(at).find(b=>b.id===l);k(Te,{isOpen:!0,title:x()("session.players.remove_title"),message:x()("session.players.remove_message",{values:{name:v?.name||"este personagem"}}),onConfirm:()=>{const b=Qt.get(o.campaign.id)||o.campaign;Ma({id:l,campaignId:null});const z=(b.sessionRoster||[]).filter(C=>C!==l),Y=(b.members||[]).filter(C=>C.id!==l),w=(b.activeEnemies||[]).filter(C=>C.type!=="player"||C.id!==l);M({sessionRoster:z,members:Y,activeEnemies:w}),a(Te).isOpen=!1}},!0)}function rt(l){const b=(Qt.get(o.campaign.id)||o.campaign).activeEnemies||[],z={...l,instanceId:Oa(),damage:0,currentHealth:l.health,afflictions:[],acted:!1,initiative:!1};M({activeEnemies:[...b,z]})}function yt(l){const b=(Qt.get(o.campaign.id)||o.campaign).activeEnemies||[];let z=[];l.enemies.forEach(Y=>{const w=oe().find(C=>C.id===Y.enemyId);if(w)for(let C=0;C<Y.count;C++)z.push({...w,instanceId:Oa(),damage:0,currentHealth:w.health,afflictions:[],acted:!1,initiative:!1})}),M({activeEnemies:[...b,...z]})}function zt(){M({combat:{active:!0,round:1}}),Ea(o.campaign.id,{active:!0,round:1})}function X(){const l=a(ke).filter(v=>v.damage<(v.currentHealth??v.health)&&v.endOfRound&&v.endOfRound.length>0).map(v=>({name:v.name,effects:v.endOfRound}));if(l.length>0){k(de,l,!0),k(Oe,!0);return}_e()}function _e(){const l=Qt.get(o.campaign.id)||o.campaign,v=(l.combat?.round||1)+1,b=(l.activeEnemies||[]).map(z=>({...z,acted:!1}));M({combat:{...l.combat,round:v},activeEnemies:b}),Ea(o.campaign.id,{active:!0,round:v}),k(Oe,!1)}function Ue(l){M({combat:{active:!1,round:1}}),Ea(o.campaign.id,{active:!1,round:1})}function Ge(l){const v=Qt.get(o.campaign.id)||o.campaign;M({activeEnemies:(v.activeEnemies||[]).filter(b=>b.instanceId!==l)})}function pt(l,v){const b=Qt.get(o.campaign.id)||o.campaign;M({activeEnemies:(b.activeEnemies||[]).map(z=>z.instanceId===l?{...z,...v}:z)})}function We(){const l=Qt.get(o.campaign.id)||o.campaign,v=l.combat?.round||1;v>1&&M({combat:{...l.combat,round:v-1}})}let ve=_t(ca(Date.now()));Ga(()=>{const l=setInterval(()=>{k(ve,Date.now(),!0)},1e4);return()=>clearInterval(l)});let je=pe(()=>(()=>{const l=a(xe).filter(v=>a(kt).includes(v.id));return $r(a(Xe),l,a(ke))})());function F(l){return l.lastUpdate?a(ve)-l.lastUpdate<6e4:!1}function ce(l,v){const b=Qt.get(o.campaign.id)||o.campaign,z=b.members||[],Y=z.findIndex(I=>I.id===l);let w=z;Y!==-1&&(w=[...z],w[Y]={...w[Y],...v});const C=b.activeEnemies||[],ee=C.findIndex(I=>I.id===l&&I.type==="player");let W=C;ee!==-1&&(W=[...C],W[ee]={...W[ee],...v}),M({members:w,activeEnemies:W})}function Ee(l,v,b){l.dataTransfer&&(l.dataTransfer.setData("application/json",JSON.stringify({item:v,type:b})),l.dataTransfer.effectAllowed="copy")}function Re(l){return l.preventDefault(),!1}function Le(l){l.preventDefault();const v=l.dataTransfer?.getData("application/json");if(v)try{const{item:b,type:z}=JSON.parse(v);z==="enemy"?rt(b):z==="encounter"&&yt(b)}catch(b){console.error("Drop error",b)}}var lt=ii(),qe=Je(lt),it=t(qe),wt=t(it),Ut=t(wt),St=t(Ut),Pt=t(St);ts(Pt,{size:14,class:"text-indigo-500"});var $=s(Pt),q=s($);{var D=l=>{var v=Cr(),b=t(v,!0);e(v),_(()=>r(b,a(xe).length)),d(l,v)};h(q,l=>{a(xe).length>0&&l(D)})}e(St);var Me=s(St,2);Me.__click=()=>k(y,!a(y));var Ye=t(Me,!0);e(Me),e(Ut);var Ke=s(Ut,2);{var st=l=>{var v=jr(),b=t(v),z=s(t(b),2),Y=t(z);e(z),e(b);var w=s(b,2);Ve(w,17,()=>a(Se),C=>C.id,(C,ee)=>{var W=Or(),I=t(W),ae=t(I),me=t(ae,!0);e(ae);var $e=s(ae,2),E=t($e,!0);e($e),e(I);var K=s(I,2),g=t(K);g.__click=()=>De(a(ee).id);var se=t(g);Za(se,{size:14}),e(g);var O=s(g,2);O.__click=()=>vt(a(ee).id);var L=t(O);sa(L,{size:14}),e(O),e(K),e(W),_(N=>{r(me,a(ee).name),r(E,N)},[()=>x()("session.players.new_request")]),d(C,W)}),va(2),e(v),_(C=>r(Y,`${C??""} (${a(Se).length??""})`),[()=>x()("session.players.waiting_approval")]),d(l,v)};h(Ke,l=>{a(Se).length>0&&l(st)})}var gt=s(Ke,2),jt=t(gt),Et=t(jt);Ve(Et,17,()=>a(xe),l=>l.id,(l,v)=>{const b=pe(()=>F(a(v))),z=pe(()=>a(kt).includes(a(v).id));var Y=Mr(),w=t(Y),C=s(w,2),ee=t(C),W=t(ee,!0);e(ee);var I=s(ee,2),ae=t(I);{var me=R=>{var P=Er(),fe=t(P,!0);e(P),_(ye=>r(fe,ye),[()=>x()("common.labels.session")]),d(R,P)};h(ae,R=>{a(z)&&R(me)})}var $e=s(ae);e(I),e(C);var E=s(C,2),K=t(E);K.__click=()=>he(a(v).id);var g=t(K);{var se=R=>{Es(R,{size:14})},O=R=>{ea(R,{size:14})};h(g,R=>{a(z)?R(se):R(O,!1)})}e(K);var L=s(K,2);L.__click=()=>Ot(a(v).id);var N=t(L);sa(N,{size:14}),e(L),e(E),e(Y),_((R,P,fe)=>{tt(Y,1,`p-2.5 rounded-xl border flex items-center gap-3 transition-all ${a(b)?"bg-indigo-900/10 border-indigo-500/20":"bg-slate-900/50 border-slate-800"} ${a(b)||a(z)?"opacity-100":"opacity-40"} hover:border-indigo-500/40 group shadow-sm`),tt(w,1,`w-2 h-2 rounded-full ${a(b)?"bg-green-500 shadow-[0_0_8px_rgba(74,222,128,0.4)]":"bg-slate-700"}`),tt(ee,1,`font-bold text-sm ${a(b)?"text-white":"text-slate-500"} group-hover:text-indigo-300 transition-colors`),r(W,a(v).name),r($e,` ${R??""} ${a(v).level??""} • ${a(v).ancestry??""}`),tt(K,1,`p-1.5 rounded-lg transition-all ${a(z)?"text-amber-400 hover:bg-amber-400/10":"text-slate-500 hover:text-indigo-400 hover:bg-indigo-400/10"}`),be(K,"title",P),be(L,"title",fe)},[()=>x()("common.labels.level"),()=>a(z)?x()("session.players.remove_from_session"):x()("session.players.add_to_session"),()=>x()("session.players.kick_from_campaign")]),d(l,Y)});var et=s(Et,2);{var T=l=>{var v=Sr(),b=t(v,!0);e(v),_(z=>r(b,z),[()=>x()("session.players.none")]),d(l,v)};h(et,l=>{a(xe).length===0&&l(T)})}e(jt),e(gt);var j=s(gt,2),S=t(j);{var le=l=>{var v=Ir(),b=Je(v);b.__click=()=>M({isPublished:!0});var z=t(b);da(z,{size:14});var Y=s(z);e(b);var w=s(b,2),C=t(w,!0);e(w),_((ee,W)=>{r(Y,` ${ee??""}`),r(C,W)},[()=>x()("session.publish.publish_session"),()=>x()("session.publish.make_visible")]),d(l,v)},B=l=>{var v=Dr(),b=Je(v),z=t(b),Y=t(z),w=t(Y);as(w,{size:10,class:"animate-pulse"});var C=s(w);e(Y),e(z);var ee=s(z,2);ee.__click=()=>k(we,!a(we));var W=t(ee);Ws(W,{size:14}),e(ee),e(b);var I=s(b,2);{var ae=P=>{var fe=Rr(),ye=t(fe);e(fe),_((ft,ht)=>{be(ye,"src",ft),be(ye,"alt",ht)},[()=>`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent(a(ge))}`,()=>x()("session.publish.qr_alt")]),d(P,fe)};h(I,P=>{a(we)&&P(ae)})}var me=s(I,2),$e=t(me),E=t($e);E.__click=Rt;var K=t(E,!0);e(E);var g=s(E,2);g.__click=Rt;var se=t(g);{var O=P=>{var fe=Nr(),ye=t(fe);Za(ye,{size:10,class:"inline mr-1"});var ft=s(ye);e(fe),_(ht=>r(ft,` ${ht??""}`),[()=>x()("common.buttons.copied")]),d(P,fe)};h(se,P=>{a(He)&&P(O)})}var L=s(se,2);Bs(L,{size:14}),e(g),e($e),e(me);var N=s(me,2);N.__click=()=>M({isPublished:!1});var R=t(N,!0);e(N),_((P,fe,ye,ft)=>{r(C,` ${P??""}`),be(ee,"title",fe),r(K,a(ge)),be(g,"aria-label",ye),r(R,ft)},[()=>x()("session.publish.public_session"),()=>x()("session.publish.qr_code"),()=>x()("session.publish.copy_link"),()=>x()("session.publish.remove_public")]),d(l,v)};h(S,l=>{o.campaign?.isPublished?l(B,!1):l(le)})}e(j),e(wt);var U=s(wt,2),Z=t(U),Ne=t(Z);Ne.__click=()=>k(Ce,"enemies");var re=t(Ne);ga(re,{size:14});var ne=s(re);e(Ne);var H=s(Ne,2);H.__click=()=>k(Ce,"encounters");var ze=t(H);La(ze,{size:14});var ie=s(ze);e(H),e(Z);var Pe=s(Z,2),dt=t(Pe);{var nt=l=>{var v=Ur(),b=Je(v);Ve(b,17,()=>a(Fe),w=>w.id,(w,C)=>{var ee=Ar(),W=t(ee),I=t(W);Gs(I,{size:12,class:"text-slate-600 cursor-grab"});var ae=s(I,2),me=t(ae),$e=t(me),E=s($e);{var K=N=>{da(N,{size:10,class:"text-indigo-400"})};h(E,N=>{a(C).global&&N(K)})}e(me);var g=s(me,2),se=t(g);e(g),e(ae),e(W);var O=s(W,2);O.__click=()=>rt(a(C));var L=t(O);ea(L,{size:16}),e(O),e(ee),_(N=>{r($e,`${a(C).name??""} `),r(se,`${N??""} ${a(C).difficulty??""}`)},[()=>x()("session.enemies.difficulty")]),ha("dragstart",ee,N=>Ee(N,a(C),"enemy")),d(w,ee)});var z=s(b,2);{var Y=w=>{var C=Tr(),ee=t(C,!0);e(C),_(W=>r(ee,W),[()=>x()("session.enemies.none")]),d(w,C)};h(z,w=>{a(Fe).length===0&&w(Y)})}d(l,v)},ct=l=>{var v=Lr(),b=Je(v);Ve(b,17,()=>a(A),w=>w.id,(w,C)=>{var ee=Pr(),W=t(ee),I=t(W),ae=t(I),me=s(ae);{var $e=O=>{da(O,{size:10,class:"text-indigo-400"})};h(me,O=>{a(C).global&&O($e)})}e(I);var E=s(I,2),K=t(E);e(E),e(W);var g=s(W,2);g.__click=()=>yt(a(C));var se=t(g);Ha(se,{size:14}),e(g),e(ee),_((O,L)=>{r(ae,`${a(C).name??""} `),r(K,`${O??""} ${L??""}`)},[()=>a(C).enemies?.reduce((O,L)=>O+L.count,0)||0,()=>x()("session.enemies.title")]),ha("dragstart",ee,O=>Ee(O,a(C),"encounter")),d(w,ee)});var z=s(b,2);{var Y=w=>{var C=Hr(),ee=t(C,!0);e(C),_(W=>r(ee,W),[()=>x()("session.enemies.no_encounters")]),d(w,C)};h(z,w=>{a(A).length===0&&w(Y)})}d(l,v)};h(dt,l=>{a(Ce)==="enemies"?l(nt):l(ct,!1)})}e(Pe),e(U),e(it);var Mt=s(it,2),$t=t(Mt),Bt=t($t),Lt=t(Bt);{var p=l=>{var v=Fr();v.__click=zt;var b=t(v);bs(b,{size:20});var z=s(b);e(v),_(Y=>r(z,` ${Y??""}`),[()=>x()("session.combat.start")]),d(l,v)},u=l=>{var v=qr(),b=t(v);b.__click=We;var z=t(b);Na(z,{size:20}),e(b);var Y=s(b,2),w=t(Y),C=t(w,!0);e(w);var ee=s(w),W=t(ee,!0);e(ee),e(Y);var I=s(Y,2);I.__click=X;var ae=t(I);Ms(ae,{size:16});var me=s(ae);e(I);var $e=s(I,4);$e.__click=()=>Ue();var E=t($e,!0);e($e),e(v),_((K,g,se,O,L)=>{be(b,"title",K),r(C,g),r(W,a(Ht).round),be(I,"title",se),r(me,` ${O??""}`),r(E,L)},[()=>x()("session.combat.previous"),()=>x()("session.combat.round"),()=>x()("session.combat.next"),()=>x()("session.combat.next"),()=>x()("session.combat.end")]),d(l,v)};h(Lt,l=>{a(Ht).active?l(u,!1):l(p)})}e(Bt),e($t);var f=s($t,2),m=t(f);Ve(m,25,()=>a(je),l=>l.type==="player"?l.id:l.instanceId,(l,v)=>{var b=Br(),z=t(b);yr(z,{get entity(){return a(v)},updateEnemy:pt,removeFromCombat:Ge,updatePlayer:ce}),e(b),zs(b,()=>wr,()=>({duration:300})),d(l,b)});var ue=s(m,2);{var Ae=l=>{var v=Jr(),b=t(v,!0);e(v),_(z=>r(b,z),[()=>x()("session.combat.empty")]),d(l,v)};h(ue,l=>{a(je).length===0&&l(Ae)})}e(f),e(Mt),va(2),e(qe);var Be=s(qe,2);{var Qe=l=>{var v=Qr();v.__click=O=>{O.target===O.currentTarget&&k(Oe,!1)};var b=t(v),z=t(b),Y=t(z),w=t(Y);Ss(w,{size:24}),e(Y);var C=s(Y,2),ee=t(C),W=t(ee,!0);e(ee);var I=s(ee,2),ae=t(I,!0);e(I),e(C),e(z);var me=s(z,2);Ve(me,21,()=>a(de),Ct,(O,L)=>{var N=Wr(),R=t(N),P=t(R);ga(P,{size:14,class:"text-slate-500"});var fe=s(P);e(R);var ye=s(R,2);Ve(ye,21,()=>a(L).effects,Ct,(ft,ht)=>{var It=Gr(),Ft=t(It),Gt=t(Ft);e(Ft);var Yt=s(Ft,2),aa=t(Yt,!0);e(Yt),e(It),_(()=>{r(Gt,`${a(ht).name??""}:`),r(aa,a(ht).desc)}),d(ft,It)}),e(ye),e(N),_(()=>r(fe,` ${a(L).name??""}`)),d(O,N)}),e(me);var $e=s(me,2),E=t($e);E.__click=()=>k(Oe,!1);var K=t(E,!0);e(E);var g=s(E,2);g.__click=_e;var se=t(g,!0);e(g),e($e),e(b),e(v),_((O,L,N,R)=>{r(W,O),r(ae,L),r(K,N),r(se,R)},[()=>x()("session.end_of_round.title"),()=>x()("session.end_of_round.summary"),()=>x()("common.buttons.cancel"),()=>x()("session.end_of_round.advance")]),d(l,v)};h(Be,l=>{a(Oe)&&l(Qe)})}var xt=s(Be,2);{var mt=l=>{var v=Xr();v.__click=g=>{g.target===g.currentTarget&&k(y,!1)};var b=t(v),z=t(b),Y=t(z),w=t(Y),C=t(w,!0);e(w);var ee=s(w,2),W=t(ee,!0);e(ee),e(Y);var I=s(Y,2);I.__click=()=>k(y,!1);var ae=t(I);ma(ae,{size:16}),e(I),e(z);var me=s(z,2),$e=t(me);Ve($e,17,()=>a(ut),Ct,(g,se)=>{var O=Vr();O.__click=()=>he(a(se).id);var L=t(O),N=t(L,!0);e(L);var R=s(L,2),P=t(R),fe=t(P,!0);e(P);var ye=s(P,2),ft=t(ye);e(ye),e(R);var ht=s(R,2),It=t(ht);ea(It,{size:16}),e(ht),e(O),_((Ft,Gt)=>{r(N,Ft),r(fe,a(se).name),r(ft,`${Gt??""} ${a(se).level??""} • ${a(se).ancestry??""}`)},[()=>a(se).name.charAt(0),()=>x()("common.labels.level")]),d(g,O)});var E=s($e,2);{var K=g=>{var se=Zr(),O=t(se),L=t(O);ga(L,{size:24}),e(O);var N=s(O,2),R=t(N,!0);e(N);var P=s(N,2),fe=t(P,!0);e(P),e(se),_((ye,ft)=>{r(R,ye),r(fe,ft)},[()=>x()("session.manage_session.no_available"),()=>x()("session.manage_session.all_in_session")]),d(g,se)};h(E,g=>{a(ut).length===0&&g(K)})}e(me),e(b),e(v),_((g,se)=>{r(C,g),r(W,se)},[()=>x()("session.manage_session.title"),()=>x()("session.manage_session.description")]),d(l,v)};h(xt,l=>{a(y)&&l(mt)})}var Nt=s(xt,2);{var Dt=l=>{var v=ri();v.__click=R=>{R.target===R.currentTarget&&k(te,!1)};var b=t(v),z=t(b),Y=t(z),w=t(Y);ga(w,{size:16});var C=s(w);e(Y);var ee=s(Y,2);ee.__click=()=>k(te,!1);var W=t(ee);ma(W,{size:18}),e(ee),e(z);var I=s(z,2),ae=t(I);ae.__click=()=>k(Ce,"enemies");var me=t(ae);ga(me,{size:14});var $e=s(me);e(ae);var E=s(ae,2);E.__click=()=>k(Ce,"encounters");var K=t(E);La(K,{size:14});var g=s(K);e(E),e(I);var se=s(I,2),O=t(se);{var L=R=>{var P=ei(),fe=Je(P);Ve(fe,17,()=>a(Fe),ht=>ht.id,(ht,It)=>{var Ft=Yr(),Gt=t(Ft),Yt=t(Gt),aa=t(Yt),za=s(aa);{var Zt=Xt=>{da(Xt,{size:10,class:"text-indigo-400"})};h(za,Xt=>{a(It).global&&Xt(Zt)})}e(Yt);var fa=s(Yt,2),$a=t(fa);e(fa),e(Gt);var la=s(Gt,2);la.__click=()=>{rt(a(It)),k(te,!1)};var Ca=t(la);ea(Ca,{size:16}),e(la),e(Ft),_(Xt=>{r(aa,`${a(It).name??""} `),r($a,`${Xt??""} ${a(It).difficulty??""}`)},[()=>x()("session.enemies.difficulty")]),d(ht,Ft)});var ye=s(fe,2);{var ft=ht=>{var It=Kr(),Ft=t(It,!0);e(It),_(Gt=>r(Ft,Gt),[()=>x()("session.enemies.none")]),d(ht,It)};h(ye,ht=>{a(Fe).length===0&&ht(ft)})}d(R,P)},N=R=>{var P=si(),fe=Je(P);Ve(fe,17,()=>a(A),ht=>ht.id,(ht,It)=>{var Ft=ti(),Gt=t(Ft),Yt=t(Gt),aa=t(Yt),za=s(aa);{var Zt=Xt=>{da(Xt,{size:10,class:"text-indigo-400"})};h(za,Xt=>{a(It).global&&Xt(Zt)})}e(Yt);var fa=s(Yt,2),$a=t(fa);e(fa),e(Gt);var la=s(Gt,2);la.__click=()=>{yt(a(It)),k(te,!1)};var Ca=t(la);Ha(Ca,{size:16}),e(la),e(Ft),_((Xt,Da)=>{r(aa,`${a(It).name??""} `),r($a,`${Xt??""} ${Da??""}`)},[()=>a(It).enemies?.reduce((Xt,Da)=>Xt+Da.count,0)||0,()=>x()("session.enemies.title")]),d(ht,Ft)});var ye=s(fe,2);{var ft=ht=>{var It=ai(),Ft=t(It,!0);e(It),_(Gt=>r(Ft,Gt),[()=>x()("session.enemies.no_encounters")]),d(ht,It)};h(ye,ht=>{a(A).length===0&&ht(ft)})}d(R,P)};h(O,R=>{a(Ce)==="enemies"?R(L):R(N,!1)})}e(se),e(b),e(v),_((R,P,fe)=>{r(C,` ${R??""}`),tt(ae,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(Ce)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r($e,` ${P??""}`),tt(E,1,`flex-1 text-xs font-bold py-2 rounded flex items-center justify-center gap-2 transition-colors ${a(Ce)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(g,` ${fe??""}`)},[()=>x()("session.enemies.title"),()=>x()("session.enemies.title"),()=>x()("session.enemies.encounters")]),d(l,v)};h(Nt,l=>{a(te)&&l(Dt)})}var Tt=s(Nt,2);Tt.__click=()=>k(te,!0);var Jt=t(Tt);ga(Jt,{size:24}),e(Tt);var Wt=s(Tt,2);rs(Wt,{get isOpen(){return G()},onClose:()=>ya.set(!1)});var Vt=s(Wt,2);Ka(Vt,{get isOpen(){return a(Te).isOpen},get title(){return a(Te).title},get message(){return a(Te).message},get onConfirm(){return a(Te).onConfirm},onCancel:()=>a(Te).isOpen=!1}),_((l,v,b,z)=>{r($,` ${l??""} `),r(Ye,v),tt(Ne,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(Ce)==="enemies"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(ne,` ${b??""}`),tt(H,1,`flex-1 text-xs font-bold py-1.5 rounded flex items-center justify-center gap-2 transition-colors ${a(Ce)==="encounters"?"bg-indigo-600 text-white":"text-slate-500 hover:text-white"}`),r(ie,` ${z??""}`)},[()=>x()("session.players.title"),()=>a(y)?x()("session.players.close"):x()("session.players.add"),()=>x()("session.enemies.title"),()=>x()("session.enemies.encounters")]),ha("dragover",Mt,Re),ha("drop",Mt,Le),d(Q,lt),ba(),i()}_a(["click"]);var oi=c('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),li=c('<div class="text-xs text-slate-500 italic mt-2 leading-relaxed opacity-75"> </div>'),di=c('<span class="text-slate-400"> </span>'),vi=c('<span class="text-slate-400"> </span>'),ci=c('<div class="text-sm mb-4"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span></div>'),ui=c('<div class="mb-3 text-sm"><span class="font-bold text-indigo-400"> </span> <span class="text-slate-300 ml-1"> </span></div>'),bi=c('<span class="text-slate-300"> </span>'),_i=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-400"> </span> <span class="text-white ml-1"> </span> <!></div>'),pi=c('<div class="mt-4"><h4 class="text-red-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),xi=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),mi=c('<div class="mt-4"><h4 class="text-orange-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),fi=c('<div class="mb-2 text-sm"><span class="font-bold text-white"> </span> <span class="text-slate-300 ml-1"> </span></div>'),gi=c('<div class="mt-4"><h4 class="text-yellow-500 font-bold text-xs uppercase mb-2 tracking-wider"> </h4> <!></div>'),hi=c('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl"><div class="flex items-start gap-3 mb-4"><!> <div class="flex-1 min-w-0"><div class="flex items-baseline gap-2"><h2 class="text-xl font-bold text-white font-serif tracking-wide"> </h2> <span class="text-red-500 font-bold text-sm"> </span></div> <div class="text-sm text-slate-400 mt-1"> </div> <!></div></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <span class="text-slate-500 font-bold ml-3"> </span> <span class="text-white ml-1"> </span></div> <div class="text-sm mb-3"><span class="text-white"><span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> <span class="text-slate-500 font-bold"> </span> </span></div> <div class="text-sm mb-3"><span class="text-slate-500 font-bold"> </span> <span class="text-white ml-1"> </span> <!></div> <!> <div class="border-t border-slate-700 my-4"></div> <!> <!> <!> <!></div>'),yi=c('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc-text" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc-text" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-desc" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div class="flex items-center gap-2 mt-4"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),wi=c('<div class="bg-slate-900 p-3 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),ki=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-perception" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-perception" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-speed-notes" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-speed-notes" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-senses" type="text" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[80px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div></div></div>'),zi=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),$i=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-2"><div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <select class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm"><option> </option><option> </option></select></div> <div class="grid grid-cols-2 gap-2"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/> <input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600"/></div> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Ci=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Oi=c('<div class="flex gap-2 items-start"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),ji=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="p-4 bg-slate-900 rounded border border-indigo-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-indigo-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-red-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-red-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-orange-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-orange-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div> <div class="p-4 bg-slate-900 rounded border border-yellow-500/30"><div class="mb-3"><h4 class="font-bold text-sm uppercase text-yellow-400"> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div></div>'),Ei=c('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),Mi=c('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" aria-label="Close" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-start justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function Si(Q,o){ua(o,!0);const n=()=>qt(ta,"$t",oe),[oe,J]=pa(),x=A=>{var M=hi(),he=t(M),De=t(he);{var vt=u=>{var f=oi(),m=t(f);ja(m,{get hash(){return a(i).imageUrl},get alt(){return a(i).name},size:"custom"}),e(f),d(u,f)};h(De,u=>{a(i).imageUrl&&u(vt)})}var Ot=s(De,2),rt=t(Ot),yt=t(rt),zt=t(yt,!0);e(yt);var X=s(yt,2),_e=t(X);e(X),e(rt);var Ue=s(rt,2),Ge=t(Ue);e(Ue);var pt=s(Ue,2);{var We=u=>{var f=li(),m=t(f,!0);e(f),_(()=>r(m,a(i).description)),d(u,f)};h(pt,u=>{a(i).description&&u(We)})}e(Ot),e(he);var ve=s(he,2),je=t(ve),F=t(je,!0);e(je);var ce=s(je,2),Ee=t(ce);e(ce);var Re=s(ce,2);{var Le=u=>{var f=di(),m=t(f);e(f),_(()=>r(m,`; ${a(i).senses??""}`)),d(u,f)};h(Re,u=>{a(i).senses&&u(Le)})}e(ve);var lt=s(ve,2),qe=t(lt),it=t(qe,!0);e(qe);var wt=s(qe,2),Ut=t(wt,!0);e(wt);var St=s(wt,2),Pt=t(St,!0);e(St);var $=s(St,2),q=t($,!0);e($),e(lt);var D=s(lt,2),Me=t(D),Ye=t(Me),Ke=t(Ye,!0);e(Ye);var st=s(Ye),gt=s(st),jt=t(gt,!0);e(gt);var Et=s(gt),et=s(Et),T=t(et,!0);e(et);var j=s(et),S=s(j),le=t(S,!0);e(S);var B=s(S);e(Me),e(D);var U=s(D,2),Z=t(U),Ne=t(Z,!0);e(Z);var re=s(Z,2),ne=t(re,!0);e(re);var H=s(re,2);{var ze=u=>{var f=vi(),m=t(f);e(f),_(()=>r(m,`; ${a(i).speedNotes??""}`)),d(u,f)};h(H,u=>{a(i).speedNotes&&u(ze)})}e(U);var ie=s(U,2);{var Pe=u=>{var f=ci(),m=t(f),ue=t(m,!0);e(m);var Ae=s(m,2),Be=t(Ae,!0);e(Ae),e(f),_(Qe=>{r(ue,Qe),r(Be,a(i).immunities)},[()=>n()("session.enemy_modal.immunities")]),d(u,f)};h(ie,u=>{a(i).immunities&&u(Pe)})}var dt=s(ie,4);{var nt=u=>{var f=At(),m=Je(f);Ve(m,17,()=>a(i).traits,Ct,(ue,Ae)=>{var Be=ui(),Qe=t(Be),xt=t(Qe,!0);e(Qe);var mt=s(Qe,2),Nt=t(mt,!0);e(mt),e(Be),_(()=>{r(xt,a(Ae).name),r(Nt,a(Ae).desc)}),d(ue,Be)}),d(u,f)};h(dt,u=>{a(i).traits.length>0&&u(nt)})}var ct=s(dt,2);{var Mt=u=>{var f=pi(),m=t(f),ue=t(m,!0);e(m);var Ae=s(m,2);Ve(Ae,17,()=>a(i).attackOptions,Ct,(Be,Qe)=>{var xt=_i(),mt=t(xt),Nt=t(mt,!0);e(mt);var Dt=s(mt,2),Tt=t(Dt);e(Dt);var Jt=s(Dt,2),Wt=t(Jt);e(Jt);var Vt=s(Jt,2);{var l=v=>{var b=bi(),z=t(b);e(b),_(()=>r(z,`; ${a(Qe).desc??""}`)),d(v,b)};h(Vt,v=>{a(Qe).desc&&v(l)})}e(xt),_(v=>{r(Nt,a(Qe).name),r(Tt,`(${v??""})`),r(Wt,`${a(Qe).attackRoll??""} (${a(Qe).damage??""})`)},[()=>a(Qe).type==="melee"?n()("session.enemy_modal.melee").toLowerCase():n()("session.enemy_modal.ranged").toLowerCase()]),d(Be,xt)}),e(f),_(Be=>r(ue,Be),[()=>n()("session.enemy_modal.attack_options")]),d(u,f)};h(ct,u=>{a(i).attackOptions.length>0&&u(Mt)})}var $t=s(ct,2);{var Bt=u=>{var f=mi(),m=t(f),ue=t(m,!0);e(m);var Ae=s(m,2);Ve(Ae,17,()=>a(i).specialAttacks,Ct,(Be,Qe)=>{var xt=xi(),mt=t(xt),Nt=t(mt,!0);e(mt);var Dt=s(mt,2),Tt=t(Dt,!0);e(Dt),e(xt),_(()=>{r(Nt,a(Qe).name),r(Tt,a(Qe).desc)}),d(Be,xt)}),e(f),_(Be=>r(ue,Be),[()=>n()("session.enemy_modal.special_attacks")]),d(u,f)};h($t,u=>{a(i).specialAttacks.length>0&&u(Bt)})}var Lt=s($t,2);{var p=u=>{var f=gi(),m=t(f),ue=t(m,!0);e(m);var Ae=s(m,2);Ve(Ae,17,()=>a(i).endOfRound,Ct,(Be,Qe)=>{var xt=fi(),mt=t(xt),Nt=t(mt,!0);e(mt);var Dt=s(mt,2),Tt=t(Dt,!0);e(Dt),e(xt),_(()=>{r(Nt,a(Qe).name),r(Tt,a(Qe).desc)}),d(Be,xt)}),e(f),_(Be=>r(ue,Be),[()=>n()("session.enemy_modal.end_of_round")]),d(u,f)};h(Lt,u=>{a(i).endOfRound.length>0&&u(p)})}e(M),_((u,f,m,ue,Ae,Be,Qe,xt,mt,Nt,Dt,Tt,Jt,Wt,Vt,l,v)=>{r(zt,u),r(_e,`${f??""} ${a(i).difficulty??""}`),r(Ge,`${m??""} ${ue??""} ${a(i).descriptors??""}`),r(F,Ae),r(Ee,`${a(i).perception??""} (${Be??""})`),r(it,Qe),r(Ut,a(i).defense),r(Pt,xt),r(q,a(i).health),r(Ke,mt),r(st,` ${a(i).attributes.strength??""} (${Nt??""}), `),r(jt,Dt),r(Et,` ${a(i).attributes.agility??""} (${Tt??""}), `),r(T,Jt),r(j,` ${a(i).attributes.intellect??""} (${Wt??""}), `),r(le,Vt),r(B,` ${a(i).attributes.will??""} (${l??""})`),r(Ne,v),r(ne,a(i).speed)},[()=>a(i).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemies.difficulty").toUpperCase(),()=>n()("session.enemy_modal.size"),()=>Te(a(i).size),()=>n()("sofdl.attributes.perception"),()=>de(a(i).perception),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("sofdl.attributes.strength"),()=>de(a(i).attributes.strength),()=>n()("sofdl.attributes.agility"),()=>de(a(i).attributes.agility),()=>n()("sofdl.attributes.intellect"),()=>de(a(i).attributes.intellect),()=>n()("sofdl.attributes.will"),()=>de(a(i).attributes.will),()=>n()("session.enemy_modal.speed")]),d(A,M)};let G=Kt(o,"isOpen",3,!1),V=Kt(o,"initialData",3,"{}"),i=_t(ca(Oe())),y=_t("general"),te=_t(!1),He=_t(""),we=_t(void 0);function Ze(A){const M=A.target.files;if(M&&M.length>0){const he=M[0],De=new FileReader;De.onload=()=>{k(He,De.result,!0),k(te,!0)},De.readAsDataURL(he)}A.target&&(A.target.value="")}async function Ce(A){try{const M=await ns(A);a(i).imageUrl=M,k(te,!1)}catch(M){console.error(M),alert(M.message||"Erro ao salvar imagem")}}function Oe(){return{name:"",difficulty:1,size:1,description:"",descriptors:"",perception:10,senses:"",defense:10,health:10,attributes:{strength:10,agility:10,intellect:10,will:10},speed:10,speedNotes:"",immunities:"",traits:[],attackOptions:[],specialAttacks:[],endOfRound:[],imageUrl:"",global:!1}}function de(A){const M=A-10;return M>=0?`+${M}`:`${M}`}function Te(A){return A===.125?"1/8":A===.5?"1/2":A}Ra(()=>{if(G()&&V())try{const A=JSON.parse(V());Object.keys(A).length===0?k(i,Oe(),!0):k(i,{...Oe(),...A},!0)}catch{k(i,Oe(),!0)}});function ge(){a(i).traits=[...a(i).traits,{name:"",desc:""}]}function Rt(A){a(i).traits=a(i).traits.filter((M,he)=>he!==A)}function kt(){a(i).attackOptions=[...a(i).attackOptions,{name:"",type:"melee",attackRoll:"+0",damage:"1d6",desc:""}]}function Ht(A){a(i).attackOptions=a(i).attackOptions.filter((M,he)=>he!==A)}function ke(){a(i).specialAttacks=[...a(i).specialAttacks,{name:"",desc:""}]}function Ie(A){a(i).specialAttacks=a(i).specialAttacks.filter((M,he)=>he!==A)}function Xe(){a(i).endOfRound=[...a(i).endOfRound,{name:"",desc:""}]}function at(A){a(i).endOfRound=a(i).endOfRound.filter((M,he)=>he!==A)}function xe(A){}var Se=At(),ut=Je(Se);{var Fe=A=>{var M=Mi(),he=Je(M);he.__click=xe;var De=t(he),vt=t(De),Ot=t(vt),rt=t(Ot),yt=t(rt);yt.__click=function(...et){o.onClose?.apply(this,et)};var zt=t(yt);Na(zt,{size:24}),e(yt);var X=s(yt,2),_e=t(X,!0);e(X),e(rt);var Ue=s(rt,2);Ue.__click=function(...et){o.onClose?.apply(this,et)};var Ge=t(Ue);ma(Ge,{size:20}),e(Ue),e(Ot);var pt=s(Ot,2),We=t(pt);We.__click=()=>k(y,"general");var ve=t(We,!0);e(We);var je=s(We,2);je.__click=()=>k(y,"stats");var F=t(je,!0);e(je);var ce=s(je,2);ce.__click=()=>k(y,"abilities");var Ee=t(ce,!0);e(ce);var Re=s(ce,2);Re.__click=()=>k(y,"preview");var Le=t(Re,!0);e(Re),e(pt);var lt=s(pt,2),qe=t(lt);{var it=et=>{var T=yi(),j=t(T),S=t(j);S.__click=()=>a(we)?.click();var le=t(S),B=t(le);Ba(B,()=>a(i).imageUrl,m=>{ja(m,{get hash(){return a(i).imageUrl},get alt(){return a(i).name},size:"custom",fallbackText:"?"})}),e(le);var U=s(le,2),Z=t(U);os(Z,{size:20,class:"text-white"}),e(U),e(S);var Ne=s(S,2),re=t(Ne),ne=t(re,!0);e(re);var H=s(re,2);bt(H),e(Ne),e(j);var ze=s(j,2),ie=t(ze),Pe=t(ie,!0);e(ie);var dt=s(ie,2);xa(dt),e(ze);var nt=s(ze,2),ct=t(nt),Mt=t(ct,!0);e(ct);var $t=s(ct,2);bt($t),e(nt);var Bt=s(nt,2),Lt=t(Bt);bt(Lt);var p=s(Lt,2),u=t(p);da(u,{size:14});var f=s(u);e(p),e(Bt),e(T),_((m,ue,Ae,Be,Qe,xt)=>{r(ne,m),r(Pe,ue),be(dt,"placeholder",Ae),r(Mt,Be),be($t,"placeholder",Qe),r(f,` ${xt??""}`)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.descriptors"),()=>n()("session.enemy_modal.descriptors_placeholder"),()=>n()("session.enemy_modal.global_enemy")]),ot(H,()=>a(i).name,m=>a(i).name=m),ot(dt,()=>a(i).description,m=>a(i).description=m),ot($t,()=>a(i).descriptors,m=>a(i).descriptors=m),Ya(Lt,()=>a(i).global,m=>a(i).global=m),d(et,T)},wt=et=>{var T=At(),j=Je(T);{var S=B=>{var U=ki(),Z=t(U),Ne=t(Z),re=t(Ne),ne=t(re,!0);e(re);var H=s(re,2);bt(H),e(Ne);var ze=s(Ne,2),ie=t(ze),Pe=t(ie,!0);e(ie);var dt=s(ie,2);{let E=pe(()=>a(i).size||1);ls(dt,{get value(){return a(E)},onUpdate:K=>a(i).size=K})}e(ze),e(Z);var nt=s(Z,2),ct=t(nt),Mt=t(ct),$t=t(Mt,!0);e(Mt);var Bt=s(Mt,2);bt(Bt),e(ct);var Lt=s(ct,2),p=t(Lt),u=t(p,!0);e(p);var f=s(p,2);bt(f),e(Lt),e(nt);var m=s(nt,2),ue=t(m),Ae=t(ue),Be=t(Ae,!0);e(Ae);var Qe=s(Ae,2);bt(Qe),e(ue);var xt=s(ue,2),mt=t(xt),Nt=t(mt,!0);e(mt);var Dt=s(mt,2);bt(Dt),e(xt),e(m);var Tt=s(m,2),Jt=t(Tt),Wt=t(Jt,!0);e(Jt);var Vt=s(Jt,2);Ve(Vt,5,()=>[{key:"strength",label:n()("sofdl.attributes.strength")},{key:"agility",label:n()("sofdl.attributes.agility")},{key:"intellect",label:n()("sofdl.attributes.intellect")},{key:"will",label:n()("sofdl.attributes.will")}],Ct,(E,K)=>{var g=wi(),se=t(g),O=t(se,!0);e(se);var L=s(se,2);bt(L);var N=s(L,2),R=t(N,!0);e(N),e(g),_((P,fe)=>{be(se,"for",`attr-${a(K).key??""}`),be(se,"title",a(K).label),r(O,P),be(L,"id",`attr-${a(K).key??""}`),tt(N,1,`text-xs font-bold ${a(i).attributes[a(K).key]-10>=0?"text-green-500":"text-red-500"}`),r(R,fe)},[()=>a(K).label.substring(0,3),()=>de(a(i).attributes[a(K).key])]),ot(L,()=>a(i).attributes[a(K).key],P=>a(i).attributes[a(K).key]=P),d(E,g)}),e(Vt),e(Tt);var l=s(Tt,2),v=t(l),b=t(v),z=t(b,!0);e(b);var Y=s(b,2);bt(Y),e(v);var w=s(v,2),C=t(w),ee=t(C,!0);e(C);var W=s(C,2);bt(W),e(w);var I=s(w,2),ae=t(I),me=t(ae,!0);e(ae);var $e=s(ae,2);xa($e),e(I),e(l),e(U),_((E,K,g,se,O,L,N,R,P,fe,ye,ft,ht)=>{r(ne,E),r(Pe,K),r($t,g),r(u,se),r(Be,O),r(Nt,L),r(Wt,N),r(z,R),be(Y,"placeholder",P),r(ee,fe),be(W,"placeholder",ye),r(me,ft),be($e,"placeholder",ht)},[()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.defense"),()=>n()("sofdl.attributes.perception"),()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.speed_notes"),()=>n()("session.enemy_modal.speed_notes_placeholder"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder_sotdl"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder_sotdl")]),ot(H,()=>a(i).difficulty,E=>a(i).difficulty=E),ot(Bt,()=>a(i).speed,E=>a(i).speed=E),ot(f,()=>a(i).health,E=>a(i).health=E),ot(Qe,()=>a(i).defense,E=>a(i).defense=E),ot(Dt,()=>a(i).perception,E=>a(i).perception=E),ot(Y,()=>a(i).speedNotes,E=>a(i).speedNotes=E),ot(W,()=>a(i).senses,E=>a(i).senses=E),ot($e,()=>a(i).immunities,E=>a(i).immunities=E),d(B,U)},le=B=>{var U=At(),Z=Je(U);{var Ne=ne=>{var H=ji(),ze=t(H),ie=t(ze),Pe=t(ie),dt=t(Pe,!0);e(Pe),e(ie);var nt=s(ie,2),ct=t(nt);Ve(ct,17,()=>a(i).traits,Ct,(K,g,se)=>{var O=zi(),L=t(O),N=t(L);bt(N);var R=s(N,2);xa(R),e(L);var P=s(L,2);P.__click=()=>Rt(se);var fe=t(P);sa(fe,{size:16}),e(P),e(O),_((ye,ft)=>{be(N,"placeholder",ye),be(R,"placeholder",ft)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),ot(N,()=>a(g).name,ye=>a(g).name=ye),ot(R,()=>a(g).desc,ye=>a(g).desc=ye),d(K,O)});var Mt=s(ct,2);Mt.__click=ge;var $t=t(Mt),Bt=t($t);ea(Bt,{size:16}),e($t);var Lt=s($t);e(Mt),e(nt),e(ze);var p=s(ze,2),u=t(p),f=t(u),m=t(f,!0);e(f),e(u);var ue=s(u,2),Ae=t(ue);Ve(Ae,17,()=>a(i).attackOptions,Ct,(K,g,se)=>{var O=$i(),L=t(O),N=t(L),R=t(N);bt(R);var P=s(R,2),fe=t(P),ye=t(fe,!0);e(fe),fe.value=fe.__value="melee";var ft=s(fe),ht=t(ft,!0);e(ft),ft.value=ft.__value="ranged",e(P),e(N);var It=s(N,2),Ft=t(It);bt(Ft);var Gt=s(Ft,2);bt(Gt),e(It);var Yt=s(It,2);xa(Yt),e(L);var aa=s(L,2);aa.__click=()=>Ht(se);var za=t(aa);sa(za,{size:16}),e(aa),e(O),_((Zt,fa,$a,la,Ca,Xt)=>{be(R,"placeholder",Zt),r(ye,fa),r(ht,$a),be(Ft,"placeholder",la),be(Gt,"placeholder",Ca),be(Yt,"placeholder",Xt)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.melee"),()=>n()("session.enemy_modal.ranged"),()=>n()("session.enemy_modal.attack_placeholder"),()=>n()("session.enemy_modal.damage_placeholder"),()=>n()("session.enemy_modal.desc_effects_placeholder")]),ot(R,()=>a(g).name,Zt=>a(g).name=Zt),ps(P,()=>a(g).type,Zt=>a(g).type=Zt),ot(Ft,()=>a(g).attackRoll,Zt=>a(g).attackRoll=Zt),ot(Gt,()=>a(g).damage,Zt=>a(g).damage=Zt),ot(Yt,()=>a(g).desc,Zt=>a(g).desc=Zt),d(K,O)});var Be=s(Ae,2);Be.__click=kt;var Qe=t(Be),xt=t(Qe);ea(xt,{size:16}),e(Qe);var mt=s(Qe);e(Be),e(ue),e(p);var Nt=s(p,2),Dt=t(Nt),Tt=t(Dt),Jt=t(Tt,!0);e(Tt),e(Dt);var Wt=s(Dt,2),Vt=t(Wt);Ve(Vt,17,()=>a(i).specialAttacks,Ct,(K,g,se)=>{var O=Ci(),L=t(O),N=t(L);bt(N);var R=s(N,2);xa(R),e(L);var P=s(L,2);P.__click=()=>Ie(se);var fe=t(P);sa(fe,{size:16}),e(P),e(O),_((ye,ft)=>{be(N,"placeholder",ye),be(R,"placeholder",ft)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),ot(N,()=>a(g).name,ye=>a(g).name=ye),ot(R,()=>a(g).desc,ye=>a(g).desc=ye),d(K,O)});var l=s(Vt,2);l.__click=ke;var v=t(l),b=t(v);ea(b,{size:16}),e(v);var z=s(v);e(l),e(Wt),e(Nt);var Y=s(Nt,2),w=t(Y),C=t(w),ee=t(C,!0);e(C),e(w);var W=s(w,2),I=t(W);Ve(I,17,()=>a(i).endOfRound,Ct,(K,g,se)=>{var O=Oi(),L=t(O),N=t(L);bt(N);var R=s(N,2);xa(R),e(L);var P=s(L,2);P.__click=()=>at(se);var fe=t(P);sa(fe,{size:16}),e(P),e(O),_((ye,ft)=>{be(N,"placeholder",ye),be(R,"placeholder",ft)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),ot(N,()=>a(g).name,ye=>a(g).name=ye),ot(R,()=>a(g).desc,ye=>a(g).desc=ye),d(K,O)});var ae=s(I,2);ae.__click=Xe;var me=t(ae),$e=t(me);ea($e,{size:16}),e(me);var E=s(me);e(ae),e(W),e(Y),e(H),_((K,g,se,O,L,N,R,P)=>{r(dt,K),r(Lt,` ${g??""}`),r(m,se),r(mt,` ${O??""}`),r(Jt,L),r(z,` ${N??""}`),r(ee,R),r(E,` ${P??""}`)},[()=>n()("session.enemy_modal.traits"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.attack_options"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.special_attacks"),()=>n()("common.buttons.add"),()=>n()("session.enemy_modal.end_of_round"),()=>n()("common.buttons.add")]),d(ne,H)},re=ne=>{var H=At(),ze=Je(H);{var ie=Pe=>{var dt=Ei(),nt=t(dt);x(nt),e(dt),d(Pe,dt)};h(ze,Pe=>{a(y)==="preview"&&Pe(ie)},!0)}d(ne,H)};h(Z,ne=>{a(y)==="abilities"?ne(Ne):ne(re,!1)},!0)}d(B,U)};h(j,B=>{a(y)==="stats"?B(S):B(le,!1)},!0)}d(et,T)};h(qe,et=>{a(y)==="general"?et(it):et(wt,!1)})}e(lt);var Ut=s(lt,2),St=t(Ut);St.__click=()=>o.onSave(a(i));var Pt=t(St);Ja(Pt,{size:18});var $=s(Pt);e(St),e(Ut),e(vt);var q=s(vt,2),D=t(q),Me=t(D),Ye=t(Me);qa(Ye,{size:14});var Ke=s(Ye);e(Me),e(D);var st=s(D,2),gt=t(st);x(gt),e(st),e(q),e(De),e(he);var jt=s(he,2);jt.__change=Ze,cs(jt,et=>k(we,et),()=>a(we));var Et=s(jt,2);is(Et,{get isOpen(){return a(te)},get imageUrl(){return a(He)},onClose:()=>k(te,!1),onCrop:Ce}),_((et,T,j,S,le,B,U)=>{r(_e,et),tt(We,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(ve,T),tt(je,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(F,j),tt(ce,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(Ee,S),tt(Re,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(Le,le),r($,` ${B??""}`),r(Ke,` ${U??""}`)},[()=>n()("session.enemy_modal.title"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_stats"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("session.enemy_modal.preview"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview")]),Sa(3,De,()=>Ia,()=>({y:20,duration:300})),Sa(3,he,()=>Ia,()=>({duration:200,opacity:1})),d(A,M)};h(ut,A=>{G()&&A(Fe)})}d(Q,Se),ba(),J()}_a(["click","change"]);var Ii=c('<div class="w-16 h-16 rounded-lg overflow-hidden border border-slate-700 shadow-lg flex-shrink-0"><!></div>'),Ri=c('<div class="bg-slate-950 p-2 rounded border border-slate-800"><div class="text-[10px] text-slate-500 uppercase font-bold mb-1"> </div> <div class="text-white font-bold"> <span> </span></div></div>'),Ni=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Di=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Ai=c('<div class="flex gap-2"><span class="font-bold text-slate-500 uppercase"> </span> <span class="text-white"> </span></div>'),Ti=c('<div class="mb-2 pl-3 border-l-2 border-indigo-900"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Ui=c('<div><h4 class="font-bold text-indigo-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Pi=c('<div class="mb-2 pl-3 border-l-2 border-red-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Hi=c('<div><h4 class="font-bold text-red-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Li=c('<div class="mb-2 pl-3 border-l-2 border-orange-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Fi=c('<div><h4 class="font-bold text-orange-400 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),qi=c('<div class="mb-2 pl-3 border-l-2 border-yellow-900/50"><span class="font-bold text-white"> </span> <span class="text-slate-300"> </span></div>'),Bi=c('<div><h4 class="font-bold text-yellow-500 uppercase text-xs mb-2 tracking-wider"> </h4> <!></div>'),Ji=c('<div class="w-full max-w-md bg-slate-900 border border-slate-700 rounded-xl p-5 shadow-2xl relative"><div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg border border-red-400"> </div> <div class="flex items-center gap-3 mb-4"><!> <div class="flex-1 min-w-0"><h2 class="text-2xl font-bold text-white mb-1 font-serif tracking-wide truncate"> </h2> <div class="h-1 w-20 bg-red-600 rounded-full"></div></div></div> <div class="grid grid-cols-2 gap-4 mb-4 text-sm"><div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold text-lg"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div> <div class="bg-slate-950 p-2 rounded border border-slate-800 flex justify-between items-center"><span class="text-slate-500 uppercase font-bold text-[10px]"> </span> <span class="text-white font-mono font-bold"> </span></div></div> <div class="grid grid-cols-4 gap-2 mb-6 text-center font-mono text-slate-300"></div> <div class="mb-6 space-y-2 text-xs"><!> <!> <!></div> <div class="space-y-5 text-sm"><!> <!> <!> <!></div></div>'),Gi=c('<div class="space-y-4 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="flex items-center gap-4"><div class="relative group cursor-pointer"><div class="w-16 h-16 rounded-xl overflow-hidden border border-slate-700"><!></div> <div class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"><!></div></div> <div class="flex-1"><label for="enemy-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="enemy-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white font-bold text-lg"/></div></div> <div><label for="enemy-desc" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <textarea id="enemy-desc" class="w-full bg-slate-900 border border-slate-700 rounded p-3 text-white text-sm min-h-[100px] resize-none focus:border-indigo-500 focus:outline-none transition-colors"></textarea></div> <div class="flex items-center gap-2"><input id="enemy-global" type="checkbox" class="w-4 h-4 bg-slate-900 border-slate-700 rounded focus:ring-indigo-500"/> <label for="enemy-global" class="text-sm font-bold text-slate-400 select-none cursor-pointer flex items-center gap-2"><!> </label></div></div>'),Wi=c('<div class="bg-slate-900 p-2 rounded border border-slate-700 text-center"><label class="text-[10px] text-slate-500 uppercase font-bold block mb-1 text-ellipsis overflow-hidden whitespace-nowrap"> </label> <input type="number" class="w-full bg-transparent text-center font-bold text-white text-xl focus:outline-none mb-1"/> <div> </div></div>'),Qi=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"><div class="grid grid-cols-2 gap-4"><div><label for="enemy-diff" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-diff" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div class="flex flex-col"><label for="enemy-size" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <!></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-defense" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-defense" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-health" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-health" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div class="grid grid-cols-2 gap-4"><div><label for="enemy-damage" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-damage" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div> <div><label for="enemy-speed" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-speed" type="number" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white"/></div></div> <div><h4 class="text-indigo-400 font-bold text-sm uppercase mb-3 text-center border-b border-indigo-500/20 pb-2"> </h4> <div class="grid grid-cols-4 gap-3"></div></div> <div class="space-y-3 pt-4 border-t border-slate-800"><div><label for="enemy-senses" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-senses" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-langs" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-langs" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div> <div><label for="enemy-immune" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label><input id="enemy-immune" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white text-sm"/></div></div></div>'),Vi=c('<div class="flex gap-2 items-start animate-in fade-in slide-in-from-left-2"><div class="flex-1 space-y-1"><input class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm font-bold placeholder-slate-600 focus:border-indigo-500 focus:outline-none"/> <textarea class="w-full bg-slate-950 border border-slate-700 rounded p-2 text-white text-sm placeholder-slate-600 resize-none focus:border-indigo-500 focus:outline-none" rows="2"></textarea></div> <button class="mt-1 text-slate-600 hover:text-red-400 p-2 hover:bg-slate-800 rounded"><!></button></div>'),Zi=c('<div><div class="mb-3"><h4> </h4></div> <div class="space-y-3"><!> <button class="w-full py-3 border-2 border-dashed border-slate-700 rounded hover:border-slate-500 hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-slate-500 hover:text-white font-bold text-sm group"><div class="p-1 rounded-full bg-slate-800 group-hover:bg-slate-700 transition-colors"><!></div> </button></div></div>'),Xi=c('<div class="space-y-6 animate-in fade-in slide-in-from-bottom-2 duration-300"></div>'),Yi=c('<div class="flex-1 flex items-start justify-center p-4 min-h-0 animate-in fade-in slide-in-from-right-2 duration-300"><!></div>'),Ki=c('<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 lg:p-4" role="button" tabindex="-1"><div class="bg-slate-900 w-full h-full lg:rounded-xl lg:max-w-6xl lg:h-[90vh] border-0 lg:border border-slate-700 shadow-2xl overflow-hidden flex flex-col lg:flex-row" role="dialog" aria-modal="true" aria-labelledby="modal-title"><div class="w-full lg:w-1/2 flex flex-col h-full border-r border-slate-700"><div class="p-4 border-b border-slate-700 bg-slate-900 flex justify-between items-center"><div class="flex items-center gap-3"><button class="lg:hidden text-slate-400 hover:text-white p-1 rounded-full hover:bg-slate-800 transition-colors"><!></button> <h3 id="modal-title" class="font-bold text-white text-lg"> </h3></div> <button class="hidden lg:block text-slate-400 hover:text-white"><!></button></div> <div class="flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto"><button> </button> <button> </button> <button> </button> <button> </button></div> <div class="flex-1 overflow-y-auto p-6 custom-scrollbar bg-slate-800/50"><!></div> <div class="p-4 border-t border-slate-700 bg-slate-900 flex justify-end gap-3 safe-area-bottom"><button class="px-6 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-white font-bold flex items-center gap-2 transition-colors"><!> </button></div></div> <div class="hidden lg:flex w-1/2 bg-slate-950 flex-col border-l border-slate-800"><div class="p-4 border-b border-slate-800 bg-slate-950"><h3 class="font-bold text-slate-500 text-xs uppercase flex items-center gap-2"><!> </h3></div> <div class="flex-1 p-8 overflow-y-auto flex items-center justify-center bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-slate-900 via-slate-950 to-slate-950"><!></div></div></div></div> <input type="file" hidden="" accept="image/*"/> <!>',1);function en(Q,o){ua(o,!0);const n=()=>qt(ta,"$t",oe),[oe,J]=pa(),x=ke=>{var Ie=Ji(),Xe=t(Ie),at=t(Xe);e(Xe);var xe=s(Xe,2),Se=t(xe);{var ut=T=>{var j=Ii(),S=t(j);ja(S,{get hash(){return a(i).imageUrl},get alt(){return a(i).name},size:"custom"}),e(j),d(T,j)};h(Se,T=>{a(i).imageUrl&&T(ut)})}var Fe=s(Se,2),A=t(Fe),M=t(A,!0);e(A),va(2),e(Fe),e(xe);var he=s(xe,2),De=t(he),vt=t(De),Ot=t(vt,!0);e(vt);var rt=s(vt,2),yt=t(rt,!0);e(rt),e(De);var zt=s(De,2),X=t(zt),_e=t(X,!0);e(X);var Ue=s(X,2),Ge=t(Ue,!0);e(Ue),e(zt);var pt=s(zt,2),We=t(pt),ve=t(We,!0);e(We);var je=s(We,2),F=t(je,!0);e(je),e(pt);var ce=s(pt,2),Ee=t(ce),Re=t(Ee,!0);e(Ee);var Le=s(Ee,2),lt=t(Le,!0);e(Le),e(ce),e(he);var qe=s(he,2);Ve(qe,20,()=>["str","agi","int","wil"],Ct,(T,j)=>{var S=Ri(),le=t(S),B=t(le,!0);e(le);var U=s(le,2),Z=t(U),Ne=s(Z),re=t(Ne);e(Ne),e(U),e(S),_(()=>{r(B,j),r(Z,`${a(i).stats[j]??""} `),tt(Ne,1,`text-xs ${a(i).stats[j]-10>=0?"text-green-500":"text-red-500"}`),r(re,`(${a(i).stats[j]-10>=0?"+":""}${a(i).stats[j]-10})`)}),d(T,S)}),e(qe);var it=s(qe,2),wt=t(it);{var Ut=T=>{var j=Ni(),S=t(j),le=t(S);e(S);var B=s(S,2),U=t(B,!0);e(B),e(j),_(Z=>{r(le,`${Z??""}:`),r(U,a(i).senses)},[()=>n()("session.enemy_modal.senses")]),d(T,j)};h(wt,T=>{a(i).senses&&T(Ut)})}var St=s(wt,2);{var Pt=T=>{var j=Di(),S=t(j),le=t(S);e(S);var B=s(S,2),U=t(B,!0);e(B),e(j),_(Z=>{r(le,`${Z??""}:`),r(U,a(i).languages)},[()=>n()("session.enemy_modal.languages")]),d(T,j)};h(St,T=>{a(i).languages&&T(Pt)})}var $=s(St,2);{var q=T=>{var j=Ai(),S=t(j),le=t(S);e(S);var B=s(S,2),U=t(B,!0);e(B),e(j),_(Z=>{r(le,`${Z??""}:`),r(U,a(i).immune)},[()=>n()("session.enemy_modal.immunities")]),d(T,j)};h($,T=>{a(i).immune&&T(q)})}e(it);var D=s(it,2),Me=t(D);{var Ye=T=>{var j=Ui(),S=t(j),le=t(S,!0);e(S);var B=s(S,2);Ve(B,17,()=>a(i).traits,Ct,(U,Z,Ne,re)=>{var ne=Ti(),H=t(ne),ze=t(H);e(H);var ie=s(H,2),Pe=t(ie,!0);e(ie),e(ne),_(()=>{r(ze,`${a(Z).name??""}:`),r(Pe,a(Z).desc)}),d(U,ne)}),e(j),_(U=>r(le,U),[()=>n()("session.enemy_modal.traits")]),d(T,j)};h(Me,T=>{a(i).traits.length>0&&T(Ye)})}var Ke=s(Me,2);{var st=T=>{var j=Hi(),S=t(j),le=t(S,!0);e(S);var B=s(S,2);Ve(B,17,()=>a(i).actions,Ct,(U,Z,Ne,re)=>{var ne=Pi(),H=t(ne),ze=t(H);e(H);var ie=s(H,2),Pe=t(ie,!0);e(ie),e(ne),_(()=>{r(ze,`${a(Z).name??""}:`),r(Pe,a(Z).desc)}),d(U,ne)}),e(j),_(U=>r(le,U),[()=>n()("session.enemy_modal.actions")]),d(T,j)};h(Ke,T=>{a(i).actions.length>0&&T(st)})}var gt=s(Ke,2);{var jt=T=>{var j=Fi(),S=t(j),le=t(S,!0);e(S);var B=s(S,2);Ve(B,17,()=>a(i).reactions,Ct,(U,Z,Ne,re)=>{var ne=Li(),H=t(ne),ze=t(H);e(H);var ie=s(H,2),Pe=t(ie,!0);e(ie),e(ne),_(()=>{r(ze,`${a(Z).name??""}:`),r(Pe,a(Z).desc)}),d(U,ne)}),e(j),_(U=>r(le,U),[()=>n()("session.enemy_modal.reactions")]),d(T,j)};h(gt,T=>{a(i).reactions.length>0&&T(jt)})}var Et=s(gt,2);{var et=T=>{var j=Bi(),S=t(j),le=t(S,!0);e(S);var B=s(S,2);Ve(B,17,()=>a(i).endOfRound,Ct,(U,Z,Ne,re)=>{var ne=qi(),H=t(ne),ze=t(H);e(H);var ie=s(H,2),Pe=t(ie,!0);e(ie),e(ne),_(()=>{r(ze,`${a(Z).name??""}:`),r(Pe,a(Z).desc)}),d(U,ne)}),e(j),_(U=>r(le,U),[()=>n()("session.enemy_modal.end_of_round")]),d(T,j)};h(Et,T=>{a(i).endOfRound.length>0&&T(et)})}e(D),e(Ie),_((T,j,S,le,B,U)=>{r(at,`${T??""} ${a(i).difficulty??""}`),r(M,j),r(Ot,S),r(yt,a(i).defense),r(_e,le),r(Ge,a(i).health),r(ve,B),r(F,a(i).size),r(Re,U),r(lt,a(i).speed)},[()=>n()("session.enemy_modal.difficulty"),()=>a(i).name||n()("session.enemy_modal.enemy_default"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.speed")]),d(ke,Ie)};let G=Kt(o,"isOpen",3,!1),V=Kt(o,"initialData",3,"{}"),i=_t(ca(Oe())),y=_t("general"),te=_t(!1),He=_t(""),we=_t(void 0);function Ze(ke){const Ie=ke.target.files;if(Ie&&Ie.length>0){const Xe=Ie[0],at=new FileReader;at.onload=()=>{k(He,at.result,!0),k(te,!0)},at.readAsDataURL(Xe)}ke.target&&(ke.target.value="")}async function Ce(ke){try{const Ie=await ns(ke);a(i).imageUrl=Ie,k(te,!1)}catch(Ie){console.error(Ie),alert(Ie.message||"Erro ao salvar imagem")}}function Oe(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",imageUrl:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[],global:!1}}Ra(()=>{if(G()&&V())try{const ke=JSON.parse(V());Object.keys(ke).length===0?k(i,Oe(),!0):k(i,{...Oe(),...ke},!0)}catch{k(i,Oe(),!0)}});function de(ke){a(i)[ke]=[...a(i)[ke],{name:"",desc:""}]}function Te(ke,Ie){a(i)[ke]=a(i)[ke].filter((Xe,at)=>at!==Ie)}function ge(ke){}var Rt=At(),kt=Je(Rt);{var Ht=ke=>{var Ie=Ki(),Xe=Je(Ie);Xe.__click=ge;var at=t(Xe),xe=t(at),Se=t(xe),ut=t(Se),Fe=t(ut);Fe.__click=function(...D){o.onClose?.apply(this,D)};var A=t(Fe);Na(A,{size:24}),e(Fe);var M=s(Fe,2),he=t(M,!0);e(M),e(ut);var De=s(ut,2);De.__click=function(...D){o.onClose?.apply(this,D)};var vt=t(De);ma(vt,{size:20}),e(De),e(Se);var Ot=s(Se,2),rt=t(Ot);rt.__click=()=>k(y,"general");var yt=t(rt,!0);e(rt);var zt=s(rt,2);zt.__click=()=>k(y,"stats");var X=t(zt,!0);e(zt);var _e=s(zt,2);_e.__click=()=>k(y,"abilities");var Ue=t(_e,!0);e(_e);var Ge=s(_e,2);Ge.__click=()=>k(y,"preview");var pt=t(Ge,!0);e(Ge),e(Ot);var We=s(Ot,2),ve=t(We);{var je=D=>{var Me=Gi(),Ye=t(Me),Ke=t(Ye);Ke.__click=()=>a(we)?.click();var st=t(Ke),gt=t(st);Ba(gt,()=>a(i).imageUrl,ie=>{ja(ie,{get hash(){return a(i).imageUrl},get alt(){return a(i).name},size:"custom",fallbackText:"?"})}),e(st);var jt=s(st,2),Et=t(jt);os(Et,{size:20,class:"text-white"}),e(jt),e(Ke);var et=s(Ke,2),T=t(et),j=t(T,!0);e(T);var S=s(T,2);bt(S),e(et),e(Ye);var le=s(Ye,2),B=t(le),U=t(B,!0);e(B);var Z=s(B,2);xa(Z),e(le);var Ne=s(le,2),re=t(Ne);bt(re);var ne=s(re,2),H=t(ne);da(H,{size:14});var ze=s(H);e(ne),e(Ne),e(Me),_((ie,Pe,dt,nt)=>{r(j,ie),r(U,Pe),be(Z,"placeholder",dt),r(ze,` ${nt??""}`)},[()=>n()("session.enemy_modal.name"),()=>n()("session.enemy_modal.description"),()=>n()("session.enemy_modal.description_placeholder"),()=>n()("session.enemy_modal.global_enemy")]),ot(S,()=>a(i).name,ie=>a(i).name=ie),ot(Z,()=>a(i).description,ie=>a(i).description=ie),Ya(re,()=>a(i).global,ie=>a(i).global=ie),d(D,Me)},F=D=>{var Me=At(),Ye=Je(Me);{var Ke=gt=>{var jt=Qi(),Et=t(jt),et=t(Et),T=t(et),j=t(T,!0);e(T);var S=s(T);bt(S),e(et);var le=s(et,2),B=t(le),U=t(B,!0);e(B);var Z=s(B,2);{let w=pe(()=>a(i).size||1);ls(Z,{get value(){return a(w)},onUpdate:C=>a(i).size=C})}e(le),e(Et);var Ne=s(Et,2),re=t(Ne),ne=t(re),H=t(ne,!0);e(ne);var ze=s(ne);bt(ze),e(re);var ie=s(re,2),Pe=t(ie),dt=t(Pe,!0);e(Pe);var nt=s(Pe);bt(nt),e(ie),e(Ne);var ct=s(Ne,2),Mt=t(ct),$t=t(Mt),Bt=t($t,!0);e($t);var Lt=s($t);bt(Lt),e(Mt);var p=s(Mt,2),u=t(p),f=t(u,!0);e(u);var m=s(u);bt(m),e(p),e(ct);var ue=s(ct,2),Ae=t(ue),Be=t(Ae,!0);e(Ae);var Qe=s(Ae,2);Ve(Qe,20,()=>["str","agi","int","wil"],Ct,(w,C)=>{var ee=Wi(),W=t(ee),I=t(W,!0);e(W);var ae=s(W,2);bt(ae);var me=s(ae,2),$e=t(me);e(me),e(ee),_(E=>{be(W,"for",`attr-${C??""}`),r(I,E),be(ae,"id",`attr-${C??""}`),tt(me,1,`text-xs font-bold ${a(i).stats[C]-10>=0?"text-green-500":"text-red-500"}`),r($e,`${a(i).stats[C]-10>=0?"+":""}${a(i).stats[C]-10}`)},[()=>n()("sofww.attributes."+C).substring(0,3)]),ot(ae,()=>a(i).stats[C],E=>a(i).stats[C]=E),d(w,ee)}),e(Qe),e(ue);var xt=s(ue,2),mt=t(xt),Nt=t(mt),Dt=t(Nt,!0);e(Nt);var Tt=s(Nt);bt(Tt),e(mt);var Jt=s(mt,2),Wt=t(Jt),Vt=t(Wt,!0);e(Wt);var l=s(Wt);bt(l),e(Jt);var v=s(Jt,2),b=t(v),z=t(b,!0);e(b);var Y=s(b);bt(Y),e(v),e(xt),e(jt),_((w,C,ee,W,I,ae,me,$e,E,K,g,se,O)=>{r(j,w),r(U,C),r(H,ee),r(dt,W),r(Bt,I),r(f,ae),r(Be,me),r(Dt,$e),be(Tt,"placeholder",E),r(Vt,K),be(l,"placeholder",g),r(z,se),be(Y,"placeholder",O)},[()=>n()("session.enemy_modal.difficulty"),()=>n()("session.enemy_modal.size"),()=>n()("session.enemy_modal.defense"),()=>n()("session.enemy_modal.health"),()=>n()("session.enemy_modal.damage"),()=>n()("session.enemy_modal.speed"),()=>n()("session.enemy_modal.main_attributes"),()=>n()("session.enemy_modal.senses"),()=>n()("session.enemy_modal.senses_placeholder"),()=>n()("session.enemy_modal.languages"),()=>n()("session.enemy_modal.languages_placeholder"),()=>n()("session.enemy_modal.immunities"),()=>n()("session.enemy_modal.immunities_placeholder")]),ot(S,()=>a(i).difficulty,w=>a(i).difficulty=w),ot(ze,()=>a(i).defense,w=>a(i).defense=w),ot(nt,()=>a(i).health,w=>a(i).health=w),ot(Lt,()=>a(i).damage,w=>a(i).damage=w),ot(m,()=>a(i).speed,w=>a(i).speed=w),ot(Tt,()=>a(i).senses,w=>a(i).senses=w),ot(l,()=>a(i).languages,w=>a(i).languages=w),ot(Y,()=>a(i).immune,w=>a(i).immune=w),d(gt,jt)},st=gt=>{var jt=At(),Et=Je(jt);{var et=j=>{var S=Xi();Ve(S,20,()=>[{key:"traits",label:"traits",color:"text-indigo-400",border:"border-indigo-500/30"},{key:"actions",label:"actions",color:"text-red-400",border:"border-red-500/30"},{key:"reactions",label:"reactions",color:"text-orange-400",border:"border-orange-500/30"},{key:"endOfRound",label:"end_of_round",color:"text-yellow-400",border:"border-yellow-500/30"}],Ct,(le,B)=>{var U=Zi(),Z=t(U),Ne=t(Z),re=t(Ne,!0);e(Ne),e(Z);var ne=s(Z,2),H=t(ne);Ve(H,17,()=>a(i)[B.key],Ct,(nt,ct,Mt)=>{var $t=Vi(),Bt=t($t),Lt=t(Bt);bt(Lt);var p=s(Lt,2);xa(p),e(Bt);var u=s(Bt,2);u.__click=()=>Te(B.key,Mt);var f=t(u);sa(f,{size:16}),e(u),e($t),_((m,ue)=>{be(Lt,"placeholder",m),be(p,"placeholder",ue)},[()=>n()("session.enemy_modal.name_placeholder"),()=>n()("session.enemy_modal.desc_placeholder")]),ot(Lt,()=>a(ct).name,m=>a(ct).name=m),ot(p,()=>a(ct).desc,m=>a(ct).desc=m),d(nt,$t)});var ze=s(H,2);ze.__click=()=>de(B.key);var ie=t(ze),Pe=t(ie);ea(Pe,{size:16}),e(ie);var dt=s(ie);e(ze),e(ne),e(U),_((nt,ct)=>{tt(U,1,`p-4 bg-slate-900 rounded border ${B.border??""}`),tt(Ne,1,`font-bold text-sm uppercase ${B.color??""}`),r(re,nt),r(dt,` ${ct??""}`)},[()=>n()("session.enemy_modal."+B.label),()=>n()("common.buttons.add")]),d(le,U)}),e(S),d(j,S)},T=j=>{var S=At(),le=Je(S);{var B=U=>{var Z=Yi(),Ne=t(Z);x(Ne),e(Z),d(U,Z)};h(le,U=>{a(y)==="preview"&&U(B)},!0)}d(j,S)};h(Et,j=>{a(y)==="abilities"?j(et):j(T,!1)},!0)}d(gt,jt)};h(Ye,gt=>{a(y)==="stats"?gt(Ke):gt(st,!1)},!0)}d(D,Me)};h(ve,D=>{a(y)==="general"?D(je):D(F,!1)})}e(We);var ce=s(We,2),Ee=t(ce);Ee.__click=()=>o.onSave(a(i));var Re=t(Ee);Ja(Re,{size:18});var Le=s(Re);e(Ee),e(ce),e(xe);var lt=s(xe,2),qe=t(lt),it=t(qe),wt=t(it);qa(wt,{size:14});var Ut=s(wt);e(it),e(qe);var St=s(qe,2),Pt=t(St);x(Pt),e(St),e(lt),e(at),e(Xe);var $=s(Xe,2);$.__change=Ze,cs($,D=>k(we,D),()=>a(we));var q=s($,2);is(q,{get isOpen(){return a(te)},get imageUrl(){return a(He)},onClose:()=>k(te,!1),onCrop:Ce}),_((D,Me,Ye,Ke,st,gt,jt,Et)=>{be(Xe,"aria-label",D),r(he,Me),tt(rt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="general"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(yt,Ye),tt(zt,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="stats"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(X,Ke),tt(_e,1,`flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="abilities"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(Ue,st),tt(Ge,1,`lg:hidden flex-1 py-3 px-4 text-sm font-bold border-b-2 whitespace-nowrap transition-colors ${a(y)==="preview"?"border-indigo-500 text-indigo-400 bg-slate-800":"border-transparent text-slate-500 hover:text-white"}`),r(pt,gt),r(Le,` ${jt??""}`),r(Ut,` ${Et??""}`)},[()=>n()("session.enemy_modal.close"),()=>n()("session.enemy_modal.title"),()=>n()("session.enemy_modal.tab_general"),()=>n()("session.enemy_modal.tab_stats"),()=>n()("session.enemy_modal.tab_abilities"),()=>n()("session.enemy_modal.preview"),()=>n()("common.buttons.save"),()=>n()("session.enemy_modal.preview")]),Sa(3,at,()=>Ia,()=>({y:20,duration:300})),Sa(3,Xe,()=>Ia,()=>({duration:200,opacity:1})),d(ke,Ie)};h(kt,ke=>{G()&&ke(Ht)})}d(Q,Rt),ba(),J()}_a(["click","change"]);var tn=c('<div class="flex justify-between items-center bg-slate-800 p-2 rounded border border-slate-700"><div class="flex-1"><div class="text-sm font-bold text-white"> </div> <div class="text-[10px] text-slate-400"> </div></div> <div class="flex items-center gap-2"><input type="number" min="1" class="w-12 bg-slate-900 border border-slate-600 rounded text-center text-white"/> <button class="text-red-400 hover:text-red-300"><!></button></div></div>'),an=c('<div class="text-center text-slate-600 italic text-sm py-4"> </div>'),sn=c('<div class="flex justify-between items-center bg-slate-950 p-2 rounded border border-slate-800 hover:border-indigo-500/30 transition-colors"><div><div class="text-sm font-bold text-white max-w-[120px] truncate"> </div> <div class="text-[10px] text-slate-500"> </div></div> <button class="text-indigo-400 hover:text-white p-1 bg-slate-900 rounded border border-slate-800"><!></button></div>'),rn=c('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4" role="button" tabindex="-1"><div class="bg-slate-800 rounded-xl w-full max-w-2xl p-6 border border-slate-700 shadow-2xl flex flex-col max-h-[90vh]" role="dialog" aria-modal="true" aria-labelledby="encounter-modal-title"><div class="flex justify-between items-center mb-6"><h3 id="encounter-modal-title" class="text-xl font-bold text-white"> </h3> <button class="text-slate-400 hover:text-white"><!></button></div> <div class="space-y-4 mb-6"><div><label for="encounter-name" class="text-xs text-slate-500 uppercase font-bold block mb-1"> </label> <input id="encounter-name" class="w-full bg-slate-900 border border-slate-700 rounded p-2 text-white outline-hidden focus:border-indigo-500"/></div></div> <div class="flex-1 flex gap-4 min-h-0"><div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"><!> <!></div></div> <div class="flex-1 bg-slate-900 border border-slate-800 rounded-lg p-3 flex flex-col"><h4 class="text-xs text-slate-500 uppercase font-bold mb-2"> </h4> <div class="flex-1 overflow-y-auto space-y-2 custom-scrollbar"></div></div></div> <div class="flex gap-3 mt-6 pt-4 border-t border-slate-700"><button class="flex-1 bg-slate-700 hover:bg-slate-600 text-white py-2 rounded font-bold"> </button> <button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-2 rounded font-bold flex items-center justify-center gap-2"><!> </button></div></div></div>');function nn(Q,o){ua(o,!0);const n=()=>qt(ta,"$t",J),oe=()=>qt(Fa,"$liveEnemies",J),[J,x]=pa();let G=Kt(o,"isOpen",3,!1),V=Kt(o,"initialData",3,"{}"),i=_t(ca({name:"",enemies:[]}));Ra(()=>{if(G()&&V())try{const de=JSON.parse(V());k(i,{name:de.name||"",enemies:de.enemies||[]},!0)}catch{k(i,{name:"",enemies:[]},!0)}});function y(de){a(i).enemies.find(ge=>ge.enemyId===de)?a(i).enemies=a(i).enemies.map(ge=>ge.enemyId===de?{...ge,count:ge.count+1}:ge):a(i).enemies=[...a(i).enemies,{enemyId:de,count:1}]}function te(de){a(i).enemies=a(i).enemies.filter((Te,ge)=>ge!==de)}function He(de,Te){const ge=Math.max(1,parseInt(Te)||1);a(i).enemies[de].count=ge}function we(de){}var Ze=At(),Ce=Je(Ze);{var Oe=de=>{var Te=rn();Te.__click=we;var ge=t(Te),Rt=t(ge),kt=t(Rt),Ht=t(kt,!0);e(kt);var ke=s(kt,2);ke.__click=function(...F){o.onClose?.apply(this,F)};var Ie=t(ke);ma(Ie,{size:20}),e(ke),e(Rt);var Xe=s(Rt,2),at=t(Xe),xe=t(at),Se=t(xe,!0);e(xe);var ut=s(xe,2);bt(ut),e(at),e(Xe);var Fe=s(Xe,2),A=t(Fe),M=t(A),he=t(M,!0);e(M);var De=s(M,2),vt=t(De);Ve(vt,17,()=>a(i).enemies,Ct,(F,ce,Ee)=>{const Re=pe(()=>oe().find(D=>D.id===a(ce).enemyId));var Le=tn(),lt=t(Le),qe=t(lt),it=t(qe,!0);e(qe);var wt=s(qe,2),Ut=t(wt);e(wt),e(lt);var St=s(lt,2),Pt=t(St);bt(Pt),Pt.__input=D=>He(Ee,D.target.value);var $=s(Pt,2);$.__click=()=>te(Ee);var q=t($);sa(q,{size:16}),e($),e(St),e(Le),_(D=>{r(it,D),r(Ut,`Dif ${(a(Re)?a(Re).difficulty:"?")??""}`),Ua(Pt,a(ce).count)},[()=>a(Re)?a(Re).name:n()("session.encounter_modal.unknown")]),d(F,Le)});var Ot=s(vt,2);{var rt=F=>{var ce=an(),Ee=t(ce,!0);e(ce),_(Re=>r(Ee,Re),[()=>n()("session.encounter_modal.none_added")]),d(F,ce)};h(Ot,F=>{a(i).enemies.length===0&&F(rt)})}e(De),e(A);var yt=s(A,2),zt=t(yt),X=t(zt,!0);e(zt);var _e=s(zt,2);Ve(_e,5,oe,F=>F.id,(F,ce)=>{var Ee=sn(),Re=t(Ee),Le=t(Re),lt=t(Le,!0);e(Le);var qe=s(Le,2),it=t(qe);e(qe),e(Re);var wt=s(Re,2);wt.__click=()=>y(a(ce).id);var Ut=t(wt);ea(Ut,{size:16}),e(wt),e(Ee),_(()=>{r(lt,a(ce).name),r(it,`Dif ${a(ce).difficulty??""}`)}),d(F,Ee)}),e(_e),e(yt),e(Fe);var Ue=s(Fe,2),Ge=t(Ue);Ge.__click=function(...F){o.onClose?.apply(this,F)};var pt=t(Ge,!0);e(Ge);var We=s(Ge,2);We.__click=()=>o.onSave(a(i));var ve=t(We);Ja(ve,{size:18});var je=s(ve);e(We),e(Ue),e(ge),e(Te),_((F,ce,Ee,Re,Le,lt,qe,it)=>{be(Te,"aria-label",F),r(Ht,ce),r(Se,Ee),be(ut,"placeholder",Re),r(he,Le),r(X,lt),r(pt,qe),r(je,` ${it??""}`)},[()=>n()("session.encounter_modal.close"),()=>n()("session.encounter_modal.title"),()=>n()("session.encounter_modal.name"),()=>n()("session.encounter_modal.name_placeholder"),()=>n()("session.encounter_modal.enemies_in_encounter"),()=>n()("session.encounter_modal.add_enemies"),()=>n()("common.buttons.cancel"),()=>n()("session.encounter_modal.save_encounter")]),ot(ut,()=>a(i).name,F=>a(i).name=F),d(de,Te)};h(Ce,de=>{G()&&de(Oe)})}d(Q,Ze),ba(),x()}_a(["click","input"]);var on=c('<div class="text-[10px] text-slate-400 flex items-center gap-1.5 bg-slate-950 p-1 px-1.5 rounded-lg border border-slate-800/50"><span class="text-indigo-400 font-black"> </span> <span class="font-medium truncate max-w-[80px]"> </span></div>'),ln=c('<div class="text-[10px] text-slate-600 italic"> </div>'),dn=c('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-4 transition-all hover:border-indigo-500/30 group relative flex flex-col justify-between shadow-lg hover:shadow-indigo-500/10" role="region"><div class="flex-1"><div class="flex items-center gap-2 mb-2"><div class="font-bold text-white text-base group-hover:text-indigo-400 transition-colors uppercase tracking-tight truncate"> </div> <!></div> <div class="flex flex-wrap gap-1"><!> <!></div></div> <div class="flex gap-2 mt-3 pt-3 border-t border-slate-800/50"><button class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-1.5 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-indigo-900/20"><!> </button> <button class="p-1.5 text-slate-400 hover:text-white bg-slate-800/50 rounded-lg border border-slate-800 transition-all" title="Editar"><!></button> <button class="p-1.5 text-slate-400 hover:text-red-400 bg-slate-800/50 rounded-lg border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),vn=c('<button class="text-[10px] font-bold text-indigo-400 hover:text-indigo-300 mt-1 uppercase tracking-wider"> </button>'),cn=c('<div class="mb-4 flex-1"><p> </p> <!></div>'),un=c('<div class="mb-4 flex-1 text-[10px] text-slate-600 italic"> </div>'),bn=c('<div class="bg-slate-900 border border-slate-800 rounded-2xl p-5 hover:border-indigo-500/30 transition-all relative group cursor-move hover:shadow-lg hover:shadow-indigo-500/10 active:scale-[0.98] flex flex-col" draggable="true" role="listitem"><div class="flex justify-between items-start mb-3"><div class="flex items-center gap-2"><h3 class="font-bold text-lg text-white group-hover:text-indigo-400 transition-colors"> </h3> <!></div> <span class="text-[10px] font-black bg-indigo-500/10 text-indigo-400 border border-indigo-400/20 px-2 py-1 rounded-lg uppercase"> </span></div> <!> <div class="mt-auto flex gap-2 pt-4 border-t border-slate-800/50"><button class="flex-1 bg-slate-800/50 hover:bg-slate-800 text-white py-2 rounded-xl text-xs font-bold border border-slate-800 transition-all"> </button> <button class="bg-slate-800/50 hover:bg-red-900/20 text-slate-500 hover:text-red-400 px-3 rounded-xl border border-slate-800 hover:border-red-900/30 transition-all"><!></button></div></div>'),_n=c('<div class="text-center text-slate-500 italic col-span-3"> </div>'),pn=c('<div><div class="mb-12"><div class="flex justify-between items-center mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[120px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!></div></div> <div class="mb-6"><h3 class="text-sm font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2 mb-6"><!> </h3></div> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"><button class="min-h-[180px] border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center text-slate-500 hover:border-indigo-500 hover:text-indigo-400 transition-all hover:bg-indigo-500/5 gap-2 group"><!> <span class="font-bold text-sm"> </span></button> <!> <!></div> <!> <!> <!></div>');function xn(Q,o){ua(o,!0);const n=()=>qt(Fa,"$liveEnemies",x),oe=()=>qt(es,"$liveEncounters",x),J=()=>qt(ta,"$t",x),[x,G]=pa();let V=_t(!1),i=_t(null),y=_t("{}"),te=_t(!1),He=_t(null),we=_t("{}"),Ze=_t(ca({isOpen:!1,title:"",message:"",onConfirm:()=>{}}));function Ce(){return{name:"",difficulty:1,defense:10,health:10,damage:0,size:1,speed:10,description:"",senses:"",languages:"",immune:"",stats:{str:10,agi:10,int:10,wil:10},traits:[],actions:[],reactions:[],endOfRound:[]}}function Oe($=null){k(i,$?$.id:null,!0),$?k(y,JSON.stringify($),!0):a(Se)==="sofdl"?k(y,"{}"):k(y,JSON.stringify(Ce()),!0),k(V,!0)}let de=ca(new Set);function Te($){de.has($)?de.delete($):de.add($)}function ge($){const q=a(i)||Oa(),D=Qt.get(o.campId);Va.set(q,{...$,id:q,campaignId:o.campId,system:D?.system||"sofww"}),k(V,!1)}function Rt($){const q=n().find(D=>D.id===$);k(Ze,{isOpen:!0,title:"Excluir Inimigo",message:`Tem certeza que deseja excluir permanentemente o inimigo "${q?.name||"este inimigo"}"?`,onConfirm:()=>{Va.delete($),a(Ze).isOpen=!1}},!0)}function kt($=null){k(He,$?$.id:null,!0),k(we,JSON.stringify($||{name:"",enemies:[]}),!0),k(te,!0)}function Ht($){const q=a(He)||Oa();Aa.set(q,{...$,id:q,system:a(Se)}),k(te,!1)}function ke($){const q=oe().find(D=>D.id===$);k(Ze,{isOpen:!0,title:"Excluir Encontro",message:`Tem certeza que deseja excluir permanentemente o encontro "${q?.name||"este encontro"}"?`,onConfirm:()=>{Aa.delete($),a(Ze).isOpen=!1}},!0)}function Ie($){const q=Qt.get(o.campId);if(!q)return;const D=q.activeEnemies||[];let Me=[];$.enemies.forEach(Ye=>{const Ke=n().find(st=>st.id===Ye.enemyId);if(Ke)for(let st=0;st<Ye.count;st++)Me.push({...Ke,instanceId:Oa(),damage:0,currentHealth:Ke.health,afflictions:[],acted:!1,initiative:!1})}),Qt.set(o.campId,{...q,activeEnemies:[...D,...Me]})}function Xe($,q){$.dataTransfer.setData("text/plain",q.id),$.dataTransfer.effectAllowed="copy"}function at($){return $.preventDefault(),!1}function xe($,q){$.preventDefault();const D=$.dataTransfer.getData("text/plain");if(!D)return;const Me=q.enemies||[],Ye=Me.find(st=>st.enemyId===D);let Ke;Ye?Ke=Me.map(st=>st.enemyId===D?{...st,count:st.count+1}:st):Ke=[...Me,{enemyId:D,count:1}],Aa.set(q.id,{...q,enemies:Ke})}let Se=pe(()=>Qt.get(o.campId)?.system||"sofww"),ut=pe(()=>n().filter($=>{const D=($.system||"sofww")===a(Se),Me=$.global===!0,Ye=$.campaignId===o.campId;return D&&(Me||Ye)})),Fe=pe(()=>oe().filter($=>{const D=($.system||"sofww")===a(Se),Me=$.global===!0,Ye=$.campaignId===o.campId;return D&&(Me||Ye)}));var A=pn(),M=t(A),he=t(M),De=t(he),vt=t(De);La(vt,{size:16});var Ot=s(vt);e(De),e(he);var rt=s(he,2),yt=t(rt);yt.__click=()=>kt();var zt=t(yt);ea(zt,{size:28,class:"group-hover:scale-110 transition-transform"});var X=s(zt,2),_e=t(X,!0);e(X),e(yt);var Ue=s(yt,2);Ve(Ue,17,()=>a(Fe),$=>$.id,($,q)=>{var D=dn(),Me=t(D),Ye=t(Me),Ke=t(Ye),st=t(Ke,!0);e(Ke);var gt=s(Ke,2);{var jt=H=>{da(H,{size:12,class:"text-indigo-400"})};h(gt,H=>{a(q).global&&H(jt)})}e(Ye);var Et=s(Ye,2),et=t(Et);Ve(et,17,()=>a(q).enemies||[],Ct,(H,ze)=>{const ie=pe(()=>n().find($t=>$t.id===a(ze).enemyId));var Pe=on(),dt=t(Pe),nt=t(dt);e(dt);var ct=s(dt,2),Mt=t(ct,!0);e(ct),e(Pe),_(()=>{r(nt,`${a(ze).count??""}x`),r(Mt,a(ie)?a(ie).name:"...")}),d(H,Pe)});var T=s(et,2);{var j=H=>{var ze=ln(),ie=t(ze,!0);e(ze),_(Pe=>r(ie,Pe),[()=>J()("session.bestiary.empty_encounter")]),d(H,ze)};h(T,H=>{a(q).enemies?.length||H(j)})}e(Et),e(Me);var S=s(Me,2),le=t(S);le.__click=()=>Ie(a(q));var B=t(le);Ha(B,{size:12,fill:"currentColor"});var U=s(B);e(le);var Z=s(le,2);Z.__click=()=>kt(a(q));var Ne=t(Z);Ts(Ne,{size:14}),e(Z);var re=s(Z,2);re.__click=()=>ke(a(q).id);var ne=t(re);sa(ne,{size:14}),e(re),e(S),e(D),_(H=>{be(D,"aria-label",`Encontro ${a(q).name??""}`),r(st,a(q).name),r(U,` ${H??""}`)},[()=>J()("session.bestiary.start")]),ha("dragover",D,at),ha("drop",D,H=>xe(H,a(q))),d($,D)}),e(rt),e(M);var Ge=s(M,2),pt=t(Ge),We=t(pt);ga(We,{size:16});var ve=s(We);e(pt),e(Ge);var je=s(Ge,2),F=t(je);F.__click=()=>Oe();var ce=t(F);ea(ce,{size:32,class:"group-hover:scale-110 transition-transform"});var Ee=s(ce,2),Re=t(Ee,!0);e(Ee),e(F);var Le=s(F,2);Ve(Le,17,()=>a(ut),$=>$.id,($,q)=>{var D=bn(),Me=t(D),Ye=t(Me),Ke=t(Ye),st=t(Ke,!0);e(Ke);var gt=s(Ke,2);{var jt=re=>{da(re,{size:14,class:"text-indigo-400"})};h(gt,re=>{a(q).global&&re(jt)})}e(Ye);var Et=s(Ye,2),et=t(Et);e(Et),e(Me);var T=s(Me,2);{var j=re=>{var ne=cn(),H=t(ne),ze=t(H,!0);e(H);var ie=s(H,2);{var Pe=dt=>{var nt=vn();nt.__click=()=>Te(a(q).id);var ct=t(nt,!0);e(nt),_(Mt=>r(ct,Mt),[()=>de.has(a(q).id)?J()("session.bestiary.see_less"):J()("session.bestiary.see_more")]),d(dt,nt)};h(ie,dt=>{a(q).description.length>120&&dt(Pe)})}e(ne),_(dt=>{tt(H,1,`text-xs text-slate-400 leading-relaxed ${dt??""}`),r(ze,a(q).description)},[()=>de.has(a(q).id)?"":"line-clamp-3"]),d(re,ne)},S=re=>{var ne=un(),H=t(ne,!0);e(ne),_(ze=>r(H,ze),[()=>J()("session.bestiary.no_description")]),d(re,ne)};h(T,re=>{a(q).description?re(j):re(S,!1)})}var le=s(T,2),B=t(le);B.__click=()=>Oe(a(q));var U=t(B,!0);e(B);var Z=s(B,2);Z.__click=()=>Rt(a(q).id);var Ne=t(Z);sa(Ne,{size:14}),e(Z),e(le),e(D),_((re,ne)=>{r(st,a(q).name),r(et,`${re??""} ${a(q).difficulty??""}`),r(U,ne)},[()=>J()("session.bestiary.level"),()=>J()("common.buttons.edit")]),ha("dragstart",D,re=>Xe(re,a(q))),d($,D)});var lt=s(Le,2);{var qe=$=>{var q=_n(),D=t(q,!0);e(q),_(Me=>r(D,Me),[()=>J()("session.bestiary.no_enemies")]),d($,q)};h(lt,$=>{a(ut).length===0&&$(qe)})}e(je);var it=s(je,2);{var wt=$=>{Si($,{get isOpen(){return a(V)},get initialData(){return a(y)},onClose:()=>k(V,!1),onSave:ge})},Ut=$=>{en($,{get isOpen(){return a(V)},get initialData(){return a(y)},onClose:()=>k(V,!1),onSave:ge})};h(it,$=>{a(Se)==="sofdl"?$(wt):$(Ut,!1)})}var St=s(it,2);nn(St,{get isOpen(){return a(te)},get initialData(){return a(we)},onClose:()=>k(te,!1),onSave:Ht});var Pt=s(St,2);Ka(Pt,{get isOpen(){return a(Ze).isOpen},get title(){return a(Ze).title},get message(){return a(Ze).message},get onConfirm(){return a(Ze).onConfirm},onCancel:()=>a(Ze).isOpen=!1}),e(A),_(($,q,D,Me)=>{r(Ot,` ${$??""}`),r(_e,q),r(ve,` ${D??""}`),r(Re,Me)},[()=>J()("session.bestiary.encounters_title"),()=>J()("session.bestiary.new_encounter"),()=>J()("session.bestiary.title"),()=>J()("session.bestiary.new_enemy")]),d(Q,A),ba(),G()}_a(["click"]);var mn=c('<div class="flex items-center gap-1 text-slate-400 ml-1"><!> <span class="text-xs"> </span></div>'),fn=c('<div class="flex items-center gap-1 text-emerald-400"><!> <span class="text-xs font-bold hidden sm:block"> </span></div> <!>',1),gn=c('<div class="flex items-center gap-1 text-slate-500"><!> <span class="text-xs hidden sm:block"> </span></div>'),hn=c('<span class="absolute -top-1 -right-1 flex h-3 w-3"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex rounded-full h-3 w-3 bg-red-500 border border-slate-900"></span></span>'),yn=c('<header class="bg-slate-900/80 backdrop-blur-md border-b border-white/5 sticky top-0 z-40 shadow-2xl"><div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-3"><div class="flex items-center justify-between gap-2 sm:gap-4"><div class="flex items-center gap-1 sm:gap-3 shrink-0"><button class="p-2 text-slate-400 hover:text-white hover:bg-white/5 rounded-full transition-all flex items-center gap-1 group"><!> <!></button> <div class="flex flex-col"><h1 class="text-base sm:text-lg font-black text-white leading-tight truncate max-w-[140px] sm:max-w-none"> </h1> <span class="text-xs text-indigo-400 font-mono font-black uppercase tracking-wider"> </span></div></div> <div class="hidden md:flex bg-slate-950/50 p-1 rounded-xl border border-white/5"><button><!> <span class="hidden min-[400px]:block"> </span></button> <button><!> <span class="hidden min-[400px]:block"> </span></button></div> <div class="flex items-center gap-1 sm:gap-2"><div class="flex items-center gap-2 mr-2 border-r border-white/10 pr-2"><!></div> <button class="p-2 sm:p-2.5 text-slate-400 hover:text-white hover:bg-white/5 rounded-lg transition-all"><!></button> <button class="p-2 sm:p-2.5 bg-indigo-600/10 text-indigo-400 border border-indigo-400/20 rounded-lg hover:bg-indigo-600 hover:text-white transition-all relative"><!> <!></button></div></div></div></header>');function wn(Q,o){ua(o,!0);const n=()=>qt(ta,"$t",G),oe=()=>qt(gs,"$syncState",G),J=()=>qt(ya,"$isHistoryOpen",G),x=()=>qt(hs,"$hasUnreadRolls",G),[G,V]=pa();let i=Kt(o,"campaignName",3,""),y=Kt(o,"gmName",3,"Mestre"),te=Kt(o,"activeSubTab",3,"session"),He=Kt(o,"onTabChange",3,()=>{}),we=Kt(o,"onOpenSettings",3,()=>{});var Ze=yn(),Ce=t(Ze),Oe=t(Ce),de=t(Oe),Te=t(de);Te.__click=()=>Hs(ss("/"));var ge=t(Te);Na(ge,{size:20,class:"group-hover:-translate-x-0.5 transition-transform"});var Rt=s(ge,2);Is(Rt,{size:18,class:"hidden sm:block opacity-50"}),e(Te);var kt=s(Te,2),Ht=t(kt),ke=t(Ht,!0);e(Ht);var Ie=s(Ht,2),Xe=t(Ie,!0);e(Ie),e(kt),e(de);var at=s(de,2),xe=t(at);xe.__click=()=>He()("session");var Se=t(xe);{let ve=pe(()=>te()==="session"?"opacity-100":"opacity-50");ds(Se,{size:14,get class(){return a(ve)}})}var ut=s(Se,2),Fe=t(ut,!0);e(ut),e(xe);var A=s(xe,2);A.__click=()=>He()("bestiary");var M=t(A);{let ve=pe(()=>te()==="bestiary"?"opacity-100":"opacity-50");us(M,{size:14,get class(){return a(ve)}})}var he=s(M,2),De=t(he,!0);e(he),e(A),e(at);var vt=s(at,2),Ot=t(vt),rt=t(Ot);{var yt=ve=>{var je=fn(),F=Je(je),ce=t(F);as(ce,{size:16});var Ee=s(ce,2),Re=t(Ee,!0);e(Ee),e(F);var Le=s(F,2);{var lt=qe=>{var it=mn(),wt=t(it);ts(wt,{size:14});var Ut=s(wt,2),St=t(Ut,!0);e(Ut),e(it),_(Pt=>{be(it,"title",Pt),r(St,oe().peers.length)},[()=>n()("common.status.peers",{values:{count:oe().peers.length}})]),d(qe,it)};h(Le,qe=>{oe().peers.length>0&&qe(lt)})}_((qe,it)=>{be(F,"title",qe),r(Re,it)},[()=>n()("common.status.connected"),()=>n()("common.status.connected")]),d(ve,je)},zt=ve=>{var je=gn(),F=t(je);Ls(F,{size:16});var ce=s(F,2),Ee=t(ce,!0);e(ce),e(je),_((Re,Le)=>{be(je,"title",Re),r(Ee,Le)},[()=>n()("common.status.offline"),()=>n()("common.status.offline")]),d(ve,je)};h(rt,ve=>{oe().isConnected?ve(yt):ve(zt,!1)})}e(Ot);var X=s(Ot,2);X.__click=function(...ve){we()?.apply(this,ve)};var _e=t(X);Us(_e,{size:20}),e(X);var Ue=s(X,2);Ue.__click=()=>ya.update(ve=>!ve);var Ge=t(Ue);Rs(Ge,{size:20});var pt=s(Ge,2);{var We=ve=>{var je=hn();d(ve,je)};h(pt,ve=>{x()&&ve(We)})}e(Ue),e(vt),e(Oe),e(Ce),e(Ze),_((ve,je,F,ce,Ee,Re,Le,lt)=>{be(Te,"aria-label",ve),be(Te,"title",je),r(ke,i()),r(Xe,y()),tt(xe,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${te()==="session"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),be(xe,"aria-pressed",te()==="session"),r(Fe,F),tt(A,1,`flex items-center gap-2 px-3 sm:px-4 py-1.5 rounded-lg text-xs font-black transition-all ${te()==="bestiary"?"bg-indigo-600 text-white shadow-lg shadow-indigo-500/20":"text-slate-500 hover:text-slate-300"}`),be(A,"aria-pressed",te()==="bestiary"),r(De,ce),be(X,"aria-label",Ee),be(X,"title",Re),be(Ue,"aria-label",Le),be(Ue,"title",lt),be(Ue,"aria-pressed",J())},[()=>n()("character.header.back_dashboard"),()=>n()("character.header.back_dashboard"),()=>n()("common.labels.session"),()=>n()("common.labels.bestiary"),()=>n()("common.buttons.settings"),()=>n()("common.buttons.settings"),()=>n()("character.header.history"),()=>n()("character.header.history")]),d(Q,Ze),ba(),V()}_a(["click"]);var kn=c('<!> <!> <main class="max-w-7xl mx-auto p-4 md:p-8 animate-in slide-in-from-bottom-4 duration-500"><!></main>',1),zn=c('<div class="flex flex-col items-center justify-center min-h-screen p-4 text-center"><div class="w-20 h-20 bg-slate-800 rounded-full flex items-center justify-center mx-auto mb-6 text-slate-600"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-ghost"><path d="M9 10h.01"></path><path d="M15 10h.01"></path><path d="M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"></path></svg></div> <h1 class="text-2xl font-black text-white mb-2 uppercase tracking-tight"> </h1> <p class="text-slate-400 mb-8 max-w-md"> </p> <button class="bg-indigo-600 hover:bg-indigo-500 text-white px-8 py-3 rounded-xl font-bold transition-all flex items-center gap-2"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left"><path d="m12 19-7-7 7-7"></path><path d="19 12H5"></path></svg> </button></div>'),$n=c('<div class="flex items-center justify-center min-h-screen"><div class="relative w-16 h-16"><div class="absolute inset-0 border-4 border-indigo-500/20 rounded-full"></div> <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div></div></div>'),Cn=c('<div class="fixed bottom-24 left-1/2 -translate-x-1/2 md:left-8 md:translate-x-0 z-[60] flex flex-col items-center gap-2"><div class="bg-slate-900/95 backdrop-blur-md border border-white/10 rounded-2xl p-2 flex items-center gap-2 shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 duration-200"><button class="bg-indigo-600/20 hover:bg-indigo-600 text-indigo-400 hover:text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-indigo-500/20"><span class="text-[10px] opacity-70">d20</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">1d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">2d6</span> <!></button> <button class="bg-slate-800 hover:bg-slate-700 text-white font-bold w-12 h-12 rounded-xl flex flex-col items-center justify-center transition-all active:scale-95 shadow-lg border border-white/5"><span class="text-[10px] opacity-70">3d6</span> <!></button> <div class="w-px h-8 bg-white/10 mx-1"></div> <button class="w-10 h-10 flex items-center justify-center text-slate-500 hover:text-white transition-colors"><!></button></div></div>  <div class="fixed inset-0 bg-black/40 z-[55]"></div>',1),On=c('<div class="min-h-screen bg-slate-950 text-slate-100 font-sans pb-20"><!> <!> <!> <div class="hidden md:block fixed bottom-8 left-8 z-[60]"><button class="w-16 h-16 bg-indigo-600 hover:bg-indigo-500 text-white rounded-full shadow-[0_0_20px_rgba(79,70,229,0.4)] flex items-center justify-center transition-all active:scale-90 border-2 border-white/10 group" title="Rolagens Rápidas"><!></button></div> <nav class="md:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-6 pt-2 pointer-events-none"><div class="max-w-md mx-auto relative h-16 pointer-events-auto"><div class="absolute inset-0 bg-slate-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden"><div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-indigo-500/30 to-transparent"></div></div> <div class="relative h-full flex items-center justify-around px-2"><button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Sessão</span></button> <div class="relative w-16 h-16 -mt-10 flex items-center justify-center"><div class="absolute inset-0 bg-indigo-600/20 rounded-full blur-xl animate-pulse"></div> <button class="relative w-14 h-14 bg-indigo-600 rounded-full flex items-center justify-center shadow-[0_0_20px_rgba(79,70,229,0.5)] border-4 border-slate-900 transition-all active:scale-90 hover:bg-indigo-500 z-10" aria-label="Rolar Dados"><!></button></div> <button><!> <span class="text-[9px] font-black uppercase tracking-widest leading-none">Bestiário</span></button></div></div></nav> <!></div>');function Qn(Q,o){ua(o,!0);const n=()=>qt(xs,"$page",G),oe=()=>qt(ks,"$liveCampaigns",G),J=()=>qt(ta,"$t",G),x=()=>qt(ya,"$isHistoryOpen",G),[G,V]=pa();let i=_t("session"),y=_t(!1),te=pe(()=>n().params.id),He=pe(()=>oe().find(X=>X.id===a(te))),we=pe(()=>!!a(He));function Ze(X){if(!a(te)||!a(He))return;const _e={...a(He),...X};Qt.set(a(te),_e),Pa(a(te),{name:_e.name,gmName:_e.gmName}),k(y,!1)}let Ce=_t(!1),Oe=_t(ca({isOpen:!1,sides:20,count:1,modifier:0}));function de(X,_e=1){k(Oe,{isOpen:!0,sides:X,count:_e,modifier:0},!0)}function Te(X){if(!a(He))return;const _e=zr(a(Oe).sides,a(Oe).count,X);let Ue="";a(Oe).count>1&&(Ue+=`Dados: [${_e.results.join(", ")}] `),_e.bonusRolls?.length>0&&(Ue+=`Bonus Rolls: [${_e.bonusRolls.join(", ")}] -> ${Math.abs(_e.modifierTotal)}`);const Ge=a(He).gmName||Ta(ta)("common.labels.master");ys.addToHistory({source:"GM",charName:Ge,name:`${a(Oe).count}d${a(Oe).sides} ${X?X>0?`+${X}`:X:""}`,description:Ue.trim()||null,total:_e.total,formula:_e.formula,crit:_e.crit}),ya.set(!0),a(Oe).isOpen=!1}var ge=On(),Rt=t(ge);{var kt=X=>{var _e=kn(),Ue=Je(_e);wn(Ue,{get campaignName(){return a(He).name},get gmName(){return a(He).gmName},get activeSubTab(){return a(i)},onTabChange:F=>k(i,F,!0),onOpenSettings:()=>k(y,!0)});var Ge=s(Ue,2);{let F=pe(()=>JSON.stringify(a(He)));Ps(Ge,{get isOpen(){return a(y)},get initialData(){return a(F)},onClose:()=>k(y,!1),onSave:Ze})}var pt=s(Ge,2),We=t(pt);{var ve=F=>{ni(F,{get campaign(){return a(He)}})},je=F=>{var ce=At(),Ee=Je(ce);{var Re=Le=>{xn(Le,{get campId(){return a(te)}})};h(Ee,Le=>{a(i)==="bestiary"&&Le(Re)},!0)}d(F,ce)};h(We,F=>{a(i)==="session"?F(ve):F(je,!1)})}e(pt),d(X,_e)},Ht=X=>{var _e=At(),Ue=Je(_e);{var Ge=We=>{var ve=zn(),je=s(t(ve),2),F=t(je,!0);e(je);var ce=s(je,2),Ee=t(ce,!0);e(ce);var Re=s(ce,2);Re.__click=()=>window.history.back();var Le=s(t(Re));e(Re),e(ve),_((lt,qe,it)=>{r(F,lt),r(Ee,qe),r(Le,` ${it??""}`)},[()=>J()("campaign.not_found.title"),()=>J()("campaign.not_found.message"),()=>J()("common.buttons.back")]),d(We,ve)},pt=We=>{var ve=$n();d(We,ve)};h(Ue,We=>{a(we)&&!a(He)?We(Ge):We(pt,!1)},!0)}d(X,_e)};h(Rt,X=>{a(we)&&a(He)?X(kt):X(Ht,!1)})}var ke=s(Rt,2);rs(ke,{get isOpen(){return x()},onClose:()=>ya.set(!1)});var Ie=s(ke,2);{var Xe=X=>{var _e=Cn(),Ue=Je(_e),Ge=t(Ue),pt=t(Ge);pt.__click=()=>{de(20),k(Ce,!1)};var We=s(t(pt),2);ka(We,{size:16}),e(pt);var ve=s(pt,2);ve.__click=()=>{de(6),k(Ce,!1)};var je=s(t(ve),2);ka(je,{size:16}),e(ve);var F=s(ve,2);F.__click=()=>{de(6,2),k(Ce,!1)};var ce=s(t(F),2);ka(ce,{size:16}),e(F);var Ee=s(F,2);Ee.__click=()=>{de(6,3),k(Ce,!1)};var Re=s(t(Ee),2);ka(Re,{size:16}),e(Ee);var Le=s(Ee,4);Le.__click=()=>k(Ce,!1);var lt=t(Le);ma(lt,{size:20}),e(Le),e(Ge),e(Ue);var qe=s(Ue,2);qe.__click=()=>k(Ce,!1),d(X,_e)};h(Ie,X=>{a(Ce)&&X(Xe)})}var at=s(Ie,2),xe=t(at);xe.__click=()=>k(Ce,!a(Ce));var Se=t(xe);ka(Se,{size:32,class:"group-hover:rotate-12 transition-transform"}),e(xe),e(at);var ut=s(at,2),Fe=t(ut),A=s(t(Fe),2),M=t(A);M.__click=()=>{k(i,"session"),k(Ce,!1)};var he=t(M);{let X=pe(()=>a(i)==="session"?"animate-in zoom-in-75 duration-300":"");ds(he,{size:20,get class(){return a(X)}})}va(2),e(M);var De=s(M,2),vt=s(t(De),2);vt.__click=()=>k(Ce,!a(Ce));var Ot=t(vt);{let X=pe(()=>a(Ce)?"rotate-90":"rotate-0");ka(Ot,{size:28,get class(){return`text-white ${a(X)??""} transition-transform duration-300`}})}e(vt),e(De);var rt=s(De,2);rt.__click=()=>{k(i,"bestiary"),k(Ce,!1)};var yt=t(rt);{let X=pe(()=>a(i)==="bestiary"?"animate-in zoom-in-75 duration-300":"");us(yt,{size:20,get class(){return a(X)}})}va(2),e(rt),e(A),e(Fe),e(ut);var zt=s(ut,2);{let X=pe(()=>`${J()("session.quick.roll_title")} (${a(Oe).count}d${a(Oe).sides})`),_e=pe(()=>a(Oe).sides===20?J()("session.quick.boons_banes"):J()("session.quick.fixed_modifier"));Ns(zt,{get isOpen(){return a(Oe).isOpen},get title(){return a(X)},get label(){return a(_e)},onClose:()=>a(Oe).isOpen=!1,onRoll:Te,initialModifier:0})}e(ge),_(()=>{tt(M,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(i)==="session"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`),tt(rt,1,`flex flex-col items-center justify-center gap-1 flex-1 transition-all ${a(i)==="bestiary"?"text-indigo-400":"text-slate-500 hover:text-slate-300"}`)}),d(Q,ge),ba(),V()}_a(["click"]);export{Qn as component};
