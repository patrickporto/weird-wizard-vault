import{ba as Sn,aV as Xe,av as Yn,L as xn,K as On,h as Rn,bb as Qn}from"./EigO5Itq.js";import{w as Y,j as B,g as _}from"./CE5Oy5gg.js";import{_ as Ht}from"./PPVm8Dsz.js";import{$ as de}from"./B3FtJd8P.js";import{d as Zn,a as gt}from"./2Gu058ss.js";function ia(e,t,n=t){var s=new WeakSet;Sn(e,"input",async r=>{var a=r?e.defaultValue:e.value;if(a=Nt(e)?Lt(a):a,n(a),Xe!==null&&s.add(Xe),await Yn(),a!==(a=t())){var o=e.selectionStart,u=e.selectionEnd,c=e.value.length;if(e.value=a??"",u!==null){var h=e.value.length;o===u&&u===c&&h>c?(e.selectionStart=h,e.selectionEnd=h):(e.selectionStart=o,e.selectionEnd=Math.min(u,h))}}}),(Rn&&e.defaultValue!==e.value||xn(t)==null&&e.value)&&(n(Nt(e)?Lt(e.value):e.value),Xe!==null&&s.add(Xe)),On(()=>{var r=t();if(e===document.activeElement){var a=Qn??Xe;if(s.has(a))return}Nt(e)&&r===Lt(e.value)||e.type==="date"&&!r&&!e.value||r!==e.value&&(e.value=r??"")})}function la(e,t,n=t){Sn(e,"change",s=>{var r=s?e.defaultChecked:e.checked;n(r)}),(Rn&&e.defaultChecked!==e.checked||xn(t)==null)&&n(e.checked),On(()=>{var s=t();e.checked=!!s})}function Nt(e){var t=e.type;return t==="number"||t==="range"}function Lt(e){return e===""?null:+e}const yt="0123456789abcdef";class Te{constructor(t){this.bytes=t}static ofInner(t){if(t.length!==16)throw new TypeError("not 128-bit length");return new Te(t)}static fromFieldsV7(t,n,s,r){if(!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(s)||!Number.isInteger(r)||t<0||n<0||s<0||r<0||t>0xffffffffffff||n>4095||s>1073741823||r>4294967295)throw new RangeError("invalid field value");const a=new Uint8Array(16);return a[0]=t/2**40,a[1]=t/2**32,a[2]=t/2**24,a[3]=t/2**16,a[4]=t/2**8,a[5]=t,a[6]=112|n>>>8,a[7]=n,a[8]=128|s>>>24,a[9]=s>>>16,a[10]=s>>>8,a[11]=s,a[12]=r>>>24,a[13]=r>>>16,a[14]=r>>>8,a[15]=r,new Te(a)}static parse(t){var n,s,r,a;let o;switch(t.length){case 32:o=(n=/^[0-9a-f]{32}$/i.exec(t))===null||n===void 0?void 0:n[0];break;case 36:o=(s=/^([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(t))===null||s===void 0?void 0:s.slice(1,6).join("");break;case 38:o=(r=/^\{([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})\}$/i.exec(t))===null||r===void 0?void 0:r.slice(1,6).join("");break;case 45:o=(a=/^urn:uuid:([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(t))===null||a===void 0?void 0:a.slice(1,6).join("");break}if(o){const u=new Uint8Array(16);for(let c=0;c<16;c+=4){const h=parseInt(o.substring(2*c,2*c+8),16);u[c+0]=h>>>24,u[c+1]=h>>>16,u[c+2]=h>>>8,u[c+3]=h}return new Te(u)}else throw new SyntaxError("could not parse UUID string")}toString(){let t="";for(let n=0;n<this.bytes.length;n++)t+=yt.charAt(this.bytes[n]>>>4),t+=yt.charAt(this.bytes[n]&15),(n===3||n===5||n===7||n===9)&&(t+="-");return t}toHex(){let t="";for(let n=0;n<this.bytes.length;n++)t+=yt.charAt(this.bytes[n]>>>4),t+=yt.charAt(this.bytes[n]&15);return t}toJSON(){return this.toString()}getVariant(){const t=this.bytes[8]>>>4;if(t<0)throw new Error("unreachable");if(t<=7)return this.bytes.every(n=>n===0)?"NIL":"VAR_0";if(t<=11)return"VAR_10";if(t<=13)return"VAR_110";if(t<=15)return this.bytes.every(n=>n===255)?"MAX":"VAR_RESERVED";throw new Error("unreachable")}getVersion(){return this.getVariant()==="VAR_10"?this.bytes[6]>>>4:void 0}clone(){return new Te(this.bytes.slice(0))}equals(t){return this.compareTo(t)===0}compareTo(t){for(let n=0;n<16;n++){const s=this.bytes[n]-t.bytes[n];if(s!==0)return Math.sign(s)}return 0}}class es{constructor(t){this.timestamp_biased=0,this.counter=0,this.random=t??ts()}generate(){return this.generateOrResetCore(Date.now(),1e4)}generateOrAbort(){return this.generateOrAbortCore(Date.now(),1e4)}generateOrResetCore(t,n){let s=this.generateOrAbortCore(t,n);return s===void 0&&(this.timestamp_biased=0,s=this.generateOrAbortCore(t,n)),s}generateOrAbortCore(t,n){if(!Number.isInteger(t)||t<0||t>0xffffffffffff)throw new RangeError("`unixTsMs` must be a 48-bit unsigned integer");if(n<0||n>0xffffffffffff)throw new RangeError("`rollbackAllowance` out of reasonable range");if(t++,t>this.timestamp_biased)this.timestamp_biased=t,this.resetCounter();else if(t+n>=this.timestamp_biased)this.counter++,this.counter>4398046511103&&(this.timestamp_biased++,this.resetCounter());else return;return Te.fromFieldsV7(this.timestamp_biased-1,Math.trunc(this.counter/2**30),this.counter&2**30-1,this.random.nextUint32())}resetCounter(){this.counter=this.random.nextUint32()*1024+(this.random.nextUint32()&1023)}generateV4(){const t=new Uint8Array(Uint32Array.of(this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32()).buffer);return t[6]=64|t[6]>>>4,t[8]=128|t[8]>>>2,Te.ofInner(t)}}const ts=()=>{if(typeof crypto<"u"&&typeof crypto.getRandomValues<"u")return new ns;if(typeof UUIDV7_DENY_WEAK_RNG<"u"&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");return{nextUint32:()=>Math.trunc(Math.random()*65536)*65536+Math.trunc(Math.random()*65536)}};class ns{constructor(){this.buffer=new Uint32Array(8),this.cursor=65535}nextUint32(){return this.cursor>=this.buffer.length&&(crypto.getRandomValues(this.buffer),this.cursor=0),this.buffer[this.cursor++]}}let sn;const st=()=>ss().toString(),ss=()=>(sn||(sn=new es)).generate(),{floor:rs,random:as}=Math,ot="Trystero",it=(e,t)=>Array(e).fill().map(t),rn="0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz",Cn=e=>it(e,()=>rn[rs(as()*rn.length)]).join(""),Pe=Cn(20),Me=Promise.all.bind(Promise),_n=typeof window<"u",{entries:Vt,fromEntries:In,keys:os}=Object,pe=()=>{},he=e=>new Error(`${ot}: ${e}`),is=new TextEncoder,ls=new TextDecoder,qe=e=>is.encode(e),Et=e=>ls.decode(e),vt=(...e)=>e.join("@"),us=(e,t,n,s)=>(e.relayUrls||t).slice(0,e.relayUrls?e.relayUrls.length:e.relayRedundancy||n),lt=JSON.stringify,ut=JSON.parse,an=3333,wt={};let rt=null,Ft=null;const cs=()=>{rt||(rt=new Promise(e=>{Ft=e}).finally(()=>{Ft=null,rt=null}))},fs=()=>Ft?.(),ps=(e,t)=>{const n={},s=()=>{const r=new WebSocket(e);r.onclose=()=>{if(rt){rt.then(s);return}wt[e]??=an,setTimeout(s,wt[e]),wt[e]*=2},r.onmessage=a=>t(a.data),n.socket=r,n.url=r.url,n.ready=new Promise(a=>r.onopen=()=>{a(n),wt[e]=an}),n.send=a=>{r.readyState===1&&r.send(a)}};return s(),n},hs=()=>{if(_n){const e=new AbortController;return addEventListener("online",fs,{signal:e.signal}),addEventListener("offline",cs,{signal:e.signal}),()=>e.abort()}return pe},Jt="AES-GCM",ds={},ms=e=>btoa(String.fromCharCode.apply(null,new Uint8Array(e))),gs=e=>{const t=atob(e);return new Uint8Array(t.length).map((n,s)=>t.charCodeAt(s)).buffer},ys=async(e,t)=>new Uint8Array(await crypto.subtle.digest(e,qe(t))),et=async e=>ds[e]||=Array.from(await ys("SHA-1",e)).map(t=>t.toString(36)).join(""),vs=async(e,t,n)=>crypto.subtle.importKey("raw",await crypto.subtle.digest({name:"SHA-256"},qe(`${e}:${t}:${n}`)),{name:Jt},!1,["encrypt","decrypt"]),Pn="$",Nn=",",ws=async(e,t)=>{const n=crypto.getRandomValues(new Uint8Array(16));return n.join(Nn)+Pn+ms(await crypto.subtle.encrypt({name:Jt,iv:n},await e,qe(t)))},bs=async(e,t)=>{const[n,s]=t.split(Pn);return Et(await crypto.subtle.decrypt({name:Jt,iv:new Uint8Array(n.split(Nn))},await e,gs(s)))},As=5e3,on="icegatheringstatechange",ln="offer",Es="answer",un=(e,{rtcConfig:t,rtcPolyfill:n,turnConfig:s})=>{const r=new(n||RTCPeerConnection)({iceServers:Ms.concat(s||[]),...t}),a={};let o=!1,u=!1,c=null;const h=f=>{f.binaryType="arraybuffer",f.bufferedAmountLowThreshold=65535,f.onmessage=l=>a.data?.(l.data),f.onopen=()=>a.connect?.(),f.onclose=()=>a.close?.(),f.onerror=l=>a.error?.(l)},p=f=>Promise.race([new Promise(l=>{const i=()=>{f.iceGatheringState==="complete"&&(f.removeEventListener(on,i),l())};f.addEventListener(on,i),i()}),new Promise(l=>setTimeout(l,As))]).then(()=>({type:f.localDescription.type,sdp:f.localDescription.sdp.replace(/a=ice-options:trickle\s\n/g,"")}));return e?(c=r.createDataChannel("data"),h(c)):r.ondatachannel=({channel:f})=>{c=f,h(f)},r.onnegotiationneeded=async()=>{try{o=!0,await r.setLocalDescription();const f=await p(r);a.signal?.(f)}catch(f){a.error?.(f)}finally{o=!1}},r.onconnectionstatechange=()=>{["disconnected","failed","closed"].includes(r.connectionState)&&a.close?.()},r.ontrack=f=>{a.track?.(f.track,f.streams[0]),a.stream?.(f.streams[0])},r.onremovestream=f=>a.stream?.(f.stream),e&&(r.canTrickleIceCandidates||r.onnegotiationneeded()),{created:Date.now(),connection:r,get channel(){return c},get isDead(){return r.connectionState==="closed"},async signal(f){if(!(c?.readyState==="open"&&!f.sdp?.includes("a=rtpmap")))try{if(f.type===ln){if(o||r.signalingState!=="stable"&&!u){if(e)return;await Me([r.setLocalDescription({type:"rollback"}),r.setRemoteDescription(f)])}else await r.setRemoteDescription(f);await r.setLocalDescription();const l=await p(r);return a.signal?.(l),l}else if(f.type===Es){u=!0;try{await r.setRemoteDescription(f)}finally{u=!1}}}catch(l){a.error?.(l)}},sendData:f=>c.send(f),destroy:()=>{c?.close(),r.close(),o=!1,u=!1},setHandlers:f=>Object.assign(a,f),offerPromise:e?new Promise(f=>a.signal=l=>{l.type===ln&&f(l)}):Promise.resolve(),addStream:f=>f.getTracks().forEach(l=>r.addTrack(l,f)),removeStream:f=>r.getSenders().filter(l=>f.getTracks().includes(l.track)).forEach(l=>r.removeTrack(l)),addTrack:(f,l)=>r.addTrack(f,l),removeTrack:f=>{const l=r.getSenders().find(i=>i.track===f);l&&r.removeTrack(l)},replaceTrack:(f,l)=>{const i=r.getSenders().find(m=>m.track===f);if(i)return i.replaceTrack(l)}}},Ms=[...it(3,(e,t)=>`stun:stun${t||""}.l.google.com:19302`),"stun:stun.cloudflare.com:3478"].map(e=>({urls:e})),ks=Object.getPrototypeOf(Uint8Array),Mt=12,Ln=0,kt=Ln+Mt,Tt=kt+1,tt=Tt+1,nt=tt+1,Ee=16*2**10-nt,bt=255,cn="bufferedamountlow",Ie=e=>"@_"+e,Ts=(e,t,n)=>{const s={},r={},a={},o={},u={},c={},h={},p={onPeerJoin:pe,onPeerLeave:pe,onPeerStream:pe,onPeerTrack:pe},f=(d,g)=>(d?Array.isArray(d)?d:[d]:os(s)).flatMap(k=>{const R=s[k];return R?g(k,R):(console.warn(`${ot}: no peer with id ${k} found`),[])}),l=d=>{s[d]&&(s[d].destroy(),delete s[d],delete o[d],delete u[d],p.onPeerLeave(d),t(d))},i=d=>{if(r[d])return a[d];if(!d)throw he("action type argument is required");const g=qe(d);if(g.byteLength>Mt)throw he(`action type string "${d}" (${g.byteLength}b) exceeds byte limit (${Mt}). Hint: choose a shorter name.`);const k=new Uint8Array(Mt);k.set(g);let R=0;return r[d]={onComplete:pe,onProgress:pe,setOnComplete:q=>r[d]={...r[d],onComplete:q},setOnProgress:q=>r[d]={...r[d],onProgress:q},send:async(q,y,A,F)=>{if(A&&typeof A!="object")throw he("action meta argument must be an object");const Q=typeof q;if(Q==="undefined")throw he("action data cannot be undefined");const J=Q!=="string",ie=q instanceof Blob,N=ie||q instanceof ArrayBuffer||q instanceof ks;if(A&&!N)throw he("action meta argument can only be used with binary data");const K=N?new Uint8Array(ie?await q.arrayBuffer():q):qe(J?lt(q):q),re=A?qe(lt(A)):null,$=Math.ceil(K.byteLength/Ee)+(A?1:0)||1,G=it($,(W,X)=>{const le=X===$-1,ue=A&&X===0,ce=new Uint8Array(nt+(ue?re.byteLength:le?K.byteLength-Ee*($-(A?2:1)):Ee));return ce.set(k),ce.set([R],kt),ce.set([le|ue<<1|N<<2|J<<3],Tt),ce.set([Math.round((X+1)/$*bt)],tt),ce.set(A?ue?re:K.subarray((X-1)*Ee,X*Ee):K.subarray(X*Ee,(X+1)*Ee),nt),ce});return R=R+1&bt,Me(f(y,async(W,X)=>{const{channel:le}=X;let ue=0;for(;ue<$;){const ce=G[ue];if(le.bufferedAmount>le.bufferedAmountLowThreshold&&await new Promise(Xn=>{const nn=()=>{le.removeEventListener(cn,nn),Xn()};le.addEventListener(cn,nn)}),!s[W])break;X.sendData(ce),ue++,F?.(ce[tt]/bt,W,A)}}))}},a[d]||=[r[d].send,r[d].setOnComplete,r[d].setOnProgress]},m=(d,g)=>{const k=new Uint8Array(g),R=Et(k.subarray(Ln,kt)).replaceAll("\0",""),[q]=k.subarray(kt,Tt),[y]=k.subarray(Tt,tt),[A]=k.subarray(tt,nt),F=k.subarray(nt),Q=!!(y&1),J=!!(y&2),ie=!!(y&4),N=!!(y&8);if(!r[R]){console.warn(`${ot}: received message with unregistered type (${R})`);return}o[d]||={},o[d][R]||={};const K=o[d][R][q]||={chunks:[]};if(J?K.meta=ut(Et(F)):K.chunks.push(F),r[R].onProgress(A/bt,d,K.meta),!Q)return;const re=new Uint8Array(K.chunks.reduce(($,G)=>$+G.byteLength,0));if(K.chunks.reduce(($,G)=>(re.set(G,$),$+G.byteLength),0),delete o[d][R][q],ie)r[R].onComplete(re,d,K.meta);else{const $=Et(re);r[R].onComplete(N?ut($):$,d)}},E=async()=>{await T(""),await new Promise(d=>setTimeout(d,99)),Vt(s).forEach(([d,g])=>{g.destroy(),delete s[d]}),n()},[M,C]=i(Ie("ping")),[x,U]=i(Ie("pong")),[I,O]=i(Ie("signal")),[P,H]=i(Ie("stream")),[z,w]=i(Ie("track")),[T,ne]=i(Ie("leave"));return e((d,g)=>{s[g]||(s[g]=d,d.setHandlers({data:k=>m(g,k),stream:k=>{p.onPeerStream(k,g,c[g]),delete c[g]},track:(k,R)=>{p.onPeerTrack(k,R,g,h[g]),delete h[g]},signal:k=>I(k,g),close:()=>l(g),error:k=>{console.error(k),l(g)}}),p.onPeerJoin(g))}),C((d,g)=>x("",g)),U((d,g)=>{u[g]?.(),delete u[g]}),O((d,g)=>s[g]?.signal(d)),H((d,g)=>c[g]=d),w((d,g)=>h[g]=d),ne((d,g)=>l(g)),_n&&addEventListener("beforeunload",E),{makeAction:i,leave:E,ping:async d=>{if(!d)throw he("ping() must be called with target peer ID");const g=Date.now();return M("",d),await new Promise(k=>u[d]=k),Date.now()-g},getPeers:()=>In(Vt(s).map(([d,g])=>[d,g.connection])),addStream:(d,g,k)=>f(g,async(R,q)=>{k&&await P(k,R),q.addStream(d)}),removeStream:(d,g)=>f(g,(k,R)=>R.removeStream(d)),addTrack:(d,g,k,R)=>f(k,async(q,y)=>{R&&await z(R,q),y.addTrack(d,g)}),removeTrack:(d,g)=>f(g,(k,R)=>R.removeTrack(d)),replaceTrack:(d,g,k,R)=>f(k,async(q,y)=>{R&&await z(R,q),y.replaceTrack(d,g)}),onPeerJoin:d=>p.onPeerJoin=d,onPeerLeave:d=>p.onPeerLeave=d,onPeerStream:d=>p.onPeerStream=d,onPeerTrack:d=>p.onPeerTrack=d}},Ss=20,xs=5333,fn=57333,Os=({init:e,subscribe:t,announce:n})=>{const s={};let r=!1,a,o,u,c;return(h,p,f)=>{const{appId:l}=h;if(s[l]?.[p])return s[l][p];const i={},m={},E=vt(ot,l,p),M=et(E),C=et(vt(E,Pe)),x=vs(h.password||"",l,p),U=y=>async A=>({type:A.type,sdp:await y(x,A.sdp)}),I=U(bs),O=U(ws),P=()=>un(!0,h),H=(y,A,F)=>{if(m[A]){m[A]!==y&&y.destroy();return}m[A]=y,q(y,A),i[A]?.forEach((Q,J)=>{J!==F&&Q.destroy()}),delete i[A]},z=(y,A)=>{m[A]===y&&delete m[A]},w=(y,A)=>{if(m[y])return;const F=i[y]?.[A];F&&(delete i[y][A],F.destroy())},T=y=>(o.push(...it(y,P)),Me(o.splice(0,y).map(A=>A.offerPromise.then(O).then(F=>({peer:A,offer:F}))))),ne=(y,A)=>f?.({error:`incorrect password (${h.password}) when decrypting ${A}`,appId:l,peerId:y,roomId:p}),d=y=>async(A,F,Q)=>{const[J,ie]=await Me([M,C]);if(A!==J&&A!==ie)return;const{peerId:N,offer:K,answer:re,peer:$}=typeof F=="string"?ut(F):F;if(!(N===Pe||m[N])){if(N&&!K&&!re){if(i[N]?.[y])return;const[[{peer:G,offer:W}],X]=await Me([T(1),et(vt(E,N))]);i[N]||=[],i[N][y]=G,setTimeout(()=>w(N,y),g[y]*.9),G.setHandlers({connect:()=>H(G,N,y),close:()=>z(G,N)}),Q(X,lt({peerId:Pe,offer:W}))}else if(K){if(i[N]?.[y]&&Pe>N)return;const W=un(!1,h);W.setHandlers({connect:()=>H(W,N,y),close:()=>z(W,N)});let X;try{X=await I(K)}catch{ne(N,"offer");return}if(W.isDead)return;const[le,ue]=await Me([et(vt(E,N)),W.signal(X)]);Q(le,lt({peerId:Pe,answer:await O(ue)}))}else if(re){let G;try{G=await I(re)}catch{ne(N,"answer");return}if($)$.setHandlers({connect:()=>H($,N,y),close:()=>z($,N)}),$.signal(G);else{const W=i[N]?.[y];W&&!W.isDead&&W.signal(G)}}}};if(!h)throw he("requires a config map as the first argument");if(!l&&!h.firebaseApp)throw he("config map is missing appId field");if(!p)throw he("roomId argument required");if(!r){const y=e(h);o=it(Ss,P),a=Array.isArray(y)?y:[y],r=!0,u=setInterval(()=>o=o.filter(A=>{const F=Date.now()-A.created<fn;return F||A.destroy(),F}),fn*1.03),c=h.manualRelayReconnection?pe:hs()}const g=a.map(()=>xs),k=[],R=a.map(async(y,A)=>t(await y,await M,await C,d(A),T));Me([M,C]).then(([y,A])=>{const F=async(Q,J)=>{const ie=await n(Q,y,A);typeof ie=="number"&&(g[J]=ie),k[J]=setTimeout(()=>F(Q,J),g[J])};R.forEach(async(Q,J)=>{await Q,F(await a[J],J)})});let q=pe;return s[l]||={},s[l][p]=Ts(y=>q=y,y=>delete m[y],()=>{delete s[l][p],k.forEach(clearTimeout),R.forEach(async y=>(await y)()),clearInterval(u),c(),r=!1})}},Ut={},Un={},Ye={},Qe={},Ze={},pn={},At={},Rs="announce",Dn=20,hn=10,Cs=33333,_s=120333,Is=3,Ps=async e=>{if(Ut[e])return Ut[e];const t=(await et(e)).slice(0,Dn);return Ut[e]=t,Un[t]=e,t},dn=async(e,t,n)=>e.send(lt({action:Rs,info_hash:await Ps(t),peer_id:Pe,...n})),mn=(e,t,n)=>console.warn(`${ot}: torrent tracker ${n?"failure":"warning"} from ${e} - ${t}`),qn=Os({init:e=>us(e,Ns,Is).map(t=>{const n=ps(t,r=>{const a=ut(r),o=a["failure reason"],u=a["warning message"],{interval:c}=a,h=Un[a.info_hash];if(o){mn(s,o,!0);return}if(u&&mn(s,u),c&&c*1e3>Ze[s]&&Qe[s][h]){const p=Math.min(c*1e3,_s);clearInterval(Ye[s][h]),Ze[s]=p,Ye[s][h]=setInterval(Qe[s][h],p)}pn[a.offer_id]||(a.offer||a.answer)&&(pn[a.offer_id]=!0,At[s][h]?.(a))}),{url:s}=n;return At[s]={},n.ready}),subscribe:(e,t,n,s,r)=>{const{url:a}=e,o=async()=>{const u=In((await r(hn)).map(c=>[Cn(Dn),c]));At[e.url][t]=c=>{if(c.offer)s(t,{offer:c.offer,peerId:c.peer_id},(h,p)=>dn(e,t,{answer:ut(p).answer,offer_id:c.offer_id,to_peer_id:c.peer_id}));else if(c.answer){const h=u[c.offer_id];h&&s(t,{answer:c.answer,peerId:c.peer_id,peer:h.peer})}},dn(e,t,{numwant:hn,offers:Vt(u).map(([c,{offer:h}])=>({offer_id:c,offer:h}))})};return Ze[a]=Cs,Qe[a]||={},Qe[a][t]=o,Ye[a]||={},Ye[a][t]=setInterval(o,Ze[a]),o(),()=>{clearInterval(Ye[a][t]),delete At[a][t],delete Qe[a][t]}},announce:e=>Ze[e.url]}),Ns=["tracker.webtorrent.dev","tracker.openwebtorrent.com","tracker.btorrent.xyz","tracker.files.fm:7073/announce"].map(e=>"wss://"+e);var te="INUMBER",Je="IOP1",Ge="IOP2",We="IOP3",ge="IVAR",Oe="IVARNAME",Fe="IFUNCALL",St="IFUNDEF",Z="IEXPR",Gt="IEXPREVAL",Re="IMEMBER",xt="IENDSTATEMENT",$e="IARRAY";function S(e,t){this.type=e,this.value=t??0}S.prototype.toString=function(){switch(this.type){case te:case Je:case Ge:case We:case ge:case Oe:case xt:return this.value;case Fe:return"CALL "+this.value;case St:return"DEF "+this.value;case $e:return"ARRAY "+this.value;case Re:return"."+this.value;default:return"Invalid Instruction"}};function Ot(e){return new S(Je,e)}function ve(e){return new S(Ge,e)}function Hn(e){return new S(We,e)}function $t(e,t,n,s,r){for(var a=[],o=[],u,c,h,p,f=0;f<e.length;f++){var l=e[f],i=l.type;if(i===te||i===Oe)Array.isArray(l.value)?a.push.apply(a,$t(l.value.map(function(m){return new S(te,m)}).concat(new S($e,l.value.length)),t,n,s,r)):a.push(l);else if(i===ge&&r.hasOwnProperty(l.value))l=new S(te,r[l.value]),a.push(l);else if(i===Ge&&a.length>1)c=a.pop(),u=a.pop(),p=n[l.value],l=new S(te,p(u.value,c.value)),a.push(l);else if(i===We&&a.length>2)h=a.pop(),c=a.pop(),u=a.pop(),l.value==="?"?a.push(u.value?c.value:h.value):(p=s[l.value],l=new S(te,p(u.value,c.value,h.value)),a.push(l));else if(i===Je&&a.length>0)u=a.pop(),p=t[l.value],l=new S(te,p(u.value)),a.push(l);else if(i===Z){for(;a.length>0;)o.push(a.shift());o.push(new S(Z,$t(l.value,t,n,s,r)))}else if(i===Re&&a.length>0)u=a.pop(),a.push(new S(te,u.value[l.value]));else{for(;a.length>0;)o.push(a.shift());o.push(l)}}for(;a.length>0;)o.push(a.shift());return o}function Vn(e,t,n){for(var s=[],r=0;r<e.length;r++){var a=e[r],o=a.type;if(o===ge&&a.value===t)for(var u=0;u<n.tokens.length;u++){var c=n.tokens[u],h;c.type===Je?h=Ot(c.value):c.type===Ge?h=ve(c.value):c.type===We?h=Hn(c.value):h=new S(c.type,c.value),s.push(h)}else o===Z?s.push(new S(Z,Vn(a.value,t,n))):s.push(a)}return s}function ke(e,t,n){var s=[],r,a,o,u,c,h;if(Wt(e))return fe(e,n);for(var p=e.length,f=0;f<p;f++){var l=e[f],i=l.type;if(i===te||i===Oe)s.push(l.value);else if(i===Ge)a=s.pop(),r=s.pop(),l.value==="and"?s.push(r?!!ke(a,t,n):!1):l.value==="or"?s.push(r?!0:!!ke(a,t,n)):l.value==="="?(u=t.binaryOps[l.value],s.push(u(r,ke(a,t,n),n))):(u=t.binaryOps[l.value],s.push(u(fe(r,n),fe(a,n))));else if(i===We)o=s.pop(),a=s.pop(),r=s.pop(),l.value==="?"?s.push(ke(r?a:o,t,n)):(u=t.ternaryOps[l.value],s.push(u(fe(r,n),fe(a,n),fe(o,n))));else if(i===ge)if(l.value in t.functions)s.push(t.functions[l.value]);else if(l.value in t.unaryOps&&t.parser.isOperatorEnabled(l.value))s.push(t.unaryOps[l.value]);else{var m=n[l.value];if(m!==void 0)s.push(m);else throw new Error("undefined variable: "+l.value)}else if(i===Je)r=s.pop(),u=t.unaryOps[l.value],s.push(u(fe(r,n)));else if(i===Fe){for(h=l.value,c=[];h-- >0;)c.unshift(fe(s.pop(),n));if(u=s.pop(),u.apply&&u.call)s.push(u.apply(void 0,c));else throw new Error(u+" is not a function")}else if(i===St)s.push((function(){for(var E=s.pop(),M=[],C=l.value;C-- >0;)M.unshift(s.pop());var x=s.pop(),U=function(){for(var I=Object.assign({},n),O=0,P=M.length;O<P;O++)I[M[O]]=arguments[O];return ke(E,t,I)};return Object.defineProperty(U,"name",{value:x,writable:!1}),n[x]=U,U})());else if(i===Z)s.push(Ls(l,t));else if(i===Gt)s.push(l);else if(i===Re)r=s.pop(),s.push(r[l.value]);else if(i===xt)s.pop();else if(i===$e){for(h=l.value,c=[];h-- >0;)c.unshift(s.pop());s.push(c)}else throw new Error("invalid Expression")}if(s.length>1)throw new Error("invalid Expression (parity)");return s[0]===0?0:fe(s[0],n)}function Ls(e,t,n){return Wt(e)?e:{type:Gt,value:function(s){return ke(e.value,t,s)}}}function Wt(e){return e&&e.type===Gt}function fe(e,t){return Wt(e)?e.value(t):e}function zt(e,t){for(var n=[],s,r,a,o,u,c,h=0;h<e.length;h++){var p=e[h],f=p.type;if(f===te)typeof p.value=="number"&&p.value<0?n.push("("+p.value+")"):Array.isArray(p.value)?n.push("["+p.value.map(gn).join(", ")+"]"):n.push(gn(p.value));else if(f===Ge)r=n.pop(),s=n.pop(),o=p.value,t?o==="^"?n.push("Math.pow("+s+", "+r+")"):o==="and"?n.push("(!!"+s+" && !!"+r+")"):o==="or"?n.push("(!!"+s+" || !!"+r+")"):o==="||"?n.push("(function(a,b){ return Array.isArray(a) && Array.isArray(b) ? a.concat(b) : String(a) + String(b); }(("+s+"),("+r+")))"):o==="=="?n.push("("+s+" === "+r+")"):o==="!="?n.push("("+s+" !== "+r+")"):o==="["?n.push(s+"[("+r+") | 0]"):n.push("("+s+" "+o+" "+r+")"):o==="["?n.push(s+"["+r+"]"):n.push("("+s+" "+o+" "+r+")");else if(f===We)if(a=n.pop(),r=n.pop(),s=n.pop(),o=p.value,o==="?")n.push("("+s+" ? "+r+" : "+a+")");else throw new Error("invalid Expression");else if(f===ge||f===Oe)n.push(p.value);else if(f===Je)s=n.pop(),o=p.value,o==="-"||o==="+"?n.push("("+o+s+")"):t?o==="not"?n.push("(!"+s+")"):o==="!"?n.push("fac("+s+")"):n.push(o+"("+s+")"):o==="!"?n.push("("+s+"!)"):n.push("("+o+" "+s+")");else if(f===Fe){for(c=p.value,u=[];c-- >0;)u.unshift(n.pop());o=n.pop(),n.push(o+"("+u.join(", ")+")")}else if(f===St){for(r=n.pop(),c=p.value,u=[];c-- >0;)u.unshift(n.pop());s=n.pop(),t?n.push("("+s+" = function("+u.join(", ")+") { return "+r+" })"):n.push("("+s+"("+u.join(", ")+") = "+r+")")}else if(f===Re)s=n.pop(),n.push(s+"."+p.value);else if(f===$e){for(c=p.value,u=[];c-- >0;)u.unshift(n.pop());n.push("["+u.join(", ")+"]")}else if(f===Z)n.push("("+zt(p.value,t)+")");else if(f!==xt)throw new Error("invalid Expression")}return n.length>1&&(t?n=[n.join(",")]:n=[n.join(";")]),String(n[0])}function gn(e){return typeof e=="string"?JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):e}function Le(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}function Kt(e,t,n){n=n||{};for(var s=!!n.withMembers,r=null,a=0;a<e.length;a++){var o=e[a];o.type===ge||o.type===Oe?!s&&!Le(t,o.value)?t.push(o.value):(r!==null&&(Le(t,r)||t.push(r)),r=o.value):o.type===Re&&s&&r!==null?r+="."+o.value:o.type===Z?Kt(o.value,t,n):r!==null&&(Le(t,r)||t.push(r),r=null)}r!==null&&!Le(t,r)&&t.push(r)}function se(e,t){this.tokens=e,this.parser=t,this.unaryOps=t.unaryOps,this.binaryOps=t.binaryOps,this.ternaryOps=t.ternaryOps,this.functions=t.functions}se.prototype.simplify=function(e){return e=e||{},new se($t(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,e),this.parser)};se.prototype.substitute=function(e,t){return t instanceof se||(t=this.parser.parse(String(t))),new se(Vn(this.tokens,e,t),this.parser)};se.prototype.evaluate=function(e){return e=e||{},ke(this.tokens,this,e)};se.prototype.toString=function(){return zt(this.tokens,!1)};se.prototype.symbols=function(e){e=e||{};var t=[];return Kt(this.tokens,t,e),t};se.prototype.variables=function(e){e=e||{};var t=[];Kt(this.tokens,t,e);var n=this.functions;return t.filter(function(s){return!(s in n)})};se.prototype.toJSFunction=function(e,t){var n=this,s=new Function(e,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+zt(this.simplify(t).tokens,!0)+"; }");return function(){return s.apply(n,arguments)}};var ct="TEOF",L="TOP",Rt="TNUMBER",Fn="TSTRING",ye="TPAREN",Be="TBRACKET",Ct="TCOMMA",Xt="TNAME",Yt="TSEMICOLON";function $n(e,t,n){this.type=e,this.value=t,this.index=n}$n.prototype.toString=function(){return this.type+": "+this.value};function V(e,t){this.pos=0,this.current=null,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.consts=e.consts,this.expression=t,this.savedPosition=0,this.savedCurrent=null,this.options=e.options,this.parser=e}V.prototype.newToken=function(e,t,n){return new $n(e,t,n??this.pos)};V.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current};V.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent};V.prototype.next=function(){if(this.pos>=this.expression.length)return this.newToken(ct,"EOF");if(this.isWhitespace()||this.isComment())return this.next();if(this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isBracket()||this.isComma()||this.isSemicolon()||this.isNamedOp()||this.isConst()||this.isName())return this.current;this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')};V.prototype.isString=function(){var e=!1,t=this.pos,n=this.expression.charAt(t);if(n==="'"||n==='"')for(var s=this.expression.indexOf(n,t+1);s>=0&&this.pos<this.expression.length;){if(this.pos=s+1,this.expression.charAt(s-1)!=="\\"){var r=this.expression.substring(t+1,s);this.current=this.newToken(Fn,this.unescape(r),t),e=!0;break}s=this.expression.indexOf(n,s+1)}return e};V.prototype.isParen=function(){var e=this.expression.charAt(this.pos);return e==="("||e===")"?(this.current=this.newToken(ye,e),this.pos++,!0):!1};V.prototype.isBracket=function(){var e=this.expression.charAt(this.pos);return(e==="["||e==="]")&&this.isOperatorEnabled("[")?(this.current=this.newToken(Be,e),this.pos++,!0):!1};V.prototype.isComma=function(){var e=this.expression.charAt(this.pos);return e===","?(this.current=this.newToken(Ct,","),this.pos++,!0):!1};V.prototype.isSemicolon=function(){var e=this.expression.charAt(this.pos);return e===";"?(this.current=this.newToken(Yt,";"),this.pos++,!0):!1};V.prototype.isConst=function(){for(var e=this.pos,t=e;t<this.expression.length;t++){var n=this.expression.charAt(t);if(n.toUpperCase()===n.toLowerCase()&&(t===this.pos||n!=="_"&&n!=="."&&(n<"0"||n>"9")))break}if(t>e){var s=this.expression.substring(e,t);if(s in this.consts)return this.current=this.newToken(Rt,this.consts[s]),this.pos+=s.length,!0}return!1};V.prototype.isNamedOp=function(){for(var e=this.pos,t=e;t<this.expression.length;t++){var n=this.expression.charAt(t);if(n.toUpperCase()===n.toLowerCase()&&(t===this.pos||n!=="_"&&(n<"0"||n>"9")))break}if(t>e){var s=this.expression.substring(e,t);if(this.isOperatorEnabled(s)&&(s in this.binaryOps||s in this.unaryOps||s in this.ternaryOps))return this.current=this.newToken(L,s),this.pos+=s.length,!0}return!1};V.prototype.isName=function(){for(var e=this.pos,t=e,n=!1;t<this.expression.length;t++){var s=this.expression.charAt(t);if(s.toUpperCase()===s.toLowerCase()){if(t===this.pos&&(s==="$"||s==="_")){s==="_"&&(n=!0);continue}else if(t===this.pos||!n||s!=="_"&&(s<"0"||s>"9"))break}else n=!0}if(n){var r=this.expression.substring(e,t);return this.current=this.newToken(Xt,r),this.pos+=r.length,!0}return!1};V.prototype.isWhitespace=function(){for(var e=!1,t=this.expression.charAt(this.pos);(t===" "||t==="	"||t===`
`||t==="\r")&&(e=!0,this.pos++,!(this.pos>=this.expression.length));)t=this.expression.charAt(this.pos);return e};var Us=/^[0-9a-f]{4}$/i;V.prototype.unescape=function(e){var t=e.indexOf("\\");if(t<0)return e;for(var n=e.substring(0,t);t>=0;){var s=e.charAt(++t);switch(s){case"'":n+="'";break;case'"':n+='"';break;case"\\":n+="\\";break;case"/":n+="/";break;case"b":n+="\b";break;case"f":n+="\f";break;case"n":n+=`
`;break;case"r":n+="\r";break;case"t":n+="	";break;case"u":var r=e.substring(t+1,t+5);Us.test(r)||this.parseError("Illegal escape sequence: \\u"+r),n+=String.fromCharCode(parseInt(r,16)),t+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+s+'"')}++t;var a=e.indexOf("\\",t);n+=e.substring(t,a<0?e.length:a),t=a}return n};V.prototype.isComment=function(){var e=this.expression.charAt(this.pos);return e==="/"&&this.expression.charAt(this.pos+1)==="*"?(this.pos=this.expression.indexOf("*/",this.pos)+2,this.pos===1&&(this.pos=this.expression.length),!0):!1};V.prototype.isRadixInteger=function(){var e=this.pos;if(e>=this.expression.length-2||this.expression.charAt(e)!=="0")return!1;++e;var t,n;if(this.expression.charAt(e)==="x")t=16,n=/^[0-9a-f]$/i,++e;else if(this.expression.charAt(e)==="b")t=2,n=/^[01]$/i,++e;else return!1;for(var s=!1,r=e;e<this.expression.length;){var a=this.expression.charAt(e);if(n.test(a))e++,s=!0;else break}return s&&(this.current=this.newToken(Rt,parseInt(this.expression.substring(r,e),t)),this.pos=e),s};V.prototype.isNumber=function(){for(var e=!1,t=this.pos,n=t,s=t,r=!1,a=!1,o;t<this.expression.length&&(o=this.expression.charAt(t),o>="0"&&o<="9"||!r&&o===".");)o==="."?r=!0:a=!0,t++,e=a;if(e&&(s=t),o==="e"||o==="E"){t++;for(var u=!0,c=!1;t<this.expression.length;){if(o=this.expression.charAt(t),u&&(o==="+"||o==="-"))u=!1;else if(o>="0"&&o<="9")c=!0,u=!1;else break;t++}c||(t=s)}return e?(this.current=this.newToken(Rt,parseFloat(this.expression.substring(n,t))),this.pos=t):this.pos=s,e};V.prototype.isOperator=function(){var e=this.pos,t=this.expression.charAt(this.pos);if(t==="+"||t==="-"||t==="*"||t==="/"||t==="%"||t==="^"||t==="?"||t===":"||t===".")this.current=this.newToken(L,t);else if(t==="∙"||t==="•")this.current=this.newToken(L,"*");else if(t===">")this.expression.charAt(this.pos+1)==="="?(this.current=this.newToken(L,">="),this.pos++):this.current=this.newToken(L,">");else if(t==="<")this.expression.charAt(this.pos+1)==="="?(this.current=this.newToken(L,"<="),this.pos++):this.current=this.newToken(L,"<");else if(t==="|")if(this.expression.charAt(this.pos+1)==="|")this.current=this.newToken(L,"||"),this.pos++;else return!1;else if(t==="=")this.expression.charAt(this.pos+1)==="="?(this.current=this.newToken(L,"=="),this.pos++):this.current=this.newToken(L,t);else if(t==="!")this.expression.charAt(this.pos+1)==="="?(this.current=this.newToken(L,"!="),this.pos++):this.current=this.newToken(L,t);else return!1;return this.pos++,this.isOperatorEnabled(this.current.value)?!0:(this.pos=e,!1)};V.prototype.isOperatorEnabled=function(e){return this.parser.isOperatorEnabled(e)};V.prototype.getCoordinates=function(){var e=0,t,n=-1;do e++,t=this.pos-n,n=this.expression.indexOf(`
`,n+1);while(n>=0&&n<this.pos);return{line:e,column:t}};V.prototype.parseError=function(e){var t=this.getCoordinates();throw new Error("parse error ["+t.line+":"+t.column+"]: "+e)};function D(e,t,n){this.parser=e,this.tokens=t,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=n.allowMemberAccess!==!1}D.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()};D.prototype.tokenMatches=function(e,t){return typeof t>"u"?!0:Array.isArray(t)?Le(t,e.value):typeof t=="function"?t(e):e.value===t};D.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()};D.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken};D.prototype.accept=function(e,t){return this.nextToken.type===e&&this.tokenMatches(this.nextToken,t)?(this.next(),!0):!1};D.prototype.expect=function(e,t){if(!this.accept(e,t)){var n=this.tokens.getCoordinates();throw new Error("parse error ["+n.line+":"+n.column+"]: Expected "+(t||e))}};D.prototype.parseAtom=function(e){var t=this.tokens.unaryOps;function n(r){return r.value in t}if(this.accept(Xt)||this.accept(L,n))e.push(new S(ge,this.current.value));else if(this.accept(Rt))e.push(new S(te,this.current.value));else if(this.accept(Fn))e.push(new S(te,this.current.value));else if(this.accept(ye,"("))this.parseExpression(e),this.expect(ye,")");else if(this.accept(Be,"["))if(this.accept(Be,"]"))e.push(new S($e,0));else{var s=this.parseArrayList(e);e.push(new S($e,s))}else throw new Error("unexpected "+this.nextToken)};D.prototype.parseExpression=function(e){var t=[];this.parseUntilEndStatement(e,t)||(this.parseVariableAssignmentExpression(t),!this.parseUntilEndStatement(e,t)&&this.pushExpression(e,t))};D.prototype.pushExpression=function(e,t){for(var n=0,s=t.length;n<s;n++)e.push(t[n])};D.prototype.parseUntilEndStatement=function(e,t){return this.accept(Yt)?(this.nextToken&&this.nextToken.type!==ct&&!(this.nextToken.type===ye&&this.nextToken.value===")")&&t.push(new S(xt)),this.nextToken.type!==ct&&this.parseExpression(t),e.push(new S(Z,t)),!0):!1};D.prototype.parseArrayList=function(e){for(var t=0;!this.accept(Be,"]");)for(this.parseExpression(e),++t;this.accept(Ct);)this.parseExpression(e),++t;return t};D.prototype.parseVariableAssignmentExpression=function(e){for(this.parseConditionalExpression(e);this.accept(L,"=");){var t=e.pop(),n=[],s=e.length-1;if(t.type===Fe){if(!this.tokens.isOperatorEnabled("()="))throw new Error("function definition is not permitted");for(var r=0,a=t.value+1;r<a;r++){var o=s-r;e[o].type===ge&&(e[o]=new S(Oe,e[o].value))}this.parseVariableAssignmentExpression(n),e.push(new S(Z,n)),e.push(new S(St,t.value));continue}if(t.type!==ge&&t.type!==Re)throw new Error("expected variable for assignment");this.parseVariableAssignmentExpression(n),e.push(new S(Oe,t.value)),e.push(new S(Z,n)),e.push(ve("="))}};D.prototype.parseConditionalExpression=function(e){for(this.parseOrExpression(e);this.accept(L,"?");){var t=[],n=[];this.parseConditionalExpression(t),this.expect(L,":"),this.parseConditionalExpression(n),e.push(new S(Z,t)),e.push(new S(Z,n)),e.push(Hn("?"))}};D.prototype.parseOrExpression=function(e){for(this.parseAndExpression(e);this.accept(L,"or");){var t=[];this.parseAndExpression(t),e.push(new S(Z,t)),e.push(ve("or"))}};D.prototype.parseAndExpression=function(e){for(this.parseComparison(e);this.accept(L,"and");){var t=[];this.parseComparison(t),e.push(new S(Z,t)),e.push(ve("and"))}};var Ds=["==","!=","<","<=",">=",">","in"];D.prototype.parseComparison=function(e){for(this.parseAddSub(e);this.accept(L,Ds);){var t=this.current;this.parseAddSub(e),e.push(ve(t.value))}};var qs=["+","-","||"];D.prototype.parseAddSub=function(e){for(this.parseTerm(e);this.accept(L,qs);){var t=this.current;this.parseTerm(e),e.push(ve(t.value))}};var Hs=["*","/","%"];D.prototype.parseTerm=function(e){for(this.parseFactor(e);this.accept(L,Hs);){var t=this.current;this.parseFactor(e),e.push(ve(t.value))}};D.prototype.parseFactor=function(e){var t=this.tokens.unaryOps;function n(r){return r.value in t}if(this.save(),this.accept(L,n)){if(this.current.value!=="-"&&this.current.value!=="+"){if(this.nextToken.type===ye&&this.nextToken.value==="("){this.restore(),this.parseExponential(e);return}else if(this.nextToken.type===Yt||this.nextToken.type===Ct||this.nextToken.type===ct||this.nextToken.type===ye&&this.nextToken.value===")"){this.restore(),this.parseAtom(e);return}}var s=this.current;this.parseFactor(e),e.push(Ot(s.value))}else this.parseExponential(e)};D.prototype.parseExponential=function(e){for(this.parsePostfixExpression(e);this.accept(L,"^");)this.parseFactor(e),e.push(ve("^"))};D.prototype.parsePostfixExpression=function(e){for(this.parseFunctionCall(e);this.accept(L,"!");)e.push(Ot("!"))};D.prototype.parseFunctionCall=function(e){var t=this.tokens.unaryOps;function n(a){return a.value in t}if(this.accept(L,n)){var s=this.current;this.parseAtom(e),e.push(Ot(s.value))}else for(this.parseMemberExpression(e);this.accept(ye,"(");)if(this.accept(ye,")"))e.push(new S(Fe,0));else{var r=this.parseArgumentList(e);e.push(new S(Fe,r))}};D.prototype.parseArgumentList=function(e){for(var t=0;!this.accept(ye,")");)for(this.parseExpression(e),++t;this.accept(Ct);)this.parseExpression(e),++t;return t};D.prototype.parseMemberExpression=function(e){for(this.parseAtom(e);this.accept(L,".")||this.accept(Be,"[");){var t=this.current;if(t.value==="."){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect(Xt),e.push(new S(Re,this.current.value))}else if(t.value==="["){if(!this.tokens.isOperatorEnabled("["))throw new Error('unexpected "[]", arrays are disabled');this.parseExpression(e),this.expect(Be,"]"),e.push(ve("["))}else throw new Error("unexpected symbol: "+t.value)}};function Vs(e,t){return Number(e)+Number(t)}function Fs(e,t){return e-t}function $s(e,t){return e*t}function Bs(e,t){return e/t}function js(e,t){return e%t}function Js(e,t){return Array.isArray(e)&&Array.isArray(t)?e.concat(t):""+e+t}function Gs(e,t){return e===t}function Ws(e,t){return e!==t}function zs(e,t){return e>t}function Ks(e,t){return e<t}function Xs(e,t){return e>=t}function Ys(e,t){return e<=t}function Qs(e,t){return!!(e&&t)}function Zs(e,t){return!!(e||t)}function er(e,t){return Le(t,e)}function tr(e){return(Math.exp(e)-Math.exp(-e))/2}function nr(e){return(Math.exp(e)+Math.exp(-e))/2}function sr(e){return e===1/0?1:e===-1/0?-1:(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e))}function rr(e){return e===-1/0?e:Math.log(e+Math.sqrt(e*e+1))}function ar(e){return Math.log(e+Math.sqrt(e*e-1))}function or(e){return Math.log((1+e)/(1-e))/2}function yn(e){return Math.log(e)*Math.LOG10E}function ir(e){return-e}function lr(e){return!e}function ur(e){return e<0?Math.ceil(e):Math.floor(e)}function cr(e){return Math.random()*(e||1)}function vn(e){return Qt(e+1)}function fr(e){return isFinite(e)&&e===Math.round(e)}var pr=4.7421875,Dt=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function Qt(e){var t,n;if(fr(e)){if(e<=0)return isFinite(e)?1/0:NaN;if(e>171)return 1/0;for(var s=e-2,r=e-1;s>1;)r*=s,s--;return r===0&&(r=1),r}if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*Qt(1-e));if(e>=171.35)return 1/0;if(e>85){var a=e*e,o=a*e,u=o*e,c=u*e;return Math.sqrt(2*Math.PI/e)*Math.pow(e/Math.E,e)*(1+1/(12*e)+1/(288*a)-139/(51840*o)-571/(2488320*u)+163879/(209018880*c)+5246819/(75246796800*c*e))}--e,n=Dt[0];for(var h=1;h<Dt.length;++h)n+=Dt[h]/(e+h);return t=e+pr+.5,Math.sqrt(2*Math.PI)*Math.pow(t,e+.5)*Math.exp(-t)*n}function hr(e){return Array.isArray(e)?e.length:String(e).length}function wn(){for(var e=0,t=0,n=0;n<arguments.length;n++){var s=Math.abs(arguments[n]),r;t<s?(r=t/s,e=e*r*r+1,t=s):s>0?(r=s/t,e+=r*r):e+=s}return t===1/0?1/0:t*Math.sqrt(e)}function bn(e,t,n){return e?t:n}function dr(e,t){return typeof t>"u"||+t==0?Math.round(e):(e=+e,t=-+t,isNaN(e)||!(typeof t=="number"&&t%1===0)?NaN:(e=e.toString().split("e"),e=Math.round(+(e[0]+"e"+(e[1]?+e[1]-t:-t))),e=e.toString().split("e"),+(e[0]+"e"+(e[1]?+e[1]+t:t))))}function mr(e,t,n){return n&&(n[e]=t),t}function gr(e,t){return e[t|0]}function yr(e){return arguments.length===1&&Array.isArray(e)?Math.max.apply(Math,e):Math.max.apply(Math,arguments)}function vr(e){return arguments.length===1&&Array.isArray(e)?Math.min.apply(Math,e):Math.min.apply(Math,arguments)}function wr(e,t){if(typeof e!="function")throw new Error("First argument to map is not a function");if(!Array.isArray(t))throw new Error("Second argument to map is not an array");return t.map(function(n,s){return e(n,s)})}function br(e,t,n){if(typeof e!="function")throw new Error("First argument to fold is not a function");if(!Array.isArray(n))throw new Error("Second argument to fold is not an array");return n.reduce(function(s,r,a){return e(s,r,a)},t)}function Ar(e,t){if(typeof e!="function")throw new Error("First argument to filter is not a function");if(!Array.isArray(t))throw new Error("Second argument to filter is not an array");return t.filter(function(n,s){return e(n,s)})}function Er(e,t){if(!(Array.isArray(t)||typeof t=="string"))throw new Error("Second argument to indexOf is not a string or array");return t.indexOf(e)}function Mr(e,t){if(!Array.isArray(t))throw new Error("Second argument to join is not an array");return t.join(e)}function kr(e){return(e>0)-(e<0)||+e}var An=1/3;function Tr(e){return e<0?-Math.pow(-e,An):Math.pow(e,An)}function Sr(e){return Math.exp(e)-1}function xr(e){return Math.log(1+e)}function Or(e){return Math.log(e)/Math.LN2}function Ae(e){this.options=e||{},this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||tr,cosh:Math.cosh||nr,tanh:Math.tanh||sr,asinh:Math.asinh||rr,acosh:Math.acosh||ar,atanh:Math.atanh||or,sqrt:Math.sqrt,cbrt:Math.cbrt||Tr,log:Math.log,log2:Math.log2||Or,ln:Math.log,lg:Math.log10||yn,log10:Math.log10||yn,expm1:Math.expm1||Sr,log1p:Math.log1p||xr,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||ur,"-":ir,"+":Number,exp:Math.exp,not:lr,length:hr,"!":vn,sign:Math.sign||kr},this.binaryOps={"+":Vs,"-":Fs,"*":$s,"/":Bs,"%":js,"^":Math.pow,"||":Js,"==":Gs,"!=":Ws,">":zs,"<":Ks,">=":Xs,"<=":Ys,and:Qs,or:Zs,in:er,"=":mr,"[":gr},this.ternaryOps={"?":bn},this.functions={random:cr,fac:vn,min:vr,max:yr,hypot:Math.hypot||wn,pyt:Math.hypot||wn,pow:Math.pow,atan2:Math.atan2,if:bn,gamma:Qt,roundTo:dr,map:wr,fold:br,filter:Ar,indexOf:Er,join:Mr},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}Ae.prototype.parse=function(e){var t=[],n=new D(this,new V(this,e),{allowMemberAccess:this.options.allowMemberAccess});return n.parseExpression(t),n.expect(ct,"EOF"),new se(t,this)};Ae.prototype.evaluate=function(e,t){return this.parse(e).evaluate(t)};var Bn=new Ae;Ae.parse=function(e){return Bn.parse(e)};Ae.evaluate=function(e,t){return Bn.parse(e).evaluate(t)};var En={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",and:"logical",or:"logical",not:"logical","?":"conditional",":":"conditional","=":"assignment","[":"array","()=":"fndef"};function Rr(e){return En.hasOwnProperty(e)?En[e]:e}Ae.prototype.isOperatorEnabled=function(e){var t=Rr(e),n=this.options.operators||{};return!(t in n)||!!n[t]};const ua={NEXT_ROLL:"Próxima Rolagem",ROUNDS:"Rodadas",MINUTES:"Minutos",HOURS:"Horas",DAYS:"Dias",LUCK_ENDS:"Sorte Encerra",PERMANENT:"Indeterminado",END_OF_ROUND:"Fim da Rodada",CONCENTRATION:"Concentração"},He={ADD:"ADD",SET:"SET",MULT:"MULT"},ca={str:"Força",agi:"Agilidade",int:"Intelecto",wil:"Vontade",defense:"Defesa",speed:"Deslocamento",health:"Vida",damage:"Dano (Dados)",boons:"Boons/Banes",healing_rate:"Taxa de Cura"},we={WEAPON:"Weapon",ARMOR:"Armor",SHIELD:"Shield",CONSUMABLE:"Consumable",EXPLOSIVE:"Explosive",OTHER:"Other"},fa=["Aeromancy","Alchemy","Alteration","Animism","Astromancy","Chaos","Chronomancy","Conjuration","Cryomancy","Dark Arts","Destruction","Divination","Eldritch","Enchantment","Evocation","Geomancy","Hydromancy","Illusion","Invocation","Necromancy","Oneiromancy","Order","Primal","Protection","Psychomancy","Pyromancy","Shadowmancy","Skullduggery","Spiritualism","Symbolism","Technomancy","Teleportation","War"],Cr=[[1,0,0,0,0,0,0,0,0,0,0],[2,1,0,0,0,0,0,0,0,0,0],[3,2,1,0,0,0,0,0,0,0,0],[4,2,1,1,0,0,0,0,0,0,0],[5,2,2,1,1,0,0,0,0,0,0],[6,3,2,2,1,1,0,0,0,0,0],[7,3,2,2,2,1,1,0,0,0,0],[8,3,2,2,2,1,1,1,0,0,0],[9,3,3,2,2,2,1,1,1,0,0],[10,3,3,3,2,2,1,1,1,1,0],[11,3,3,3,3,2,1,1,1,1,1]],pa=["Air","Alteration","Arcana","Battle","Celestial","Chaos","Conjuration","Curse","Death","Demonology","Destruction","Divination","Enchantment","Ether","Fey","Fire","Forbidden","Illusion","Life","Metal","Nature","Necromancy","Order","Primal","Protection","Rune","Shadow","Song","Soul","Spiritualism","Storm","Technomancy","Telekinesis","Telepathy","Teleportation","Theurgy","Time","Transformation","Water"];function ha(e,t){return e<0||e>10||t<0||t>10?0:Cr[e]?.[t]??0}const _r=new Ae,jn={name:"",level:1,ancestry:"",paths:{novice:"",expert:"",master:""},attributes:[{name:"Strength",value:10,key:"str"},{name:"Agility",value:10,key:"agi"},{name:"Intellect",value:10,key:"int"},{name:"Will",value:10,key:"wil"}],currency:{gp:0,sp:0,cp:0},naturalDefense:10,bonusDamage:0,size:1,speed:10,currentRound:1,languages:[],professions:[],senses:[],afflictions:[],effects:[],notes:"",campaignId:null,campaignName:null,gmName:null,combatActive:!1,initiative:!1,acted:!1,spells:[],talents:[],equipment:[]},v=Y(JSON.parse(JSON.stringify(jn))),at=Y([]),Ve=Y({type:null,isOpen:!1,data:null}),Ir=Y("acoes"),_t=Y(24),Ce=Y(24),ze=Y(0),je=Y(!1),It=Y(!1),Mn={autoOpenHistory:!1,stickyHistory:!1,theme:"dark",userName:"",enable3DDice:!1,diceTheme:"default"};function Pr(){const e=typeof localStorage<"u"?localStorage.getItem("wwv_app_settings"):null,{subscribe:t,set:n,update:s}=Y(e?{...Mn,...JSON.parse(e)}:Mn);return{subscribe:t,set:r=>{typeof localStorage<"u"&&localStorage.setItem("wwv_app_settings",JSON.stringify(r)),n(r)},update:r=>{s(a=>{const o=r(a);return typeof localStorage<"u"&&localStorage.setItem("wwv_app_settings",JSON.stringify(o)),o})}}}const Zt=Pr();je.subscribe(e=>{e&&It.set(!1)});const Ke=B(v,e=>{const t=e.effects.filter(s=>s.isActive),n=e.talents.filter(s=>(s.isPassive||s.activityType==="Passive")&&s.effect).map(s=>({...s.effect,id:`talent-effect-${s.id}`,name:s.name,sourceType:"talent",sourceId:s.id}));return[...t,...n]});function xe(e,t){if(typeof e=="number")return e;if(!e)return 0;const n=String(e).trim();if(!isNaN(Number(n)))return Number(n);try{const s={};Array.isArray(t.attributes)&&t.attributes.forEach(a=>{s[a.key]=a.value}),s.level=t.level||0,s.defense=t.naturalDefense||0,s.speed=t.speed||0,s.bonusDamage=t.bonusDamage||0,s.currentRound=t.currentRound||0;const r=n.replace(/@(\w+)/g,"$1");return _r.evaluate(r,s)}catch{return 0}}function Pt(e,t,n,s){let r=t||0;const a=n.flatMap(h=>Array.isArray(h.modifiers)?h.modifiers:[]),o=a.filter(h=>h.target===e&&h.type===He.SET);return o.length>0&&(r=xe(o[o.length-1].value,s)),a.filter(h=>h.target===e&&h.type===He.ADD).forEach(h=>{r+=xe(h.value,s)}),a.filter(h=>h.target===e&&h.type===He.MULT).forEach(h=>{r*=xe(h.value,s)}),Math.floor(r)}const en=B([v,Ke],([e,t])=>{const n={};return Array.isArray(e.attributes)&&e.attributes.forEach(s=>{n[s.key]=Pt(s.key,s.value,t,e)}),n}),Jn=B([v,Ce,Ke],([e,t,n])=>Pt("health",t,n,e)),Nr=B([Jn,_t],([e,t])=>Math.max(0,e-t)),Lr=B([ze,Ce],([e,t])=>t>0?Math.min(100,e/t*100):100),Gn=B([ze,Ce],([e,t])=>e>=t),Ur=B([ze,Ce,Gn],([e,t,n])=>e>=t/2&&!n),Dr=B([v,en,Ke],([e,t,n])=>{let s=Pt("speed",e.speed,n,e);const r=e.afflictions;return r.includes("Held")||r.includes("Stunned")||r.includes("Unconscious")||r.includes("Incapacitated")?0:((r.includes("Blinded")||r.includes("Weakened"))&&(s=Math.floor(s/2)),r.includes("Slowed")&&(s=Math.min(s,2)),Math.max(0,s))}),qr=B([v,Ke],([e,t])=>{let n=e.naturalDefense,s=0;const r=e.equipment.find(a=>a.type===we.ARMOR&&a.equipped);if(r){const a=r.defenseFixed||0,o=e.naturalDefense+(r.defenseMod||0);r.defenseFixed&&r.defenseMod?n=Math.max(a,o):r.defenseFixed?n=a:r.defenseMod&&(n=e.naturalDefense+r.defenseMod)}return e.equipment.filter(a=>a.type===we.SHIELD&&a.equippedState).forEach(a=>{s+=a.defenseMod||0}),Pt("defense",n+s,t,e)});B([v,Ke],([e,t])=>{const s=t.flatMap(r=>Array.isArray(r.modifiers)?r.modifiers:[]).filter(r=>r.target==="damage"&&r.type===He.ADD).reduce((r,a)=>r+xe(a.value,e),0);return(e.bonusDamage||0)+s});const ee={updateCurrency:(e,t)=>{v.update(n=>{let s=n.currency.gp*100+n.currency.sp*10+n.currency.cp,r=0;return e==="gp"&&(r=t*100),e==="sp"&&(r=t*10),e==="cp"&&(r=t),s+=r,s<0&&(s=0),{...n,currency:{gp:Math.floor(s/100),sp:Math.floor(s%100/10),cp:s%100%10}}})},advanceRound:e=>{v.update(t=>{const n=t.currentRound||1;if(e==="next"){const s=(t.effects||[]).map(r=>{if(r.isActive&&r.duration==="ROUNDS"&&r.roundsLeft>0){const a=r.roundsLeft-1;return a<=0?{...r,roundsLeft:0,isActive:!1}:{...r,roundsLeft:a}}return r});return{...t,currentRound:n+1,effects:s}}else return{...t,currentRound:Math.max(1,n-1)}})},addToHistory:(e,t=!0)=>{const n=_(v),s=_(at);if(e.id&&s.find(o=>o.id===e.id))return;const r={id:e.id||st(),timestamp:e.timestamp||new Date,charName:n.name,source:e.source||"gm",name:e.name||"Action",...e};at.update(o=>[r,...o]),_(Zt).autoOpenHistory?je.set(!0):_(je)||It.set(!0),t&&n.campaignId&&Ht(async()=>{const{syncRoll:o}=await Promise.resolve().then(()=>jt);return{syncRoll:o}},void 0,import.meta.url).then(({syncRoll:o})=>{o(r)})},clearHistory:()=>at.set([]),addItem:e=>v.update(t=>({...t,equipment:[...t.equipment,e]})),updateItem:e=>v.update(t=>({...t,equipment:t.equipment.map(n=>n.id===e.id?e:n)})),deleteItem:e=>v.update(t=>({...t,equipment:t.equipment.filter(n=>n.id!==e)})),useConsumable:e=>{if(e.quantity>0){const t=_(de);ee.updateItem({...e,quantity:e.quantity-1}),ee.addToHistory({source:"item",name:e.name,description:t("sofww.item_types.consumable")+`: ${e.name}`})}},equipItem:(e,t=null)=>{v.update(n=>{let s=[...n.equipment];return e.type===we.ARMOR?s=s.map(r=>r.id===e.id?{...r,equipped:!r.equipped}:r.type===we.ARMOR&&e.type===we.ARMOR&&!e.equipped?{...r,equipped:!1}:r):(e.type===we.WEAPON||e.type===we.SHIELD)&&(s=s.map(r=>r.id===e.id?{...r,equippedState:t}:r)),{...n,equipment:s}})},toggleAffliction:e=>{v.update(t=>t.afflictions.includes(e)?{...t,afflictions:t.afflictions.filter(n=>n!==e)}:{...t,afflictions:[...t.afflictions,e]})},addLanguage:e=>v.update(t=>({...t,languages:[...t.languages,e]})),removeLanguage:e=>v.update(t=>({...t,languages:t.languages.filter((n,s)=>s!==e)})),addSense:e=>v.update(t=>({...t,senses:[...t.senses||[],e]})),removeSense:e=>v.update(t=>({...t,senses:(t.senses||[]).filter((n,s)=>s!==e)})),confirmRest:()=>{v.update(t=>{const n=t.spells.map(r=>({...r,castings:r.maxCastings})),s=t.talents.map(r=>({...r,uses:r.maxUses}));return{...t,spells:n,talents:s}}),ze.set(0);const e=_(_t);Ce.set(e),Ve.set({type:null,isOpen:!1,data:null})},finalizeRoll:(e,t,n=[],s={})=>{const r=_(v),a=_(en),o=_(de),u=e.type==="weapon_attack",c=e.type==="luck",h=e.type==="weapon_damage",p=e?.source,f=p?.name||o("common.labels.action"),l=(E,M)=>E.traits&&E.traits.toLowerCase().includes(M.toLowerCase());let i={},m=()=>{};if(h){let E=parseInt(p.damageDice)||0;const M=p.grip&&p.grip.toLowerCase()==="two"||p.equippedState&&p.equippedState.toLowerCase()==="two";l(p,"Versatile")&&M&&(E+=1);let C=r.bonusDamage||0;l(p,"Light")&&C>1&&(C-=1);const x=n.flatMap(w=>Array.isArray(w.modifiers)?w.modifiers:[]).filter(w=>w.target==="damage"&&w.type===He.ADD).reduce((w,T)=>w+xe(T.value,r),0),U=C+x,I=Math.max(0,E+U+t);let O=[],P=0,H=[];for(let w=0;w<I;w++){let T=Math.floor(Math.random()*6)+1;if(T===1&&l(p,"Brutal")){const ne=Math.floor(Math.random()*6)+1;H.push(`1->${ne}`),T=ne}else H.push(`${T}`);O.push(T),P+=T}const z=`${I}d6 [${O.join(", ")}] ${H.some(w=>w.includes("->"))?`(Rolagens: ${H.join(", ")})`:""}`;i={damageDice:O,total:P,formula:z},m=()=>{ee.addToHistory({source:"damage",name:p.name,description:`${o("history.source.damage")}: ${I}d6 ${l(p,"Brutal")?"(Brutal)":""}`,formula:z,total:P,effectsApplied:n.map(w=>w.name)}),p.type===we.EXPLOSIVE&&ee.useConsumable(p)}}else{const E=Math.floor(Math.random()*20)+1;let M=0,C=o("history.source.luck");if(e.type==="attribute")M=(a[e.source.key]||e.source.value)-10,C=o(`sofww.attributes.${e.source.key}`);else if(u){let w="str",T=o("sofww.attributes.str");p.range==="Ranged"&&(w="agi",T=o("sofww.attributes.agi"),l(p,"Thrown")&&(w="str",T=o("sofww.attributes.str"))),l(p,"Nimble")&&(w="agi",T=o("sofww.attributes.agi")),M=(a[w]||10)-10,C=T}const x=Math.floor(n.flatMap(w=>Array.isArray(w.modifiers)?w.modifiers:[]).filter(w=>w.target==="boons"&&w.type===He.ADD).reduce((w,T)=>w+xe(T.value,r),0));t+=x;let U=0,I="",O=[];if(t!==0){const w=Math.abs(t);for(let ne=0;ne<w;ne++)O.push(Math.floor(Math.random()*6)+1);const T=Math.max(...O);t>0?(U=T,I=` + ${T} [${o("sofdl.rolls.boon")}]`):(U=-T,I=` - ${T} [${o("sofdl.rolls.bane")}]`)}const P=E+M+U;let H="";if(u?H=`${o("history.source.attack")} (${C})`:c?H=o("history.source.luck"):H=`${o("history.source.attribute")}: ${f}`,t!==0&&(H+=` ${o("sofdl.rolls.attribute_test",{values:{attr:"",modifier:t}}).replace(/^[^ ]+ /,"")}`),u&&E===20){let w=[];l(p,"Bludgeoning")&&w.push(o("sofww.afflictions.vulnerable.name")),l(p,"Piercing")&&w.push(o("sofww.afflictions.weakened.name")),l(p,"Slashing")&&w.push("+1d6 Dmg"),w.length>0&&(H+=`
CRÍTICO! ${w.join(" ")} `)}const z=`d20(${E})${M!==0?(M>=0?"+":"")+M:""}${I}`;i={d20:E,boonBaneDice:O,total:P,formula:z},m=()=>{ee.addToHistory({source:u?"attack":c?"luck":"attribute",name:f,description:H,formula:z,total:P,crit:E===20,effectsApplied:n.map(w=>w.name)}),v.update(w=>({...w,effects:w.effects.map(T=>T.isActive&&T.duration==="NEXT_ROLL"?{...T,isActive:!1}:T)})),u&&l(p,"Reload")&&v.update(w=>({...w,equipment:w.equipment.map(T=>T.id===p.id?{...T,isLoaded:!1}:T)}))}}return s.suppressHistory||m(),{...i,commit:m}},reloadWeapon:e=>{const t=_(de);v.update(n=>({...n,equipment:n.equipment.map(s=>s.id===e.id?{...s,isLoaded:!0}:s)})),ee.addToHistory({source:"attribute",name:t("actions.reload"),description:`${t("actions.reload")}: ${e.name}`})},addSpell:e=>v.update(t=>({...t,spells:[...t.spells,e]})),updateSpell:e=>v.update(t=>({...t,spells:t.spells.map(n=>n.id===e.id?e:n)})),deleteSpell:e=>v.update(t=>({...t,spells:t.spells.filter(n=>n.id!==e)})),commitSpellCast:e=>{e.castings>0&&(v.update(t=>({...t,spells:t.spells.map(n=>n.id===e.id?{...n,castings:n.castings-1}:n)})),ee.addToHistory({source:"spell",name:e.name,description:e.description}),Ve.set({type:null,isOpen:!1,data:null}))},addTalent:e=>v.update(t=>({...t,talents:[...t.talents,e]})),updateTalent:e=>v.update(t=>({...t,talents:t.talents.map(n=>n.id===e.id?e:n)})),deleteTalent:e=>v.update(t=>({...t,talents:t.talents.filter(n=>n.id!==e)})),commitTalentUse:e=>{e.activityType==="Duration"&&e.duration==="LUCK_ENDS"?v.update(t=>({...t,talents:t.talents.map(n=>n.id===e.id?{...n,uses:0}:n)})):e.maxUses&&v.update(t=>({...t,talents:t.talents.map(n=>n.id===e.id?{...n,uses:n.uses-1}:n)})),ee.addToHistory({source:"talent",name:e.name,description:e.description}),Ve.set({type:null,isOpen:!1,data:null})},recoverTalent:e=>{v.update(t=>({...t,talents:t.talents.map(n=>n.id===e&&n.uses<n.maxUses?{...n,uses:(n.uses||0)+1}:n)}))},rollLuckTalent:e=>{const t=_(de),n=Math.floor(Math.random()*20)+1,s=n>=10,a=_(v).talents.find(o=>o.id===e);ee.addToHistory({source:"luck",name:`${t("character.history.source.luck")} - ${a?.name||t("character.talents.title")}`,formula:`d20(${n})`,total:n,description:s?t("character.dice_roll.luck_success",{values:{total:n}}):t("character.dice_roll.luck_failure",{values:{total:n}})}),s&&v.update(o=>({...o,talents:o.talents.map(u=>u.id===e?{...u,uses:1}:u)}))},addEffect:e=>v.update(t=>({...t,effects:[...t.effects,e]})),updateEffect:e=>v.update(t=>({...t,effects:t.effects.map(n=>n.id===e.id?e:n)})),deleteEffect:e=>v.update(t=>({...t,effects:t.effects.filter(n=>n.id!==e)})),toggleEffect:e=>v.update(t=>({...t,effects:t.effects.map(n=>{if(n.id===e){const s=!n.isActive;return{...n,isActive:s,roundsLeft:s&&n.duration==="ROUNDS"&&n.initialRounds||n.roundsLeft}}return n})})),cleanInactiveEffects:()=>v.update(e=>({...e,effects:e.effects.filter(t=>t.isActive)})),applyEffectToCharacter:(e,t)=>{const n=e.name||(t?t.name:"Effect"),s=e.description||(t?t.description:""),r={id:st(),isActive:!0,name:n,description:s,roundsLeft:0,duration:"PERMANENT",modifiers:[],...e};r.duration==="ROUNDS"&&!r.initialRounds&&(r.initialRounds=r.roundsLeft),v.update(a=>({...a,effects:[...a.effects,r]}))},checkLuckEnds:e=>{const t=_(de),n=Math.floor(Math.random()*20)+1,s=n>=10;ee.addToHistory({source:"luck",name:t("sofww.duration.luck_ends"),description:s?t("character.dice_roll.luck_success",{values:{total:n}}):t("character.dice_roll.luck_failure",{values:{total:n}})}),s&&v.update(r=>({...r,effects:r.effects.map(a=>a.id===e?{...a,isActive:!1}:a)}))},joinCampaign:e=>{v.update(t=>({...t,campaignId:e.id,campaignName:e.name,gmName:e.gmName||"Game Master"})),Ht(async()=>{const{joinCampaignRoom:t}=await Promise.resolve().then(()=>jt);return{joinCampaignRoom:t}},void 0,import.meta.url).then(({joinCampaignRoom:t})=>{t(e.id,!1)})},leaveCampaign:()=>{v.update(e=>({...e,campaignId:null,campaignName:null,gmName:null,combatActive:!1}))}},da=Object.freeze(Object.defineProperty({__proto__:null,activeEffects:Ke,activeTab:Ir,appSettings:Zt,character:v,characterActions:ee,currentHealth:Ce,damage:ze,damagePercentage:Lr,defaultCharacter:jn,derivedStats:en,effectiveMaxHealth:Jn,effectiveSpeed:Dr,evaluateModifierValue:xe,hasUnreadRolls:It,isHistoryOpen:je,isIncapacitated:Gn,isInjured:Ur,modalState:Ve,normalHealth:_t,rollHistory:at,tempHealth:Nr,totalDefense:qr},Symbol.toStringTag,{value:"Module"})),Hr=new Ae,Vr={id:"",system:"sofdl",name:"",ancestry:"",level:0,paths:{novice:"",expert:"",master:""},imageUrl:"",attributes:{strength:10,agility:10,intellect:10,will:10},perception:10,defense:10,health:10,healingRate:2,size:1,speed:10,power:0,damage:0,insanity:0,corruption:0,description:"",notes:"",professions:[],languages:["Comum"],senses:[],afflictions:[],talents:[],spells:[],equipment:[],currency:{gc:0,ss:0,cp:0,bits:0},effects:[],campaignId:null,campaignName:null,gmName:null,campaignApproval:null,combatActive:!1,currentRound:1,initiative:!1,acted:!1,magicSystem:"standard"},b=Y(JSON.parse(JSON.stringify(Vr))),Fr=B(b,e=>e.effects.filter(t=>t.isActive)),_e=B([b,Fr],([e,t])=>{const n={strength:e.attributes.strength,agility:e.attributes.agility,intellect:e.attributes.intellect,will:e.attributes.will,perception:e.perception,defense:e.defense,health:e.health,speed:e.speed,healingRate:e.healingRate,power:e.power,boons:0},s=[];t.forEach(o=>{o.modifiers&&o.modifiers.forEach(u=>{s.push(u)})});const r=o=>o==="healing_rate"?"healingRate":o;return Object.keys(n).forEach(o=>{const u=s.filter(p=>r(p.target)===o);if(u.length===0)return;const c=u.filter(p=>p.type==="SET");if(c.length>0){const p=c[c.length-1];n[o]=qt(p.value,e)}c.length===0&&u.filter(f=>f.type==="ADD").forEach(f=>{n[o]+=qt(f.value,e)}),u.filter(p=>p.type==="MULT").forEach(p=>{n[o]*=qt(p.value,e)}),n[o]=Math.floor(n[o])}),{strength:n.strength,agility:n.agility,intellect:n.intellect,will:n.will,perception:n.perception,defense:n.defense,health:n.health,speed:n.speed,healingRate:n.healingRate,power:n.power,boons:n.boons}}),ma=B(_e,e=>({strength:e.strength,agility:e.agility,intellect:e.intellect,will:e.will})),$r=B(_e,e=>({strength:e.strength-10,agility:e.agility-10,intellect:e.intellect-10,will:e.will-10}));B([b,_e],([e,t])=>t.health-e.damage);B([b,_e],([e,t])=>e.damage>=t.health/2);B([b,_e],([e,t])=>e.damage>=t.health);function qt(e,t){if(typeof e=="number")return e;if(!e)return 0;const n=String(e).trim();if(!isNaN(Number(n)))return Number(n);try{const s={};t.attributes&&Object.entries(t.attributes).forEach(([a,o])=>{s[a]=o}),s.level=t.level||0,s.perception=t.perception||0,s.defense=t.defense||0,s.health=t.health||0,s.healingRate=t.healingRate||0,s.size=t.size||0,s.speed=t.speed||0,s.power=t.power||0,s.damage=t.damage||0,s.insanity=t.insanity||0,s.corruption=t.corruption||0;const r=n.replace(/@(\w+)/g,"$1");return Hr.evaluate(r,s)}catch{return 0}}const ga=B(_e,e=>Math.max(0,e.healingRate)),Ue={set:e=>{b.update(t=>{const n={...t,...e};return e.health!==void 0&&e.healingRate===void 0&&(n.healingRate=Math.floor(n.health/4)),n})},updateAttribute:(e,t)=>{b.update(n=>({...n,attributes:{...n.attributes,[e]:t}}))},takeDamage:e=>{b.update(t=>{const n=Math.max(0,Math.min(t.health,t.damage+e));return{...t,damage:n}})},heal:e=>{b.update(t=>{const n=Math.max(0,t.damage-e);return{...t,damage:n}})},updateStat:(e,t)=>{b.update(n=>({...n,[e]:Math.max(0,t)}))},toggleEffect:e=>{b.update(t=>({...t,effects:t.effects.map(n=>n.id===e?{...n,isActive:!n.isActive}:n)}))},deleteEffect:e=>{b.update(t=>({...t,effects:t.effects.filter(n=>n.id!==e)}))},cleanInactiveEffects:()=>{b.update(e=>({...e,effects:e.effects.filter(t=>t.isActive)}))},advanceRound:e=>{b.update(t=>{if(e==="next"){const n=t.effects.map(s=>s.isActive&&s.duration==="END_OF_ROUND"?{...s,isActive:!1}:s);return{...t,currentRound:t.currentRound+1,effects:n}}return{...t,currentRound:Math.max(1,t.currentRound-1)}})},checkLuckEnds:e=>{const n=_(b).effects.find(r=>r.id===e),s=_(de);Ve.set({type:"pre_roll",isOpen:!0,data:{type:"luck_ends",system:"sofdl",effectId:e,source:{name:n?.name||s("sofdl.rolls.effect")}}})},checkConcentration:e=>{const n=_(b).effects.find(r=>r.id===e),s=_(de);Ve.set({type:"pre_roll",isOpen:!0,data:{type:"concentration",system:"sofdl",effectId:e,key:"will",source:{name:n?.name||s("sofdl.rolls.concentration")}}})},addSpell:e=>{b.update(t=>({...t,spells:[...t.spells,{...e,id:e.id||st()}]}))},updateSpell:e=>{b.update(t=>({...t,spells:t.spells.map(n=>n.id===e.id?e:n)}))},deleteSpell:e=>{b.update(t=>({...t,spells:t.spells.filter(n=>n.id!==e)}))},castSpell:e=>{const n=_(b).spells.find(s=>s.id===e);n&&(b.update(s=>({...s,spells:s.spells.map(r=>r.id===e?{...r,castingsUsed:(r.castingsUsed||0)+1}:r)})),Ue.addToHistory({source:"spell",name:n.name,description:n.description,type:"spell"}))},resetSpellCastings:()=>{b.update(e=>({...e,spells:e.spells.map(t=>({...t,castingsUsed:0}))}))},addTalent:e=>{b.update(t=>({...t,talents:[...t.talents,{...e,id:e.id||st()}]}))},updateTalent:e=>{b.update(t=>({...t,talents:t.talents.map(n=>n.id===e.id?e:n)}))},deleteTalent:e=>{b.update(t=>({...t,talents:t.talents.filter(n=>n.id!==e)}))},useTalent:e=>{const n=_(b).talents.find(s=>s.id===e);n&&(b.update(s=>({...s,talents:s.talents.map(r=>r.id===e&&r.uses>0?{...r,uses:r.uses-1}:r)})),Ue.addToHistory({source:"talent",name:n.name,description:n.description,type:"talent"}))},resetTalentUses:()=>{b.update(e=>({...e,talents:e.talents.map(t=>({...t,uses:t.maxUses}))}))},addSense:e=>{b.update(t=>({...t,senses:t.senses.includes(e)?t.senses:[...t.senses,e]}))},removeSense:e=>{b.update(t=>({...t,senses:t.senses.filter((n,s)=>s!==e)}))},toggleAffliction:e=>{b.update(t=>({...t,afflictions:t.afflictions.includes(e)?t.afflictions.filter(n=>n!==e):[...t.afflictions,e]}))},leaveCampaign:()=>{b.update(e=>({...e,campaignId:null,campaignName:null,gmName:null,campaignApproval:null}))},addToHistory:(e,t=!0)=>{const n=_(b),s={id:e.id||st(),timestamp:e.timestamp||new Date,charName:n.name,...e};at.update(a=>[s,...a]),_(Zt).autoOpenHistory?je.set(!0):_(je)||It.set(!0),t&&n.campaignId&&Ht(async()=>{const{syncRoll:a}=await Promise.resolve().then(()=>jt);return{syncRoll:a}},void 0,import.meta.url).then(({syncRoll:a})=>{a(s)})},addLanguage:e=>b.update(t=>({...t,languages:[...t.languages,e]})),removeLanguage:e=>b.update(t=>({...t,languages:t.languages.filter((n,s)=>s!==e)})),addProfession:e=>b.update(t=>({...t,professions:[...t.professions,e]})),removeProfession:e=>b.update(t=>({...t,professions:t.professions.filter((n,s)=>s!==e)})),updateCurrency:(e,t)=>{b.update(n=>{const s=Math.max(0,(n.currency[e]||0)+t);return{...n,currency:{...n.currency,[e]:s}}})},addItem:e=>b.update(t=>({...t,equipment:[...t.equipment,e]})),updateItem:e=>b.update(t=>({...t,equipment:t.equipment.map(n=>n.id===e.id?e:n)})),deleteItem:e=>b.update(t=>({...t,equipment:t.equipment.filter(n=>n.id!==e)})),useConsumable:e=>{b.update(t=>({...t,equipment:t.equipment.map(n=>n.id===e.id?{...n,quantity:Math.max(0,n.quantity-1)}:n)}))},reloadWeapon:e=>b.update(t=>({...t,equipment:t.equipment.map(n=>n.id===e.id?{...n,isLoaded:!0}:n)})),finalizeRoll:(e,t,n=[],s={})=>{_(b);const r=_($r),a=_(_e),o=e?.type==="weapon_damage"||e?.type==="spell_damage",u=_(de),c=e?.source?.name||e?.key||u("character.modals.attribute");let h={},p=()=>{};if(o){const f=e.source?.damage??e.source?.damageDice??"1d6",l=String(f),i=Number(e.source?.damageMod)||0;let m=0,E=[],M="";if(l==="0")m=0,M="0";else if(!l.includes("d"))m=parseInt(l)||0,M=`${m}`,E=[m];else{const I=l.match(/(\d+)d(\d+)/);if(I){const O=parseInt(I[1])||1,P=parseInt(I[2])||6;for(let H=0;H<O;H++){const z=Math.floor(Math.random()*P)+1;m+=z,E.push(z)}M=`${l} [${E.join(", ")}]`}else m=1,M="1"}const C=m+t+i,x=t+i!==0?`${t+i>0?"+":""}${t+i}`:"",U=`${M}${x}`;h={damageDice:E,total:C,formula:U},p=()=>{const I=_(de);Ue.addToHistory({source:"damage",name:c,description:I("sofdl.rolls.damage_description",{values:{source:c}}),formula:U,total:C,effectsApplied:n})}}else{const f=Math.floor(Math.random()*20)+1;let l=0,i=c;e.type==="attribute"?(l=r[e.key]||0,i=u(`sofdl.attributes.${e.key}`)):e.type==="luck"&&(l=0,i=u("character.luck_test"));let m=t+(a.boons||0),E=0,M="",C=[];if(m!==0){const O=Math.abs(m);for(let H=0;H<O;H++)C.push(Math.floor(Math.random()*6)+1);const P=Math.max(...C);m>0?(E=P,M=` + ${P} [${u("sofdl.rolls.boon")}]`):(E=-P,M=` - ${P} [${u("sofdl.rolls.bane")}]`)}let x="attribute";e.type==="weapon_attack"?x="attack":(e.type==="luck"||e.type==="luck_ends")&&(x="luck");const U=f+l+E,I=`d20(${f})${l!==0?(l>=0?"+":"")+l:""}${M}`;h={d20:f,boonBaneDice:C,total:U,formula:I},p=()=>{Ue.addToHistory({source:x,name:i,description:e.type==="luck_ends"?u("sofdl.rolls.luck_ends",{values:{effect:c}}):u("sofdl.rolls.attribute_test",{values:{attr:i,modifier:t}}),formula:I,total:U,crit:f===20,effectsApplied:n}),e.type==="luck_ends"&&U>=10&&b.update(O=>({...O,effects:O.effects.map(P=>P.id===e.effectId?{...P,isActive:!1}:P)}))}}return s.suppressHistory||p(),{...h,commit:p}},rest:()=>{b.update(e=>{const t=e.spells.map(r=>({...r,castingsUsed:0})),n=e.talents.map(r=>({...r,uses:r.isPassive?0:r.maxUses})),s=Math.max(0,e.damage-e.healingRate);return{...e,spells:t,talents:n,damage:s}})}},Br="wss://tracker.openwebtorrent.com",ya=[{label:"OpenWebTorrent (Standard)",value:"wss://tracker.openwebtorrent.com"},{label:"Files.fm",value:"wss://tracker.files.fm:7073/announce"},{label:"WebTorrent Dev",value:"wss://tracker.webtorrent.dev"},{label:"Vibe Community",value:"wss://toad.vibe.community:443/announce"},{label:"BTorrent",value:"wss://tracker.btorrent.xyz"}],jr=(e,t)=>{let n=t;if(typeof window<"u"){const o=localStorage.getItem(e);o&&(n=JSON.parse(o))}const{subscribe:s,set:r,update:a}=Y(n);return{subscribe:s,set:o=>{typeof window<"u"&&localStorage.setItem(e,JSON.stringify(o)),r(o)},update:o=>{a(u=>{const c=o(u);return typeof window<"u"&&localStorage.setItem(e,JSON.stringify(c)),c})}}},Wn=jr("app_tracker_url",Br);function tn(){const e=_(Wn);return{appId:Zn,trackerUrls:[e]}}const ae=Y({roomId:null,peers:[],currentCharacterId:null,lastGmUpdate:0,isGM:!1,isConnected:!1}),Jr=B(ae,e=>e.lastGmUpdate?Date.now()-e.lastGmUpdate<6e4:!1);let j=null,be=null,ft=null,pt=null,ht=null,dt=null,Se=null,oe=null,kn=0,Tn=0;const Gr=2e3,Bt=Y([]),De=Y("disconnected");function mt(e,t){if(!e)return!0;try{return e.leave(),!0}catch(n){return console.warn(`Failed to leave ${t}:`,n),!1}}function zn(e){return Date.now()-e>=Gr}let me;function Kn(){if(be&&me)return _(Wn),console.log("Lobby already connected, reusing existing connection"),De.set("connected"),me;if(!zn(kn))return console.warn("Lobby join rate limited. Skipping duplicate join attempt."),null;kn=Date.now(),Se&&(clearInterval(Se),Se=null),mt(be,"existing lobby"),be=null,De.set("connecting");try{const e=tn();be=qn(e,"public-discovery");const[t,n]=be.makeAction("discovery");return n(s=>{Bt.update(r=>{const a=r.findIndex(o=>o.id===s.id);if(a!==-1){const o=[...r];return o[a]={...s,lastSeen:Date.now()},o}return[...r,{...s,lastSeen:Date.now()}]})}),Se=setInterval(()=>{const s=Date.now();Bt.update(r=>r.filter(a=>s-a.lastSeen<12e4))},6e4),De.set("connected"),me=t,t}catch(e){return console.error("Failed to join lobby:",e),be=null,De.set("error"),null}}function Wr(e){return me?(me({id:e.id,name:e.name,gmName:e.gmName||"Mestre",description:e.description,system:e.system}),!0):(console.warn("Cannot announce campaign: lobby not initialized"),!1)}function zr(){if(typeof window<"u"){const e=Kn();e&&(me=e)}}typeof window<"u"&&(zr(),window.addEventListener("beforeunload",()=>{Kr()}));function Kr(){Se&&(clearInterval(Se),Se=null),oe&&(clearInterval(oe),oe=null),mt(be,"lobby"),mt(j,"room"),be=null,j=null,me=null,De.set("disconnected")}let Ne=null;function Xr(e,t=!1,n=null){const s=`campaign-${e}`;if(Ne===s&&j)return ae.update(r=>({...r,isGM:t,currentCharacterId:n})),j;if(!zn(Tn))return console.warn("Campaign join rate limited. Skipping duplicate join attempt."),j;Tn=Date.now(),oe&&(clearInterval(oe),oe=null),mt(j,"existing campaign room"),j=null,Ne=null,ft=null,pt=null,ht=null,dt=null;try{Ne=s;const r=tn();j=qn(r,Ne),ae.set({isConnected:!0,isGM:t,currentCharacterId:n,peers:[],roomId:e,lastGmUpdate:0});const[a,o]=j.makeAction("combat"),[u,c]=j.makeAction("history"),[h,p]=j.makeAction("charUpdate"),[f,l]=j.makeAction("campaign");return ft=a,pt=u,ht=h,dt=f,o(i=>{t||v.update(m=>({...m,currentRound:i.round,combatActive:i.active}))}),l(i=>{ae.update(m=>({...m,lastGmUpdate:Date.now()})),t||v.update(m=>({...m,campaignName:i.name,gmName:i.gmName,passwordHash:i.passwordHash,system:i.system}))}),t&&(oe=setInterval(()=>{if(!me)return;const i=gt.get(e);i&&i.isPublished&&me({id:e,name:i.name,gmName:i.gmName||"Mestre",description:i.description,system:i.system})},3e4)),c(i=>{ee.addToHistory(i,!1)}),p(i=>{if(t){const m=gt.get(e);if(m){const E=m.members||[],M=E.findIndex(O=>O.id===i.id);let C;if(M!==-1){C=[...E];const O=C[M],P={...i};O.campaignApproval==="approved"&&i.campaignApproval==="pending"&&delete P.campaignApproval,C[M]={...O,...P,lastUpdate:Date.now()}}else C=[...E,{...i,lastUpdate:Date.now()}];const x=m.activeEnemies||[],U=x.findIndex(O=>O.id===i.id&&O.type==="player");let I=x;U!==-1&&(I=[...x],I[U]={...I[U],...i}),gt.set(e,{...m,members:C,activeEnemies:I})}}else{const m=_(ae),E=_(v),M=m.currentCharacterId||E?.id;if(M&&M===i.id){const C=i.system==="sofdl";if(i.campaignApproval==="rejected"||i.campaignId===null){C?Ue.leaveCampaign():v.update(x=>({...x,campaignId:null,campaignName:null,gmName:null,campaignApproval:null}));return}C?Ue.set({name:i.name,afflictions:i.afflictions,senses:i.senses,initiative:i.initiative,acted:i.acted,campaignApproval:i.campaignApproval,imageUrl:i.imageUrl,notes:i.notes,damage:i.damage,health:i.health,healingRate:i.healingRate,insanity:i.insanity,corruption:i.corruption,defense:i.defense,speed:i.speed,power:i.power,attributes:i.attributes}):(v.update(x=>({...x,name:i.name||x.name,afflictions:i.afflictions||x.afflictions,senses:i.senses||x.senses,initiative:i.initiative!==void 0?i.initiative:x.initiative??!1,acted:i.acted!==void 0?i.acted:x.acted??!1,campaignApproval:i.campaignApproval||x.campaignApproval,imageUrl:i.imageUrl||x.imageUrl,notes:i.notes!==void 0?i.notes:x.notes})),i.damage!==void 0&&ze.set(i.damage),i.currentHealth!==void 0&&Ce.set(i.currentHealth),i.normalHealth!==void 0&&_t.set(i.normalHealth))}}}),j.onPeerJoin(i=>{if(ae.update(m=>({...m,peers:[...m.peers,i]})),t){const m=gt.get(e);m&&(m.combat&&a(m.combat),f({name:m.name,gmName:m.gmName||"Mestre",passwordHash:m.passwordHash,system:m.system}))}}),j.onPeerLeave(i=>{ae.update(m=>({...m,peers:m.peers.filter(E=>E!==i)}))}),j}catch(r){return console.error("Failed to join campaign room:",r),j=null,Ne=null,ae.set({isConnected:!1,isGM:!1,currentCharacterId:null,peers:[],roomId:null,lastGmUpdate:0}),null}}function Yr(e,t){ft&&ft(t)}function Qr(e,t){dt&&dt({name:t.name,gmName:t.gmName||"Mestre",passwordHash:t.passwordHash,system:t.system})}function Zr(e){pt&&pt(e)}function ea(e){ht&&ht(e)}function ta(){oe&&(clearInterval(oe),oe=null),mt(j,"campaign room"),j=null,Ne=null,ft=null,pt=null,ht=null,dt=null,ae.set({isConnected:!1,isGM:!1,currentCharacterId:null,peers:[],roomId:null,lastGmUpdate:0})}const jt=Object.freeze(Object.defineProperty({__proto__:null,announceCampaign:Wr,getTrackerConfig:tn,isGmOnline:Jr,joinCampaignRoom:Xr,joinLobby:Kn,leaveCampaignRoom:ta,lobbyStatus:De,publicCampaigns:Bt,syncCampaign:Qr,syncCharacter:ea,syncCombat:Yr,syncRoll:Zr,syncState:ae},Symbol.toStringTag,{value:"Module"}));export{ha as $,ya as A,Ur as B,Gn as C,Br as D,Lr as E,Ve as F,ua as G,He as H,we as I,Ue as J,ma as K,en as L,fa as M,qt as N,xe as O,Fr as P,Ke as Q,b as R,_e as S,_t as T,Ce as U,qr as V,Dr as W,Ir as X,ca as Y,$r as Z,ga as _,qn as a,pa as a0,Vr as a1,jn as a2,da as a3,ia as b,v as c,Zt as d,ee as e,ea as f,tn as g,Qr as h,Jr as i,Xr as j,je as k,ta as l,Wr as m,Yr as n,la as o,ae as p,It as q,at as r,Pe as s,Wn as t,st as u,De as v,Bt as w,Jn as x,ze as y,Nr as z};
