import"./DsnmJJEf.js";import"./Dcsmm6So.js";import{o as ge,u as pe,v as K,w as X,k as x,x as It,R as F,a2 as Mt,L as Et,F as A,z as Nt,j as z,B as p,A as _,G as Gt,I as f,ad as ee,y as s,t as W,n as Ot,T as me,b7 as be}from"./Dw_raXzk.js";import{I as rt,s as at}from"./DjRg1Dji.js";import{l as nt,s as it,p as R,i as G}from"./C7jdvfZ7.js";import{d as St,f as re,s as H,j as ae,e as jt,o as xe,r as _e}from"./Dy4L3Tb7.js";import{s as ft,e as zt,i as ne,$ as ie,j as ye,a as Pt,g as Ft,r as we}from"./DHvfXG5j.js";import{s as oe,a as Wt}from"./CLDCoJG6.js";import{M as $e,P as Me,X as se,T as Ae}from"./DsV61ll_.js";import{v as At,q as Pe,z as Ce,b as Be}from"./DoCbXyb_.js";import{t as Le,s as Ee}from"./CdKeR9oO.js";import{b as Dt}from"./Bb9Zu10p.js";import{C as Ie}from"./Dw-BcmbT.js";function Ne(h,i,l){ge(()=>{var d=pe(()=>i(h,l?.())||{});if(d?.destroy)return()=>d.destroy()})}function jr(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M12 18V5"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77"}]];rt(h,it({name:"brain"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}function zr(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z"}],["circle",{cx:"12",cy:"13",r:"3"}]];rt(h,it({name:"camera"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}function Dr(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"m15 18-6-6 6-6"}]];rt(h,it({name:"chevron-left"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}function Sr(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M12 6v6l4 2"}],["circle",{cx:"12",cy:"12",r:"10"}]];rt(h,it({name:"clock"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}function je(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["rect",{width:"12",height:"12",x:"2",y:"10",rx:"2",ry:"2"}],["path",{d:"m17.92 14 3.5-3.5a2.24 2.24 0 0 0 0-3l-5-4.92a2.24 2.24 0 0 0-3 0L10 6"}],["path",{d:"M6 18h.01"}],["path",{d:"M10 14h.01"}],["path",{d:"M15 6h.01"}],["path",{d:"M18 9h.01"}]];rt(h,it({name:"dices"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}function Rr(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["circle",{cx:"12",cy:"12",r:"3"}]];rt(h,it({name:"eye"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}function Tr(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M9 10h.01"}],["path",{d:"M15 10h.01"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"}]];rt(h,it({name:"ghost"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}function Xt(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}],["path",{d:"M12 7v5l4 2"}]];rt(h,it({name:"history"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}function Ur(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1"}]];rt(h,it({name:"layout-dashboard"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}function ze(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M5 12h14"}]];rt(h,it({name:"minus"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}function Hr(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}]];rt(h,it({name:"rotate-ccw"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}function Or(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["path",{d:"m11 19-6-6"}],["path",{d:"m5 21-2-2"}],["path",{d:"m8 16-4 4"}],["path",{d:"M9.5 17.5 21 6V3h-3L6.5 14.5"}]];rt(h,it({name:"sword"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}function De(h,i){const l=nt(i,["children","$$slots","$$events","$$legacy"]);const d=[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]];rt(h,it({name:"zoom-in"},()=>l,{get iconNode(){return d},children:(u,b)=>{var c=K(),g=X(c);at(g,i,"default",{}),x(u,c)},$$slots:{default:!0}}))}var Se=z('<div class="w-2 h-2 bg-white rounded-sm"></div>'),Re=z('<span class="text-[9px] text-slate-400 bg-slate-800 px-1 rounded"> </span>'),Te=z('<div class="flex flex-wrap gap-1 mt-1"></div>'),Ue=z('<button><div class="flex items-center gap-3"><div><!></div> <div><span class="text-sm font-bold text-slate-200 block leading-tight"> </span> <!></div></div></button>'),He=z('<div class="space-y-2"><h4 class="text-xs font-bold text-slate-500 uppercase px-1"> </h4> <div class="grid grid-cols-1 gap-2 max-h-[150px] overflow-y-auto pr-1 custom-scrollbar"></div></div>'),Oe=z('<div class="space-y-6"><div class="bg-slate-900/50 p-6 rounded-2xl border border-white/5 text-center shadow-inner relative overflow-hidden group"><div class="absolute inset-0 bg-indigo-500/5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"></div> <div class="flex justify-center items-center gap-8 mb-4 relative z-10"><button class="w-12 h-12 rounded-full bg-slate-800 hover:bg-red-500/20 text-slate-300 hover:text-red-400 border border-slate-700 hover:border-red-500/30 flex items-center justify-center transition-all active:scale-90 shadow-lg" aria-label="Diminuir"><!></button> <div class="flex flex-col items-center min-w-[100px]"><span> </span></div> <button class="w-12 h-12 rounded-full bg-slate-800 hover:bg-green-500/20 text-slate-300 hover:text-green-400 border border-slate-700 hover:border-green-500/30 flex items-center justify-center transition-all active:scale-90 shadow-lg" aria-label="Aumentar"><!></button></div> <div class="text-[10px] font-black text-slate-500 uppercase tracking-[0.2em] relative z-10"> </div></div> <!> <!> <button class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-black py-4 rounded-xl flex items-center justify-center gap-3 shadow-lg shadow-indigo-600/20 transition-all active:scale-[0.98] uppercase tracking-widest text-sm"><!> </button></div>');function Fr(h,i){It(i,!0);const l=()=>Wt(ie,"$t",d),[d,u]=oe();let b=R(i,"initialModifier",3,0),c=R(i,"label",3,"Boons / Banes"),g=R(i,"rollLabel",3,"ROLAR"),C=R(i,"effects",19,()=>[]),j=F(0),P=F(Mt([]));Et(()=>{i.isOpen?(A(j,b()),A(P,C().map(I=>I.id),!0)):A(P,[],!0)});function B(I){s(P).includes(I)?A(P,s(P).filter(m=>m!==I),!0):A(P,[...s(P),I],!0)}var y=K(),D=X(y);{var S=I=>{$e(I,{get isOpen(){return i.isOpen},get onClose(){return i.onClose},get title(){return i.title},children:(m,o)=>{var n=Oe(),e=p(n),t=_(p(e),2),a=p(t);a.__click=()=>Gt(j,-1);var r=p(a);ze(r,{size:24}),f(a);var L=_(a,2),T=p(L),k=p(T);f(T),f(L);var V=_(L,2);V.__click=()=>Gt(j);var ct=p(V);Me(ct,{size:24}),f(V),f(t);var J=_(t,2),gt=p(J,!0);f(J),f(e);var E=_(e,2);{var w=Y=>{var tt=He(),ut=p(tt),Ct=p(ut,!0);f(ut);var _t=_(ut,2);zt(_t,21,C,pt=>pt.id,(pt,et)=>{var ht=Ue();ht.__click=()=>B(s(et).id);var vt=p(ht),mt=p(vt),ot=p(mt);{var lt=Z=>{var M=Se();x(Z,M)};G(ot,Z=>{s(P).includes(s(et).id)&&Z(lt)})}f(mt);var $t=_(mt,2),yt=p($t),v=p(yt,!0);f(yt);var N=_(yt,2);{var U=Z=>{var M=Te();zt(M,21,()=>s(et).modifiers,ne,(O,dt)=>{var wt=Re(),bt=p(wt);f(wt),W(()=>H(bt,`${s(dt).target??""}: ${s(dt).value??""}`)),x(O,wt)}),f(M),x(Z,M)};G(N,Z=>{s(et).modifiers&&s(et).modifiers.length>0&&Z(U)})}f($t),f(vt),f(ht),W((Z,M)=>{ft(ht,1,`flex items-center justify-between p-3 rounded-lg border transition-all text-left ${Z??""}`),ft(mt,1,`w-4 h-4 rounded border flex items-center justify-center transition-colors ${M??""}`),H(v,s(et).name)},[()=>s(P).includes(s(et).id)?"bg-indigo-900/30 border-indigo-500/50 shadow-sm":"bg-slate-900/50 border-slate-800 opacity-60 hover:opacity-100 hover:border-slate-700",()=>s(P).includes(s(et).id)?"bg-indigo-500 border-indigo-400":"border-slate-600 bg-slate-900"]),x(pt,ht)}),f(_t),f(tt),W(pt=>H(Ct,pt),[()=>l()("character.effects.active")]),x(Y,tt)};G(E,Y=>{C().length>0&&Y(w)})}var $=_(E,2);re($,()=>i.children??ee);var q=_($,2);q.__click=()=>{const Y=C().filter(tt=>s(P).includes(tt.id));i.onRoll(s(j),Y)};var Q=p(q);je(Q,{size:18});var st=_(Q);f(q),f(n),W(()=>{ft(T,1,`text-5xl font-black ${s(j)>0?"text-green-400":s(j)<0?"text-red-400":"text-slate-500"} tabular-nums drop-shadow-sm transition-colors duration-300`),H(k,`${s(j)>0?"+":""}${s(j)??""}`),H(gt,c()),H(st,` ${g()??""}`)}),x(m,n)},$$slots:{default:!0}})};G(D,I=>{i.isOpen&&I(S)})}x(h,y),Nt(),u()}St(["click"]);var Ut={exports:{}},Vt;function Fe(){return Vt||(Vt=1,(function(h,i){(function(l){h.exports=l()})(function(l){var d=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function u(o,n){var e=o[0],t=o[1],a=o[2],r=o[3];e+=(t&a|~t&r)+n[0]-680876936|0,e=(e<<7|e>>>25)+t|0,r+=(e&t|~e&a)+n[1]-389564586|0,r=(r<<12|r>>>20)+e|0,a+=(r&e|~r&t)+n[2]+606105819|0,a=(a<<17|a>>>15)+r|0,t+=(a&r|~a&e)+n[3]-1044525330|0,t=(t<<22|t>>>10)+a|0,e+=(t&a|~t&r)+n[4]-176418897|0,e=(e<<7|e>>>25)+t|0,r+=(e&t|~e&a)+n[5]+1200080426|0,r=(r<<12|r>>>20)+e|0,a+=(r&e|~r&t)+n[6]-1473231341|0,a=(a<<17|a>>>15)+r|0,t+=(a&r|~a&e)+n[7]-45705983|0,t=(t<<22|t>>>10)+a|0,e+=(t&a|~t&r)+n[8]+1770035416|0,e=(e<<7|e>>>25)+t|0,r+=(e&t|~e&a)+n[9]-1958414417|0,r=(r<<12|r>>>20)+e|0,a+=(r&e|~r&t)+n[10]-42063|0,a=(a<<17|a>>>15)+r|0,t+=(a&r|~a&e)+n[11]-1990404162|0,t=(t<<22|t>>>10)+a|0,e+=(t&a|~t&r)+n[12]+1804603682|0,e=(e<<7|e>>>25)+t|0,r+=(e&t|~e&a)+n[13]-40341101|0,r=(r<<12|r>>>20)+e|0,a+=(r&e|~r&t)+n[14]-1502002290|0,a=(a<<17|a>>>15)+r|0,t+=(a&r|~a&e)+n[15]+1236535329|0,t=(t<<22|t>>>10)+a|0,e+=(t&r|a&~r)+n[1]-165796510|0,e=(e<<5|e>>>27)+t|0,r+=(e&a|t&~a)+n[6]-1069501632|0,r=(r<<9|r>>>23)+e|0,a+=(r&t|e&~t)+n[11]+643717713|0,a=(a<<14|a>>>18)+r|0,t+=(a&e|r&~e)+n[0]-373897302|0,t=(t<<20|t>>>12)+a|0,e+=(t&r|a&~r)+n[5]-701558691|0,e=(e<<5|e>>>27)+t|0,r+=(e&a|t&~a)+n[10]+38016083|0,r=(r<<9|r>>>23)+e|0,a+=(r&t|e&~t)+n[15]-660478335|0,a=(a<<14|a>>>18)+r|0,t+=(a&e|r&~e)+n[4]-405537848|0,t=(t<<20|t>>>12)+a|0,e+=(t&r|a&~r)+n[9]+568446438|0,e=(e<<5|e>>>27)+t|0,r+=(e&a|t&~a)+n[14]-1019803690|0,r=(r<<9|r>>>23)+e|0,a+=(r&t|e&~t)+n[3]-187363961|0,a=(a<<14|a>>>18)+r|0,t+=(a&e|r&~e)+n[8]+1163531501|0,t=(t<<20|t>>>12)+a|0,e+=(t&r|a&~r)+n[13]-1444681467|0,e=(e<<5|e>>>27)+t|0,r+=(e&a|t&~a)+n[2]-51403784|0,r=(r<<9|r>>>23)+e|0,a+=(r&t|e&~t)+n[7]+1735328473|0,a=(a<<14|a>>>18)+r|0,t+=(a&e|r&~e)+n[12]-1926607734|0,t=(t<<20|t>>>12)+a|0,e+=(t^a^r)+n[5]-378558|0,e=(e<<4|e>>>28)+t|0,r+=(e^t^a)+n[8]-2022574463|0,r=(r<<11|r>>>21)+e|0,a+=(r^e^t)+n[11]+1839030562|0,a=(a<<16|a>>>16)+r|0,t+=(a^r^e)+n[14]-35309556|0,t=(t<<23|t>>>9)+a|0,e+=(t^a^r)+n[1]-1530992060|0,e=(e<<4|e>>>28)+t|0,r+=(e^t^a)+n[4]+1272893353|0,r=(r<<11|r>>>21)+e|0,a+=(r^e^t)+n[7]-155497632|0,a=(a<<16|a>>>16)+r|0,t+=(a^r^e)+n[10]-1094730640|0,t=(t<<23|t>>>9)+a|0,e+=(t^a^r)+n[13]+681279174|0,e=(e<<4|e>>>28)+t|0,r+=(e^t^a)+n[0]-358537222|0,r=(r<<11|r>>>21)+e|0,a+=(r^e^t)+n[3]-722521979|0,a=(a<<16|a>>>16)+r|0,t+=(a^r^e)+n[6]+76029189|0,t=(t<<23|t>>>9)+a|0,e+=(t^a^r)+n[9]-640364487|0,e=(e<<4|e>>>28)+t|0,r+=(e^t^a)+n[12]-421815835|0,r=(r<<11|r>>>21)+e|0,a+=(r^e^t)+n[15]+530742520|0,a=(a<<16|a>>>16)+r|0,t+=(a^r^e)+n[2]-995338651|0,t=(t<<23|t>>>9)+a|0,e+=(a^(t|~r))+n[0]-198630844|0,e=(e<<6|e>>>26)+t|0,r+=(t^(e|~a))+n[7]+1126891415|0,r=(r<<10|r>>>22)+e|0,a+=(e^(r|~t))+n[14]-1416354905|0,a=(a<<15|a>>>17)+r|0,t+=(r^(a|~e))+n[5]-57434055|0,t=(t<<21|t>>>11)+a|0,e+=(a^(t|~r))+n[12]+1700485571|0,e=(e<<6|e>>>26)+t|0,r+=(t^(e|~a))+n[3]-1894986606|0,r=(r<<10|r>>>22)+e|0,a+=(e^(r|~t))+n[10]-1051523|0,a=(a<<15|a>>>17)+r|0,t+=(r^(a|~e))+n[1]-2054922799|0,t=(t<<21|t>>>11)+a|0,e+=(a^(t|~r))+n[8]+1873313359|0,e=(e<<6|e>>>26)+t|0,r+=(t^(e|~a))+n[15]-30611744|0,r=(r<<10|r>>>22)+e|0,a+=(e^(r|~t))+n[6]-1560198380|0,a=(a<<15|a>>>17)+r|0,t+=(r^(a|~e))+n[13]+1309151649|0,t=(t<<21|t>>>11)+a|0,e+=(a^(t|~r))+n[4]-145523070|0,e=(e<<6|e>>>26)+t|0,r+=(t^(e|~a))+n[11]-1120210379|0,r=(r<<10|r>>>22)+e|0,a+=(e^(r|~t))+n[2]+718787259|0,a=(a<<15|a>>>17)+r|0,t+=(r^(a|~e))+n[9]-343485551|0,t=(t<<21|t>>>11)+a|0,o[0]=e+o[0]|0,o[1]=t+o[1]|0,o[2]=a+o[2]|0,o[3]=r+o[3]|0}function b(o){var n=[],e;for(e=0;e<64;e+=4)n[e>>2]=o.charCodeAt(e)+(o.charCodeAt(e+1)<<8)+(o.charCodeAt(e+2)<<16)+(o.charCodeAt(e+3)<<24);return n}function c(o){var n=[],e;for(e=0;e<64;e+=4)n[e>>2]=o[e]+(o[e+1]<<8)+(o[e+2]<<16)+(o[e+3]<<24);return n}function g(o){var n=o.length,e=[1732584193,-271733879,-1732584194,271733878],t,a,r,L,T,k;for(t=64;t<=n;t+=64)u(e,b(o.substring(t-64,t)));for(o=o.substring(t-64),a=o.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<a;t+=1)r[t>>2]|=o.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(u(e,r),t=0;t<16;t+=1)r[t]=0;return L=n*8,L=L.toString(16).match(/(.*?)(.{0,8})$/),T=parseInt(L[2],16),k=parseInt(L[1],16)||0,r[14]=T,r[15]=k,u(e,r),e}function C(o){var n=o.length,e=[1732584193,-271733879,-1732584194,271733878],t,a,r,L,T,k;for(t=64;t<=n;t+=64)u(e,c(o.subarray(t-64,t)));for(o=t-64<n?o.subarray(t-64):new Uint8Array(0),a=o.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<a;t+=1)r[t>>2]|=o[t]<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(u(e,r),t=0;t<16;t+=1)r[t]=0;return L=n*8,L=L.toString(16).match(/(.*?)(.{0,8})$/),T=parseInt(L[2],16),k=parseInt(L[1],16)||0,r[14]=T,r[15]=k,u(e,r),e}function j(o){var n="",e;for(e=0;e<4;e+=1)n+=d[o>>e*8+4&15]+d[o>>e*8&15];return n}function P(o){var n;for(n=0;n<o.length;n+=1)o[n]=j(o[n]);return o.join("")}P(g("hello")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&(function(){function o(n,e){return n=n|0||0,n<0?Math.max(n+e,0):Math.min(n,e)}ArrayBuffer.prototype.slice=function(n,e){var t=this.byteLength,a=o(n,t),r=t,L,T,k,V;return e!==l&&(r=o(e,t)),a>r?new ArrayBuffer(0):(L=r-a,T=new ArrayBuffer(L),k=new Uint8Array(T),V=new Uint8Array(this,a,L),k.set(V),T)}})();function B(o){return/[\u0080-\uFFFF]/.test(o)&&(o=unescape(encodeURIComponent(o))),o}function y(o,n){var e=o.length,t=new ArrayBuffer(e),a=new Uint8Array(t),r;for(r=0;r<e;r+=1)a[r]=o.charCodeAt(r);return n?a:t}function D(o){return String.fromCharCode.apply(null,new Uint8Array(o))}function S(o,n,e){var t=new Uint8Array(o.byteLength+n.byteLength);return t.set(new Uint8Array(o)),t.set(new Uint8Array(n),o.byteLength),t}function I(o){var n=[],e=o.length,t;for(t=0;t<e-1;t+=2)n.push(parseInt(o.substr(t,2),16));return String.fromCharCode.apply(String,n)}function m(){this.reset()}return m.prototype.append=function(o){return this.appendBinary(B(o)),this},m.prototype.appendBinary=function(o){this._buff+=o,this._length+=o.length;var n=this._buff.length,e;for(e=64;e<=n;e+=64)u(this._hash,b(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},m.prototype.end=function(o){var n=this._buff,e=n.length,t,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r;for(t=0;t<e;t+=1)a[t>>2]|=n.charCodeAt(t)<<(t%4<<3);return this._finish(a,e),r=P(this._hash),o&&(r=I(r)),this.reset(),r},m.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},m.prototype.setState=function(o){return this._buff=o.buff,this._length=o.length,this._hash=o.hash,this},m.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},m.prototype._finish=function(o,n){var e=n,t,a,r;if(o[e>>2]|=128<<(e%4<<3),e>55)for(u(this._hash,o),e=0;e<16;e+=1)o[e]=0;t=this._length*8,t=t.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(t[2],16),r=parseInt(t[1],16)||0,o[14]=a,o[15]=r,u(this._hash,o)},m.hash=function(o,n){return m.hashBinary(B(o),n)},m.hashBinary=function(o,n){var e=g(o),t=P(e);return n?I(t):t},m.ArrayBuffer=function(){this.reset()},m.ArrayBuffer.prototype.append=function(o){var n=S(this._buff.buffer,o),e=n.length,t;for(this._length+=o.byteLength,t=64;t<=e;t+=64)u(this._hash,c(n.subarray(t-64,t)));return this._buff=t-64<e?new Uint8Array(n.buffer.slice(t-64)):new Uint8Array(0),this},m.ArrayBuffer.prototype.end=function(o){var n=this._buff,e=n.length,t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a,r;for(a=0;a<e;a+=1)t[a>>2]|=n[a]<<(a%4<<3);return this._finish(t,e),r=P(this._hash),o&&(r=I(r)),this.reset(),r},m.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},m.ArrayBuffer.prototype.getState=function(){var o=m.prototype.getState.call(this);return o.buff=D(o.buff),o},m.ArrayBuffer.prototype.setState=function(o){return o.buff=y(o.buff,!0),m.prototype.setState.call(this,o)},m.ArrayBuffer.prototype.destroy=m.prototype.destroy,m.ArrayBuffer.prototype._finish=m.prototype._finish,m.ArrayBuffer.hash=function(o,n){var e=C(new Uint8Array(o)),t=P(e);return n?I(t):t},m})})(Ut)),Ut.exports}var We=Fe();const Ze=ye(We),Yt=5;async function Wr(h){if(h.size>Yt*1024*1024)throw new Error(`Imagem muito grande. Máximo de ${Yt}MB.`);const i=await h.arrayBuffer(),l=Ze.ArrayBuffer.hash(i);if(At.has(l))return l;const d=new FileReader,b=await new Promise((c,g)=>{d.onload=()=>c(d.result),d.onerror=g,d.readAsDataURL(h)});return At.set(l,b),l}function ke(h,i){if(!h)return i(void 0),()=>{};i(At.get(h));const l=d=>{const u=At.get(h);i(u)};return At.observe(l),()=>{At.unobserve(l)}}var qe=z('<img class="w-full h-full object-cover rounded-full border border-white/10 shadow-sm"/>'),Ge=z('<div class="w-full h-full bg-slate-800 rounded-full border border-white/10 flex items-center justify-center font-black text-slate-500 shadow-sm"> </div>'),Xe=z("<div><!></div>");function Zr(h,i){It(i,!0);let l=R(i,"size",3,"md"),d=R(i,"fallbackText",3,"?"),u=F(void 0),b;Et(()=>{b&&b(),i.hash?b=ke(i.hash,B=>{A(u,B,!0)}):A(u,void 0)}),ae(()=>{b&&b()});const c={sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-16 h-16 text-lg",xl:"w-20 h-20 text-xl",custom:"w-full h-full"};var g=Xe(),C=p(g);{var j=B=>{var y=qe();W(()=>{Pt(y,"src",s(u)),Pt(y,"alt",i.alt)}),x(B,y)},P=B=>{var y=Ge(),D=p(y,!0);f(y),W(()=>H(D,d())),x(B,y)};G(C,B=>{s(u)?B(j):B(P,!1)})}f(g),W(()=>ft(g,1,`${c[l()]??""} relative flex-shrink-0`)),x(h,g),Nt()}var Ve=z('<div class="absolute z-50 bottom-full left-1/2 mb-2 w-max max-w-[200px] p-2 bg-slate-800 border border-indigo-500 rounded-lg shadow-xl shadow-black/50 text-[10px] text-slate-300 leading-relaxed text-center pointer-events-none whitespace-normal -translate-x-1/2" style="margin-left: var(--x-offset);"> <div class="absolute -bottom-1 left-1/2 w-2 h-2 bg-slate-800 border-r border-b border-indigo-500 -translate-x-1/2" style="transform: translateX(calc(-50% - var(--x-offset))) rotate(45deg);"></div></div>'),Ye=z('<div role="button" tabindex="0"><!> <!></div>');function kr(h,i){let l=R(i,"text",3,""),d=R(i,"class",3,""),u=F(!1),b=!1,c=F(0),g,C=F(void 0);function j(){if(!g||!s(C))return;const m=g.getBoundingClientRect(),n=s(C).getBoundingClientRect().width/2;A(c,0);const e=m.left+m.width/2-n;e<10&&A(c,10-e);const t=m.left+m.width/2+n;t>window.innerWidth-10&&A(c,window.innerWidth-10-t)}async function P(){b||(A(u,!0),setTimeout(j,0))}function B(m){b&&(s(u)?A(u,!1):(A(u,!0),setTimeout(j,0)))}var y=Ye();y.__touchstart=()=>b=!0,y.__click=B,y.__keydown=m=>{(m.key==="Enter"||m.key===" ")&&A(u,!s(u))};var D=p(y);re(D,()=>i.children??ee);var S=_(D,2);{var I=m=>{var o=Ve(),n=p(o);Ot(),f(o),Dt(o,e=>A(C,e),()=>s(C)),W(()=>H(n,`${l()??""} `)),Le(3,o,()=>Ee,()=>({duration:150,start:.95})),x(m,o)};G(S,m=>{s(u)&&l()&&m(I)})}f(y),Dt(y,m=>g=m,()=>g),W(()=>{ft(y,1,`relative inline-flex ${d()??""}`),Ft(y,`--x-offset: ${s(c)??""}px;`)}),jt("mouseenter",y,P),jt("mouseleave",y,()=>!b&&A(u,!1)),x(h,y)}St(["touchstart","click","keydown"]);var Ke=z('<div class="fixed inset-0 bg-black/50 z-[90] lg:hidden backdrop-blur-sm" role="button" tabindex="-1"></div>'),Je=z('<div class="flex flex-col items-center justify-center h-full text-slate-600 opacity-50"><div class="w-16 h-16 border-2 border-dashed border-slate-800 rounded-full flex items-center justify-center mb-4"><!></div> <p class="text-sm font-bold uppercase tracking-widest italic"> </p></div>'),Qe=z('<span class="text-[10px] text-white/50 font-black uppercase tracking-tighter"> </span>'),tr=z('<div class="text-[10px] text-slate-400 font-medium italic mt-1 leading-relaxed opacity-80 whitespace-pre-wrap"> </div>'),er=z('<span class="text-[8px] font-black uppercase tracking-widest bg-indigo-500/10 text-indigo-300 px-2 py-0.5 rounded-full border border-indigo-500/20"> </span>'),rr=z('<div class="flex flex-wrap gap-1 mb-3"></div>'),ar=z('<div class="absolute inset-0 bg-yellow-400/5 animate-pulse"></div>'),nr=z('<span class="text-[10px] animate-bounce">✨</span>'),ir=z('<div class="relative bg-black/40 rounded-xl p-3 flex justify-between items-center border border-white/5 group-hover:border-white/10 transition-colors overflow-hidden"><!> <div class="flex flex-col"><span class="text-[10px] text-slate-500 font-black uppercase tracking-widest mb-0.5"> </span> <div class="text-xs font-mono text-indigo-300 font-bold"> </div></div> <div class="flex flex-col items-end"><span class="text-[10px] text-slate-500 font-black uppercase tracking-widest mb-0.5"> </span> <div> <!></div></div></div>'),or=z('<div class="relative bg-slate-800/40 hover:bg-slate-800/60 transition-colors rounded-2xl border border-white/5 p-4 shadow-xl overflow-hidden group animate-in slide-in-from-right-8 duration-300"><div></div> <div class="flex justify-between items-start mb-3"><div class="flex flex-col"><div class="flex items-center gap-2"><span> </span> <!></div></div> <span class="text-[9px] text-slate-500 font-black tracking-widest uppercase"> </span></div> <div class="flex items-center gap-3 mb-2"><div class="flex-1"><div class="font-black text-white text-sm uppercase tracking-tight leading-snug"> </div> <!></div></div> <!> <!></div>'),sr=z('<!> <aside><div class="px-6 py-5 border-b border-white/5 flex justify-between items-center bg-slate-950/50"><div class="flex items-center gap-3"><div class="p-2 bg-indigo-500/10 rounded-lg border border-indigo-500/20"><!></div> <div><h3 class="font-black text-white uppercase tracking-widest text-sm"> </h3> <p class="text-[10px] text-slate-500 font-bold uppercase tracking-tighter"> </p></div></div> <button class="p-2 hover:bg-white/5 rounded-full text-slate-400 hover:text-white transition-all active:scale-90"><!></button></div> <div class="flex-1 overflow-y-auto p-4 sm:p-6 space-y-4 custom-scrollbar"><!> <!></div> <div class="p-6 border-t border-white/5 bg-slate-950/80"><button class="w-full py-3 text-xs font-black uppercase tracking-[0.2em] text-red-400/70 hover:text-red-400 border border-red-900/30 rounded-xl hover:bg-red-900/20 transition-all flex items-center justify-center gap-3 active:scale-[0.98]"><!> </button></div></aside>',1);function qr(h,i){It(i,!0);const l=()=>Wt(ie,"$t",u),d=()=>Wt(Ce,"$rollHistory",u),[u,b]=oe();let c=R(i,"isOpen",3,!1);var g=sr(),C=X(g);{var j=E=>{var w=Ke();w.__click=function(...$){i.onClose?.apply(this,$)},W($=>Pt(w,"aria-label",$),[()=>l()("character.history.close")]),x(E,w)};G(C,E=>{c()&&E(j)})}var P=_(C,2),B=p(P),y=p(B),D=p(y),S=p(D);Xt(S,{size:20,class:"text-indigo-400"}),f(D);var I=_(D,2),m=p(I),o=p(m,!0);f(m);var n=_(m,2),e=p(n);f(n),f(I),f(y);var t=_(y,2);t.__click=function(...E){i.onClose?.apply(this,E)};var a=p(t);se(a,{size:24}),f(t),f(B);var r=_(B,2),L=p(r);{var T=E=>{var w=Je(),$=p(w),q=p($);Xt(q,{size:32}),f($);var Q=_($,2),st=p(Q,!0);f(Q),f(w),W(Y=>H(st,Y),[()=>l()("character.history.none")]),x(E,w)};G(L,E=>{d().length===0&&E(T)})}var k=_(L,2);zt(k,1,d,E=>E.id,(E,w)=>{const $=me(()=>s(w).source?.toLowerCase().replace("ação","attribute").replace("consumível","item").replace("magia","spell").replace("dano","damage").replace("ataque","attack").replace("sorte","luck").replace("talento","talent"));var q=or(),Q=p(q),st=_(Q,2),Y=p(st),tt=p(Y),ut=p(tt),Ct=p(ut,!0);f(ut);var _t=_(ut,2);{var pt=M=>{var O=Qe(),dt=p(O,!0);f(O),W(()=>H(dt,s(w).charName)),x(M,O)};G(_t,M=>{s(w).charName&&s(w).charName!==s(w).source&&M(pt)})}f(tt),f(Y);var et=_(Y,2),ht=p(et,!0);f(et),f(st);var vt=_(st,2),mt=p(vt),ot=p(mt),lt=p(ot,!0);f(ot);var $t=_(ot,2);{var yt=M=>{var O=tr(),dt=p(O,!0);f(O),W(()=>H(dt,s(w).description)),x(M,O)};G($t,M=>{s(w).description&&M(yt)})}f(mt),f(vt);var v=_(vt,2);{var N=M=>{var O=rr();zt(O,21,()=>s(w).effectsApplied,ne,(dt,wt)=>{var bt=er(),Bt=p(bt,!0);f(bt),W(()=>H(Bt,s(wt))),x(dt,bt)}),f(O),x(M,O)};G(v,M=>{s(w).effectsApplied?.length>0&&M(N)})}var U=_(v,2);{var Z=M=>{var O=ir(),dt=p(O);{var wt=xt=>{var Lt=ar();x(xt,Lt)};G(dt,xt=>{s(w).crit&&xt(wt)})}var bt=_(dt,2),Bt=p(bt),de=p(Bt,!0);f(Bt);var Zt=_(Bt,2),ce=p(Zt,!0);f(Zt),f(bt);var kt=_(bt,2),Rt=p(kt),ue=p(Rt,!0);f(Rt);var Tt=_(Rt,2),qt=p(Tt),he=_(qt);{var ve=xt=>{var Lt=nr();x(xt,Lt)};G(he,xt=>{s(w).crit&&xt(ve)})}f(Tt),f(kt),f(O),W((xt,Lt,fe)=>{H(de,xt),H(ce,Lt),H(ue,fe),ft(Tt,1,`text-3xl font-black font-mono leading-none flex items-baseline gap-1 ${s(w).crit?"text-yellow-400 drop-shadow-[0_0_10px_rgba(250,204,21,0.3)]":"text-white"}`),H(qt,`${s(w).total??""} `)},[()=>l()("character.history.formula"),()=>s(w).formula||l()("character.history.fixed"),()=>l()("character.history.total")]),x(M,O)};G(U,M=>{(s(w).formula||s(w).total!==void 0)&&M(Z)})}f(q),W((M,O)=>{ft(Q,1,`absolute left-0 top-0 bottom-0 w-1 ${s(w).source==="GM"?"bg-indigo-500":"bg-emerald-500"}`),ft(ut,1,`text-[10px] px-1.5 py-0.5 rounded ${s(w).source==="GM"?"bg-indigo-500/20 text-indigo-400":"bg-emerald-500/20 text-emerald-400"} uppercase font-black tracking-widest leading-none border border-current opacity-70`),H(Ct,M),H(ht,O),H(lt,s(w).name)},[()=>l()(`character.history.source.${s($)}`,{default:s(w).source}),()=>new Date(s(w).timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]),x(E,q)}),f(r);var V=_(r,2),ct=p(V);ct.__click=function(...E){Pe.clearHistory?.apply(this,E)};var J=p(ct);Ae(J,{size:16});var gt=_(J);f(ct),f(V),f(P),W((E,w,$)=>{ft(P,1,`h-full bg-slate-900/95 backdrop-blur-xl border-l border-white/10 transition-all duration-500 ease-out shadow-[0_0_50px_rgba(0,0,0,0.5)] flex flex-col fixed top-0 right-0 z-[100] w-full sm:w-96 ${c()?"translate-x-0":"translate-x-full"}`),H(o,E),H(e,`${d().length??""} ${w??""}`),H(gt,` ${$??""}`)},[()=>l()("character.history.title"),()=>l()("character.history.rolls_count"),()=>l()("character.history.clear")]),x(h,g),Nt(),b()}St(["click"]);function Kt(h,i,l){return h>=i*l?{width:i*l,height:i}:{width:h,height:h/l}}function Ht(h,i,l,d){return{x:Jt(h.x,i.width,l.width,d),y:Jt(h.y,i.height,l.height,d)}}function Jt(h,i,l,d){let u=i*d/2-l/2;return d<1&&(u=l/2-i*d/2),Math.min(u,Math.max(h,-u))}function Qt(h,i){return Math.sqrt(Math.pow(h.y-i.y,2)+Math.pow(h.x-i.x,2))}function lr(h,i,l,d,u,b=!0){const c=b?dr:cr,g={x:c(100,((i.width-l.width/u)/2-h.x/u)/i.width*100),y:c(100,((i.height-l.height/u)/2-h.y/u)/i.height*100),width:c(100,l.width/i.width*100/u),height:c(100,l.height/i.height*100/u)},C=c(i.naturalWidth,g.width*i.naturalWidth/100,!0),j=c(i.naturalHeight,g.height*i.naturalHeight/100,!0),B=i.naturalWidth>=i.naturalHeight*d?{width:Math.round(j*d),height:j}:{width:C,height:Math.round(C/d)},y={...B,x:c(i.naturalWidth-B.width,g.x*i.naturalWidth/100,!0),y:c(i.naturalHeight-B.height,g.y*i.naturalHeight/100,!0)};return{croppedAreaPercentages:g,croppedAreaPixels:y}}function dr(h,i,l=!1){const d=l?Math.round(i):i;return Math.min(h,Math.max(0,d))}function cr(h,i){return i}function te(h,i){return{x:(i.x+h.x)/2,y:(i.y+h.y)/2}}var ur=z('<div data-testid="cropper"></div>'),hr=z('<div class="svelte-easy-crop-container svelte-1yetlj5" role="button" data-testid="container"><img class="svelte-easy-crop-image svelte-1yetlj5" alt=""/> <!></div>');function vr(h,i){It(i,!0);let l=R(i,"crop",31,()=>Mt({x:0,y:0})),d=R(i,"zoom",15,1),u=R(i,"minZoom",11,1),b=R(i,"maxZoom",11,3),c=R(i,"aspect",3,4/3),g=R(i,"cropSize",3,null),C=R(i,"cropShape",3,"rect"),j=R(i,"showGrid",3,!0),P=R(i,"zoomSpeed",3,1),B=R(i,"crossOrigin",3,null),y=R(i,"restrictPosition",3,!0),D=R(i,"tabindex",3,void 0),S=F(null),I=F(Mt({width:0,height:0,naturalWidth:0,naturalHeight:0})),m=F(null),o=F(null),n=F(null),e=F(Mt({x:0,y:0})),t=F(Mt({x:0,y:0})),a=F(0),r=F(null),L=F(null);xe(()=>{s(n)&&s(n).complete&&V(),s(m)&&(s(m).addEventListener("gesturestart",T),s(m).addEventListener("gesturechange",T))}),ae(()=>{s(m)&&(s(m).removeEventListener("gesturestart",T),s(m).removeEventListener("gesturechange",T)),k()});const T=v=>v.preventDefault(),k=()=>{typeof document<"u"&&(document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",tt),document.removeEventListener("touchmove",Q),document.removeEventListener("touchend",tt))},V=()=>{J(),vt()},ct=()=>g()?g().width/g().height:c(),J=()=>{s(n)&&(A(I,{width:s(n).width,height:s(n).height,naturalWidth:s(n).naturalWidth,naturalHeight:s(n).naturalHeight},!0),A(S,g()?g():Kt(s(n).width,s(n).height,c()),!0)),s(m)&&A(o,s(m).getBoundingClientRect(),!0)},gt=v=>({x:Number(v.clientX),y:Number(v.clientY)}),E=v=>({x:Number(v.clientX),y:Number(v.clientY)}),w=v=>{v.preventDefault(),document.addEventListener("mousemove",$),document.addEventListener("mouseup",tt),st(gt(v))},$=v=>Y(gt(v)),q=v=>{v.preventDefault(),document.addEventListener("touchmove",Q,{passive:!1}),document.addEventListener("touchend",tt),v.touches.length===2?ut(v):v.touches.length===1&&st(E(v.touches[0]))},Q=v=>{v.preventDefault(),v.touches.length===2?Ct(v):v.touches.length===1&&Y(E(v.touches[0]))},st=({x:v,y:N})=>{A(e,{x:v,y:N},!0),A(t,{x:l().x,y:l().y},!0)},Y=({x:v,y:N})=>{s(r)&&window.cancelAnimationFrame(s(r)),A(r,window.requestAnimationFrame(()=>{if(v===void 0||N===void 0||!s(S))return;const U=v-s(e).x,Z=N-s(e).y,M={x:s(t).x+U,y:s(t).y+Z};l(y()?Ht(M,s(I),s(S),d()):M)}),!0)},tt=()=>{k(),vt()},ut=v=>{const N=E(v.touches[0]),U=E(v.touches[1]);A(a,Qt(N,U),!0),st(te(N,U))},Ct=v=>{const N=E(v.touches[0]),U=E(v.touches[1]),Z=te(N,U);Y(Z),s(L)&&window.cancelAnimationFrame(s(L)),A(L,window.requestAnimationFrame(()=>{const M=Qt(N,U),O=d()*(M/s(a));ht(O,Z),A(a,M,!0)}),!0)},_t=v=>{v.preventDefault();const N=gt(v),U=d()-v.deltaY*P()/200;ht(U,N)},pt=({x:v,y:N})=>{if(!s(o))throw new Error("The Cropper is not mounted");return{x:s(o).width/2-(v-s(o).left),y:s(o).height/2-(N-s(o).top)}},et=({x:v,y:N})=>({x:(v+l().x)/d(),y:(N+l().y)/d()}),ht=(v,N)=>{if(!s(S))return;const U=pt(N),Z=et(U);d(Math.min(b(),Math.max(v,u())));const M={x:Z.x*d()-U.x,y:Z.y*d()-U.y};l(y()?Ht(M,s(I),s(S),d()):M)},vt=()=>{if(!s(S)||s(S).width===0)return;const v=y()?Ht(l(),s(I),s(S),d()):l(),{croppedAreaPercentages:N,croppedAreaPixels:U}=lr(v,s(I),s(S),ct(),d(),y());i.oncropcomplete?.({percent:N,pixels:U})};Et(()=>{s(n)&&A(S,g()?g():Kt(s(n).width,s(n).height,c()),!0)}),Et(()=>{d()&&vt()});const mt=v=>{Et(()=>(v.addEventListener("touchstart",q),v.addEventListener("mousedown",w),v.addEventListener("wheel",_t,{passive:!1}),()=>{v.removeEventListener("touchstart",q),v.removeEventListener("mousedown",w),v.removeEventListener("wheel",_t)}))};var ot=hr();jt("resize",be,J);var lt=p(ot);Dt(lt,v=>A(n,v),()=>s(n));var $t=_(lt,2);{var yt=v=>{var N=ur();let U;W(()=>{U=ft(N,1,"svelte-easy-crop-area svelte-1yetlj5",null,U,{"svelte-easy-crop-round":C()==="round","svelte-easy-crop-grid":j()}),Ft(N,`width: ${s(S).width??""}px; height: ${s(S).height??""}px;`)}),x(v,N)};G($t,v=>{s(S)&&v(yt)})}f(ot),Dt(ot,v=>A(m,v),()=>s(m)),Ne(ot,v=>mt?.(v)),W(()=>{Pt(ot,"tabindex",D()),Pt(lt,"src",i.image),Ft(lt,`transform: translate(${l().x??""}px, ${l().y??""}px) scale(${d()??""});`),Pt(lt,"crossorigin",B())}),jt("load",lt,V),_e(lt),x(h,ot),Nt()}const fr=h=>new Promise((i,l)=>{const d=new Image;d.addEventListener("load",()=>i(d)),d.addEventListener("error",u=>l(u)),d.setAttribute("crossOrigin","anonymous"),d.src=h});function le(h){return h*Math.PI/180}function gr(h,i,l){const d=le(l);return{width:Math.abs(Math.cos(d)*h)+Math.abs(Math.sin(d)*i),height:Math.abs(Math.sin(d)*h)+Math.abs(Math.cos(d)*i)}}async function pr(h,i,l=0,d={horizontal:!1,vertical:!1}){const u=await fr(h),b=document.createElement("canvas"),c=b.getContext("2d");if(!c)return null;const g=le(l),{width:C,height:j}=gr(u.width,u.height,l);b.width=C,b.height=j,c.translate(C/2,j/2),c.rotate(g),c.scale(d.horizontal?-1:1,d.vertical?-1:1),c.translate(-u.width/2,-u.height/2),c.drawImage(u,0,0);const P=c.getImageData(i.x,i.y,i.width,i.height);return b.width=i.width,b.height=i.height,c.putImageData(P,0,0),new Promise((B,y)=>{b.toBlob(D=>{B(D)},"image/jpeg",.8)})}var mr=z('<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> Processando...',1),br=z("<!> Salvar Foto",1),xr=z('<div class="fixed inset-0 z-[60] flex items-center justify-center bg-black/90 p-4 animate-in fade-in duration-200" role="dialog" aria-modal="true"><div class="bg-slate-900 border border-slate-700 rounded-2xl w-full max-w-2xl flex flex-col shadow-2xl overflow-hidden max-h-[90vh]"><div class="p-4 border-b border-slate-800 flex justify-between items-center bg-slate-950"><h3 class="font-bold text-white flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-indigo-500"></div> Editar Imagem</h3> <button class="text-slate-400 hover:text-white p-2 rounded-lg hover:bg-slate-800 transition-colors"><!></button></div> <div class="relative flex-1 bg-black min-h-[400px]"><!></div> <div class="p-4 bg-slate-950 border-t border-slate-800 space-y-4"><div class="flex items-center gap-4"><div class="flex items-center gap-2 text-slate-400 w-full px-4"><!> <input type="range" min="1" max="3" step="0.1" class="w-full accent-indigo-500 h-1 bg-slate-800 rounded-lg appearance-none cursor-pointer"/></div></div> <div class="flex justify-end gap-3 pt-2"><button class="px-6 py-2.5 rounded-xl bg-slate-800 hover:bg-slate-700 text-white font-bold transition-all text-sm border border-slate-700">Cancelar</button> <button class="px-8 py-2.5 rounded-xl bg-indigo-600 hover:bg-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold transition-all text-sm shadow-lg shadow-indigo-900/20 flex items-center gap-2"><!></button></div></div></div></div>');function Gr(h,i){It(i,!0);let l=R(i,"isOpen",3,!1),d=R(i,"imageUrl",3,""),u=R(i,"aspectRatio",3,1),b=F(Mt({x:0,y:0})),c=F(1),g=F(null),C=F(!1);async function j(){if(console.log("handleSave called",{isProcessing:s(C),pixelCrop:s(g)}),!(s(C)||!s(g))){A(C,!0);try{console.log("Calling getCroppedImg with",{imageUrl:d().substring(0,50)+"...",pixelCrop:s(g)});const D=await pr(d(),s(g),0);console.log("getCroppedImg result:",D),D&&i.onCrop(D)}catch(D){console.error("Error in handleSave:",D)}finally{A(C,!1)}}}var P=K(),B=X(P);{var y=D=>{var S=xr(),I=p(S),m=p(I),o=_(p(m),2);o.__click=function(...$){i.onClose?.apply(this,$)};var n=p(o);se(n,{size:20}),f(o),f(m);var e=_(m,2),t=p(e);vr(t,{get image(){return d()},get aspect(){return u()},oncropcomplete:$=>{console.log("oncropcomplete prop data:",$),A(g,$.pixels,!0)},showGrid:!0,get crop(){return s(b)},set crop($){A(b,$,!0)},get zoom(){return s(c)},set zoom($){A(c,$,!0)}}),f(e);var a=_(e,2),r=p(a),L=p(r),T=p(L);De(T,{size:16});var k=_(T,2);we(k),f(L),f(r);var V=_(r,2),ct=p(V);ct.__click=function(...$){i.onClose?.apply(this,$)};var J=_(ct,2);J.__click=j;var gt=p(J);{var E=$=>{var q=mr();Ot(),x($,q)},w=$=>{var q=br(),Q=X(q);Ie(Q,{size:18}),Ot(),x($,q)};G(gt,$=>{s(C)?$(E):$(w,!1)})}f(J),f(V),f(a),f(I),f(S),W(()=>J.disabled=s(C)),Be(k,()=>s(c),$=>A(c,$)),x(D,S)};G(B,D=>{l()&&D(y)})}x(h,P),Nt()}St(["click"]);export{Zr as A,jr as B,Dr as C,je as D,Rr as E,Tr as G,qr as H,Gr as I,Ur as L,ze as M,Hr as R,Or as S,kr as T,Ne as a,Sr as b,zr as c,Xt as d,Fr as e,Wr as s};
